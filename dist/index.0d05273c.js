let e,t,r,i,n,s,o,a,l,h;var u,c,d,f,p,m,g,v,y,x,b,T,A,E,w,C,S,I,R,M,P,O,D,N,F,B,L,k,U,G,z,j,H,V,X,W,$,Y,q,Z,K,Q,J,ee,et,er,ei,en,es,eo,ea,el,eh,eu,ec,ed,ef,ep,em,eg,ev,ey,e_,ex,eb,eT,eA,eE,ew,eC,eS,eI,eR,eM,eP,eO,eD,eN,eF,eB,eL,ek,eU,eG,ez,ej,eH,eV,eX,eW,e$,eY,eq,eZ,eK,eQ,eJ,e0,e1,e2,e3,e4,e5,e8,e6,e7,e9,te,tt,tr,ti,tn,ts,to,ta,tl,th,tu,tc,td,tf,tp,tm,tg,tv,ty,t_,tx,tb,tT,tA,tE,tw,tC,tS,tI,tR,tM,tP,tO,tD,tN,tF,tB,tL,tk,tU,tG,tz,tj,tH,tV,tX,tW=globalThis;function t$(e){return e&&e.__esModule?e.default:e}function tY(e,t,r,i){Object.defineProperty(e,t,{get:r,set:i,enumerable:!0,configurable:!0})}var tq={},tZ={},tK=tW.parcelRequire1995;null==tK&&((tK=function(e){if(e in tq)return tq[e].exports;if(e in tZ){var t=tZ[e];delete tZ[e];var r={id:e,exports:{}};return tq[e]=r,t.call(r.exports,r,r.exports),r.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){tZ[e]=t},tW.parcelRequire1995=tK);var tQ=tK.register;tQ("biuEp",function(e,t){var r=tK("dBHwk");function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var n=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,o=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,a=["'"].concat(["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","	"])),l=["%","/","?",";","#"].concat(a),h=["/","?","#"],u=/^[+a-z0-9A-Z_-]{0,63}$/,c=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,d={javascript:!0,"javascript:":!0},f={javascript:!0,"javascript:":!0},p={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},m=tK("2rasJ");function g(e,t,r){if(e&&"object"==typeof e&&e instanceof i)return e;var n=new i;return n.parse(e,t,r),n}i.prototype.parse=function(e,t,i){if("string"!=typeof e)throw TypeError("Parameter 'url' must be a string, not "+typeof e);var s=e.indexOf("?"),g=-1!==s&&s<e.indexOf("#")?"?":"#",v=e.split(g);v[0]=v[0].replace(/\\/g,"/");var y=e=v.join(g);if(y=y.trim(),!i&&1===e.split("#").length){var x=o.exec(y);if(x)return this.path=y,this.href=y,this.pathname=x[1],x[2]?(this.search=x[2],t?this.query=m.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var b=n.exec(y);if(b){var T=(b=b[0]).toLowerCase();this.protocol=T,y=y.substr(b.length)}if(i||b||y.match(/^\/\/[^@/]+@[^@/]+/)){var A="//"===y.substr(0,2);A&&!(b&&f[b])&&(y=y.substr(2),this.slashes=!0)}if(!f[b]&&(A||b&&!p[b])){for(var E,w,C=-1,S=0;S<h.length;S++){var I=y.indexOf(h[S]);-1!==I&&(-1===C||I<C)&&(C=I)}-1!==(w=-1===C?y.lastIndexOf("@"):y.lastIndexOf("@",C))&&(E=y.slice(0,w),y=y.slice(w+1),this.auth=decodeURIComponent(E)),C=-1;for(var S=0;S<l.length;S++){var I=y.indexOf(l[S]);-1!==I&&(-1===C||I<C)&&(C=I)}-1===C&&(C=y.length),this.host=y.slice(0,C),y=y.slice(C),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var M=this.hostname.split(/\./),S=0,P=M.length;S<P;S++){var O=M[S];if(O&&!O.match(u)){for(var D="",N=0,F=O.length;N<F;N++)O.charCodeAt(N)>127?D+="x":D+=O[N];if(!D.match(u)){var B=M.slice(0,S),L=M.slice(S+1),k=O.match(c);k&&(B.push(k[1]),L.unshift(k[2])),L.length&&(y="/"+L.join(".")+y),this.hostname=B.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=r.toASCII(this.hostname));var U=this.port?":"+this.port:"",G=this.hostname||"";this.host=G+U,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==y[0]&&(y="/"+y))}if(!d[T])for(var S=0,P=a.length;S<P;S++){var z=a[S];if(-1!==y.indexOf(z)){var j=encodeURIComponent(z);j===z&&(j=escape(z)),y=y.split(z).join(j)}}var H=y.indexOf("#");-1!==H&&(this.hash=y.substr(H),y=y.slice(0,H));var V=y.indexOf("?");if(-1!==V?(this.search=y.substr(V),this.query=y.substr(V+1),t&&(this.query=m.parse(this.query)),y=y.slice(0,V)):t&&(this.search="",this.query={}),y&&(this.pathname=y),p[T]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var U=this.pathname||"",X=this.search||"";this.path=U+X}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":")+"@");var t=this.protocol||"",r=this.pathname||"",i=this.hash||"",n=!1,s="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&"object"==typeof this.query&&Object.keys(this.query).length&&(s=m.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||p[t])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),i&&"#"!==i.charAt(0)&&(i="#"+i),o&&"?"!==o.charAt(0)&&(o="?"+o),t+n+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(o=o.replace("#","%23"))+i},i.prototype.resolve=function(e){return this.resolveObject(g(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if("string"==typeof e){var t=new i;t.parse(e,!1,!0),e=t}for(var r=new i,n=Object.keys(this),s=0;s<n.length;s++){var o=n[s];r[o]=this[o]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),l=0;l<a.length;l++){var h=a[l];"protocol"!==h&&(r[h]=e[h])}return p[r.protocol]&&r.hostname&&!r.pathname&&(r.pathname="/",r.path=r.pathname),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!p[e.protocol]){for(var u=Object.keys(e),c=0;c<u.length;c++){var d=u[c];r[d]=e[d]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||f[e.protocol])r.pathname=e.pathname;else{for(var m=(e.pathname||"").split("/");m.length&&!(e.host=m.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==m[0]&&m.unshift(""),m.length<2&&m.unshift(""),r.pathname=m.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var g=r.pathname||"",v=r.search||"";r.path=g+v}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var y=r.pathname&&"/"===r.pathname.charAt(0),x=e.host||e.pathname&&"/"===e.pathname.charAt(0),b=x||y||r.host&&e.pathname,T=b,A=r.pathname&&r.pathname.split("/")||[],m=e.pathname&&e.pathname.split("/")||[],E=r.protocol&&!p[r.protocol];if(E&&(r.hostname="",r.port=null,r.host&&(""===A[0]?A[0]=r.host:A.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===m[0]?m[0]=e.host:m.unshift(e.host)),e.host=null),b=b&&(""===m[0]||""===A[0])),x)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,A=m;else if(m.length)A||(A=[]),A.pop(),A=A.concat(m),r.search=e.search,r.query=e.query;else if(null!=e.search){if(E){r.host=A.shift(),r.hostname=r.host;var w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");w&&(r.auth=w.shift(),r.hostname=w.shift(),r.host=r.hostname)}return r.search=e.search,r.query=e.query,(null!==r.pathname||null!==r.search)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!A.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var C=A.slice(-1)[0],S=(r.host||e.host||A.length>1)&&("."===C||".."===C)||""===C,I=0,R=A.length;R>=0;R--)"."===(C=A[R])?A.splice(R,1):".."===C?(A.splice(R,1),I++):I&&(A.splice(R,1),I--);if(!b&&!T)for(;I--;I)A.unshift("..");b&&""!==A[0]&&(!A[0]||"/"!==A[0].charAt(0))&&A.unshift(""),S&&"/"!==A.join("/").substr(-1)&&A.push("");var M=""===A[0]||A[0]&&"/"===A[0].charAt(0);if(E){r.hostname=M?"":A.length?A.shift():"",r.host=r.hostname;var w=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");w&&(r.auth=w.shift(),r.hostname=w.shift(),r.host=r.hostname)}return(b=b||r.host&&A.length)&&!M&&A.unshift(""),A.length>0?r.pathname=A.join("/"):(r.pathname=null,r.path=null),(null!==r.pathname||null!==r.search)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},i.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},t.parse=g,t.resolve=function(e,t){return g(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?g(e,!1,!0).resolveObject(t):t},t.format=function(e){return("string"==typeof e&&(e=g(e)),e instanceof i)?e.format():i.prototype.format.call(e)},t.Url=i}),tQ("dBHwk",function(e,t){!function(r){var i=t&&!t.nodeType&&t,n=e&&!e.nodeType&&e,s="object"==typeof tW&&tW;(s.global===s||s.window===s||s.self===s)&&(r=s);var o,a,l=/^xn--/,h=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,c={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,f=String.fromCharCode;function p(e){throw RangeError(c[e])}function m(e,t){for(var r=e.length,i=[];r--;)i[r]=t(e[r]);return i}function g(e,t){var r=e.split("@"),i="";return r.length>1&&(i=r[0]+"@",e=r[1]),i+m((e=e.replace(u,".")).split("."),t).join(".")}function v(e){for(var t,r,i=[],n=0,s=e.length;n<s;)(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<s?(64512&(r=e.charCodeAt(n++)))==56320?i.push(((1023&t)<<10)+(1023&r)+65536):(i.push(t),n--):i.push(t);return i}function y(e){return m(e,function(e){var t="";return e>65535&&(e-=65536,t+=f(e>>>10&1023|55296),e=56320|1023&e),t+=f(e)}).join("")}function x(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function b(e,t,r){var i=0;for(e=r?d(e/700):e>>1,e+=d(e/t);e>455;i+=36)e=d(e/35);return d(i+36*e/(e+38))}function T(e){var t,r,i,n,s,o,a,l,h,u,c,f=[],m=e.length,g=0,v=128,x=72;for((i=e.lastIndexOf("-"))<0&&(i=0),n=0;n<i;++n)e.charCodeAt(n)>=128&&p("not-basic"),f.push(e.charCodeAt(n));for(s=i>0?i+1:0;s<m;){for(o=g,a=1,l=36;s>=m&&p("invalid-input"),((h=(t=e.charCodeAt(s++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:36)>=36||h>d((2147483647-g)/a))&&p("overflow"),g+=h*a,!(h<(u=l<=x?1:l>=x+26?26:l-x));l+=36)a>d(2147483647/(c=36-u))&&p("overflow"),a*=c;x=b(g-o,r=f.length+1,0==o),d(g/r)>2147483647-v&&p("overflow"),v+=d(g/r),g%=r,f.splice(g++,0,v)}return y(f)}function A(e){var t,r,i,n,s,o,a,l,h,u,c,m,g,y,T,A=[];for(o=0,m=(e=v(e)).length,t=128,r=0,s=72;o<m;++o)(c=e[o])<128&&A.push(f(c));for(i=n=A.length,n&&A.push("-");i<m;){for(a=2147483647,o=0;o<m;++o)(c=e[o])>=t&&c<a&&(a=c);for(a-t>d((2147483647-r)/(g=i+1))&&p("overflow"),r+=(a-t)*g,t=a,o=0;o<m;++o)if((c=e[o])<t&&++r>2147483647&&p("overflow"),c==t){for(l=r,h=36;!(l<(u=h<=s?1:h>=s+26?26:h-s));h+=36)T=l-u,y=36-u,A.push(f(x(u+T%y,0))),l=d(T/y);A.push(f(x(l,0))),s=b(r,g,i==n),r=0,++i}++r,++t}return A.join("")}if(o={version:"1.4.1",ucs2:{decode:v,encode:y},decode:T,encode:A,toASCII:function(e){return g(e,function(e){return h.test(e)?"xn--"+A(e):e})},toUnicode:function(e){return g(e,function(e){return l.test(e)?T(e.slice(4).toLowerCase()):e})}},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return o});else if(i&&n){if(e.exports==i)n.exports=o;else for(a in o)o.hasOwnProperty(a)&&(i[a]=o[a])}else r.punycode=o}(this)}),tQ("2rasJ",function(e,t){var r=tK("jJyEy"),i=tK("cfYIz"),n=tK("i1Gbt");e.exports={formats:n,parse:i,stringify:r}}),tQ("jJyEy",function(e,t){var r=tK("LlIML"),i=tK("iBfJ5"),n=tK("i1Gbt"),s=Object.prototype.hasOwnProperty,o={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},a=Array.isArray,l=Array.prototype.push,h=function(e,t){l.apply(e,a(t)?t:[t])},u=Date.prototype.toISOString,c=n.default,d={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:i.encode,encodeValuesOnly:!1,format:c,formatter:n.formatters[c],indices:!1,serializeDate:function(e){return u.call(e)},skipNulls:!1,strictNullHandling:!1},f={},p=function e(t,n,s,o,l,u,c,p,m,g,v,y,x,b,T,A){for(var E,w,C=t,S=A,I=0,R=!1;void 0!==(S=S.get(f))&&!R;){var M=S.get(t);if(I+=1,void 0!==M){if(M===I)throw RangeError("Cyclic object value");R=!0}void 0===S.get(f)&&(I=0)}if("function"==typeof p?C=p(n,C):C instanceof Date?C=v(C):"comma"===s&&a(C)&&(C=i.maybeMap(C,function(e){return e instanceof Date?v(e):e})),null===C){if(l)return c&&!b?c(n,d.encoder,T,"key",y):n;C=""}if("string"==typeof(E=C)||"number"==typeof E||"boolean"==typeof E||"symbol"==typeof E||"bigint"==typeof E||i.isBuffer(C))return c?[x(b?n:c(n,d.encoder,T,"key",y))+"="+x(c(C,d.encoder,T,"value",y))]:[x(n)+"="+x(String(C))];var P=[];if(void 0===C)return P;if("comma"===s&&a(C))b&&c&&(C=i.maybeMap(C,c)),w=[{value:C.length>0?C.join(",")||null:void 0}];else if(a(p))w=p;else{var O=Object.keys(C);w=m?O.sort(m):O}for(var D=o&&a(C)&&1===C.length?n+"[]":n,N=0;N<w.length;++N){var F=w[N],B="object"==typeof F&&void 0!==F.value?F.value:C[F];if(!u||null!==B){var L=a(C)?"function"==typeof s?s(D,F):D:D+(g?"."+F:"["+F+"]");A.set(t,I);var k=r();k.set(f,A),h(P,e(B,L,s,o,l,u,"comma"===s&&b&&a(C)?null:c,p,m,g,v,y,x,b,T,k))}}return P},m=function(e){if(!e)return d;if(null!==e.encoder&&void 0!==e.encoder&&"function"!=typeof e.encoder)throw TypeError("Encoder has to be a function.");var t=e.charset||d.charset;if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=n.default;if(void 0!==e.format){if(!s.call(n.formatters,e.format))throw TypeError("Unknown format option provided.");r=e.format}var i=n.formatters[r],o=d.filter;return("function"==typeof e.filter||a(e.filter))&&(o=e.filter),{addQueryPrefix:"boolean"==typeof e.addQueryPrefix?e.addQueryPrefix:d.addQueryPrefix,allowDots:void 0===e.allowDots?d.allowDots:!!e.allowDots,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:d.charsetSentinel,delimiter:void 0===e.delimiter?d.delimiter:e.delimiter,encode:"boolean"==typeof e.encode?e.encode:d.encode,encoder:"function"==typeof e.encoder?e.encoder:d.encoder,encodeValuesOnly:"boolean"==typeof e.encodeValuesOnly?e.encodeValuesOnly:d.encodeValuesOnly,filter:o,format:r,formatter:i,serializeDate:"function"==typeof e.serializeDate?e.serializeDate:d.serializeDate,skipNulls:"boolean"==typeof e.skipNulls?e.skipNulls:d.skipNulls,sort:"function"==typeof e.sort?e.sort:null,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:d.strictNullHandling}};e.exports=function(e,t){var i,n,s=e,l=m(t);"function"==typeof l.filter?s=(0,l.filter)("",s):a(l.filter)&&(i=l.filter);var u=[];if("object"!=typeof s||null===s)return"";n=t&&t.arrayFormat in o?t.arrayFormat:t&&"indices"in t?t.indices?"indices":"repeat":"indices";var c=o[n];if(t&&"commaRoundTrip"in t&&"boolean"!=typeof t.commaRoundTrip)throw TypeError("`commaRoundTrip` must be a boolean, or absent");var d="comma"===c&&t&&t.commaRoundTrip;i||(i=Object.keys(s)),l.sort&&i.sort(l.sort);for(var f=r(),g=0;g<i.length;++g){var v=i[g];l.skipNulls&&null===s[v]||h(u,p(s[v],v,c,d,l.strictNullHandling,l.skipNulls,l.encode?l.encoder:null,l.filter,l.sort,l.allowDots,l.serializeDate,l.format,l.formatter,l.encodeValuesOnly,l.charset,f))}var y=u.join(l.delimiter),x=!0===l.addQueryPrefix?"?":"";return l.charsetSentinel&&("iso-8859-1"===l.charset?x+="utf8=%26%2310003%3B&":x+="utf8=%E2%9C%93&"),y.length>0?x+y:""}}),tQ("LlIML",function(e,t){var r=tK("1zENl"),i=tK("hXu6F"),n=tK("e7DLx"),s=r("%TypeError%"),o=r("%WeakMap%",!0),a=r("%Map%",!0),l=i("WeakMap.prototype.get",!0),h=i("WeakMap.prototype.set",!0),u=i("WeakMap.prototype.has",!0),c=i("Map.prototype.get",!0),d=i("Map.prototype.set",!0),f=i("Map.prototype.has",!0),p=function(e,t){for(var r,i=e;null!==(r=i.next);i=r)if(r.key===t)return i.next=r.next,r.next=e.next,e.next=r,r},m=function(e,t){var r=p(e,t);return r&&r.value},g=function(e,t,r){var i=p(e,t);i?i.value=r:e.next={key:t,next:e.next,value:r}};e.exports=function(){var e,t,r,i={assert:function(e){if(!i.has(e))throw new s("Side channel does not contain "+n(e))},get:function(i){if(o&&i&&("object"==typeof i||"function"==typeof i)){if(e)return l(e,i)}else if(a){if(t)return c(t,i)}else if(r)return m(r,i)},has:function(i){if(o&&i&&("object"==typeof i||"function"==typeof i)){if(e)return u(e,i)}else if(a){if(t)return f(t,i)}else if(r)return!!p(r,i);return!1},set:function(i,n){o&&i&&("object"==typeof i||"function"==typeof i)?(e||(e=new o),h(e,i,n)):a?(t||(t=new a),d(t,i,n)):(r||(r={key:{},next:null}),g(r,i,n))}};return i}}),tQ("1zENl",function(e,t){var r=SyntaxError,i=Function,n=TypeError,s=function(e){try{return i('"use strict"; return ('+e+").constructor;")()}catch(e){}},o=Object.getOwnPropertyDescriptor;if(o)try{o({},"")}catch(e){o=null}var a=function(){throw new n},l=o?function(){try{return arguments.callee,a}catch(e){try{return o(arguments,"callee").get}catch(e){return a}}}():a,h=tK("24qIq")(),u=tK("dSRh6")(),c=Object.getPrototypeOf||(u?function(e){return e.__proto__}:null),d={},f="undefined"!=typeof Uint8Array&&c?c(Uint8Array):void 0,p={"%AggregateError%":"undefined"==typeof AggregateError?void 0:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?void 0:ArrayBuffer,"%ArrayIteratorPrototype%":h&&c?c([][Symbol.iterator]()):void 0,"%AsyncFromSyncIteratorPrototype%":void 0,"%AsyncFunction%":d,"%AsyncGenerator%":d,"%AsyncGeneratorFunction%":d,"%AsyncIteratorPrototype%":d,"%Atomics%":"undefined"==typeof Atomics?void 0:Atomics,"%BigInt%":"undefined"==typeof BigInt?void 0:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?void 0:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?void 0:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?void 0:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?void 0:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?void 0:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?void 0:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":d,"%Int8Array%":"undefined"==typeof Int8Array?void 0:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?void 0:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?void 0:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":h&&c?c(c([][Symbol.iterator]())):void 0,"%JSON%":"object"==typeof JSON?JSON:void 0,"%Map%":"undefined"==typeof Map?void 0:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&h&&c?c(new Map()[Symbol.iterator]()):void 0,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?void 0:Promise,"%Proxy%":"undefined"==typeof Proxy?void 0:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?void 0:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?void 0:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&h&&c?c(new Set()[Symbol.iterator]()):void 0,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?void 0:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":h&&c?c(""[Symbol.iterator]()):void 0,"%Symbol%":h?Symbol:void 0,"%SyntaxError%":r,"%ThrowTypeError%":l,"%TypedArray%":f,"%TypeError%":n,"%Uint8Array%":"undefined"==typeof Uint8Array?void 0:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?void 0:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?void 0:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?void 0:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?void 0:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?void 0:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?void 0:WeakSet};if(c)try{null.error}catch(e){var m=c(c(e));p["%Error.prototype%"]=m}var g=function e(t){var r;if("%AsyncFunction%"===t)r=s("async function () {}");else if("%GeneratorFunction%"===t)r=s("function* () {}");else if("%AsyncGeneratorFunction%"===t)r=s("async function* () {}");else if("%AsyncGenerator%"===t){var i=e("%AsyncGeneratorFunction%");i&&(r=i.prototype)}else if("%AsyncIteratorPrototype%"===t){var n=e("%AsyncGenerator%");n&&c&&(r=c(n.prototype))}return p[t]=r,r},v={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},y=tK("gvair"),x=tK("4c4Ky"),b=y.call(Function.call,Array.prototype.concat),T=y.call(Function.apply,Array.prototype.splice),A=y.call(Function.call,String.prototype.replace),E=y.call(Function.call,String.prototype.slice),w=y.call(Function.call,RegExp.prototype.exec),C=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,S=/\\(\\)?/g,I=function(e){var t=E(e,0,1),i=E(e,-1);if("%"===t&&"%"!==i)throw new r("invalid intrinsic syntax, expected closing `%`");if("%"===i&&"%"!==t)throw new r("invalid intrinsic syntax, expected opening `%`");var n=[];return A(e,C,function(e,t,r,i){n[n.length]=r?A(i,S,"$1"):t||e}),n},R=function(e,t){var i,s=e;if(x(v,s)&&(s="%"+(i=v[s])[0]+"%"),x(p,s)){var o=p[s];if(o===d&&(o=g(s)),void 0===o&&!t)throw new n("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:s,value:o}}throw new r("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new n("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new n('"allowMissing" argument must be a boolean');if(null===w(/^%?[^%]*%?$/,e))throw new r("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var i=I(e),s=i.length>0?i[0]:"",a=R("%"+s+"%",t),l=a.name,h=a.value,u=!1,c=a.alias;c&&(s=c[0],T(i,b([0,1],c)));for(var d=1,f=!0;d<i.length;d+=1){var m=i[d],g=E(m,0,1),v=E(m,-1);if(('"'===g||"'"===g||"`"===g||'"'===v||"'"===v||"`"===v)&&g!==v)throw new r("property names with quotes must have matching quotes");if("constructor"!==m&&f||(u=!0),s+="."+m,x(p,l="%"+s+"%"))h=p[l];else if(null!=h){if(!(m in h)){if(!t)throw new n("base intrinsic for "+e+" exists, but the property is not available.");return}if(o&&d+1>=i.length){var y=o(h,m);h=(f=!!y)&&"get"in y&&!("originalValue"in y.get)?y.get:h[m]}else f=x(h,m),h=h[m];f&&!u&&(p[l]=h)}}return h}}),tQ("24qIq",function(e,t){var r="undefined"!=typeof Symbol&&Symbol,i=tK("7YWkK");e.exports=function(){return"function"==typeof r&&"function"==typeof Symbol&&"symbol"==typeof r("foo")&&"symbol"==typeof Symbol("bar")&&i()}}),tQ("7YWkK",function(e,t){e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),r=Object(t);if("string"==typeof t||"[object Symbol]"!==Object.prototype.toString.call(t)||"[object Symbol]"!==Object.prototype.toString.call(r))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length||"function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var i=Object.getOwnPropertySymbols(e);if(1!==i.length||i[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var n=Object.getOwnPropertyDescriptor(e,t);if(42!==n.value||!0!==n.enumerable)return!1}return!0}}),tQ("dSRh6",function(e,t){var r={foo:{}},i=Object;e.exports=function(){return({__proto__:r}).foo===r.foo&&!(({__proto__:null})instanceof i)}}),tQ("gvair",function(e,t){var r=tK("kAGnA");e.exports=Function.prototype.bind||r}),tQ("kAGnA",function(e,t){var r=Object.prototype.toString,i=Math.max,n=function(e,t){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var n=0;n<t.length;n+=1)r[n+e.length]=t[n];return r},s=function(e,t){for(var r=[],i=t||0,n=0;i<e.length;i+=1,n+=1)r[n]=e[i];return r},o=function(e,t){for(var r="",i=0;i<e.length;i+=1)r+=e[i],i+1<e.length&&(r+=t);return r};e.exports=function(e){var t,a=this;if("function"!=typeof a||"[object Function]"!==r.apply(a))throw TypeError("Function.prototype.bind called on incompatible "+a);for(var l=s(arguments,1),h=i(0,a.length-l.length),u=[],c=0;c<h;c++)u[c]="$"+c;if(t=Function("binder","return function ("+o(u,",")+"){ return binder.apply(this,arguments); }")(function(){if(this instanceof t){var r=a.apply(this,n(l,arguments));return Object(r)===r?r:this}return a.apply(e,n(l,arguments))}),a.prototype){var d=function(){};d.prototype=a.prototype,t.prototype=new d,d.prototype=null}return t}}),tQ("4c4Ky",function(e,t){var r=Function.prototype.call,i=Object.prototype.hasOwnProperty,n=tK("gvair");e.exports=n.call(r,i)}),tQ("hXu6F",function(e,t){var r=tK("1zENl"),i=tK("cOB0F"),n=i(r("String.prototype.indexOf"));e.exports=function(e,t){var s=r(e,!!t);return"function"==typeof s&&n(e,".prototype.")>-1?i(s):s}}),tQ("cOB0F",function(e,t){var r=tK("gvair"),i=tK("1zENl"),n=tK("BPe9e"),s=i("%TypeError%"),o=i("%Function.prototype.apply%"),a=i("%Function.prototype.call%"),l=i("%Reflect.apply%",!0)||r.call(a,o),h=i("%Object.defineProperty%",!0),u=i("%Math.max%");if(h)try{h({},"a",{value:1})}catch(e){h=null}e.exports=function(e){if("function"!=typeof e)throw new s("a function is required");var t=l(r,a,arguments);return n(t,1+u(0,e.length-(arguments.length-1)),!0)};var c=function(){return l(r,o,arguments)};h?h(e.exports,"apply",{value:c}):e.exports.apply=c}),tQ("BPe9e",function(e,t){var r=tK("1zENl"),i=tK("5FEEt"),n=tK("i16wS")(),s=tK("dYOee"),o=r("%TypeError%"),a=r("%Math.floor%");e.exports=function(e,t){if("function"!=typeof e)throw new o("`fn` is not a function");if("number"!=typeof t||t<0||t>4294967295||a(t)!==t)throw new o("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],l=!0,h=!0;if("length"in e&&s){var u=s(e,"length");u&&!u.configurable&&(l=!1),u&&!u.writable&&(h=!1)}return(l||h||!r)&&(n?i(e,"length",t,!0,!0):i(e,"length",t)),e}}),tQ("5FEEt",function(e,t){var r=tK("i16wS")(),i=tK("1zENl"),n=r&&i("%Object.defineProperty%",!0);if(n)try{n({},"a",{value:1})}catch(e){n=!1}var s=i("%SyntaxError%"),o=i("%TypeError%"),a=tK("dYOee");e.exports=function(e,t,r){if(!e||"object"!=typeof e&&"function"!=typeof e)throw new o("`obj` must be an object or a function`");if("string"!=typeof t&&"symbol"!=typeof t)throw new o("`property` must be a string or a symbol`");if(arguments.length>3&&"boolean"!=typeof arguments[3]&&null!==arguments[3])throw new o("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&"boolean"!=typeof arguments[4]&&null!==arguments[4])throw new o("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&"boolean"!=typeof arguments[5]&&null!==arguments[5])throw new o("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&"boolean"!=typeof arguments[6])throw new o("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,l=arguments.length>4?arguments[4]:null,h=arguments.length>5?arguments[5]:null,u=arguments.length>6&&arguments[6],c=!!a&&a(e,t);if(n)n(e,t,{configurable:null===h&&c?c.configurable:!h,enumerable:null===i&&c?c.enumerable:!i,value:r,writable:null===l&&c?c.writable:!l});else if(!u&&(i||l||h))throw new s("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.");else e[t]=r}}),tQ("i16wS",function(e,t){var r=tK("1zENl")("%Object.defineProperty%",!0),i=function(){if(r)try{return r({},"a",{value:1}),!0}catch(e){}return!1};i.hasArrayLengthDefineBug=function(){if(!i())return null;try{return 1!==r([],"length",{value:1}).length}catch(e){return!0}},e.exports=i}),tQ("dYOee",function(e,t){var r=tK("1zENl")("%Object.getOwnPropertyDescriptor%",!0);if(r)try{r([],"length")}catch(e){r=null}e.exports=r}),tQ("e7DLx",function(e,t){var r="function"==typeof Map&&Map.prototype,i=Object.getOwnPropertyDescriptor&&r?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,n=r&&i&&"function"==typeof i.get?i.get:null,s=r&&Map.prototype.forEach,o="function"==typeof Set&&Set.prototype,a=Object.getOwnPropertyDescriptor&&o?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,l=o&&a&&"function"==typeof a.get?a.get:null,h=o&&Set.prototype.forEach,u="function"==typeof WeakMap&&WeakMap.prototype?WeakMap.prototype.has:null,c="function"==typeof WeakSet&&WeakSet.prototype?WeakSet.prototype.has:null,d="function"==typeof WeakRef&&WeakRef.prototype?WeakRef.prototype.deref:null,f=Boolean.prototype.valueOf,p=Object.prototype.toString,m=Function.prototype.toString,g=String.prototype.match,v=String.prototype.slice,y=String.prototype.replace,x=String.prototype.toUpperCase,b=String.prototype.toLowerCase,T=RegExp.prototype.test,A=Array.prototype.concat,E=Array.prototype.join,w=Array.prototype.slice,C=Math.floor,S="function"==typeof BigInt?BigInt.prototype.valueOf:null,I=Object.getOwnPropertySymbols,R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol.prototype.toString:null,M="function"==typeof Symbol&&"object"==typeof Symbol.iterator,P="function"==typeof Symbol&&Symbol.toStringTag&&(typeof Symbol.toStringTag===M?"object":"symbol")?Symbol.toStringTag:null,O=Object.prototype.propertyIsEnumerable,D=("function"==typeof Reflect?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function N(e,t){if(e===1/0||e===-1/0||e!=e||e&&e>-1e3&&e<1e3||T.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if("number"==typeof e){var i=e<0?-C(-e):C(e);if(i!==e){var n=String(i),s=v.call(t,n.length+1);return y.call(n,r,"$&_")+"."+y.call(y.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return y.call(t,r,"$&_")}var F=tK("kjyEk"),B=F.custom,L=z(B)?B:null;function k(e,t,r){var i="double"===(r.quoteStyle||t)?'"':"'";return i+e+i}function U(e){return"[object Array]"===V(e)&&(!P||!("object"==typeof e&&P in e))}function G(e){return"[object RegExp]"===V(e)&&(!P||!("object"==typeof e&&P in e))}function z(e){if(M)return e&&"object"==typeof e&&e instanceof Symbol;if("symbol"==typeof e)return!0;if(!e||"object"!=typeof e||!R)return!1;try{return R.call(e),!0}catch(e){}return!1}e.exports=function e(t,r,i,o){var a=r||{};if(H(a,"quoteStyle")&&"single"!==a.quoteStyle&&"double"!==a.quoteStyle)throw TypeError('option "quoteStyle" must be "single" or "double"');if(H(a,"maxStringLength")&&("number"==typeof a.maxStringLength?a.maxStringLength<0&&a.maxStringLength!==1/0:null!==a.maxStringLength))throw TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var p=!H(a,"customInspect")||a.customInspect;if("boolean"!=typeof p&&"symbol"!==p)throw TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(H(a,"indent")&&null!==a.indent&&"	"!==a.indent&&!(parseInt(a.indent,10)===a.indent&&a.indent>0))throw TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(H(a,"numericSeparator")&&"boolean"!=typeof a.numericSeparator)throw TypeError('option "numericSeparator", if provided, must be `true` or `false`');var x=a.numericSeparator;if(void 0===t)return"undefined";if(null===t)return"null";if("boolean"==typeof t)return t?"true":"false";if("string"==typeof t)return function e(t,r){if(t.length>r.maxStringLength){var i=t.length-r.maxStringLength;return e(v.call(t,0,r.maxStringLength),r)+"... "+i+" more character"+(i>1?"s":"")}return k(y.call(y.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,W),"single",r)}(t,a);if("number"==typeof t){if(0===t)return 1/0/t>0?"0":"-0";var T=String(t);return x?N(t,T):T}if("bigint"==typeof t){var C=String(t)+"n";return x?N(t,C):C}var I=void 0===a.depth?5:a.depth;if(void 0===i&&(i=0),i>=I&&I>0&&"object"==typeof t)return U(t)?"[Array]":"[Object]";var B=function(e,t){var r;if("	"===e.indent)r="	";else{if("number"!=typeof e.indent||!(e.indent>0))return null;r=E.call(Array(e.indent+1)," ")}return{base:r,prev:E.call(Array(t+1),r)}}(a,i);if(void 0===o)o=[];else if(X(o,t)>=0)return"[Circular]";function j(t,r,n){if(r&&(o=w.call(o)).push(r),n){var s={depth:a.depth};return H(a,"quoteStyle")&&(s.quoteStyle=a.quoteStyle),e(t,s,i+1,o)}return e(t,a,i+1,o)}if("function"==typeof t&&!G(t)){var Q=function(e){if(e.name)return e.name;var t=g.call(m.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}(t),J=K(t,j);return"[Function"+(Q?": "+Q:" (anonymous)")+"]"+(J.length>0?" { "+E.call(J,", ")+" }":"")}if(z(t)){var ee=M?y.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):R.call(t);return"object"!=typeof t||M?ee:$(ee)}if(t&&"object"==typeof t&&("undefined"!=typeof HTMLElement&&t instanceof HTMLElement||"string"==typeof t.nodeName&&"function"==typeof t.getAttribute)){for(var et,er="<"+b.call(String(t.nodeName)),ei=t.attributes||[],en=0;en<ei.length;en++)er+=" "+ei[en].name+"="+k((et=ei[en].value,y.call(String(et),/"/g,"&quot;")),"double",a);return er+=">",t.childNodes&&t.childNodes.length&&(er+="..."),er+="</"+b.call(String(t.nodeName))+">"}if(U(t)){if(0===t.length)return"[]";var es=K(t,j);return B&&!function(e){for(var t=0;t<e.length;t++)if(X(e[t],"\n")>=0)return!1;return!0}(es)?"["+Z(es,B)+"]":"[ "+E.call(es,", ")+" ]"}if("[object Error]"===V(t)&&(!P||!("object"==typeof t&&P in t))){var eo=K(t,j);return"cause"in Error.prototype||!("cause"in t)||O.call(t,"cause")?0===eo.length?"["+String(t)+"]":"{ ["+String(t)+"] "+E.call(eo,", ")+" }":"{ ["+String(t)+"] "+E.call(A.call("[cause]: "+j(t.cause),eo),", ")+" }"}if("object"==typeof t&&p){if(L&&"function"==typeof t[L]&&F)return F(t,{depth:I-i});if("symbol"!==p&&"function"==typeof t.inspect)return t.inspect()}if(function(e){if(!n||!e||"object"!=typeof e)return!1;try{n.call(e);try{l.call(e)}catch(e){return!0}return e instanceof Map}catch(e){}return!1}(t)){var ea=[];return s&&s.call(t,function(e,r){ea.push(j(r,t,!0)+" => "+j(e,t))}),q("Map",n.call(t),ea,B)}if(function(e){if(!l||!e||"object"!=typeof e)return!1;try{l.call(e);try{n.call(e)}catch(e){return!0}return e instanceof Set}catch(e){}return!1}(t)){var el=[];return h&&h.call(t,function(e){el.push(j(e,t))}),q("Set",l.call(t),el,B)}if(function(e){if(!u||!e||"object"!=typeof e)return!1;try{u.call(e,u);try{c.call(e,c)}catch(e){return!0}return e instanceof WeakMap}catch(e){}return!1}(t))return Y("WeakMap");if(function(e){if(!c||!e||"object"!=typeof e)return!1;try{c.call(e,c);try{u.call(e,u)}catch(e){return!0}return e instanceof WeakSet}catch(e){}return!1}(t))return Y("WeakSet");if(function(e){if(!d||!e||"object"!=typeof e)return!1;try{return d.call(e),!0}catch(e){}return!1}(t))return Y("WeakRef");if("[object Number]"===V(t)&&(!P||!("object"==typeof t&&P in t)))return $(j(Number(t)));if(function(e){if(!e||"object"!=typeof e||!S)return!1;try{return S.call(e),!0}catch(e){}return!1}(t))return $(j(S.call(t)));if("[object Boolean]"===V(t)&&(!P||!("object"==typeof t&&P in t)))return $(f.call(t));if("[object String]"===V(t)&&(!P||!("object"==typeof t&&P in t)))return $(j(String(t)));if("undefined"!=typeof window&&t===window)return"{ [object Window] }";if(t===tW)return"{ [object globalThis] }";if(!("[object Date]"===V(t)&&(!P||!("object"==typeof t&&P in t)))&&!G(t)){var eh=K(t,j),eu=D?D(t)===Object.prototype:t instanceof Object||t.constructor===Object,ec=t instanceof Object?"":"null prototype",ed=!eu&&P&&Object(t)===t&&P in t?v.call(V(t),8,-1):ec?"Object":"",ef=(eu||"function"!=typeof t.constructor?"":t.constructor.name?t.constructor.name+" ":"")+(ed||ec?"["+E.call(A.call([],ed||[],ec||[]),": ")+"] ":"");return 0===eh.length?ef+"{}":B?ef+"{"+Z(eh,B)+"}":ef+"{ "+E.call(eh,", ")+" }"}return String(t)};var j=Object.prototype.hasOwnProperty||function(e){return e in this};function H(e,t){return j.call(e,t)}function V(e){return p.call(e)}function X(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,i=e.length;r<i;r++)if(e[r]===t)return r;return -1}function W(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+x.call(t.toString(16))}function $(e){return"Object("+e+")"}function Y(e){return e+" { ? }"}function q(e,t,r,i){return e+" ("+t+") {"+(i?Z(r,i):E.call(r,", "))+"}"}function Z(e,t){if(0===e.length)return"";var r="\n"+t.prev+t.base;return r+E.call(e,","+r)+"\n"+t.prev}function K(e,t){var r,i=U(e),n=[];if(i){n.length=e.length;for(var s=0;s<e.length;s++)n[s]=H(e,s)?t(e[s],e):""}var o="function"==typeof I?I(e):[];if(M){r={};for(var a=0;a<o.length;a++)r["$"+o[a]]=o[a]}for(var l in e)if(H(e,l)&&(!i||String(Number(l))!==l||!(l<e.length))){if(M&&r["$"+l]instanceof Symbol)continue;T.call(/[^\w$]/,l)?n.push(t(l,e)+": "+t(e[l],e)):n.push(l+": "+t(e[l],e))}if("function"==typeof I)for(var h=0;h<o.length;h++)O.call(e,o[h])&&n.push("["+t(o[h])+"]: "+t(e[o[h]],e));return n}}),tQ("kjyEk",function(e,t){}),tQ("iBfJ5",function(e,t){var r=tK("i1Gbt"),i=Object.prototype.hasOwnProperty,n=Array.isArray,s=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),o=function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(n(r)){for(var i=[],s=0;s<r.length;++s)void 0!==r[s]&&i.push(r[s]);t.obj[t.prop]=i}}},a=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},i=0;i<e.length;++i)void 0!==e[i]&&(r[i]=e[i]);return r};e.exports={arrayToObject:a,assign:function(e,t){return Object.keys(t).reduce(function(e,r){return e[r]=t[r],e},e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],i=0;i<t.length;++i)for(var n=t[i],s=n.obj[n.prop],a=Object.keys(s),l=0;l<a.length;++l){var h=a[l],u=s[h];"object"==typeof u&&null!==u&&-1===r.indexOf(u)&&(t.push({obj:s,prop:h}),r.push(u))}return o(t),e},decode:function(e,t,r){var i=e.replace(/\+/g," ");if("iso-8859-1"===r)return i.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(i)}catch(e){return i}},encode:function(e,t,i,n,o){if(0===e.length)return e;var a=e;if("symbol"==typeof e?a=Symbol.prototype.toString.call(e):"string"!=typeof e&&(a=String(e)),"iso-8859-1"===i)return escape(a).replace(/%u[0-9a-f]{4}/gi,function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"});for(var l="",h=0;h<a.length;++h){var u=a.charCodeAt(h);if(45===u||46===u||95===u||126===u||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||o===r.RFC1738&&(40===u||41===u)){l+=a.charAt(h);continue}if(u<128){l+=s[u];continue}if(u<2048){l+=s[192|u>>6]+s[128|63&u];continue}if(u<55296||u>=57344){l+=s[224|u>>12]+s[128|u>>6&63]+s[128|63&u];continue}h+=1,l+=s[240|(u=65536+((1023&u)<<10|1023&a.charCodeAt(h)))>>18]+s[128|u>>12&63]+s[128|u>>6&63]+s[128|63&u]}return l},isBuffer:function(e){return!!e&&"object"==typeof e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},maybeMap:function(e,t){if(n(e)){for(var r=[],i=0;i<e.length;i+=1)r.push(t(e[i]));return r}return t(e)},merge:function e(t,r,s){if(!r)return t;if("object"!=typeof r){if(n(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(s&&(s.plainObjects||s.allowPrototypes)||!i.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var o=t;return(n(t)&&!n(r)&&(o=a(t,s)),n(t)&&n(r))?(r.forEach(function(r,n){if(i.call(t,n)){var o=t[n];o&&"object"==typeof o&&r&&"object"==typeof r?t[n]=e(o,r,s):t.push(r)}else t[n]=r}),t):Object.keys(r).reduce(function(t,n){var o=r[n];return i.call(t,n)?t[n]=e(t[n],o,s):t[n]=o,t},o)}}}),tQ("i1Gbt",function(e,t){var r=String.prototype.replace,i=/%20/g,n={RFC1738:"RFC1738",RFC3986:"RFC3986"};e.exports={default:n.RFC3986,formatters:{RFC1738:function(e){return r.call(e,i,"+")},RFC3986:function(e){return String(e)}},RFC1738:n.RFC1738,RFC3986:n.RFC3986}}),tQ("cfYIz",function(e,t){var r=tK("iBfJ5"),i=Object.prototype.hasOwnProperty,n=Array.isArray,s={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:r.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},o=function(e,t){return e&&"string"==typeof e&&t.comma&&e.indexOf(",")>-1?e.split(","):e},a=function(e,t){var a={__proto__:null},l=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,h=t.parameterLimit===1/0?void 0:t.parameterLimit,u=l.split(t.delimiter,h),c=-1,d=t.charset;if(t.charsetSentinel)for(f=0;f<u.length;++f)0===u[f].indexOf("utf8=")&&("utf8=%E2%9C%93"===u[f]?d="utf-8":"utf8=%26%2310003%3B"===u[f]&&(d="iso-8859-1"),c=f,f=u.length);for(f=0;f<u.length;++f)if(f!==c){var f,p,m,g=u[f],v=g.indexOf("]="),y=-1===v?g.indexOf("="):v+1;-1===y?(p=t.decoder(g,s.decoder,d,"key"),m=t.strictNullHandling?null:""):(p=t.decoder(g.slice(0,y),s.decoder,d,"key"),m=r.maybeMap(o(g.slice(y+1),t),function(e){return t.decoder(e,s.decoder,d,"value")})),m&&t.interpretNumericEntities&&"iso-8859-1"===d&&(m=m.replace(/&#(\d+);/g,function(e,t){return String.fromCharCode(parseInt(t,10))})),g.indexOf("[]=")>-1&&(m=n(m)?[m]:m),i.call(a,p)?a[p]=r.combine(a[p],m):a[p]=m}return a},l=function(e,t,r,i){for(var n=i?t:o(t,r),s=e.length-1;s>=0;--s){var a,l=e[s];if("[]"===l&&r.parseArrays)a=[].concat(n);else{a=r.plainObjects?Object.create(null):{};var h="["===l.charAt(0)&&"]"===l.charAt(l.length-1)?l.slice(1,-1):l,u=parseInt(h,10);r.parseArrays||""!==h?!isNaN(u)&&l!==h&&String(u)===h&&u>=0&&r.parseArrays&&u<=r.arrayLimit?(a=[])[u]=n:"__proto__"!==h&&(a[h]=n):a={0:n}}n=a}return n},h=function(e,t,r,n){if(e){var s=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/g,a=r.depth>0&&/(\[[^[\]]*])/.exec(s),h=a?s.slice(0,a.index):s,u=[];if(h){if(!r.plainObjects&&i.call(Object.prototype,h)&&!r.allowPrototypes)return;u.push(h)}for(var c=0;r.depth>0&&null!==(a=o.exec(s))&&c<r.depth;){if(c+=1,!r.plainObjects&&i.call(Object.prototype,a[1].slice(1,-1))&&!r.allowPrototypes)return;u.push(a[1])}return a&&u.push("["+s.slice(a.index)+"]"),l(u,t,r,n)}},u=function(e){if(!e)return s;if(null!==e.decoder&&void 0!==e.decoder&&"function"!=typeof e.decoder)throw TypeError("Decoder has to be a function.");if(void 0!==e.charset&&"utf-8"!==e.charset&&"iso-8859-1"!==e.charset)throw TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var t=void 0===e.charset?s.charset:e.charset;return{allowDots:void 0===e.allowDots?s.allowDots:!!e.allowDots,allowPrototypes:"boolean"==typeof e.allowPrototypes?e.allowPrototypes:s.allowPrototypes,allowSparse:"boolean"==typeof e.allowSparse?e.allowSparse:s.allowSparse,arrayLimit:"number"==typeof e.arrayLimit?e.arrayLimit:s.arrayLimit,charset:t,charsetSentinel:"boolean"==typeof e.charsetSentinel?e.charsetSentinel:s.charsetSentinel,comma:"boolean"==typeof e.comma?e.comma:s.comma,decoder:"function"==typeof e.decoder?e.decoder:s.decoder,delimiter:"string"==typeof e.delimiter||r.isRegExp(e.delimiter)?e.delimiter:s.delimiter,depth:"number"==typeof e.depth||!1===e.depth?+e.depth:s.depth,ignoreQueryPrefix:!0===e.ignoreQueryPrefix,interpretNumericEntities:"boolean"==typeof e.interpretNumericEntities?e.interpretNumericEntities:s.interpretNumericEntities,parameterLimit:"number"==typeof e.parameterLimit?e.parameterLimit:s.parameterLimit,parseArrays:!1!==e.parseArrays,plainObjects:"boolean"==typeof e.plainObjects?e.plainObjects:s.plainObjects,strictNullHandling:"boolean"==typeof e.strictNullHandling?e.strictNullHandling:s.strictNullHandling}};e.exports=function(e,t){var i=u(t);if(""===e||null==e)return i.plainObjects?Object.create(null):{};for(var n="string"==typeof e?a(e,i):e,s=i.plainObjects?Object.create(null):{},o=Object.keys(n),l=0;l<o.length;++l){var c=o[l],d=h(c,n[c],i,"string"==typeof e);s=r.merge(s,d,i)}return!0===i.allowSparse?s:r.compact(s)}}),tQ("02Ztr",function(e,t){var r=tK("gpDEB"),i=tK("kzBhd"),n=tK("72a6v"),s=tK("dIU5s");e.exports=function(e,t){return r(e)||i(e,t)||n(e,t)||s()},e.exports.__esModule=!0,e.exports.default=e.exports}),tQ("gpDEB",function(e,t){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports}),tQ("kzBhd",function(e,t){e.exports=function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,s,o,a=[],l=!0,h=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=s.call(r)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){h=!0,n=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(h)throw n}}return a}},e.exports.__esModule=!0,e.exports.default=e.exports}),tQ("72a6v",function(e,t){var r=tK("2zZPz");e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return r(e,t)}},e.exports.__esModule=!0,e.exports.default=e.exports}),tQ("2zZPz",function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i},e.exports.__esModule=!0,e.exports.default=e.exports}),tQ("dIU5s",function(e,t){e.exports=function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports}),tQ("fu0YK",function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports}),tQ("lR7jo",function(e,t){var r=tK("5DKOa");function i(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}e.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports}),tQ("5DKOa",function(e,t){var r=tK("41YNz").default,i=tK("fKGZD");e.exports=function(e){var t=i(e,"string");return"symbol"==r(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports}),tQ("41YNz",function(e,t){function r(t){return e.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,r(t)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports}),tQ("fKGZD",function(e,t){var r=tK("41YNz").default;e.exports=function(e,t){if("object"!=r(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=r(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports});const tJ={ADAPTER:{createCanvas:(e,t)=>{let r=document.createElement("canvas");return r.width=e,r.height=t,r},getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(e,t)=>fetch(e,t),parseXML:e=>new DOMParser().parseFromString(e,"text/xml")},RESOLUTION:1,CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1};var t0=/iPhone/i,t1=/iPod/i,t2=/iPad/i,t3=/\biOS-universal(?:.+)Mac\b/i,t4=/\bAndroid(?:.+)Mobile\b/i,t5=/Android/i,t8=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,t6=/Silk/i,t7=/Windows Phone/i,t9=/\bWindows(?:.+)ARM\b/i,re=/BlackBerry/i,rt=/BB10/i,rr=/Opera Mini/i,ri=/\b(CriOS|Chrome)(?:.+)Mobile/i,rn=/Mobile(?:.+)Firefox\b/i,rs=function(e){return void 0!==e&&"MacIntel"===e.platform&&"number"==typeof e.maxTouchPoints&&e.maxTouchPoints>1&&"undefined"==typeof MSStream};function ro(e){var t,r={userAgent:"",platform:"",maxTouchPoints:0};e||"undefined"==typeof navigator?"string"==typeof e?r.userAgent=e:e&&e.userAgent&&(r={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}):r={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0};var i=r.userAgent,n=i.split("[FBAN");void 0!==n[1]&&(i=n[0]),void 0!==(n=i.split("Twitter"))[1]&&(i=n[0]);var s=(t=i,function(e){return e.test(t)}),o={apple:{phone:s(t0)&&!s(t7),ipod:s(t1),tablet:!s(t0)&&(s(t2)||rs(r))&&!s(t7),universal:s(t3),device:(s(t0)||s(t1)||s(t2)||s(t3)||rs(r))&&!s(t7)},amazon:{phone:s(t8),tablet:!s(t8)&&s(t6),device:s(t8)||s(t6)},android:{phone:!s(t7)&&s(t8)||!s(t7)&&s(t4),tablet:!s(t7)&&!s(t8)&&!s(t4)&&(s(t6)||s(t5)),device:!s(t7)&&(s(t8)||s(t6)||s(t4)||s(t5))||s(/\bokhttp\b/i)},windows:{phone:s(t7),tablet:s(t9),device:s(t7)||s(t9)},other:{blackberry:s(re),blackberry10:s(rt),opera:s(rr),firefox:s(rn),chrome:s(ri),device:s(re)||s(rt)||s(rr)||s(rn)||s(ri)},any:!1,phone:!1,tablet:!1};return o.any=o.apple.device||o.android.device||o.windows.device||o.other.device,o.phone=o.apple.phone||o.android.phone||o.windows.phone,o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet,o}const ra=(ro.default??ro)(globalThis.navigator);var rl={};tY(rl,"BaseTextureCache",()=>i3),tY(rl,"BoundingBox",()=>i0),tY(rl,"CanvasRenderTarget",()=>i8),tY(rl,"DATA_URI",()=>iz),tY(rl,"EventEmitter",()=>t$(rh)),tY(rl,"ProgramCache",()=>i1),tY(rl,"TextureCache",()=>i2),tY(rl,"clearTextureCache",()=>i5),tY(rl,"correctBlendMode",()=>iL),tY(rl,"createIndicesForQuads",()=>ij),tY(rl,"decomposeDataUri",()=>nt),tY(rl,"deprecation",()=>rL),tY(rl,"destroyTextureCache",()=>i4),tY(rl,"detectVideoAlphaMode",()=>r7),tY(rl,"determineCrossOrigin",()=>nr),tY(rl,"earcut",()=>t$(rv)),tY(rl,"getBufferType",()=>iH),tY(rl,"getCanvasBoundingBox",()=>i9),tY(rl,"getResolutionOfUrl",()=>ni),tY(rl,"hex2rgb",()=>iO),tY(rl,"hex2string",()=>iD),tY(rl,"interleaveTypedArrays",()=>iX),tY(rl,"isMobile",()=>ra),tY(rl,"isPow2",()=>i$),tY(rl,"isWebGLSupported",()=>it),tY(rl,"log2",()=>iY),tY(rl,"nextPow2",()=>iW),tY(rl,"path",()=>rz),tY(rl,"premultiplyBlendMode",()=>iB),tY(rl,"premultiplyRgba",()=>ik),tY(rl,"premultiplyTint",()=>iU),tY(rl,"premultiplyTintToRgba",()=>iG),tY(rl,"removeItems",()=>iq),tY(rl,"rgb2hex",()=>iF),tY(rl,"sayHello",()=>ie),tY(rl,"sign",()=>iZ),tY(rl,"skipHello",()=>r9),tY(rl,"string2hex",()=>iN),tY(rl,"trimCanvas",()=>ne),tY(rl,"uid",()=>iQ),tY(rl,"url",()=>rk),tJ.RETINA_PREFIX=/@([0-9\.]+)x/,tJ.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var rh={},ru=Object.prototype.hasOwnProperty,rc="~";function rd(){}function rf(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function rp(e,t,r,i,n){if("function"!=typeof r)throw TypeError("The listener must be a function");var s=new rf(r,i||e,n),o=rc?rc+t:t;return e._events[o]?e._events[o].fn?e._events[o]=[e._events[o],s]:e._events[o].push(s):(e._events[o]=s,e._eventsCount++),e}function rm(e,t){0==--e._eventsCount?e._events=new rd:delete e._events[t]}function rg(){this._events=new rd,this._eventsCount=0}Object.create&&(rd.prototype=Object.create(null),new rd().__proto__||(rc=!1)),rg.prototype.eventNames=function(){var e,t,r=[];if(0===this._eventsCount)return r;for(t in e=this._events)ru.call(e,t)&&r.push(rc?t.slice(1):t);return Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(e)):r},rg.prototype.listeners=function(e){var t=rc?rc+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var i=0,n=r.length,s=Array(n);i<n;i++)s[i]=r[i].fn;return s},rg.prototype.listenerCount=function(e){var t=rc?rc+e:e,r=this._events[t];return r?r.fn?1:r.length:0},rg.prototype.emit=function(e,t,r,i,n,s){var o=rc?rc+e:e;if(!this._events[o])return!1;var a,l,h=this._events[o],u=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),u){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,r),!0;case 4:return h.fn.call(h.context,t,r,i),!0;case 5:return h.fn.call(h.context,t,r,i,n),!0;case 6:return h.fn.call(h.context,t,r,i,n,s),!0}for(l=1,a=Array(u-1);l<u;l++)a[l-1]=arguments[l];h.fn.apply(h.context,a)}else{var c,d=h.length;for(l=0;l<d;l++)switch(h[l].once&&this.removeListener(e,h[l].fn,void 0,!0),u){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,t);break;case 3:h[l].fn.call(h[l].context,t,r);break;case 4:h[l].fn.call(h[l].context,t,r,i);break;default:if(!a)for(c=1,a=Array(u-1);c<u;c++)a[c-1]=arguments[c];h[l].fn.apply(h[l].context,a)}}return!0},rg.prototype.on=function(e,t,r){return rp(this,e,t,r,!1)},rg.prototype.once=function(e,t,r){return rp(this,e,t,r,!0)},rg.prototype.removeListener=function(e,t,r,i){var n=rc?rc+e:e;if(!this._events[n])return this;if(!t)return rm(this,n),this;var s=this._events[n];if(s.fn)s.fn!==t||i&&!s.once||r&&s.context!==r||rm(this,n);else{for(var o=0,a=[],l=s.length;o<l;o++)(s[o].fn!==t||i&&!s[o].once||r&&s[o].context!==r)&&a.push(s[o]);a.length?this._events[n]=1===a.length?a[0]:a:rm(this,n)}return this},rg.prototype.removeAllListeners=function(e){var t;return e?(t=rc?rc+e:e,this._events[t]&&rm(this,t)):(this._events=new rd,this._eventsCount=0),this},rg.prototype.off=rg.prototype.removeListener,rg.prototype.addListener=rg.prototype.on,rg.prefixed=rc,rg.EventEmitter=rg,rh=rg;var rv={};function ry(e,t,r){r=r||2;var i,n,s,o,a,l,h,u=t&&t.length,c=u?t[0]*r:e.length,d=r_(e,0,c,r,!0),f=[];if(!d||d.next===d.prev)return f;if(u&&(d=function(e,t,r,i){var n,s,o,a,l,h=[];for(n=0,s=t.length;n<s;n++)o=t[n]*i,a=n<s-1?t[n+1]*i:e.length,(l=r_(e,o,a,i,!1))===l.next&&(l.steiner=!0),h.push(function(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e)return r}(l));for(h.sort(rb),n=0;n<h.length;n++)r=function(e,t){var r=function(e,t){var r,i,n,s=t,o=e.x,a=e.y,l=-1/0;do{if(a<=s.y&&a>=s.next.y&&s.next.y!==s.y){var h=s.x+(a-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(h<=o&&h>l&&(l=h,n=s.x<s.next.x?s:s.next,h===o))return n}s=s.next}while(s!==t)if(!n)return null;var u,c=n,d=n.x,f=n.y,p=1/0;s=n;do o>=s.x&&s.x>=d&&o!==s.x&&rA(a<f?o:l,a,d,f,a<f?l:o,a,s.x,s.y)&&(u=Math.abs(a-s.y)/(o-s.x),rR(s,e)&&(u<p||u===p&&(s.x>n.x||s.x===n.x&&(r=n,i=s,0>rE(r.prev,r,i.prev)&&0>rE(i.next,r,r.next))))&&(n=s,p=u)),s=s.next;while(s!==c)return n}(e,t);if(!r)return t;var i=rM(r,e);return rx(i,i.next),rx(r,r.next)}(h[n],r);return r}(e,t,d,r)),e.length>80*r){i=s=e[0],n=o=e[1];for(var p=r;p<c;p+=r)a=e[p],l=e[p+1],a<i&&(i=a),l<n&&(n=l),a>s&&(s=a),l>o&&(o=l);h=0!==(h=Math.max(s-i,o-n))?32767/h:0}return function e(t,r,i,n,s,o,a){if(t){!a&&o&&function(e,t,r,i){var n=e;do 0===n.z&&(n.z=rT(n.x,n.y,t,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e)n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,r,i,n,s,o,a,l,h=1;do{for(r=e,e=null,s=null,o=0;r;){for(o++,i=r,a=0,t=0;t<h&&(a++,i=i.nextZ);t++);for(l=h;a>0||l>0&&i;)0!==a&&(0===l||!i||r.z<=i.z)?(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,l--),s?s.nextZ=n:e=n,n.prevZ=s,s=n;r=i}s.nextZ=null,h*=2}while(o>1)}(n)}(t,n,s,o);for(var l,h,u=t;t.prev!==t.next;){if(l=t.prev,h=t.next,o?function(e,t,r,i){var n=e.prev,s=e.next;if(rE(n,e,s)>=0)return!1;for(var o=n.x,a=e.x,l=s.x,h=n.y,u=e.y,c=s.y,d=o<a?o<l?o:l:a<l?a:l,f=h<u?h<c?h:c:u<c?u:c,p=o>a?o>l?o:l:a>l?a:l,m=h>u?h>c?h:c:u>c?u:c,g=rT(d,f,t,r,i),v=rT(p,m,t,r,i),y=e.prevZ,x=e.nextZ;y&&y.z>=g&&x&&x.z<=v;){if(y.x>=d&&y.x<=p&&y.y>=f&&y.y<=m&&y!==n&&y!==s&&rA(o,h,a,u,l,c,y.x,y.y)&&rE(y.prev,y,y.next)>=0||(y=y.prevZ,x.x>=d&&x.x<=p&&x.y>=f&&x.y<=m&&x!==n&&x!==s&&rA(o,h,a,u,l,c,x.x,x.y)&&rE(x.prev,x,x.next)>=0))return!1;x=x.nextZ}for(;y&&y.z>=g;){if(y.x>=d&&y.x<=p&&y.y>=f&&y.y<=m&&y!==n&&y!==s&&rA(o,h,a,u,l,c,y.x,y.y)&&rE(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;x&&x.z<=v;){if(x.x>=d&&x.x<=p&&x.y>=f&&x.y<=m&&x!==n&&x!==s&&rA(o,h,a,u,l,c,x.x,x.y)&&rE(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}(t,n,s,o):function(e){var t=e.prev,r=e.next;if(rE(t,e,r)>=0)return!1;for(var i=t.x,n=e.x,s=r.x,o=t.y,a=e.y,l=r.y,h=i<n?i<s?i:s:n<s?n:s,u=o<a?o<l?o:l:a<l?a:l,c=i>n?i>s?i:s:n>s?n:s,d=o>a?o>l?o:l:a>l?a:l,f=r.next;f!==t;){if(f.x>=h&&f.x<=c&&f.y>=u&&f.y<=d&&rA(i,o,n,a,s,l,f.x,f.y)&&rE(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}(t)){r.push(l.i/i|0),r.push(t.i/i|0),r.push(h.i/i|0),rO(t),t=h.next,u=h.next;continue}if((t=h)===u){a?1===a?e(t=function(e,t,r){var i=e;do{var n=i.prev,s=i.next.next;!rw(n,s)&&rC(n,i,i.next,s)&&rR(n,s)&&rR(s,n)&&(t.push(n.i/r|0),t.push(i.i/r|0),t.push(s.i/r|0),rO(i),rO(i.next),i=e=s),i=i.next}while(i!==e)return rx(i)}(rx(t),r,i),r,i,n,s,o,2):2===a&&function(t,r,i,n,s,o){var a=t;do{for(var l,h,u=a.next.next;u!==a.prev;){if(a.i!==u.i&&(l=a,h=u,l.next.i!==h.i&&l.prev.i!==h.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&rC(r,r.next,e,t))return!0;r=r.next}while(r!==e)return!1}(l,h)&&(rR(l,h)&&rR(h,l)&&function(e,t){var r=e,i=!1,n=(e.x+t.x)/2,s=(e.y+t.y)/2;do r.y>s!=r.next.y>s&&r.next.y!==r.y&&n<(r.next.x-r.x)*(s-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e)return i}(l,h)&&(rE(l.prev,l,h.prev)||rE(l,h.prev,h))||rw(l,h)&&rE(l.prev,l,l.next)>0&&rE(h.prev,h,h.next)>0))){var c=rM(a,u);a=rx(a,a.next),c=rx(c,c.next),e(a,r,i,n,s,o,0),e(c,r,i,n,s,o,0);return}u=u.next}a=a.next}while(a!==t)}(t,r,i,n,s,o):e(rx(t),r,i,n,s,o,1);break}}}}(d,f,r,i,n,h,0),f}function r_(e,t,r,i,n){var s,o;if(n===rN(e,t,r,i)>0)for(s=t;s<r;s+=i)o=rP(s,e[s],e[s+1],o);else for(s=r-i;s>=t;s-=i)o=rP(s,e[s],e[s+1],o);return o&&rw(o,o.next)&&(rO(o),o=o.next),o}function rx(e,t){if(!e)return e;t||(t=e);var r,i=e;do if(r=!1,!i.steiner&&(rw(i,i.next)||0===rE(i.prev,i,i.next))){if(rO(i),(i=t=i.prev)===i.next)break;r=!0}else i=i.next;while(r||i!==t)return t}function rb(e,t){return e.x-t.x}function rT(e,t,r,i,n){return(e=((e=((e=((e=((e=(e-r)*n|0)|e<<8)&16711935)|e<<4)&252645135)|e<<2)&858993459)|e<<1)&1431655765)|(t=((t=((t=((t=((t=(t-i)*n|0)|t<<8)&16711935)|t<<4)&252645135)|t<<2)&858993459)|t<<1)&1431655765)<<1}function rA(e,t,r,i,n,s,o,a){return(n-o)*(t-a)>=(e-o)*(s-a)&&(e-o)*(i-a)>=(r-o)*(t-a)&&(r-o)*(s-a)>=(n-o)*(i-a)}function rE(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function rw(e,t){return e.x===t.x&&e.y===t.y}function rC(e,t,r,i){var n=rI(rE(e,t,r)),s=rI(rE(e,t,i)),o=rI(rE(r,i,e)),a=rI(rE(r,i,t));return!!(n!==s&&o!==a||0===n&&rS(e,r,t)||0===s&&rS(e,i,t)||0===o&&rS(r,e,i)||0===a&&rS(r,t,i))}function rS(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function rI(e){return e>0?1:e<0?-1:0}function rR(e,t){return 0>rE(e.prev,e,e.next)?rE(e,t,e.next)>=0&&rE(e,e.prev,t)>=0:0>rE(e,t,e.prev)||0>rE(e,e.next,t)}function rM(e,t){var r=new rD(e.i,e.x,e.y),i=new rD(t.i,t.x,t.y),n=e.next,s=t.prev;return e.next=t,t.prev=e,r.next=n,n.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function rP(e,t,r,i){var n=new rD(e,t,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function rO(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function rD(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function rN(e,t,r,i){for(var n=0,s=t,o=r-i;s<r;s+=i)n+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return n}(rv=ry).default=ry,ry.deviation=function(e,t,r,i){var n=t&&t.length,s=n?t[0]*r:e.length,o=Math.abs(rN(e,0,s,r));if(n)for(var a=0,l=t.length;a<l;a++){var h=t[a]*r,u=a<l-1?t[a+1]*r:e.length;o-=Math.abs(rN(e,h,u,r))}var c=0;for(a=0;a<i.length;a+=3){var d=i[a]*r,f=i[a+1]*r,p=i[a+2]*r;c+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===o&&0===c?0:Math.abs((c-o)/o)},ry.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,n=0;n<e.length;n++){for(var s=0;s<e[n].length;s++)for(var o=0;o<t;o++)r.vertices.push(e[n][s][o]);n>0&&(i+=e[n-1].length,r.holes.push(i))}return r};var rF=tK("biuEp");const rB={};function rL(e,t,r=3){if(rB[t])return;let i=Error().stack;typeof i>"u"?console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`):(i=i.split(`
`).splice(r).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",`${t}
Deprecated since v${e}`),console.warn(i),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",`${t}
Deprecated since v${e}`),console.warn(i))),rB[t]=!0}const rk={get parse(){return rL("7.3.0","utils.url.parse is deprecated, use native URL API instead."),rF.parse},get format(){return rL("7.3.0","utils.url.format is deprecated, use native URL API instead."),rF.format},get resolve(){return rL("7.3.0","utils.url.resolve is deprecated, use native URL API instead."),rF.resolve}};function rU(e){if("string"!=typeof e)throw TypeError(`Path must be a string. Received ${JSON.stringify(e)}`)}function rG(e){return e.split("?")[0].split("#")[0]}const rz={toPosix:e=>e.replace(RegExp("\\".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"/"),isUrl(e){return/^https?:/.test(this.toPosix(e))},isDataUrl:e=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(e),isBlobUrl:e=>e.startsWith("blob:"),hasProtocol(e){return/^[^/:]+:/.test(this.toPosix(e))},getProtocol(e){rU(e),e=this.toPosix(e);let t=/^file:\/\/\//.exec(e);if(t)return t[0];let r=/^[^/:]+:\/{0,2}/.exec(e);return r?r[0]:""},toAbsolute(e,t,r){if(rU(e),this.isDataUrl(e)||this.isBlobUrl(e))return e;let i=rG(this.toPosix(t??tJ.ADAPTER.getBaseUrl())),n=rG(this.toPosix(r??this.rootname(i)));return(e=this.toPosix(e)).startsWith("/")?rz.join(n,e.slice(1)):this.isAbsolute(e)?e:this.join(i,e)},normalize(e){if(rU(e),0===e.length)return".";if(this.isDataUrl(e)||this.isBlobUrl(e))return e;e=this.toPosix(e);let t="",r=e.startsWith("/");this.hasProtocol(e)&&(t=this.rootname(e),e=e.slice(t.length));let i=e.endsWith("/");return(e=function(e,t){let r="",i=0,n=-1,s=0,o=-1;for(let a=0;a<=e.length;++a){if(a<e.length)o=e.charCodeAt(a);else{if(47===o)break;o=47}if(47===o){if(!(n===a-1||1===s)){if(n!==a-1&&2===s){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2)){if(r.length>2){let e=r.lastIndexOf("/");if(e!==r.length-1){-1===e?(r="",i=0):i=(r=r.slice(0,e)).length-1-r.lastIndexOf("/"),n=a,s=0;continue}}else if(2===r.length||1===r.length){r="",i=0,n=a,s=0;continue}}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+=`/${e.slice(n+1,a)}`:r=e.slice(n+1,a),i=a-n-1}n=a,s=0}else 46===o&&-1!==s?++s:s=-1}return r}(e,!1)).length>0&&i&&(e+="/"),r?`/${e}`:t+e},isAbsolute(e){return rU(e),e=this.toPosix(e),!!this.hasProtocol(e)||e.startsWith("/")},join(...e){let t;if(0===e.length)return".";for(let r=0;r<e.length;++r){let i=e[r];if(rU(i),i.length>0){if(void 0===t)t=i;else{let n=e[r-1]??"";this.joinExtensions.includes(this.extname(n).toLowerCase())?t+=`/../${i}`:t+=`/${i}`}}}return void 0===t?".":this.normalize(t)},dirname(e){if(rU(e),0===e.length)return".";let t=(e=this.toPosix(e)).charCodeAt(0),r=47===t,i=-1,n=!0,s=this.getProtocol(e),o=e;e=e.slice(s.length);for(let r=e.length-1;r>=1;--r)if(47===(t=e.charCodeAt(r))){if(!n){i=r;break}}else n=!1;return -1===i?r?"/":this.isUrl(o)?s+e:s:r&&1===i?"//":s+e.slice(0,i)},rootname(e){rU(e);let t="";if(t=(e=this.toPosix(e)).startsWith("/")?"/":this.getProtocol(e),this.isUrl(e)){let r=e.indexOf("/",t.length);(t=-1!==r?e.slice(0,r):e).endsWith("/")||(t+="/")}return t},basename(e,t){rU(e),t&&rU(t),e=rG(this.toPosix(e));let r=0,i=-1,n=!0,s;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";let o=t.length-1,a=-1;for(s=e.length-1;s>=0;--s){let l=e.charCodeAt(s);if(47===l){if(!n){r=s+1;break}}else -1===a&&(n=!1,a=s+1),o>=0&&(l===t.charCodeAt(o)?-1==--o&&(i=s):(o=-1,i=a))}return r===i?i=a:-1===i&&(i=e.length),e.slice(r,i)}for(s=e.length-1;s>=0;--s)if(47===e.charCodeAt(s)){if(!n){r=s+1;break}}else -1===i&&(n=!1,i=s+1);return -1===i?"":e.slice(r,i)},extname(e){rU(e),e=rG(this.toPosix(e));let t=-1,r=0,i=-1,n=!0,s=0;for(let o=e.length-1;o>=0;--o){let a=e.charCodeAt(o);if(47===a){if(!n){r=o+1;break}continue}-1===i&&(n=!1,i=o+1),46===a?-1===t?t=o:1!==s&&(s=1):-1!==t&&(s=-1)}return -1===t||-1===i||0===s||1===s&&t===i-1&&t===r+1?"":e.slice(t,i)},parse(e){let t;rU(e);let r={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return r;let i=(e=rG(this.toPosix(e))).charCodeAt(0),n=this.isAbsolute(e);r.root=this.rootname(e),t=n||this.hasProtocol(e)?1:0;let s=-1,o=0,a=-1,l=!0,h=e.length-1,u=0;for(;h>=t;--h){if(47===(i=e.charCodeAt(h))){if(!l){o=h+1;break}continue}-1===a&&(l=!1,a=h+1),46===i?-1===s?s=h:1!==u&&(u=1):-1!==s&&(u=-1)}return -1===s||-1===a||0===u||1===u&&s===a-1&&s===o+1?-1!==a&&(0===o&&n?r.base=r.name=e.slice(1,a):r.base=r.name=e.slice(o,a)):(0===o&&n?(r.name=e.slice(1,s),r.base=e.slice(1,a)):(r.name=e.slice(o,s),r.base=e.slice(o,a)),r.ext=e.slice(s,a)),r.dir=this.dirname(e),r},sep:"/",delimiter:":",joinExtensions:[".html"]};var rj=((G=rj||{})[G.WEBGL_LEGACY=0]="WEBGL_LEGACY",G[G.WEBGL=1]="WEBGL",G[G.WEBGL2=2]="WEBGL2",G),rH=((z=rH||{})[z.UNKNOWN=0]="UNKNOWN",z[z.WEBGL=1]="WEBGL",z[z.CANVAS=2]="CANVAS",z),rV=((j=rV||{})[j.COLOR=16384]="COLOR",j[j.DEPTH=256]="DEPTH",j[j.STENCIL=1024]="STENCIL",j),rX=((H=rX||{})[H.NORMAL=0]="NORMAL",H[H.ADD=1]="ADD",H[H.MULTIPLY=2]="MULTIPLY",H[H.SCREEN=3]="SCREEN",H[H.OVERLAY=4]="OVERLAY",H[H.DARKEN=5]="DARKEN",H[H.LIGHTEN=6]="LIGHTEN",H[H.COLOR_DODGE=7]="COLOR_DODGE",H[H.COLOR_BURN=8]="COLOR_BURN",H[H.HARD_LIGHT=9]="HARD_LIGHT",H[H.SOFT_LIGHT=10]="SOFT_LIGHT",H[H.DIFFERENCE=11]="DIFFERENCE",H[H.EXCLUSION=12]="EXCLUSION",H[H.HUE=13]="HUE",H[H.SATURATION=14]="SATURATION",H[H.COLOR=15]="COLOR",H[H.LUMINOSITY=16]="LUMINOSITY",H[H.NORMAL_NPM=17]="NORMAL_NPM",H[H.ADD_NPM=18]="ADD_NPM",H[H.SCREEN_NPM=19]="SCREEN_NPM",H[H.NONE=20]="NONE",H[H.SRC_OVER=0]="SRC_OVER",H[H.SRC_IN=21]="SRC_IN",H[H.SRC_OUT=22]="SRC_OUT",H[H.SRC_ATOP=23]="SRC_ATOP",H[H.DST_OVER=24]="DST_OVER",H[H.DST_IN=25]="DST_IN",H[H.DST_OUT=26]="DST_OUT",H[H.DST_ATOP=27]="DST_ATOP",H[H.ERASE=26]="ERASE",H[H.SUBTRACT=28]="SUBTRACT",H[H.XOR=29]="XOR",H),rW=((V=rW||{})[V.POINTS=0]="POINTS",V[V.LINES=1]="LINES",V[V.LINE_LOOP=2]="LINE_LOOP",V[V.LINE_STRIP=3]="LINE_STRIP",V[V.TRIANGLES=4]="TRIANGLES",V[V.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",V[V.TRIANGLE_FAN=6]="TRIANGLE_FAN",V),r$=((X=r$||{})[X.RGBA=6408]="RGBA",X[X.RGB=6407]="RGB",X[X.RG=33319]="RG",X[X.RED=6403]="RED",X[X.RGBA_INTEGER=36249]="RGBA_INTEGER",X[X.RGB_INTEGER=36248]="RGB_INTEGER",X[X.RG_INTEGER=33320]="RG_INTEGER",X[X.RED_INTEGER=36244]="RED_INTEGER",X[X.ALPHA=6406]="ALPHA",X[X.LUMINANCE=6409]="LUMINANCE",X[X.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",X[X.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",X[X.DEPTH_STENCIL=34041]="DEPTH_STENCIL",X),rY=((W=rY||{})[W.TEXTURE_2D=3553]="TEXTURE_2D",W[W.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",W[W.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",W[W.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",W[W.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",W[W.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",W[W.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",W[W.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",W[W.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",W),rq=(($=rq||{})[$.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",$[$.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",$[$.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",$[$.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",$[$.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",$[$.UNSIGNED_INT=5125]="UNSIGNED_INT",$[$.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",$[$.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",$[$.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",$[$.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",$[$.BYTE=5120]="BYTE",$[$.SHORT=5122]="SHORT",$[$.INT=5124]="INT",$[$.FLOAT=5126]="FLOAT",$[$.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",$[$.HALF_FLOAT=36193]="HALF_FLOAT",$),rZ=((Y=rZ||{})[Y.FLOAT=0]="FLOAT",Y[Y.INT=1]="INT",Y[Y.UINT=2]="UINT",Y),rK=((q=rK||{})[q.NEAREST=0]="NEAREST",q[q.LINEAR=1]="LINEAR",q),rQ=((Z=rQ||{})[Z.CLAMP=33071]="CLAMP",Z[Z.REPEAT=10497]="REPEAT",Z[Z.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",Z),rJ=((K=rJ||{})[K.OFF=0]="OFF",K[K.POW2=1]="POW2",K[K.ON=2]="ON",K[K.ON_MANUAL=3]="ON_MANUAL",K),r0=((Q=r0||{})[Q.NPM=0]="NPM",Q[Q.UNPACK=1]="UNPACK",Q[Q.PMA=2]="PMA",Q[Q.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",Q[Q.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",Q[Q.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA",Q),r1=((J=r1||{})[J.NO=0]="NO",J[J.YES=1]="YES",J[J.AUTO=2]="AUTO",J[J.BLEND=0]="BLEND",J[J.CLEAR=1]="CLEAR",J[J.BLIT=2]="BLIT",J),r2=((ee=r2||{})[ee.AUTO=0]="AUTO",ee[ee.MANUAL=1]="MANUAL",ee),r3=((et=r3||{}).LOW="lowp",et.MEDIUM="mediump",et.HIGH="highp",et),r4=((er=r4||{})[er.NONE=0]="NONE",er[er.SCISSOR=1]="SCISSOR",er[er.STENCIL=2]="STENCIL",er[er.SPRITE=3]="SPRITE",er[er.COLOR=4]="COLOR",er),r5=((ei=r5||{})[ei.RED=1]="RED",ei[ei.GREEN=2]="GREEN",ei[ei.BLUE=4]="BLUE",ei[ei.ALPHA=8]="ALPHA",ei),r8=((en=r8||{})[en.NONE=0]="NONE",en[en.LOW=2]="LOW",en[en.MEDIUM=4]="MEDIUM",en[en.HIGH=8]="HIGH",en),r6=((es=r6||{})[es.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",es[es.ARRAY_BUFFER=34962]="ARRAY_BUFFER",es[es.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",es);async function r7(){return e??(e=(async()=>{let e=document.createElement("canvas").getContext("webgl");if(!e)return r0.UNPACK;let t=await new Promise(e=>{let t=document.createElement("video");t.onloadeddata=()=>e(t),t.onerror=()=>e(null),t.autoplay=!1,t.crossOrigin="anonymous",t.preload="auto",t.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",t.load()});if(!t)return r0.UNPACK;let r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);let i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t);let n=new Uint8Array(4);return e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,n),e.deleteFramebuffer(i),e.deleteTexture(r),e.getExtension("WEBGL_lose_context")?.loseContext(),n[0]<=n[3]?r0.PMA:r0.UNPACK})()),e}function r9(){rL("7.0.0","skipHello is deprecated, please use settings.RENDER_OPTIONS.hello")}function ie(){rL("7.0.0",'sayHello is deprecated, please use Renderer\'s "hello" option')}function it(){return typeof t>"u"&&(t=function(){let e={stencil:!0,failIfMajorPerformanceCaveat:tJ.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!tJ.ADAPTER.getWebGLRenderingContext())return!1;let t=tJ.ADAPTER.createCanvas(),r=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),i=!!r?.getContextAttributes()?.stencil;if(r){let e=r.getExtension("WEBGL_lose_context");e&&e.loseContext()}return r=null,i}catch{return!1}}()),t}var ir={grad:.9,turn:360,rad:360/(2*Math.PI)},ii=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},is=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=Math.pow(10,t)),Math.round(r*e)/r+0},io=function(e,t,r){return void 0===t&&(t=0),void 0===r&&(r=1),e>r?r:e>t?e:t},ia=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},il=function(e){return{r:io(e.r,0,255),g:io(e.g,0,255),b:io(e.b,0,255),a:io(e.a)}},ih=function(e){return{r:is(e.r),g:is(e.g),b:is(e.b),a:is(e.a,3)}},iu=/^#([0-9a-f]{3,8})$/i,ic=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},id=function(e){var t=e.r,r=e.g,i=e.b,n=e.a,s=Math.max(t,r,i),o=s-Math.min(t,r,i),a=o?s===t?(r-i)/o:s===r?2+(i-t)/o:4+(t-r)/o:0;return{h:60*(a<0?a+6:a),s:s?o/s*100:0,v:s/255*100,a:n}},ip=function(e){var t=e.h,r=e.s,i=e.v,n=e.a;t=t/360*6,r/=100,i/=100;var s=Math.floor(t),o=i*(1-r),a=i*(1-(t-s)*r),l=i*(1-(1-t+s)*r),h=s%6;return{r:255*[i,a,o,o,l,i][h],g:255*[l,i,i,a,o,o][h],b:255*[o,o,l,i,i,a][h],a:n}},im=function(e){return{h:ia(e.h),s:io(e.s,0,100),l:io(e.l,0,100),a:io(e.a)}},ig=function(e){return{h:is(e.h),s:is(e.s),l:is(e.l),a:is(e.a,3)}},iv=function(e){var t,r;return ip((t=e.s,{h:e.h,s:(t*=((r=e.l)<50?r:100-r)/100)>0?2*t/(r+t)*100:0,v:r+t,a:e.a}))},iy=function(e){var t,r,i,n;return{h:(t=id(e)).h,s:(n=(200-(r=t.s))*(i=t.v)/100)>0&&n<200?r*i/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a}},i_=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ix=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,ib=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,iT=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,iA={string:[[function(e){var t=iu.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?is(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?is(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=ib.exec(e)||iT.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:il({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t,r,i=i_.exec(e)||ix.exec(e);return i?iv(im({h:(t=i[1],void 0===(r=i[2])&&(r="deg"),Number(t)*(ir[r]||1)),s:Number(i[3]),l:Number(i[4]),a:void 0===i[5]?1:Number(i[5])/(i[6]?100:1)})):null},"hsl"]],object:[[function(e){var t=e.r,r=e.g,i=e.b,n=e.a;return ii(t)&&ii(r)&&ii(i)?il({r:Number(t),g:Number(r),b:Number(i),a:Number(void 0===n?1:n)}):null},"rgb"],[function(e){var t=e.h,r=e.s,i=e.l,n=e.a;return ii(t)&&ii(r)&&ii(i)?iv(im({h:Number(t),s:Number(r),l:Number(i),a:Number(void 0===n?1:n)})):null},"hsl"],[function(e){var t,r=e.h,i=e.s,n=e.v,s=e.a;return ii(r)&&ii(i)&&ii(n)?ip({h:ia((t={h:Number(r),s:Number(i),v:Number(n),a:Number(void 0===s?1:s)}).h),s:io(t.s,0,100),v:io(t.v,0,100),a:io(t.a)}):null},"hsv"]]},iE=function(e,t){for(var r=0;r<t.length;r++){var i=t[r][0](e);if(i)return[i,t[r][1]]}return[null,void 0]},iw=function(e,t){var r=iy(e);return{h:r.h,s:io(r.s+100*t,0,100),l:r.l,a:r.a}},iC=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},iS=function(e,t){var r=iy(e);return{h:r.h,s:r.s,l:io(r.l+100*t,0,100),a:r.a}},iI=function(){function e(e){this.parsed=("string"==typeof e?iE(e.trim(),iA.string):"object"==typeof e&&null!==e?iE(e,iA.object):[null,void 0])[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return is(iC(this.rgba),2)},e.prototype.isDark=function(){return .5>iC(this.rgba)},e.prototype.isLight=function(){return iC(this.rgba)>=.5},e.prototype.toHex=function(){var e,t,r,i,n,s;return t=(e=ih(this.rgba)).r,r=e.g,i=e.b,s=(n=e.a)<1?ic(is(255*n)):"","#"+ic(t)+ic(r)+ic(i)+s},e.prototype.toRgb=function(){return ih(this.rgba)},e.prototype.toRgbString=function(){var e,t,r,i,n;return t=(e=ih(this.rgba)).r,r=e.g,i=e.b,(n=e.a)<1?"rgba("+t+", "+r+", "+i+", "+n+")":"rgb("+t+", "+r+", "+i+")"},e.prototype.toHsl=function(){return ig(iy(this.rgba))},e.prototype.toHslString=function(){var e,t,r,i,n;return t=(e=ig(iy(this.rgba))).h,r=e.s,i=e.l,(n=e.a)<1?"hsla("+t+", "+r+"%, "+i+"%, "+n+")":"hsl("+t+", "+r+"%, "+i+"%)"},e.prototype.toHsv=function(){var e;return{h:is((e=id(this.rgba)).h),s:is(e.s),v:is(e.v),a:is(e.a,3)}},e.prototype.invert=function(){var e;return iR({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a})},e.prototype.saturate=function(e){return void 0===e&&(e=.1),iR(iw(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),iR(iw(this.rgba,-e))},e.prototype.grayscale=function(){return iR(iw(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),iR(iS(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),iR(iS(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){var t;return"number"==typeof e?iR({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):is(this.rgba.a,3)},e.prototype.hue=function(e){var t=iy(this.rgba);return"number"==typeof e?iR({h:e,s:t.s,l:t.l,a:t.a}):is(t.h)},e.prototype.isEqual=function(e){return this.toHex()===iR(e).toHex()},e}(),iR=function(e){return e instanceof iI?e:new iI(e)},iM=[];!function(e){e.forEach(function(e){0>iM.indexOf(e)&&(e(iI,iA),iM.push(e))})}([function(e,t){var r={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},i={};for(var n in r)i[r[n]]=n;var s={};e.prototype.toName=function(t){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var n,o=i[this.toHex()];if(o)return o;if(null==t?void 0:t.closest){var a=this.toRgb(),l=1/0,h="black";if(!s.length)for(var u in r)s[u]=new e(r[u]).toRgb();for(var c in r){var d=(n=s[c],Math.pow(a.r-n.r,2)+Math.pow(a.g-n.g,2)+Math.pow(a.b-n.b,2));d<l&&(l=d,h=c)}return h}},t.string.push([function(t){var i=t.toLowerCase(),n="transparent"===i?"#0000":r[i];return n?new e(n).toRgb():null},"name"])}]);const iP=class e{constructor(e=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=e}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(e){return this.value=e,this}set value(t){if(t instanceof e)this._value=this.cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(null===t)throw Error("Cannot set PIXI.Color#value to null");null!==this._value&&this.isSourceEqual(this._value,t)||(this.normalize(t),this._value=this.cloneSource(t))}}get value(){return this._value}cloneSource(e){return"string"==typeof e||"number"==typeof e||e instanceof Number||null===e?e:Array.isArray(e)||ArrayBuffer.isView(e)?e.slice(0):"object"==typeof e&&null!==e?{...e}:e}isSourceEqual(e,t){let r=typeof e;if(r!==typeof t)return!1;if("number"===r||"string"===r||e instanceof Number)return e===t;if(Array.isArray(e)&&Array.isArray(t)||ArrayBuffer.isView(e)&&ArrayBuffer.isView(t))return e.length===t.length&&e.every((e,r)=>e===t[r]);if(null!==e&&null!==t){let r=Object.keys(e),i=Object.keys(t);return r.length===i.length&&r.every(r=>e[r]===t[r])}return e===t}toRgba(){let[e,t,r,i]=this._components;return{r:e,g:t,b:r,a:i}}toRgb(){let[e,t,r]=this._components;return{r:e,g:t,b:r}}toRgbaString(){let[e,t,r]=this.toUint8RgbArray();return`rgba(${e},${t},${r},${this.alpha})`}toUint8RgbArray(e){let[t,r,i]=this._components;return(e=e??[])[0]=Math.round(255*t),e[1]=Math.round(255*r),e[2]=Math.round(255*i),e}toRgbArray(e){e=e??[];let[t,r,i]=this._components;return e[0]=t,e[1]=r,e[2]=i,e}toNumber(){return this._int}toLittleEndianNumber(){let e=this._int;return(e>>16)+(65280&e)+((255&e)<<16)}multiply(t){let[r,i,n,s]=e.temp.setValue(t)._components;return this._components[0]*=r,this._components[1]*=i,this._components[2]*=n,this._components[3]*=s,this.refreshInt(),this._value=null,this}premultiply(e,t=!0){return t&&(this._components[0]*=e,this._components[1]*=e,this._components[2]*=e),this._components[3]=e,this.refreshInt(),this._value=null,this}toPremultiplied(e,t=!0){if(1===e)return -16777216+this._int;if(0===e)return t?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,n=255&this._int;return t&&(r=r*e+.5|0,i=i*e+.5|0,n=n*e+.5|0),(255*e<<24)+(r<<16)+(i<<8)+n}toHex(){let e=this._int.toString(16);return`#${"000000".substring(0,6-e.length)+e}`}toHexa(){let e=Math.round(255*this._components[3]).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(e){return this._components[3]=this._clamp(e),this}round(e){let[t,r,i]=this._components;return this._components[0]=Math.round(t*e)/e,this._components[1]=Math.round(r*e)/e,this._components[2]=Math.round(i*e)/e,this.refreshInt(),this._value=null,this}toArray(e){e=e??[];let[t,r,i,n]=this._components;return e[0]=t,e[1]=r,e[2]=i,e[3]=n,e}normalize(t){let r,i,n,s;if(("number"==typeof t||t instanceof Number)&&t>=0&&t<=16777215){let e=t;r=(e>>16&255)/255,i=(e>>8&255)/255,n=(255&e)/255,s=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[r,i,n,s=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[r,i,n,s=255]=t,r/=255,i/=255,n/=255,s/=255;else if("string"==typeof t||"object"==typeof t){if("string"==typeof t){let r=e.HEX_PATTERN.exec(t);r&&(t=`#${r[2]}`)}let o=iR(t);o.isValid()&&({r:r,g:i,b:n,a:s}=o.rgba,r/=255,i/=255,n/=255)}if(void 0!==r)this._components[0]=r,this._components[1]=i,this._components[2]=n,this._components[3]=s,this.refreshInt();else throw Error(`Unable to convert color ${t}`)}refreshInt(){this._clamp(this._components);let[e,t,r]=this._components;this._int=(255*e<<16)+(255*t<<8)+(255*r|0)}_clamp(e,t=0,r=1){return"number"==typeof e?Math.min(Math.max(e,t),r):(e.forEach((i,n)=>{e[n]=Math.min(Math.max(i,t),r)}),e)}};function iO(e,t=[]){return rL("7.2.0","utils.hex2rgb is deprecated, use Color#toRgbArray instead"),iP.shared.setValue(e).toRgbArray(t)}function iD(e){return rL("7.2.0","utils.hex2string is deprecated, use Color#toHex instead"),iP.shared.setValue(e).toHex()}function iN(e){return rL("7.2.0","utils.string2hex is deprecated, use Color#toNumber instead"),iP.shared.setValue(e).toNumber()}function iF(e){return rL("7.2.0","utils.rgb2hex is deprecated, use Color#toNumber instead"),iP.shared.setValue(e).toNumber()}iP.shared=new iP,iP.temp=new iP,iP.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;const iB=function(){let e=[],t=[];for(let r=0;r<32;r++)e[r]=r,t[r]=r;e[rX.NORMAL_NPM]=rX.NORMAL,e[rX.ADD_NPM]=rX.ADD,e[rX.SCREEN_NPM]=rX.SCREEN,t[rX.NORMAL]=rX.NORMAL_NPM,t[rX.ADD]=rX.ADD_NPM,t[rX.SCREEN]=rX.SCREEN_NPM;let r=[];return r.push(t),r.push(e),r}();function iL(e,t){return iB[t?1:0][e]}function ik(e,t,r,i=!0){return rL("7.2.0","utils.premultiplyRgba has moved to Color.premultiply"),iP.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}function iU(e,t){return rL("7.2.0","utils.premultiplyTint has moved to Color.toPremultiplied"),iP.shared.setValue(e).toPremultiplied(t)}function iG(e,t,r,i=!0){return rL("7.2.0","utils.premultiplyTintToRgba has moved to Color.premultiply"),iP.shared.setValue(e).premultiply(t,i).toArray(r??new Float32Array(4))}const iz=/^\s*data:(?:([\w-]+)\/([\w+.-]+))?(?:;charset=([\w-]+))?(?:;(base64))?,(.*)/i;function ij(e,t=null){let r=6*e;if((t=t||new Uint16Array(r)).length!==r)throw Error(`Out buffer length is incorrect, got ${t.length} and expected ${r}`);for(let e=0,i=0;e<r;e+=6,i+=4)t[e+0]=i+0,t[e+1]=i+1,t[e+2]=i+2,t[e+3]=i+0,t[e+4]=i+2,t[e+5]=i+3;return t}function iH(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}const iV={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};function iX(e,t){let r=0,i=0,n={};for(let n=0;n<e.length;n++)i+=t[n],r+=e[n].length;let s=new ArrayBuffer(4*r),o=null,a=0;for(let r=0;r<e.length;r++){let l=t[r],h=e[r],u=iH(h);n[u]||(n[u]=new iV[u](s)),o=n[u];for(let e=0;e<h.length;e++)o[(e/l|0)*i+a+e%l]=h[e];a+=l}return new Float32Array(s)}function iW(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1}function i$(e){return!(e&e-1)&&!!e}function iY(e){let t=(e>65535?1:0)<<4,r=((e>>>=t)>255?1:0)<<3;return e>>>=r,t|=r,r=(e>15?1:0)<<2,e>>>=r,t|=r,r=(e>3?1:0)<<1,e>>>=r,(t|=r)|e>>1}function iq(e,t,r){let i;let n=e.length;if(t>=n||0===r)return;r=t+r>n?n-t:r;let s=n-r;for(i=t;i<s;++i)e[i]=e[i+r];e.length=s}function iZ(e){return 0===e?0:e<0?-1:1}let iK=0;function iQ(){return++iK}const iJ=class{constructor(e,t,r,i){this.left=e,this.top=t,this.right=r,this.bottom=i}get width(){return this.right-this.left}get height(){return this.bottom-this.top}isEmpty(){return this.left===this.right||this.top===this.bottom}};iJ.EMPTY=new iJ(0,0,0,0);let i0=iJ;const i1={},i2=Object.create(null),i3=Object.create(null);function i4(){let e;for(e in i2)i2[e].destroy();for(e in i3)i3[e].destroy()}function i5(){let e;for(e in i2)delete i2[e];for(e in i3)delete i3[e]}class i8{constructor(e,t,r){this._canvas=tJ.ADAPTER.createCanvas(),this._context=this._canvas.getContext("2d"),this.resolution=r||tJ.RESOLUTION,this.resize(e,t)}clear(){this._checkDestroyed(),this._context.setTransform(1,0,0,1,0,0),this._context.clearRect(0,0,this._canvas.width,this._canvas.height)}resize(e,t){this._checkDestroyed(),this._canvas.width=Math.round(e*this.resolution),this._canvas.height=Math.round(t*this.resolution)}destroy(){this._context=null,this._canvas=null}get width(){return this._checkDestroyed(),this._canvas.width}set width(e){this._checkDestroyed(),this._canvas.width=Math.round(e)}get height(){return this._checkDestroyed(),this._canvas.height}set height(e){this._checkDestroyed(),this._canvas.height=Math.round(e)}get canvas(){return this._checkDestroyed(),this._canvas}get context(){return this._checkDestroyed(),this._context}_checkDestroyed(){if(null===this._canvas)throw TypeError("The CanvasRenderTarget has already been destroyed")}}function i6(e,t,r){for(let i=0,n=4*r*t;i<t;++i,n+=4)if(0!==e[n+3])return!1;return!0}function i7(e,t,r,i,n){let s=4*t;for(let t=i,o=i*s+4*r;t<=n;++t,o+=s)if(0!==e[o+3])return!1;return!0}function i9(e){let{width:t,height:r}=e,i=e.getContext("2d",{willReadFrequently:!0});if(null===i)throw TypeError("Failed to get canvas 2D context");let n=i.getImageData(0,0,t,r).data,s=0,o=0,a=t-1,l=r-1;for(;o<r&&i6(n,t,o);)++o;if(o===r)return i0.EMPTY;for(;i6(n,t,l);)--l;for(;i7(n,t,s,o,l);)++s;for(;i7(n,t,a,o,l);)--a;return new i0(s,o,++a,++l)}function ne(e){let t=i9(e),{width:r,height:i}=t,n=null;if(!t.isEmpty()){let s=e.getContext("2d");if(null===s)throw TypeError("Failed to get canvas 2D context");n=s.getImageData(t.left,t.top,r,i)}return{width:r,height:i,data:n}}function nt(e){let t=iz.exec(e);if(t)return{mediaType:t[1]?t[1].toLowerCase():void 0,subType:t[2]?t[2].toLowerCase():void 0,charset:t[3]?t[3].toLowerCase():void 0,encoding:t[4]?t[4].toLowerCase():void 0,data:t[5]}}function nr(e,t=globalThis.location){if(e.startsWith("data:"))return"";t=t||globalThis.location;let r=new URL(e,document.baseURI);return r.hostname!==t.hostname||r.port!==t.port||r.protocol!==t.protocol?"anonymous":""}function ni(e,t=1){let r=tJ.RETINA_PREFIX?.exec(e);return r?parseFloat(r[1]):t}var nn=((eo=nn||{})[eo.INTERACTION=50]="INTERACTION",eo[eo.HIGH=25]="HIGH",eo[eo.NORMAL=0]="NORMAL",eo[eo.LOW=-25]="LOW",eo[eo.UTILITY=-50]="UTILITY",eo);class ns{constructor(e,t=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this.fn=e,this.context=t,this.priority=r,this.once=i}match(e,t=null){return this.fn===e&&this.context===t}emit(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));let t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t}connect(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this}destroy(e=!1){this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);let t=this.next;return this.next=e?null:t,this.previous=null,t}}const no=class e{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new ns(null,null,1/0),this.deltaMS=1/e.targetFPMS,this.elapsedMS=1/e.targetFPMS,this._tick=e=>{this._requestId=null,this.started&&(this.update(e),this.started&&null===this._requestId&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(e,t,r=nn.NORMAL){return this._addListener(new ns(e,t,r))}addOnce(e,t,r=nn.NORMAL){return this._addListener(new ns(e,t,r,!0))}_addListener(e){let t=this._head.next,r=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(r);break}r=t,t=t.next}e.previous||e.connect(r)}else e.connect(r);return this._startIfPossible(),this}remove(e,t){let r=this._head.next;for(;r;)r=r.match(e,t)?r.destroy():r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let e=0,t=this._head;for(;t=t.next;)e++;return e}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let e=this._head.next;for(;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let r;if(t>this.lastTime){if((r=this.elapsedMS=t-this.lastTime)>this._maxElapsedMS&&(r=this._maxElapsedMS),r*=this.speed,this._minElapsedMS){let e=t-this._lastFrame|0;if(e<this._minElapsedMS)return;this._lastFrame=t-e%this._minElapsedMS}this.deltaMS=r,this.deltaTime=this.deltaMS*e.targetFPMS;let i=this._head,n=i.next;for(;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){let r=Math.min(Math.max(0,Math.min(this.maxFPS,t))/1e3,e.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(e){if(0===e)this._minElapsedMS=0;else{let t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}}static get shared(){if(!e._shared){let t=e._shared=new e;t.autoStart=!0,t._protected=!0}return e._shared}static get system(){if(!e._system){let t=e._system=new e;t.autoStart=!0,t._protected=!0}return e._system}};no.targetFPMS=.06,Object.defineProperties(tJ,{TARGET_FPMS:{get:()=>no.targetFPMS,set(e){rL("7.1.0","settings.TARGET_FPMS is deprecated, use Ticker.targetFPMS"),no.targetFPMS=e}}});var na=((ea=na||{}).Renderer="renderer",ea.Application="application",ea.RendererSystem="renderer-webgl-system",ea.RendererPlugin="renderer-webgl-plugin",ea.CanvasRendererSystem="renderer-canvas-system",ea.CanvasRendererPlugin="renderer-canvas-plugin",ea.Asset="asset",ea.LoadParser="load-parser",ea.ResolveParser="resolve-parser",ea.CacheParser="cache-parser",ea.DetectionParser="detection-parser",ea);const nl=e=>{if("function"==typeof e||"object"==typeof e&&e.extension){if(!e.extension)throw Error("Extension class must have an extension object");e={..."object"!=typeof e.extension?{type:e.extension}:e.extension,ref:e}}if("object"==typeof e)e={...e};else throw Error("Invalid extension type");return"string"==typeof e.type&&(e.type=[e.type]),e},nh=(e,t)=>nl(e).priority??t,nu={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...e){return e.map(nl).forEach(e=>{e.type.forEach(t=>this._removeHandlers[t]?.(e))}),this},add(...e){return e.map(nl).forEach(e=>{e.type.forEach(t=>{let r=this._addHandlers,i=this._queue;r[t]?r[t](e):(i[t]=i[t]||[],i[t].push(e))})}),this},handle(e,t,r){let i=this._addHandlers,n=this._removeHandlers;if(i[e]||n[e])throw Error(`Extension type ${e} already has a handler`);i[e]=t,n[e]=r;let s=this._queue;return s[e]&&(s[e].forEach(e=>t(e)),delete s[e]),this},handleByMap(e,t){return this.handle(e,e=>{t[e.name]=e.ref},e=>{delete t[e.name]})},handleByList(e,t,r=-1){return this.handle(e,e=>{t.includes(e.ref)||(t.push(e.ref),t.sort((e,t)=>nh(t,r)-nh(e,r)))},e=>{let r=t.indexOf(e.ref);-1!==r&&t.splice(r,1)})}};class nc{static init(e){e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,nn.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?no.shared:new no,e.autoStart&&this.start()}static destroy(){if(this._ticker){let e=this._ticker;this.ticker=null,e.destroy()}}}nc.extension=na.Application,nu.add(nc);/*!
 * pixi-filters - v5.2.1
 * Compiled Fri, 24 Mar 2023 22:12:11 UTC
 *
 * pixi-filters is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*!
 * @pixi/filter-adjustment - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-adjustment is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */class nd{constructor(e){"number"==typeof e?this.rawBinaryData=new ArrayBuffer(e):e instanceof Uint8Array?this.rawBinaryData=e.buffer:this.rawBinaryData=e,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get uint16View(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}view(e){return this[`${e}View`]}destroy(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null}static sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw Error(`${e} isn't a valid view type`)}}}const nf=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);class np{constructor(){this.data=0,this.blendMode=rX.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(1&this.data)}set blend(e){!!(1&this.data)!==e&&(this.data^=1)}get offsets(){return!!(2&this.data)}set offsets(e){!!(2&this.data)!==e&&(this.data^=2)}get culling(){return!!(4&this.data)}set culling(e){!!(4&this.data)!==e&&(this.data^=4)}get depthTest(){return!!(8&this.data)}set depthTest(e){!!(8&this.data)!==e&&(this.data^=8)}get depthMask(){return!!(32&this.data)}set depthMask(e){!!(32&this.data)!==e&&(this.data^=32)}get clockwiseFrontFace(){return!!(16&this.data)}set clockwiseFrontFace(e){!!(16&this.data)!==e&&(this.data^=16)}get blendMode(){return this._blendMode}set blendMode(e){this.blend=e!==rX.NONE,this._blendMode=e}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){this.offsets=!!e,this._polygonOffset=e}static for2d(){let e=new np;return e.depthTest=!1,e.blend=!0,e}}np.prototype.toString=function(){return`[@pixi/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`};const nm=[];function ng(e,t){if(!e)return null;let r="";if("string"==typeof e){let t=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);t&&(r=t[1].toLowerCase())}for(let i=nm.length-1;i>=0;--i){let n=nm[i];if(n.test&&n.test(e,r))return new n(e,t)}throw Error("Unrecognized source type to auto-detect Resource")}class nv{constructor(e){this.items=[],this._name=e,this._aliasCount=0}emit(e,t,r,i,n,s,o,a){if(arguments.length>8)throw Error("max arguments reached");let{name:l,items:h}=this;this._aliasCount++;for(let u=0,c=h.length;u<c;u++)h[u][l](e,t,r,i,n,s,o,a);return h===this.items&&this._aliasCount--,this}ensureNonAliasedItems(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))}add(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this}remove(e){let t=this.items.indexOf(e);return -1!==t&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this}contains(e){return this.items.includes(e)}removeAll(){return this.ensureNonAliasedItems(),this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return 0===this.items.length}get name(){return this._name}}Object.defineProperties(nv.prototype,{dispatch:{value:nv.prototype.emit},run:{value:nv.prototype.emit}});class ny{constructor(e=0,t=0){this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new nv("setRealSize"),this.onUpdate=new nv("update"),this.onError=new nv("onError")}bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.emit(this._width,this._height)}unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)}resize(e,t){(e!==this._width||t!==this._height)&&(this._width=e,this._height=t,this.onResize.emit(e,t))}get valid(){return!!this._width&&!!this._height}update(){this.destroyed||this.onUpdate.emit()}load(){return Promise.resolve(this)}get width(){return this._width}get height(){return this._height}style(e,t,r){return!1}dispose(){}destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)}static test(e,t){return!1}}class n_ extends ny{constructor(e,t){let{width:r,height:i}=t||{};if(!r||!i)throw Error("BufferResource width or height invalid");super(r,i),this.data=e,this.unpackAlignment=t.unpackAlignment??4}upload(e,t,r){let i=e.gl;i.pixelStorei(i.UNPACK_ALIGNMENT,this.unpackAlignment),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===r0.UNPACK);let n=t.realWidth,s=t.realHeight;return r.width===n&&r.height===s?i.texSubImage2D(t.target,0,0,0,n,s,t.format,r.type,this.data):(r.width=n,r.height=s,i.texImage2D(t.target,0,r.internalFormat,n,s,0,t.format,r.type,this.data)),!0}dispose(){this.data=null}static test(e){return null===e||e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array}}const nx={scaleMode:rK.NEAREST,alphaMode:r0.NPM},nb=class e extends t$(rh){constructor(t=null,r=null){super();let{alphaMode:i,mipmap:n,anisotropicLevel:s,scaleMode:o,width:a,height:l,wrapMode:h,format:u,type:c,target:d,resolution:f,resourceOptions:p}=r=Object.assign({},e.defaultOptions,r);!t||t instanceof ny||((t=ng(t,p)).internal=!0),this.resolution=f||tJ.RESOLUTION,this.width=Math.round((a||0)*this.resolution)/this.resolution,this.height=Math.round((l||0)*this.resolution)/this.resolution,this._mipmap=n,this.anisotropicLevel=s,this._wrapMode=h,this._scaleMode=o,this.format=u,this.type=c,this.target=d,this.alphaMode=i,this.uid=iQ(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=a>0&&l>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.parentTextureArray=null,this.setResource(t)}get realWidth(){return Math.round(this.width*this.resolution)}get realHeight(){return Math.round(this.height*this.resolution)}get mipmap(){return this._mipmap}set mipmap(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)}get scaleMode(){return this._scaleMode}set scaleMode(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)}get wrapMode(){return this._wrapMode}set wrapMode(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)}setStyle(e,t){let r;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,r=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,r=!0),r&&this.dirtyStyleId++,this}setSize(e,t,r){return r=r||this.resolution,this.setRealSize(e*r,t*r,r)}setRealSize(e,t,r){return this.resolution=r||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(t)/this.resolution,this._refreshPOT(),this.update(),this}_refreshPOT(){this.isPowerOfTwo=i$(this.realWidth)&&i$(this.realHeight)}setResolution(e){let t=this.resolution;return t===e||(this.resolution=e,this.valid&&(this.width=Math.round(this.width*t)/e,this.height=Math.round(this.height*t)/e,this.emit("update",this)),this._refreshPOT()),this}setResource(e){if(this.resource===e)return this;if(this.resource)throw Error("Resource can be set only once");return e.bind(this),this.resource=e,this}update(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))}onError(e){this.emit("error",this,e)}destroy(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete i3[this.cacheId],delete i2[this.cacheId],this.cacheId=null),this.valid=!1,this.dispose(),e.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}dispose(){this.emit("dispose",this)}castToBaseTexture(){return this}static from(t,r,i=tJ.STRICT_TEXTURE_CACHE){let n="string"==typeof t,s=null;if(n)s=t;else{if(!t._pixiId){let e=r?.pixiIdPrefix||"pixiid";t._pixiId=`${e}_${iQ()}`}s=t._pixiId}let o=i3[s];if(n&&i&&!o)throw Error(`The cacheId "${s}" does not exist in BaseTextureCache.`);return o||((o=new e(t,r)).cacheId=s,e.addToCache(o,s)),o}static fromBuffer(t,r,i,n){let s,o;let a=new n_(t=t||new Float32Array(r*i*4),{width:r,height:i,...n?.resourceOptions});return t instanceof Float32Array?(s=r$.RGBA,o=rq.FLOAT):t instanceof Int32Array?(s=r$.RGBA_INTEGER,o=rq.INT):t instanceof Uint32Array?(s=r$.RGBA_INTEGER,o=rq.UNSIGNED_INT):t instanceof Int16Array?(s=r$.RGBA_INTEGER,o=rq.SHORT):t instanceof Uint16Array?(s=r$.RGBA_INTEGER,o=rq.UNSIGNED_SHORT):t instanceof Int8Array?(s=r$.RGBA,o=rq.BYTE):(s=r$.RGBA,o=rq.UNSIGNED_BYTE),a.internal=!0,new e(a,Object.assign({},nx,{type:o,format:s},n))}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),i3[t]&&i3[t]!==e&&console.warn(`BaseTexture added to the cache with an id [${t}] that already had an entry`),i3[t]=e)}static removeFromCache(e){if("string"==typeof e){let t=i3[e];if(t){let r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete i3[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)delete i3[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}};nb.defaultOptions={mipmap:rJ.POW2,anisotropicLevel:0,scaleMode:rK.LINEAR,wrapMode:rQ.CLAMP,alphaMode:r0.UNPACK,target:rY.TEXTURE_2D,format:r$.RGBA,type:rq.UNSIGNED_BYTE},nb._globalBatch=0;let nT=nb;class nA{constructor(){this.texArray=null,this.blend=0,this.type=rW.TRIANGLES,this.start=0,this.size=0,this.data=null}}let nE=0;class nw{constructor(e,t=!0,r=!1){this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=r,this.static=t,this.id=nE++,this.disposeRunner=new nv("disposeBuffer")}update(e){e instanceof Array&&(e=new Float32Array(e)),this.data=e||this.data,this._updateID++}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.data=null}set index(e){this.type=e?r6.ELEMENT_ARRAY_BUFFER:r6.ARRAY_BUFFER}get index(){return this.type===r6.ELEMENT_ARRAY_BUFFER}static from(e){return e instanceof Array&&(e=new Float32Array(e)),new nw(e)}}class nC{constructor(e,t=0,r=!1,i=rq.FLOAT,n,s,o,a=1){this.buffer=e,this.size=t,this.normalized=r,this.type=i,this.stride=n,this.start=s,this.instance=o,this.divisor=a}destroy(){this.buffer=null}static from(e,t,r,i,n){return new nC(e,t,r,i,n)}}const nS={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array},nI={5126:4,5123:2,5121:1};let nR=0;const nM={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array};class nP{constructor(e=[],t={}){this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=nR++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new nv("disposeGeometry"),this.refCount=0}addAttribute(e,t,r=0,i=!1,n,s,o,a=!1){if(!t)throw Error("You must pass a buffer when creating an attribute");t instanceof nw||(t instanceof Array&&(t=new Float32Array(t)),t=new nw(t));let l=e.split("|");if(l.length>1){for(let e=0;e<l.length;e++)this.addAttribute(l[e],t,r,i,n);return this}let h=this.buffers.indexOf(t);return -1===h&&(this.buffers.push(t),h=this.buffers.length-1),this.attributes[e]=new nC(h,r,i,n,s,o,a),this.instanced=this.instanced||a,this}getAttribute(e){return this.attributes[e]}getBuffer(e){return this.buffers[this.getAttribute(e).buffer]}addIndex(e){return e instanceof nw||(e instanceof Array&&(e=new Uint16Array(e)),e=new nw(e)),e.type=r6.ELEMENT_ARRAY_BUFFER,this.indexBuffer=e,this.buffers.includes(e)||this.buffers.push(e),this}getIndex(){return this.indexBuffer}interleave(){let e;if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;let t=[],r=[],i=new nw;for(e in this.attributes){let i=this.attributes[e],n=this.buffers[i.buffer];t.push(n.data),r.push(i.size*nI[i.type]/4),i.buffer=0}for(i.data=function(e,t){let r=0,i=0,n={};for(let n=0;n<e.length;n++)i+=t[n],r+=e[n].length;let s=new ArrayBuffer(4*r),o=null,a=0;for(let r=0;r<e.length;r++){let l=t[r],h=e[r],u=iH(h);n[u]||(n[u]=new nS[u](s)),o=n[u];for(let e=0;e<h.length;e++)o[(e/l|0)*i+a+e%l]=h[e];a+=l}return new Float32Array(s)}(t,r),e=0;e<this.buffers.length;e++)this.buffers[e]!==this.indexBuffer&&this.buffers[e].destroy();return this.buffers=[i],this.indexBuffer&&this.buffers.push(this.indexBuffer),this}getSize(){for(let e in this.attributes){let t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0}dispose(){this.disposeRunner.emit(this,!1)}destroy(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null}clone(){let e=new nP;for(let t=0;t<this.buffers.length;t++)e.buffers[t]=new nw(this.buffers[t].data.slice(0));for(let t in this.attributes){let r=this.attributes[t];e.attributes[t]=new nC(r.buffer,r.size,r.normalized,r.type,r.stride,r.start,r.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.type=r6.ELEMENT_ARRAY_BUFFER),e}static merge(e){let t;let r=new nP,i=[],n=[],s=[];for(let r=0;r<e.length;r++){t=e[r];for(let e=0;e<t.buffers.length;e++)n[e]=n[e]||0,n[e]+=t.buffers[e].data.length,s[e]=0}for(let e=0;e<t.buffers.length;e++)i[e]=new nM[iH(t.buffers[e].data)](n[e]),r.buffers[e]=new nw(i[e]);for(let r=0;r<e.length;r++){t=e[r];for(let e=0;e<t.buffers.length;e++)i[e].set(t.buffers[e].data,s[e]),s[e]+=t.buffers[e].data.length}if(r.attributes=t.attributes,t.indexBuffer){r.indexBuffer=r.buffers[t.buffers.indexOf(t.indexBuffer)],r.indexBuffer.type=r6.ELEMENT_ARRAY_BUFFER;let i=0,n=0,s=0,o=0;for(let e=0;e<t.buffers.length;e++)if(t.buffers[e]!==t.indexBuffer){o=e;break}for(let e in t.attributes){let r=t.attributes[e];(0|r.buffer)===o&&(n+=r.size*nI[r.type]/4)}for(let t=0;t<e.length;t++){let a=e[t].indexBuffer.data;for(let e=0;e<a.length;e++)r.indexBuffer.data[e+s]+=i;i+=e[t].buffers[o].data.length/n,s+=a.length}}return r}}class nO extends nP{constructor(e=!1){super(),this._buffer=new nw(null,e,!1),this._indexBuffer=new nw(null,e,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,rq.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,rq.FLOAT).addAttribute("aColor",this._buffer,4,!0,rq.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,rq.FLOAT).addIndex(this._indexBuffer)}}const nD=2*Math.PI,nN=180/Math.PI,nF=Math.PI/180;var nB=((el=nB||{})[el.POLY=0]="POLY",el[el.RECT=1]="RECT",el[el.CIRC=2]="CIRC",el[el.ELIP=3]="ELIP",el[el.RREC=4]="RREC",el);class nL{constructor(e=0,t=0){this.x=0,this.y=0,this.x=e,this.y=t}clone(){return new nL(this.x,this.y)}copyFrom(e){return this.set(e.x,e.y),this}copyTo(e){return e.set(this.x,this.y),e}equals(e){return e.x===this.x&&e.y===this.y}set(e=0,t=e){return this.x=e,this.y=t,this}}nL.prototype.toString=function(){return`[@pixi/math:Point x=${this.x} y=${this.y}]`};const nk=[new nL,new nL,new nL,new nL];class nU{constructor(e=0,t=0,r=0,i=0){this.x=Number(e),this.y=Number(t),this.width=Number(r),this.height=Number(i),this.type=nB.RECT}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}static get EMPTY(){return new nU(0,0,0,0)}clone(){return new nU(this.x,this.y,this.width,this.height)}copyFrom(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this}copyTo(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e}contains(e,t){return!(this.width<=0)&&!(this.height<=0)&&e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height}intersects(e,t){if(!t){let t=this.x<e.x?e.x:this.x;if((this.right>e.right?e.right:this.right)<=t)return!1;let r=this.y<e.y?e.y:this.y;return(this.bottom>e.bottom?e.bottom:this.bottom)>r}let r=this.left,i=this.right,n=this.top,s=this.bottom;if(i<=r||s<=n)return!1;let o=nk[0].set(e.left,e.top),a=nk[1].set(e.left,e.bottom),l=nk[2].set(e.right,e.top),h=nk[3].set(e.right,e.bottom);if(l.x<=o.x||a.y<=o.y)return!1;let u=Math.sign(t.a*t.d-t.b*t.c);if(0===u||(t.apply(o,o),t.apply(a,a),t.apply(l,l),t.apply(h,h),Math.max(o.x,a.x,l.x,h.x)<=r||Math.min(o.x,a.x,l.x,h.x)>=i||Math.max(o.y,a.y,l.y,h.y)<=n||Math.min(o.y,a.y,l.y,h.y)>=s))return!1;let c=u*(a.y-o.y),d=u*(o.x-a.x),f=c*r+d*n,p=c*i+d*n,m=c*r+d*s,g=c*i+d*s;if(Math.max(f,p,m,g)<=c*o.x+d*o.y||Math.min(f,p,m,g)>=c*h.x+d*h.y)return!1;let v=u*(o.y-l.y),y=u*(l.x-o.x),x=v*r+y*n,b=v*i+y*n,T=v*r+y*s,A=v*i+y*s;return!(Math.max(x,b,T,A)<=v*o.x+y*o.y||Math.min(x,b,T,A)>=v*h.x+y*h.y)}pad(e=0,t=e){return this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this}fit(e){let t=Math.max(this.x,e.x),r=Math.min(this.x+this.width,e.x+e.width),i=Math.max(this.y,e.y),n=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(r-t,0),this.y=i,this.height=Math.max(n-i,0),this}ceil(e=1,t=.001){let r=Math.ceil((this.x+this.width-t)*e)/e,i=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=r-this.x,this.height=i-this.y,this}enlarge(e){let t=Math.min(this.x,e.x),r=Math.max(this.x+this.width,e.x+e.width),i=Math.min(this.y,e.y),n=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=r-t,this.y=i,this.height=n-i,this}}nU.prototype.toString=function(){return`[@pixi/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class nG{constructor(e=0,t=0,r=0){this.x=e,this.y=t,this.radius=r,this.type=nB.CIRC}clone(){return new nG(this.x,this.y,this.radius)}contains(e,t){if(this.radius<=0)return!1;let r=this.radius*this.radius,i=this.x-e,n=this.y-t;return i*=i,n*=n,i+n<=r}getBounds(){return new nU(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}nG.prototype.toString=function(){return`[@pixi/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`};class nz{constructor(e=0,t=0,r=0,i=0){this.x=e,this.y=t,this.width=r,this.height=i,this.type=nB.ELIP}clone(){return new nz(this.x,this.y,this.width,this.height)}contains(e,t){if(this.width<=0||this.height<=0)return!1;let r=(e-this.x)/this.width,i=(t-this.y)/this.height;return r*=r,i*=i,r+i<=1}getBounds(){return new nU(this.x-this.width,this.y-this.height,this.width,this.height)}}nz.prototype.toString=function(){return`[@pixi/math:Ellipse x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`};class nj{constructor(...e){let t=Array.isArray(e[0])?e[0]:e;if("number"!=typeof t[0]){let e=[];for(let r=0,i=t.length;r<i;r++)e.push(t[r].x,t[r].y);t=e}this.points=t,this.type=nB.POLY,this.closeStroke=!0}clone(){let e=new nj(this.points.slice());return e.closeStroke=this.closeStroke,e}contains(e,t){let r=!1,i=this.points.length/2;for(let n=0,s=i-1;n<i;s=n++){let i=this.points[2*n],o=this.points[2*n+1],a=this.points[2*s],l=this.points[2*s+1];o>t!=l>t&&e<(t-o)/(l-o)*(a-i)+i&&(r=!r)}return r}}nj.prototype.toString=function(){return`[@pixi/math:PolygoncloseStroke=${this.closeStroke}points=${this.points.reduce((e,t)=>`${e}, ${t}`,"")}]`};class nH{constructor(e=0,t=0,r=0,i=0,n=20){this.x=e,this.y=t,this.width=r,this.height=i,this.radius=n,this.type=nB.RREC}clone(){return new nH(this.x,this.y,this.width,this.height,this.radius)}contains(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){let r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(t>=this.y+r&&t<=this.y+this.height-r||e>=this.x+r&&e<=this.x+this.width-r)return!0;let i=e-(this.x+r),n=t-(this.y+r),s=r*r;if(i*i+n*n<=s||(i=e-(this.x+this.width-r))*i+n*n<=s||i*i+(n=t-(this.y+this.height-r))*n<=s||(i=e-(this.x+r))*i+n*n<=s)return!0}return!1}}nH.prototype.toString=function(){return`[@pixi/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`};class nV{constructor(e=1,t=0,r=0,i=1,n=0,s=0){this.array=null,this.a=e,this.b=t,this.c=r,this.d=i,this.tx=n,this.ty=s}fromArray(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]}set(e,t,r,i,n,s){return this.a=e,this.b=t,this.c=r,this.d=i,this.tx=n,this.ty=s,this}toArray(e,t){this.array||(this.array=new Float32Array(9));let r=t||this.array;return e?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0),r[8]=1,r}apply(e,t){t=t||new nL;let r=e.x,i=e.y;return t.x=this.a*r+this.c*i+this.tx,t.y=this.b*r+this.d*i+this.ty,t}applyInverse(e,t){t=t||new nL;let r=1/(this.a*this.d+-(this.c*this.b)),i=e.x,n=e.y;return t.x=this.d*r*i+-this.c*r*n+(this.ty*this.c-this.tx*this.d)*r,t.y=this.a*r*n+-this.b*r*i+(-this.ty*this.a+this.tx*this.b)*r,t}translate(e,t){return this.tx+=e,this.ty+=t,this}scale(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this}rotate(e){let t=Math.cos(e),r=Math.sin(e),i=this.a,n=this.c,s=this.tx;return this.a=i*t-this.b*r,this.b=i*r+this.b*t,this.c=n*t-this.d*r,this.d=n*r+this.d*t,this.tx=s*t-this.ty*r,this.ty=s*r+this.ty*t,this}append(e){let t=this.a,r=this.b,i=this.c,n=this.d;return this.a=e.a*t+e.b*i,this.b=e.a*r+e.b*n,this.c=e.c*t+e.d*i,this.d=e.c*r+e.d*n,this.tx=e.tx*t+e.ty*i+this.tx,this.ty=e.tx*r+e.ty*n+this.ty,this}setTransform(e,t,r,i,n,s,o,a,l){return this.a=Math.cos(o+l)*n,this.b=Math.sin(o+l)*n,this.c=-Math.sin(o-a)*s,this.d=Math.cos(o-a)*s,this.tx=e-(r*this.a+i*this.c),this.ty=t-(r*this.b+i*this.d),this}prepend(e){let t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){let t=this.a,r=this.c;this.a=t*e.a+this.b*e.c,this.b=t*e.b+this.b*e.d,this.c=r*e.a+this.d*e.c,this.d=r*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this}decompose(e){let t=this.a,r=this.b,i=this.c,n=this.d,s=e.pivot,o=-Math.atan2(-i,n),a=Math.atan2(r,t),l=Math.abs(o+a);return l<1e-5||1e-5>Math.abs(nD-l)?(e.rotation=a,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=o,e.skew.y=a),e.scale.x=Math.sqrt(t*t+r*r),e.scale.y=Math.sqrt(i*i+n*n),e.position.x=this.tx+(s.x*t+s.y*i),e.position.y=this.ty+(s.x*r+s.y*n),e}invert(){let e=this.a,t=this.b,r=this.c,i=this.d,n=this.tx,s=e*i-t*r;return this.a=i/s,this.b=-t/s,this.c=-r/s,this.d=e/s,this.tx=(r*this.ty-i*n)/s,this.ty=-(e*this.ty-t*n)/s,this}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){let e=new nV;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyTo(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e}copyFrom(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this}static get IDENTITY(){return new nV}static get TEMP_MATRIX(){return new nV}}nV.prototype.toString=function(){return`[@pixi/math:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`};const nX=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],nW=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],n$=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],nY=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],nq=[],nZ=[],nK=Math.sign;!function(){for(let e=0;e<16;e++){let t=[];nq.push(t);for(let r=0;r<16;r++){let i=nK(nX[e]*nX[r]+n$[e]*nW[r]),n=nK(nW[e]*nX[r]+nY[e]*nW[r]),s=nK(nX[e]*n$[r]+n$[e]*nY[r]),o=nK(nW[e]*n$[r]+nY[e]*nY[r]);for(let e=0;e<16;e++)if(nX[e]===i&&nW[e]===n&&n$[e]===s&&nY[e]===o){t.push(e);break}}}for(let e=0;e<16;e++){let t=new nV;t.set(nX[e],nW[e],n$[e],nY[e],0,0),nZ.push(t)}}();const nQ={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:e=>nX[e],uY:e=>nW[e],vX:e=>n$[e],vY:e=>nY[e],inv:e=>8&e?15&e:7&-e,add:(e,t)=>nq[e][t],sub:(e,t)=>nq[e][nQ.inv(t)],rotate180:e=>4^e,isVertical:e=>(3&e)==2,byDirection:(e,t)=>2*Math.abs(e)<=Math.abs(t)?t>=0?nQ.S:nQ.N:2*Math.abs(t)<=Math.abs(e)?e>0?nQ.E:nQ.W:t>0?e>0?nQ.SE:nQ.SW:e>0?nQ.NE:nQ.NW,matrixAppendRotationInv:(e,t,r=0,i=0)=>{let n=nZ[nQ.inv(t)];n.tx=r,n.ty=i,e.append(n)}};class nJ{constructor(e,t,r=0,i=0){this._x=r,this._y=i,this.cb=e,this.scope=t}clone(e=this.cb,t=this.scope){return new nJ(e,t,this._x,this._y)}set(e=0,t=e){return(this._x!==e||this._y!==t)&&(this._x=e,this._y=t,this.cb.call(this.scope)),this}copyFrom(e){return(this._x!==e.x||this._y!==e.y)&&(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this}copyTo(e){return e.set(this._x,this._y),e}equals(e){return e.x===this._x&&e.y===this._y}get x(){return this._x}set x(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))}get y(){return this._y}set y(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))}}nJ.prototype.toString=function(){return`[@pixi/math:ObservablePoint x=${this.x} y=${this.y} scope=${this.scope}]`};const n0=class{constructor(){this.worldTransform=new nV,this.localTransform=new nV,this.position=new nJ(this.onChange,this,0,0),this.scale=new nJ(this.onChange,this,1,1),this.pivot=new nJ(this.onChange,this,0,0),this.skew=new nJ(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}onChange(){this._localID++}updateSkew(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++}updateLocalTransform(){let e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)}updateTransform(e){let t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){let r=e.worldTransform,i=this.worldTransform;i.a=t.a*r.a+t.b*r.c,i.b=t.a*r.b+t.b*r.d,i.c=t.c*r.a+t.d*r.c,i.d=t.c*r.b+t.d*r.d,i.tx=t.tx*r.a+t.ty*r.c+r.tx,i.ty=t.tx*r.b+t.ty*r.d+r.ty,this._parentID=e._worldID,this._worldID++}}setFromMatrix(e){e.decompose(this),this._localID++}get rotation(){return this._rotation}set rotation(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())}};n0.IDENTITY=new n0,n0.prototype.toString=function(){return`[@pixi/math:Transform position=(${this.position.x}, ${this.position.y}) rotation=${this.rotation} scale=(${this.scale.x}, ${this.scale.y}) skew=(${this.skew.x}, ${this.skew.y}) ]`};var n1=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,n2=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`;function n3(e,t,r){let i=e.createShader(t);return e.shaderSource(i,r),e.compileShader(i),i}function n4(e){let t=Array(e);for(let e=0;e<t.length;e++)t[e]=!1;return t}function n5(e,t){switch(e){case"float":case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return n4(2*t);case"bvec3":return n4(3*t);case"bvec4":return n4(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const n8=[{test:e=>"float"===e.type&&1===e.size&&!e.isArray,code:e=>`
            if(uv["${e}"] !== ud["${e}"].value)
            {
                ud["${e}"].value = uv["${e}"]
                gl.uniform1f(ud["${e}"].location, uv["${e}"])
            }
            `},{test:(e,t)=>("sampler2D"===e.type||"samplerCube"===e.type||"sampler2DArray"===e.type)&&1===e.size&&!e.isArray&&(null==t||void 0!==t.castToBaseTexture),code:e=>`t = syncData.textureCount++;

            renderer.texture.bind(uv["${e}"], t);

            if(ud["${e}"].value !== t)
            {
                ud["${e}"].value = t;
                gl.uniform1i(ud["${e}"].location, t);
; // eslint-disable-line max-len
            }`},{test:(e,t)=>"mat3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.a,code:e=>`
            gl.uniformMatrix3fv(ud["${e}"].location, false, uv["${e}"].toArray(true));
            `,codeUbo:e=>`
                var ${e}_matrix = uv.${e}.toArray(true);

                data[offset] = ${e}_matrix[0];
                data[offset+1] = ${e}_matrix[1];
                data[offset+2] = ${e}_matrix[2];
        
                data[offset + 4] = ${e}_matrix[3];
                data[offset + 5] = ${e}_matrix[4];
                data[offset + 6] = ${e}_matrix[5];
        
                data[offset + 8] = ${e}_matrix[6];
                data[offset + 9] = ${e}_matrix[7];
                data[offset + 10] = ${e}_matrix[8];
            `},{test:(e,t)=>"vec2"===e.type&&1===e.size&&!e.isArray&&void 0!==t.x,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["${e}"].location, v.x, v.y);
                }`,codeUbo:e=>`
                v = uv.${e};

                data[offset] = v.x;
                data[offset+1] = v.y;
            `},{test:e=>"vec2"===e.type&&1===e.size&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["${e}"].location, v[0], v[1]);
                }
            `},{test:(e,t)=>"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.width,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["${e}"].location, v.x, v.y, v.width, v.height)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `},{test:(e,t)=>"vec4"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.alpha)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
                    cv[3] = v.alpha;
                    gl.uniform4f(ud["${e}"].location, v.red, v.green, v.blue, v.alpha)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                    data[offset+3] = v.alpha;
                `},{test:(e,t)=>"vec3"===e.type&&1===e.size&&!e.isArray&&void 0!==t.red,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v.red || cv[1] !== v.green || cv[2] !== v.blue || cv[3] !== v.a)
                {
                    cv[0] = v.red;
                    cv[1] = v.green;
                    cv[2] = v.blue;
    
                    gl.uniform3f(ud["${e}"].location, v.red, v.green, v.blue)
                }`,codeUbo:e=>`
                    v = uv.${e};

                    data[offset] = v.red;
                    data[offset+1] = v.green;
                    data[offset+2] = v.blue;
                `},{test:e=>"vec4"===e.type&&1===e.size&&!e.isArray,code:e=>`
                cv = ud["${e}"].value;
                v = uv["${e}"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["${e}"].location, v[0], v[1], v[2], v[3])
                }`}],n6={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},n7={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"},n9={};let se=n9;function st(e,t){let r=e.getShaderSource(t).split(`
`).map((e,t)=>`${t}: ${e}`),i=e.getShaderInfoLog(t),n=i.split(`
`),s={},o=n.map(e=>parseFloat(e.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(e=>!!e&&!s[e]&&(s[e]=!0,!0)),a=[""];o.forEach(e=>{r[e-1]=`%c${r[e-1]}%c`,a.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});let l=r.join(`
`);a[0]=l,console.error(i),console.groupCollapsed("click to view full shader code"),console.warn(...a),console.groupEnd()}const sr={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};let si=null;const sn={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function ss(e,t){if(!si){let t=Object.keys(sn);si={};for(let r=0;r<t.length;++r){let i=t[r];si[e[i]]=sn[i]}}return si[t]}function so(e,t,r){if("precision"!==e.substring(0,9)){let i=t;return t===r3.HIGH&&r!==r3.HIGH&&(i=r3.MEDIUM),`precision ${i} float;
${e}`}return r!==r3.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}let sa=0;const sl={},sh=class e{constructor(t,i,n="pixi-shader",s={}){this.extra={},this.id=sa++,this.vertexSrc=t||e.defaultVertexSrc,this.fragmentSrc=i||e.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.extra=s,"#version"!==this.vertexSrc.substring(0,8)&&(sl[n=n.replace(/\s+/g,"-")]?(sl[n]++,n+=`-${sl[n]}`):sl[n]=1,this.vertexSrc=`#define SHADER_NAME ${n}
${this.vertexSrc}`,this.fragmentSrc=`#define SHADER_NAME ${n}
${this.fragmentSrc}`,this.vertexSrc=so(this.vertexSrc,e.defaultVertexPrecision,r3.HIGH),this.fragmentSrc=so(this.fragmentSrc,e.defaultFragmentPrecision,function(){if(!r){r=r3.MEDIUM;let e=function(){if(se===n9||se?.isContextLost()){let e;let t=tJ.ADAPTER.createCanvas();tJ.PREFER_ENV>=rj.WEBGL2&&(e=t.getContext("webgl2",{})),e||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),se=e}return se}();if(e&&e.getShaderPrecisionFormat){let t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);t&&(r=t.precision?r3.HIGH:r3.MEDIUM)}}return r}())),this.glPrograms={},this.syncUniforms=null}static get defaultVertexSrc(){return n2}static get defaultFragmentSrc(){return n1}static from(t,r,i){let n=t+r,s=i1[n];return s||(i1[n]=s=new e(t,r,i)),s}};sh.defaultVertexPrecision=r3.HIGH,sh.defaultFragmentPrecision=ra.apple.device?r3.HIGH:r3.MEDIUM;let su=0;class sc{constructor(e,t,r){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=su++,this.static=!!t,this.ubo=!!r,e instanceof nw?(this.buffer=e,this.buffer.type=r6.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=e,this.ubo&&(this.buffer=new nw(new Float32Array(1)),this.buffer.type=r6.UNIFORM_BUFFER,this.autoManage=!0))}update(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()}add(e,t,r){if(this.ubo)throw Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them");this.uniforms[e]=new sc(t,r)}static from(e,t,r){return new sc(e,t,r)}static uboFrom(e,t){return new sc(e,t??!0,!0)}}class sd{constructor(e,t){this.uniformBindCount=0,this.program=e,t?t instanceof sc?this.uniformGroup=t:this.uniformGroup=new sc(t):this.uniformGroup=new sc({}),this.disposeRunner=new nv("disposeShader")}checkUniformExists(e,t){if(t.uniforms[e])return!0;for(let r in t.uniforms){let i=t.uniforms[r];if(!0===i.group&&this.checkUniformExists(e,i))return!0}return!1}destroy(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()}get uniforms(){return this.uniformGroup.uniforms}static from(e,t,r){return new sd(sh.from(e,t),r)}}class sf{constructor(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},!t.includes("%count%"))throw Error('Fragment template must contain "%count%".');if(!t.includes("%forloop%"))throw Error('Fragment template must contain "%forloop%".')}generateShader(e){if(!this.programCache[e]){let t=new Int32Array(e);for(let r=0;r<e;r++)t[r]=r;this.defaultGroupCache[e]=sc.from({uSamplers:t},!0);let r=this.fragTemplate;r=(r=r.replace(/%count%/gi,`${e}`)).replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new sh(this.vertexSrc,r)}let t={tint:new Float32Array([1,1,1,1]),translationMatrix:new nV,default:this.defaultGroupCache[e]};return new sd(this.programCache[e],t)}generateSampleSrc(e){let t="";t+=`

`;for(let r=0;r<e;r++)r>0&&(t+=`
else `),r<e-1&&(t+=`if(vTextureId < ${r}.5)`),t+=`
{
	color = texture2D(uSamplers[${r}], vTextureCoord);
}`;return t+`

`}}class sp{constructor(){this.elements=[],this.ids=[],this.count=0}clear(){for(let e=0;e<this.count;e++)this.elements[e]=null;this.count=0}}class sm{constructor(e){this.renderer=e}flush(){}destroy(){this.renderer=null}start(){}stop(){this.flush()}render(e){}}var sg=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,sv=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`;const sy=class e extends sm{constructor(t){super(t),this.setShaderGenerator(),this.geometryClass=nO,this.vertexSize=6,this.state=np.for2d(),this.size=4*e.defaultBatchSize,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.maxTextures=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}static get defaultMaxTextures(){return this._defaultMaxTextures=this._defaultMaxTextures??function(e){let t=!0,r=tJ.ADAPTER.getNavigator();if(ra.tablet||ra.phone){if(ra.apple.device){let e=r.userAgent.match(/OS (\d+)_(\d+)?/);e&&11>parseInt(e[1],10)&&(t=!1)}if(ra.android.device){let e=r.userAgent.match(/Android\s([0-9.]*)/);e&&7>parseInt(e[1],10)&&(t=!1)}}return t?32:4}(0),this._defaultMaxTextures}static set defaultMaxTextures(e){this._defaultMaxTextures=e}static get canUploadSameBuffer(){return this._canUploadSameBuffer=this._canUploadSameBuffer??!ra.apple.device,this._canUploadSameBuffer}static set canUploadSameBuffer(e){this._canUploadSameBuffer=e}get MAX_TEXTURES(){return rL("7.1.0","BatchRenderer#MAX_TEXTURES renamed to BatchRenderer#maxTextures"),this.maxTextures}static get defaultVertexSrc(){return sv}static get defaultFragmentTemplate(){return sg}setShaderGenerator({vertex:t=e.defaultVertexSrc,fragment:r=e.defaultFragmentTemplate}={}){this.shaderGenerator=new sf(t,r)}contextChange(){let t=this.renderer.gl;tJ.PREFER_ENV===rj.WEBGL_LEGACY?this.maxTextures=1:(this.maxTextures=Math.min(t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),e.defaultMaxTextures),this.maxTextures=function(e,t){if(0===e)throw Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");let r=t.createShader(t.FRAGMENT_SHADER);for(;;){let i=nf.replace(/%forloop%/gi,function(e){let t="";for(let r=0;r<e;++r)r>0&&(t+=`
else `),r<e-1&&(t+=`if(test == ${r}.0){}`);return t}(e));if(t.shaderSource(r,i),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))break;e=e/2|0}return e}(this.maxTextures,t)),this._shader=this.shaderGenerator.generateShader(this.maxTextures);for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]=new this.geometryClass;this.initFlushBuffers()}initFlushBuffers(){let{_drawCallPool:t,_textureArrayPool:r}=e,i=this.size/4,n=Math.floor(i/this.maxTextures)+1;for(;t.length<i;)t.push(new nA);for(;r.length<n;)r.push(new sp);for(let e=0;e<this.maxTextures;e++)this._tempBoundTextures[e]=null}onPrerender(){this._flushId=0}render(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)}buildTexturesAndDrawCalls(){let{_bufferedTextures:t,maxTextures:r}=this,i=e._textureArrayPool,n=this.renderer.batch,s=this._tempBoundTextures,o=this.renderer.textureGC.count,a=++nT._globalBatch,l=0,h=i[0],u=0;n.copyBoundTextures(s,r);for(let e=0;e<this._bufferSize;++e){let c=t[e];t[e]=null,c._batchEnabled!==a&&(h.count>=r&&(n.boundArray(h,s,a,r),this.buildDrawCalls(h,u,e),u=e,h=i[++l],++a),c._batchEnabled=a,c.touched=o,h.elements[h.count++]=c)}h.count>0&&(n.boundArray(h,s,a,r),this.buildDrawCalls(h,u,this._bufferSize),++l,++a);for(let e=0;e<s.length;e++)s[e]=null;nT._globalBatch=a}buildDrawCalls(t,r,i){let{_bufferedElements:n,_attributeBuffer:s,_indexBuffer:o,vertexSize:a}=this,l=e._drawCallPool,h=this._dcIndex,u=this._aIndex,c=this._iIndex,d=l[h];d.start=this._iIndex,d.texArray=t;for(let e=r;e<i;++e){let i=n[e],f=iB[i._texture.baseTexture.alphaMode?1:0][i.blendMode];n[e]=null,r<e&&d.blend!==f&&(d.size=c-d.start,r=e,(d=l[++h]).texArray=t,d.start=c),this.packInterleavedGeometry(i,s,o,u,c),u+=i.vertexData.length/2*a,c+=i.indices.length,d.blend=f}r<i&&(d.size=c-d.start,++h),this._dcIndex=h,this._aIndex=u,this._iIndex=c}bindAndClearTexArray(e){let t=this.renderer.texture;for(let r=0;r<e.count;r++)t.bind(e.elements[r],e.ids[r]),e.elements[r]=null;e.count=0}updateGeometry(){let{_packedGeometries:t,_attributeBuffer:r,_indexBuffer:i}=this;e.canUploadSameBuffer?(t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(r.rawBinaryData),t[this._flushId]._indexBuffer.update(i),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)}drawBatches(){let t=this._dcIndex,{gl:r,state:i}=this.renderer,n=e._drawCallPool,s=null;for(let e=0;e<t;e++){let{texArray:t,type:o,size:a,start:l,blend:h}=n[e];s!==t&&(s=t,this.bindAndClearTexArray(t)),this.state.blendMode=h,i.set(this.state),r.drawElements(o,a,r.UNSIGNED_SHORT,2*l)}}flush(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)}start(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.maxTextures),this.renderer.shader.bind(this._shader),e.canUploadSameBuffer&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])}stop(){this.flush()}destroy(){for(let e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),super.destroy()}getAttributeBuffer(e){let t=iW(Math.ceil(e/8)),r=iY(t),i=8*t;this._aBuffers.length<=r&&(this._iBuffers.length=r+1);let n=this._aBuffers[i];return n||(this._aBuffers[i]=n=new nd(i*this.vertexSize*4)),n}getIndexBuffer(e){let t=iW(Math.ceil(e/12)),r=iY(t);this._iBuffers.length<=r&&(this._iBuffers.length=r+1);let i=this._iBuffers[r];return i||(this._iBuffers[r]=i=new Uint16Array(12*t)),i}packInterleavedGeometry(e,t,r,i,n){let{uint32View:s,float32View:o}=t,a=i/this.vertexSize,l=e.uvs,h=e.indices,u=e.vertexData,c=e._texture.baseTexture._batchLocation,d=Math.min(e.worldAlpha,1),f=iP.shared.setValue(e._tintRGB).toPremultiplied(d,e._texture.baseTexture.alphaMode>0);for(let e=0;e<u.length;e+=2)o[i++]=u[e],o[i++]=u[e+1],o[i++]=l[e],o[i++]=l[e+1],s[i++]=f,o[i++]=c;for(let e=0;e<h.length;e++)r[n++]=a+h[e]}};sy.defaultBatchSize=4096,sy.extension={name:"batch",type:na.RendererPlugin},sy._drawCallPool=[],sy._textureArrayPool=[],nu.add(sy);var s_=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,sx=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;const sb=class e extends sd{constructor(t,r,i){super(sh.from(t||e.defaultVertexSrc,r||e.defaultFragmentSrc),i),this.padding=0,this.resolution=e.defaultResolution,this.multisample=e.defaultMultisample,this.enabled=!0,this.autoFit=!0,this.state=new np}apply(e,t,r,i,n){e.applyFilter(this,t,r,i)}get blendMode(){return this.state.blendMode}set blendMode(e){this.state.blendMode=e}get resolution(){return this._resolution}set resolution(e){this._resolution=e}static get defaultVertexSrc(){return sx}static get defaultFragmentSrc(){return s_}};sb.defaultResolution=1,sb.defaultMultisample=r8.NONE;let sT=sb;class sA{constructor(){this.clearBeforeRender=!0,this._backgroundColor=new iP(0),this.alpha=1}init(e){this.clearBeforeRender=e.clearBeforeRender;let{backgroundColor:t,background:r,backgroundAlpha:i}=e,n=r??t;void 0!==n&&(this.color=n),this.alpha=i}get color(){return this._backgroundColor.value}set color(e){this._backgroundColor.setValue(e)}get alpha(){return this._backgroundColor.alpha}set alpha(e){this._backgroundColor.setAlpha(e)}get backgroundColor(){return this._backgroundColor}destroy(){}}sA.defaultOptions={backgroundAlpha:1,backgroundColor:0,clearBeforeRender:!0},sA.extension={type:[na.RendererSystem,na.CanvasRendererSystem],name:"background"},nu.add(sA);class sE{constructor(e){this.renderer=e,this.emptyRenderer=new sm(e),this.currentRenderer=this.emptyRenderer}setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())}flush(){this.setObjectRenderer(this.emptyRenderer)}reset(){this.setObjectRenderer(this.emptyRenderer)}copyBoundTextures(e,t){let{boundTextures:r}=this.renderer.texture;for(let i=t-1;i>=0;--i)e[i]=r[i]||null,e[i]&&(e[i]._batchLocation=i)}boundArray(e,t,r,i){let{elements:n,ids:s,count:o}=e,a=0;for(let e=0;e<o;e++){let o=n[e],l=o._batchLocation;if(l>=0&&l<i&&t[l]===o){s[e]=l;continue}for(;a<i;){let i=t[a];if(i&&i._batchEnabled===r&&i._batchLocation===a){a++;continue}s[e]=a,o._batchLocation=a,t[a]=o;break}}}destroy(){this.renderer=null}}sE.extension={type:na.RendererSystem,name:"batch"},nu.add(sE);let sw=0;class sC{constructor(e){this.renderer=e,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=sw++}init(e){if(e.context)this.initFromContext(e.context);else{let t=this.renderer.background.alpha<1,r=e.premultipliedAlpha;this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.useContextAlpha=e.useContextAlpha,this.powerPreference=e.powerPreference,this.initFromOptions({alpha:t,premultipliedAlpha:r,antialias:e.antialias,stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:e.powerPreference})}}initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=sw++,this.renderer.runners.contextChange.emit(e);let t=this.renderer.view;void 0!==t.addEventListener&&(t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1))}initFromOptions(e){let t=this.createContext(this.renderer.view,e);this.initFromContext(t)}createContext(e,t){let r;if(tJ.PREFER_ENV>=rj.WEBGL2&&(r=e.getContext("webgl2",t)),r)this.webGLVersion=2;else if(this.webGLVersion=1,!(r=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)))throw Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=r,this.getExtensions(),this.gl}getExtensions(){let{gl:e}=this,t={loseContext:e.getExtension("WEBGL_lose_context"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc")};1===this.webGLVersion?Object.assign(this.extensions,t,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,t,{colorBufferFloat:e.getExtension("EXT_color_buffer_float")})}handleContextLost(e){e.preventDefault(),setTimeout(()=>{this.gl.isContextLost()&&this.extensions.loseContext&&this.extensions.loseContext.restoreContext()},0)}handleContextRestored(){this.renderer.runners.contextChange.emit(this.gl)}destroy(){let e=this.renderer.view;this.renderer=null,void 0!==e.removeEventListener&&(e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored)),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()}postrender(){this.renderer.objectRenderer.renderingToScreen&&this.gl.flush()}validateContext(e){let t=e.getContextAttributes(),r="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext;r&&(this.webGLVersion=2),t&&!t.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");let i=r||!!e.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")}}sC.defaultOptions={context:null,antialias:!1,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:"default"},sC.extension={type:na.RendererSystem,name:"context"},nu.add(sC);class sS{constructor(e,t){if(this.width=Math.round(e),this.height=Math.round(t),!this.width||!this.height)throw Error("Framebuffer width or height is zero");this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new nv("disposeFramebuffer"),this.multisample=r8.NONE}get colorTexture(){return this.colorTextures[0]}addColorTexture(e=0,t){return this.colorTextures[e]=t||new nT(null,{scaleMode:rK.NEAREST,resolution:1,mipmap:rJ.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this}addDepthTexture(e){return this.depthTexture=e||new nT(null,{scaleMode:rK.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:rJ.OFF,format:r$.DEPTH_COMPONENT,type:rq.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this}enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this}enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this}resize(e,t){if(e=Math.round(e),t=Math.round(t),!e||!t)throw Error("Framebuffer width and height must not be zero");if(!(e===this.width&&t===this.height)){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(let r=0;r<this.colorTextures.length;r++){let i=this.colorTextures[r],n=i.resolution;i.setSize(e/n,t/n)}if(this.depthTexture){let r=this.depthTexture.resolution;this.depthTexture.setSize(e/r,t/r)}}}dispose(){this.disposeRunner.emit(this,!1)}destroyDepthTexture(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)}}class sI extends nT{constructor(e={}){if("number"==typeof e){let t=arguments[0],r=arguments[1],i=arguments[2],n=arguments[3];e={width:t,height:r,scaleMode:i,resolution:n}}e.width=e.width??100,e.height=e.height??100,e.multisample??(e.multisample=r8.NONE),super(null,e),this.mipmap=rJ.OFF,this.valid=!0,this._clear=new iP([0,0,0,0]),this.framebuffer=new sS(this.realWidth,this.realHeight).addColorTexture(0,this),this.framebuffer.multisample=e.multisample,this.maskStack=[],this.filterStack=[{}]}set clearColor(e){this._clear.setValue(e)}get clearColor(){return this._clear.value}get clear(){return this._clear}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t){this.framebuffer.resize(e*this.resolution,t*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)}dispose(){this.framebuffer.dispose(),super.dispose()}destroy(){super.destroy(),this.framebuffer.destroyDepthTexture(),this.framebuffer=null}}class sR extends ny{constructor(e){super(e.naturalWidth||e.videoWidth||e.width,e.naturalHeight||e.videoHeight||e.height),this.source=e,this.noSubImage=!1}static crossOrigin(e,t,r){void 0!==r||t.startsWith("data:")?!1!==r&&(e.crossOrigin="string"==typeof r?r:"anonymous"):e.crossOrigin=nr(t)}upload(e,t,r,i){let n=e.gl,s=t.realWidth,o=t.realHeight;if(i=i||this.source,"u">typeof HTMLImageElement&&i instanceof HTMLImageElement){if(!i.complete||0===i.naturalWidth)return!1}else if("u">typeof HTMLVideoElement&&i instanceof HTMLVideoElement&&i.readyState<=1)return!1;return n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===r0.UNPACK),this.noSubImage||t.target!==n.TEXTURE_2D||r.width!==s||r.height!==o?(r.width=s,r.height=o,n.texImage2D(t.target,0,r.internalFormat,t.format,r.type,i)):n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.format,r.type,i),!0}update(){if(this.destroyed)return;let e=this.source,t=e.naturalWidth||e.videoWidth||e.width,r=e.naturalHeight||e.videoHeight||e.height;this.resize(t,r),super.update()}dispose(){this.source=null}}class sM extends sR{constructor(e,t){if(t=t||{},"string"==typeof e){let r=new Image;sR.crossOrigin(r,e,t.crossorigin),r.src=e,e=r}super(e),!e.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=e.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(t.createBitmap??tJ.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,this.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,this.bitmap=null,this._load=null,!1!==t.autoLoad&&this.load()}load(e){return this._load||(void 0!==e&&(this.createBitmap=e),this._load=new Promise((e,t)=>{let r=this.source;this.url=r.src;let i=()=>{this.destroyed||(r.onload=null,r.onerror=null,this.update(),this._load=null,this.createBitmap?e(this.process()):e(this))};r.complete&&r.src?i():(r.onload=i,r.onerror=e=>{t(e),this.onError.emit(e)})})),this._load}process(){let e=this.source;if(null!==this._process)return this._process;if(null!==this.bitmap||!globalThis.createImageBitmap)return Promise.resolve(this);let t=globalThis.createImageBitmap,r=!e.crossOrigin||"anonymous"===e.crossOrigin;return this._process=fetch(e.src,{mode:r?"cors":"no-cors"}).then(e=>e.blob()).then(r=>t(r,0,0,e.width,e.height,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===r0.UNPACK?"premultiply":"none"})).then(e=>this.destroyed?Promise.reject():(this.bitmap=e,this.update(),this._process=null,Promise.resolve(this))),this._process}upload(e,t,r){if("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),!this.createBitmap)return super.upload(e,t,r);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(super.upload(e,t,r,this.bitmap),!this.preserveBitmap){let e=!0,i=t._glTextures;for(let n in i){let s=i[n];if(s!==r&&s.dirtyId!==t.dirtyId){e=!1;break}}e&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0}dispose(){this.source.onload=null,this.source.onerror=null,super.dispose(),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null}static test(e){return"u">typeof HTMLImageElement&&("string"==typeof e||e instanceof HTMLImageElement)}}class sP{constructor(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}set(e,t,r){let i=t.width,n=t.height;if(r){let t=e.width/2/i,s=e.height/2/n,o=e.x/i+t,a=e.y/n+s;r=nQ.add(r,nQ.NW),this.x0=o+t*nQ.uX(r),this.y0=a+s*nQ.uY(r),r=nQ.add(r,2),this.x1=o+t*nQ.uX(r),this.y1=a+s*nQ.uY(r),r=nQ.add(r,2),this.x2=o+t*nQ.uX(r),this.y2=a+s*nQ.uY(r),r=nQ.add(r,2),this.x3=o+t*nQ.uX(r),this.y3=a+s*nQ.uY(r)}else this.x0=e.x/i,this.y0=e.y/n,this.x1=(e.x+e.width)/i,this.y1=e.y/n,this.x2=(e.x+e.width)/i,this.y2=(e.y+e.height)/n,this.x3=e.x/i,this.y3=(e.y+e.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3}}sP.prototype.toString=function(){return`[@pixi/core:TextureUvs x0=${this.x0} y0=${this.y0} x1=${this.x1} y1=${this.y1} x2=${this.x2} y2=${this.y2} x3=${this.x3} y3=${this.y3}]`};const sO=new sP;function sD(e){e.destroy=function(){},e.on=function(){},e.once=function(){},e.emit=function(){}}class sN extends t$(rh){constructor(e,t,r,i,n,s,o){if(super(),this.noFrame=!1,t||(this.noFrame=!0,t=new nU(0,0,1,1)),e instanceof sN&&(e=e.baseTexture),this.baseTexture=e,this._frame=t,this.trim=i,this.valid=!1,this.destroyed=!1,this._uvs=sO,this.uvMatrix=null,this.orig=r||t,this._rotate=Number(n||0),!0===n)this._rotate=2;else if(this._rotate%2!=0)throw Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=s?new nL(s.x,s.y):new nL(0,0),this.defaultBorders=o,this._updateID=0,this.textureCacheIds=[],e.valid?this.noFrame?e.valid&&this.onBaseTextureUpdated(e):this.frame=t:e.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&e.on("update",this.onBaseTextureUpdated,this)}update(){this.baseTexture.resource&&this.baseTexture.resource.update()}onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)}destroy(e){if(this.baseTexture){if(e){let{resource:e}=this.baseTexture;e?.url&&i2[e.url]&&sN.removeFromCache(e.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,sN.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0,this.emit("destroyed",this),this.removeAllListeners()}clone(){let e=this._frame.clone(),t=this._frame===this.orig?e:this.orig.clone(),r=new sN(this.baseTexture,!this.noFrame&&e,t,this.trim?.clone(),this.rotate,this.defaultAnchor,this.defaultBorders);return this.noFrame&&(r._frame=e),r}updateUvs(){this._uvs===sO&&(this._uvs=new sP),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++}static from(e,t={},r=tJ.STRICT_TEXTURE_CACHE){let i="string"==typeof e,n=null;if(i)n=e;else if(e instanceof nT){if(!e.cacheId){let r=t?.pixiIdPrefix||"pixiid";e.cacheId=`${r}-${iQ()}`,nT.addToCache(e,e.cacheId)}n=e.cacheId}else{if(!e._pixiId){let r=t?.pixiIdPrefix||"pixiid";e._pixiId=`${r}_${iQ()}`}n=e._pixiId}let s=i2[n];if(i&&r&&!s)throw Error(`The cacheId "${n}" does not exist in TextureCache.`);return s||e instanceof nT?!s&&e instanceof nT&&(s=new sN(e),sN.addToCache(s,n)):(t.resolution||(t.resolution=ni(e)),(s=new sN(new nT(e,t))).baseTexture.cacheId=n,nT.addToCache(s.baseTexture,n),sN.addToCache(s,n)),s}static fromURL(e,t){let r=Object.assign({autoLoad:!1},t?.resourceOptions),i=sN.from(e,Object.assign({resourceOptions:r},t),!1),n=i.baseTexture.resource;return i.baseTexture.valid?Promise.resolve(i):n.load().then(()=>Promise.resolve(i))}static fromBuffer(e,t,r,i){return new sN(nT.fromBuffer(e,t,r,i))}static fromLoader(e,t,r,i){let n=new nT(e,Object.assign({scaleMode:nT.defaultOptions.scaleMode,resolution:ni(t)},i)),{resource:s}=n;s instanceof sM&&(s.url=t);let o=new sN(n);return r||(r=t),nT.addToCache(o.baseTexture,r),sN.addToCache(o,r),r!==t&&(nT.addToCache(o.baseTexture,t),sN.addToCache(o,t)),o.baseTexture.valid?Promise.resolve(o):new Promise(e=>{o.baseTexture.once("loaded",()=>e(o))})}static addToCache(e,t){t&&(e.textureCacheIds.includes(t)||e.textureCacheIds.push(t),i2[t]&&i2[t]!==e&&console.warn(`Texture added to the cache with an id [${t}] that already had an entry`),i2[t]=e)}static removeFromCache(e){if("string"==typeof e){let t=i2[e];if(t){let r=t.textureCacheIds.indexOf(e);return r>-1&&t.textureCacheIds.splice(r,1),delete i2[e],t}}else if(e?.textureCacheIds){for(let t=0;t<e.textureCacheIds.length;++t)i2[e.textureCacheIds[t]]===e&&delete i2[e.textureCacheIds[t]];return e.textureCacheIds.length=0,e}return null}get resolution(){return this.baseTexture.resolution}get frame(){return this._frame}set frame(e){this._frame=e,this.noFrame=!1;let{x:t,y:r,width:i,height:n}=e,s=t+i>this.baseTexture.width,o=r+n>this.baseTexture.height;if(s||o){let e=`X: ${t} + ${i} = ${t+i} > ${this.baseTexture.width}`,a=`Y: ${r} + ${n} = ${r+n} > ${this.baseTexture.height}`;throw Error(`Texture Error: frame does not fit inside the base Texture dimensions: ${e} ${s&&o?"and":"or"} ${a}`)}this.valid=i&&n&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=e),this.valid&&this.updateUvs()}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.valid&&this.updateUvs()}get width(){return this.orig.width}get height(){return this.orig.height}castToBaseTexture(){return this.baseTexture}static get EMPTY(){return sN._EMPTY||(sN._EMPTY=new sN(new nT),sD(sN._EMPTY),sD(sN._EMPTY.baseTexture)),sN._EMPTY}static get WHITE(){if(!sN._WHITE){let e=tJ.ADAPTER.createCanvas(16,16),t=e.getContext("2d");e.width=16,e.height=16,t.fillStyle="white",t.fillRect(0,0,16,16),sN._WHITE=new sN(nT.from(e)),sD(sN._WHITE),sD(sN._WHITE.baseTexture)}return sN._WHITE}}class sF extends sN{constructor(e,t){super(e,t),this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}get framebuffer(){return this.baseTexture.framebuffer}get multisample(){return this.framebuffer.multisample}set multisample(e){this.framebuffer.multisample=e}resize(e,t,r=!0){let i=this.baseTexture.resolution,n=Math.round(e*i)/i,s=Math.round(t*i)/i;this.valid=n>0&&s>0,this._frame.width=this.orig.width=n,this._frame.height=this.orig.height=s,r&&this.baseTexture.resize(n,s),this.updateUvs()}setResolution(e){let{baseTexture:t}=this;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))}static create(e){return new sF(new sI(e))}}class sB{constructor(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}createTexture(e,t,r=r8.NONE){return new sF(new sI(Object.assign({width:e,height:t,resolution:1,multisample:r},this.textureOptions)))}getOptimalTexture(e,t,r=1,i=r8.NONE){let n;e=Math.max(Math.ceil(e*r-1e-6),1),t=Math.max(Math.ceil(t*r-1e-6),1),this.enableFullScreen&&e===this._pixelsWidth&&t===this._pixelsHeight?n=i>1?-i:-1:(e=iW(e),t=iW(t),n=((65535&e)<<16|65535&t)>>>0,i>1&&(n+=4294967296*i)),this.texturePool[n]||(this.texturePool[n]=[]);let s=this.texturePool[n].pop();return s||(s=this.createTexture(e,t,i)),s.filterPoolKey=n,s.setResolution(r),s}getFilterTexture(e,t,r){let i=this.getOptimalTexture(e.width,e.height,t||e.resolution,r||r8.NONE);return i.filterFrame=e.filterFrame,i}returnTexture(e){let t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)}returnFilterTexture(e){this.returnTexture(e)}clear(e){if(e=!1!==e)for(let e in this.texturePool){let t=this.texturePool[e];if(t)for(let e=0;e<t.length;e++)t[e].destroy(!0)}this.texturePool={}}setScreenSize(e){if(!(e.width===this._pixelsWidth&&e.height===this._pixelsHeight)){for(let t in this.enableFullScreen=e.width>0&&e.height>0,this.texturePool){if(!(0>Number(t)))continue;let e=this.texturePool[t];if(e)for(let t=0;t<e.length;t++)e[t].destroy(!0);this.texturePool[t]=[]}this._pixelsWidth=e.width,this._pixelsHeight=e.height}}}sB.SCREEN_KEY=-1;class sL extends nP{constructor(){super(),this.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2])}}class sk extends nP{constructor(){super(),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new nw(this.vertices),this.uvBuffer=new nw(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}map(e,t){let r=0,i=0;return this.uvs[0]=r,this.uvs[1]=i,this.uvs[2]=r+t.width/e.width,this.uvs[3]=i,this.uvs[4]=r+t.width/e.width,this.uvs[5]=i+t.height/e.height,this.uvs[6]=r,this.uvs[7]=i+t.height/e.height,r=t.x,i=t.y,this.vertices[0]=r,this.vertices[1]=i,this.vertices[2]=r+t.width,this.vertices[3]=i,this.vertices[4]=r+t.width,this.vertices[5]=i+t.height,this.vertices[6]=r,this.vertices[7]=i+t.height,this.invalidate(),this}invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this}}class sU{constructor(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=r8.NONE,this.sourceFrame=new nU,this.destinationFrame=new nU,this.bindingSourceFrame=new nU,this.bindingDestinationFrame=new nU,this.filters=[],this.transform=null}clear(){this.target=null,this.filters=null,this.renderTexture=null}}const sG=[new nL,new nL,new nL,new nL],sz=new nV;class sj{constructor(e){this.renderer=e,this.defaultFilterStack=[{}],this.texturePool=new sB,this.statePool=[],this.quad=new sL,this.quadUv=new sk,this.tempRect=new nU,this.activeState={},this.globalUniforms=new sc({outputFrame:new nU,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}init(){this.texturePool.setScreenSize(this.renderer.view)}push(e,t){let r,i;let n=this.renderer,s=this.defaultFilterStack,o=this.statePool.pop()||new sU,a=n.renderTexture;if(a.current){let e=a.current;r=e.resolution,i=e.multisample}else r=n.resolution,i=n.multisample;let l=t[0].resolution||r,h=t[0].multisample??i,u=t[0].padding,c=t[0].autoFit,d=t[0].legacy??!0;for(let e=1;e<t.length;e++){let n=t[e];l=Math.min(l,n.resolution||r),h=Math.min(h,n.multisample??i),u=this.useMaxPadding?Math.max(u,n.padding):u+n.padding,c=c&&n.autoFit,d=d||(n.legacy??!0)}1===s.length&&(this.defaultFilterStack[0].renderTexture=a.current),s.push(o),o.resolution=l,o.multisample=h,o.legacy=d,o.target=e,o.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),o.sourceFrame.pad(u);let f=this.tempRect.copyFrom(a.sourceFrame);n.projection.transform&&this.transformAABB(sz.copyFrom(n.projection.transform).invert(),f),c?(o.sourceFrame.fit(f),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(f)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,a.current?a.current.resolution:n.resolution,a.sourceFrame,a.destinationFrame,n.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,l,h),o.filters=t,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;let p=this.tempRect;p.x=0,p.y=0,p.width=o.sourceFrame.width,p.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(a.sourceFrame),o.bindingDestinationFrame.copyFrom(a.destinationFrame),o.transform=n.projection.transform,n.projection.transform=null,a.bind(o.renderTexture,o.sourceFrame,p),n.framebuffer.clear(0,0,0,0)}pop(){let e=this.defaultFilterStack,t=e.pop(),r=t.filters;this.activeState=t;let i=this.globalUniforms.uniforms;i.outputFrame=t.sourceFrame,i.resolution=t.resolution;let n=i.inputSize,s=i.inputPixel,o=i.inputClamp;if(n[0]=t.destinationFrame.width,n[1]=t.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],s[0]=Math.round(n[0]*t.resolution),s[1]=Math.round(n[1]*t.resolution),s[2]=1/s[0],s[3]=1/s[1],o[0]=.5*s[2],o[1]=.5*s[3],o[2]=t.sourceFrame.width*n[2]-.5*s[2],o[3]=t.sourceFrame.height*n[3]-.5*s[3],t.legacy){let e=i.filterArea;e[0]=t.destinationFrame.width,e[1]=t.destinationFrame.height,e[2]=t.sourceFrame.x,e[3]=t.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();let a=e[e.length-1];if(this.renderer.framebuffer.blit(),1===r.length)r[0].apply(this,t.renderTexture,a.renderTexture,r1.BLEND,t),this.returnFilterTexture(t.renderTexture);else{let e=t.renderTexture,i=this.getOptimalFilterTexture(e.width,e.height,t.resolution);i.filterFrame=e.filterFrame;let n=0;for(n=0;n<r.length-1;++n){1===n&&t.multisample>1&&((i=this.getOptimalFilterTexture(e.width,e.height,t.resolution)).filterFrame=e.filterFrame),r[n].apply(this,e,i,r1.CLEAR,t);let s=e;e=i,i=s}r[n].apply(this,e,a.renderTexture,r1.BLEND,t),n>1&&t.multisample>1&&this.returnFilterTexture(t.renderTexture),this.returnFilterTexture(e),this.returnFilterTexture(i)}t.clear(),this.statePool.push(t)}bindAndClear(e,t=r1.CLEAR){let{renderTexture:r,state:i}=this.renderer;if(e===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,e?.filterFrame){let t=this.tempRect;t.x=0,t.y=0,t.width=e.filterFrame.width,t.height=e.filterFrame.height,r.bind(e,e.filterFrame,t)}else e!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?r.bind(e):this.renderer.renderTexture.bind(e,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);let n=1&i.stateId||this.forceClear;(t===r1.CLEAR||t===r1.BLIT&&n)&&this.renderer.framebuffer.clear(0,0,0,0)}applyFilter(e,t,r,i){let n=this.renderer;n.state.set(e.state),this.bindAndClear(r,i),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(e),e.legacy=!!e.program.attributeData.aTextureCoord,e.legacy?(this.quadUv.map(t._frame,t.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(rW.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(rW.TRIANGLE_STRIP))}calculateSpriteMatrix(e,t){let{sourceFrame:r,destinationFrame:i}=this.activeState,{orig:n}=t._texture,s=e.set(i.width,0,0,i.height,r.x,r.y),o=t.worldTransform.copyTo(nV.TEMP_MATRIX);return o.invert(),s.prepend(o),s.scale(1/n.width,1/n.height),s.translate(t.anchor.x,t.anchor.y),s}destroy(){this.renderer=null,this.texturePool.clear(!1)}getOptimalFilterTexture(e,t,r=1,i=r8.NONE){return this.texturePool.getOptimalTexture(e,t,r,i)}getFilterTexture(e,t,r){if("number"==typeof e){let r=e;e=t,t=r}e=e||this.activeState.renderTexture;let i=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution,r||r8.NONE);return i.filterFrame=e.filterFrame,i}returnFilterTexture(e){this.texturePool.returnTexture(e)}emptyPool(){this.texturePool.clear(!0)}resize(){this.texturePool.setScreenSize(this.renderer.view)}transformAABB(e,t){let r=sG[0],i=sG[1],n=sG[2],s=sG[3];r.set(t.left,t.top),i.set(t.left,t.bottom),n.set(t.right,t.top),s.set(t.right,t.bottom),e.apply(r,r),e.apply(i,i),e.apply(n,n),e.apply(s,s);let o=Math.min(r.x,i.x,n.x,s.x),a=Math.min(r.y,i.y,n.y,s.y),l=Math.max(r.x,i.x,n.x,s.x),h=Math.max(r.y,i.y,n.y,s.y);t.x=o,t.y=a,t.width=l-o,t.height=h-a}roundFrame(e,t,r,i,n){if(!(e.width<=0||e.height<=0||r.width<=0||r.height<=0)){if(n){let{a:e,b:t,c:r,d:i}=n;if((Math.abs(t)>1e-4||Math.abs(r)>1e-4)&&(Math.abs(e)>1e-4||Math.abs(i)>1e-4))return}(n=n?sz.copyFrom(n):sz.identity()).translate(-r.x,-r.y).scale(i.width/r.width,i.height/r.height).translate(i.x,i.y),this.transformAABB(n,e),e.ceil(t),this.transformAABB(n.invert(),e)}}}sj.extension={type:na.RendererSystem,name:"filter"},nu.add(sj);class sH{constructor(e){this.framebuffer=e,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=r8.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}}const sV=new nU;class sX{constructor(e){this.renderer=e,this.managedFramebuffers=[],this.unknownFramebuffer=new sS(10,10),this.msaaSamples=null}contextChange(){this.disposeAll(!0);let e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new nU,this.hasMRT=!0,this.writeDepthTexture=!0,1===this.renderer.context.webGLVersion){let t=this.renderer.context.extensions.drawBuffers,r=this.renderer.context.extensions.depthTexture;tJ.PREFER_ENV===rj.WEBGL_LEGACY&&(t=null,r=null),t?e.drawBuffers=e=>t.drawBuffersWEBGL(e):(this.hasMRT=!1,e.drawBuffers=()=>{}),r||(this.writeDepthTexture=!1)}else this.msaaSamples=e.getInternalformatParameter(e.RENDERBUFFER,e.RGBA8,e.SAMPLES)}bind(e,t,r=0){let{gl:i}=this;if(e){let n=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,i.bindFramebuffer(i.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==r&&(e.dirtyId++,e.dirtyFormat++,n.mipLevel=r),n.dirtyId!==e.dirtyId&&(n.dirtyId=e.dirtyId,n.dirtyFormat!==e.dirtyFormat?(n.dirtyFormat=e.dirtyFormat,n.dirtySize=e.dirtySize,this.updateFramebuffer(e,r)):n.dirtySize!==e.dirtySize&&(n.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(let t=0;t<e.colorTextures.length;t++){let r=e.colorTextures[t];this.renderer.texture.unbind(r.parentTextureArray||r)}if(e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t){let e=t.width>>r,i=t.height>>r,n=e/t.width;this.setViewport(t.x*n,t.y*n,e,i)}else{let t=e.width>>r,i=e.height>>r;this.setViewport(0,0,t,i)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)}setViewport(e,t,r,i){let n=this.viewport;e=Math.round(e),t=Math.round(t),r=Math.round(r),i=Math.round(i),(n.width!==r||n.height!==i||n.x!==e||n.y!==t)&&(n.x=e,n.y=t,n.width=r,n.height=i,this.gl.viewport(e,t,r,i))}get size(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}}clear(e,t,r,i,n=rV.COLOR|rV.DEPTH){let{gl:s}=this;s.clearColor(e,t,r,i),s.clear(n)}initFramebuffer(e){let{gl:t}=this,r=new sH(t.createFramebuffer());return r.multisample=this.detectSamples(e.multisample),e.glFramebuffers[this.CONTEXT_UID]=r,this.managedFramebuffers.push(e),e.disposeRunner.add(this),r}resizeFramebuffer(e){let{gl:t}=this,r=e.glFramebuffers[this.CONTEXT_UID];if(r.stencil){let i;t.bindRenderbuffer(t.RENDERBUFFER,r.stencil),i=1===this.renderer.context.webGLVersion?t.DEPTH_STENCIL:e.depth&&e.stencil?t.DEPTH24_STENCIL8:e.depth?t.DEPTH_COMPONENT24:t.STENCIL_INDEX8,r.msaaBuffer?t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,i,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,i,e.width,e.height)}let i=e.colorTextures,n=i.length;t.drawBuffers||(n=Math.min(n,1));for(let s=0;s<n;s++){let n=i[s],o=n.parentTextureArray||n;this.renderer.texture.bind(o,0),0===s&&r.msaaBuffer&&(t.bindRenderbuffer(t.RENDERBUFFER,r.msaaBuffer),t.renderbufferStorageMultisample(t.RENDERBUFFER,r.multisample,o._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height))}e.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(e.depthTexture,0)}updateFramebuffer(e,t){let{gl:r}=this,i=e.glFramebuffers[this.CONTEXT_UID],n=e.colorTextures,s=n.length;r.drawBuffers||(s=Math.min(s,1)),i.multisample>1&&this.canMultisampleFramebuffer(e)?i.msaaBuffer=i.msaaBuffer||r.createRenderbuffer():i.msaaBuffer&&(r.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));let o=[];for(let a=0;a<s;a++){let s=n[a],l=s.parentTextureArray||s;this.renderer.texture.bind(l,0),0===a&&i.msaaBuffer?(r.bindRenderbuffer(r.RENDERBUFFER,i.msaaBuffer),r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,l._glTextures[this.CONTEXT_UID].internalFormat,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,i.msaaBuffer)):(r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+a,s.target,l._glTextures[this.CONTEXT_UID].texture,t),o.push(r.COLOR_ATTACHMENT0+a))}if(o.length>1&&r.drawBuffers(o),e.depthTexture&&this.writeDepthTexture){let i=e.depthTexture;this.renderer.texture.bind(i,0),r.framebufferTexture2D(r.FRAMEBUFFER,r.DEPTH_ATTACHMENT,r.TEXTURE_2D,i._glTextures[this.CONTEXT_UID].texture,t)}if((e.stencil||e.depth)&&!(e.depthTexture&&this.writeDepthTexture)){let t,n;i.stencil=i.stencil||r.createRenderbuffer(),1===this.renderer.context.webGLVersion?(t=r.DEPTH_STENCIL_ATTACHMENT,n=r.DEPTH_STENCIL):e.depth&&e.stencil?(t=r.DEPTH_STENCIL_ATTACHMENT,n=r.DEPTH24_STENCIL8):e.depth?(t=r.DEPTH_ATTACHMENT,n=r.DEPTH_COMPONENT24):(t=r.STENCIL_ATTACHMENT,n=r.STENCIL_INDEX8),r.bindRenderbuffer(r.RENDERBUFFER,i.stencil),i.msaaBuffer?r.renderbufferStorageMultisample(r.RENDERBUFFER,i.multisample,n,e.width,e.height):r.renderbufferStorage(r.RENDERBUFFER,n,e.width,e.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,t,r.RENDERBUFFER,i.stencil)}else i.stencil&&(r.deleteRenderbuffer(i.stencil),i.stencil=null)}canMultisampleFramebuffer(e){return 1!==this.renderer.context.webGLVersion&&e.colorTextures.length<=1&&!e.depthTexture}detectSamples(e){let{msaaSamples:t}=this,r=r8.NONE;if(e<=1||null===t)return r;for(let i=0;i<t.length;i++)if(t[i]<=e){r=t[i];break}return 1===r&&(r=r8.NONE),r}blit(e,t,r){let{current:i,renderer:n,gl:s,CONTEXT_UID:o}=this;if(2!==n.context.webGLVersion||!i)return;let a=i.glFramebuffers[o];if(!a)return;if(!e){if(!a.msaaBuffer)return;let t=i.colorTextures[0];if(!t)return;a.blitFramebuffer||(a.blitFramebuffer=new sS(i.width,i.height),a.blitFramebuffer.addColorTexture(0,t)),(e=a.blitFramebuffer).colorTextures[0]!==t&&(e.colorTextures[0]=t,e.dirtyId++,e.dirtyFormat++),(e.width!==i.width||e.height!==i.height)&&(e.width=i.width,e.height=i.height,e.dirtyId++,e.dirtySize++)}t||((t=sV).width=i.width,t.height=i.height),r||(r=t);let l=t.width===r.width&&t.height===r.height;this.bind(e),s.bindFramebuffer(s.READ_FRAMEBUFFER,a.framebuffer),s.blitFramebuffer(t.left,t.top,t.right,t.bottom,r.left,r.top,r.right,r.bottom,s.COLOR_BUFFER_BIT,l?s.NEAREST:s.LINEAR),s.bindFramebuffer(s.READ_FRAMEBUFFER,e.glFramebuffers[this.CONTEXT_UID].framebuffer)}disposeFramebuffer(e,t){let r=e.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(!r)return;delete e.glFramebuffers[this.CONTEXT_UID];let n=this.managedFramebuffers.indexOf(e);n>=0&&this.managedFramebuffers.splice(n,1),e.disposeRunner.remove(this),t||(i.deleteFramebuffer(r.framebuffer),r.msaaBuffer&&i.deleteRenderbuffer(r.msaaBuffer),r.stencil&&i.deleteRenderbuffer(r.stencil)),r.blitFramebuffer&&this.disposeFramebuffer(r.blitFramebuffer,t)}disposeAll(e){let t=this.managedFramebuffers;this.managedFramebuffers=[];for(let r=0;r<t.length;r++)this.disposeFramebuffer(t[r],e)}forceStencil(){let e,t;let r=this.current;if(!r)return;let i=r.glFramebuffers[this.CONTEXT_UID];if(!i||i.stencil&&r.stencil)return;r.stencil=!0;let n=r.width,s=r.height,o=this.gl,a=i.stencil=o.createRenderbuffer();o.bindRenderbuffer(o.RENDERBUFFER,a),1===this.renderer.context.webGLVersion?(e=o.DEPTH_STENCIL_ATTACHMENT,t=o.DEPTH_STENCIL):r.depth?(e=o.DEPTH_STENCIL_ATTACHMENT,t=o.DEPTH24_STENCIL8):(e=o.STENCIL_ATTACHMENT,t=o.STENCIL_INDEX8),i.msaaBuffer?o.renderbufferStorageMultisample(o.RENDERBUFFER,i.multisample,t,n,s):o.renderbufferStorage(o.RENDERBUFFER,t,n,s),o.framebufferRenderbuffer(o.FRAMEBUFFER,e,o.RENDERBUFFER,a)}reset(){this.current=this.unknownFramebuffer,this.viewport=new nU}destroy(){this.renderer=null}}sX.extension={type:na.RendererSystem,name:"framebuffer"},nu.add(sX);const sW={5126:4,5123:2,5121:1};class s${constructor(e){this.renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}contextChange(){this.disposeAll(!0);let e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,2!==t.webGLVersion){let t=this.renderer.context.extensions.vertexArrayObject;tJ.PREFER_ENV===rj.WEBGL_LEGACY&&(t=null),t?(e.createVertexArray=()=>t.createVertexArrayOES(),e.bindVertexArray=e=>t.bindVertexArrayOES(e),e.deleteVertexArray=e=>t.deleteVertexArrayOES(e)):(this.hasVao=!1,e.createVertexArray=()=>null,e.bindVertexArray=()=>null,e.deleteVertexArray=()=>null)}if(2!==t.webGLVersion){let t=e.getExtension("ANGLE_instanced_arrays");t?(e.vertexAttribDivisor=(e,r)=>t.vertexAttribDivisorANGLE(e,r),e.drawElementsInstanced=(e,r,i,n,s)=>t.drawElementsInstancedANGLE(e,r,i,n,s),e.drawArraysInstanced=(e,r,i,n)=>t.drawArraysInstancedANGLE(e,r,i,n)):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex}bind(e,t){t=t||this.renderer.shader.shader;let{gl:r}=this,i=e.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);let s=i[t.program.id]||this.initGeometryVao(e,t,n);this._activeGeometry=e,this._activeVao!==s&&(this._activeVao=s,this.hasVao?r.bindVertexArray(s):this.activateVao(e,t.program)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){let e=this._activeGeometry,t=this.renderer.buffer;for(let r=0;r<e.buffers.length;r++){let i=e.buffers[r];t.update(i)}}checkCompatibility(e,t){let r=e.attributes,i=t.attributeData;for(let e in i)if(!r[e])throw Error(`shader and geometry incompatible, geometry missing the "${e}" attribute`)}getSignature(e,t){let r=e.attributes,i=t.attributeData,n=["g",e.id];for(let e in r)i[e]&&n.push(e,i[e].location);return n.join("-")}initGeometryVao(e,t,r=!0){let i=this.gl,n=this.CONTEXT_UID,s=this.renderer.buffer,o=t.program;o.glPrograms[n]||this.renderer.shader.generateProgram(t),this.checkCompatibility(e,o);let a=this.getSignature(e,o),l=e.glVertexArrayObjects[this.CONTEXT_UID],h=l[a];if(h)return l[o.id]=h,h;let u=e.buffers,c=e.attributes,d={},f={};for(let e in u)d[e]=0,f[e]=0;for(let e in c)!c[e].size&&o.attributeData[e]?c[e].size=o.attributeData[e].size:c[e].size||console.warn(`PIXI Geometry attribute '${e}' size cannot be determined (likely the bound shader does not have the attribute)`),d[c[e].buffer]+=c[e].size*sW[c[e].type];for(let e in c){let t=c[e],r=t.size;void 0===t.stride&&(d[t.buffer]===r*sW[t.type]?t.stride=0:t.stride=d[t.buffer]),void 0===t.start&&(t.start=f[t.buffer],f[t.buffer]+=r*sW[t.type])}h=i.createVertexArray(),i.bindVertexArray(h);for(let e=0;e<u.length;e++){let t=u[e];s.bind(t),r&&t._glBuffers[n].refCount++}return this.activateVao(e,o),l[o.id]=h,l[a]=h,i.bindVertexArray(null),s.unbind(r6.ARRAY_BUFFER),h}disposeGeometry(e,t){if(!this.managedGeometries[e.id])return;delete this.managedGeometries[e.id];let r=e.glVertexArrayObjects[this.CONTEXT_UID],i=this.gl,n=e.buffers,s=this.renderer?.buffer;if(e.disposeRunner.remove(this),r){if(s)for(let e=0;e<n.length;e++){let r=n[e]._glBuffers[this.CONTEXT_UID];r&&(r.refCount--,0!==r.refCount||t||s.dispose(n[e],t))}if(!t){for(let e in r)if("g"===e[0]){let t=r[e];this._activeVao===t&&this.unbind(),i.deleteVertexArray(t)}}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}disposeAll(e){let t=Object.keys(this.managedGeometries);for(let r=0;r<t.length;r++)this.disposeGeometry(this.managedGeometries[t[r]],e)}activateVao(e,t){let r=this.gl,i=this.CONTEXT_UID,n=this.renderer.buffer,s=e.buffers,o=e.attributes;e.indexBuffer&&n.bind(e.indexBuffer);let a=null;for(let e in o){let l=o[e],h=s[l.buffer],u=h._glBuffers[i];if(t.attributeData[e]){a!==u&&(n.bind(h),a=u);let i=t.attributeData[e].location;if(r.enableVertexAttribArray(i),r.vertexAttribPointer(i,l.size,l.type||r.FLOAT,l.normalized,l.stride,l.start),l.instance){if(this.hasInstance)r.vertexAttribDivisor(i,l.divisor);else throw Error("geometry error, GPU Instancing is not supported on this device")}}}}draw(e,t,r,i){let{gl:n}=this,s=this._activeGeometry;if(s.indexBuffer){let o=s.indexBuffer.data.BYTES_PER_ELEMENT,a=2===o?n.UNSIGNED_SHORT:n.UNSIGNED_INT;2===o||4===o&&this.canUseUInt32ElementIndex?s.instanced?n.drawElementsInstanced(e,t||s.indexBuffer.data.length,a,(r||0)*o,i||1):n.drawElements(e,t||s.indexBuffer.data.length,a,(r||0)*o):console.warn("unsupported index buffer type: uint32")}else s.instanced?n.drawArraysInstanced(e,r,t||s.getSize(),i||1):n.drawArrays(e,r,t||s.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this.renderer=null}}s$.extension={type:na.RendererSystem,name:"geometry"},nu.add(s$);const sY=new nV;class sq{constructor(e,t){this._texture=e,this.mapCoord=new nV,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof t>"u"?.5:t,this.isSimple=!1}get texture(){return this._texture}set texture(e){this._texture=e,this._textureID=-1}multiplyUvs(e,t){void 0===t&&(t=e);let r=this.mapCoord;for(let i=0;i<e.length;i+=2){let n=e[i],s=e[i+1];t[i]=n*r.a+s*r.c+r.tx,t[i+1]=n*r.b+s*r.d+r.ty}return t}update(e){let t=this._texture;if(!t||!t.valid||!e&&this._textureID===t._updateID)return!1;this._textureID=t._updateID,this._updateID++;let r=t._uvs;this.mapCoord.set(r.x1-r.x0,r.y1-r.y0,r.x3-r.x0,r.y3-r.y0,r.x0,r.y0);let i=t.orig,n=t.trim;n&&(sY.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(sY));let s=t.baseTexture,o=this.uClampFrame,a=this.clampMargin/s.resolution,l=this.clampOffset;return o[0]=(t._frame.x+a+l)/s.width,o[1]=(t._frame.y+a+l)/s.height,o[2]=(t._frame.x+t._frame.width-a+l)/s.width,o[3]=(t._frame.y+t._frame.height-a+l)/s.height,this.uClampOffset[0]=l/s.realWidth,this.uClampOffset[1]=l/s.realHeight,this.isSimple=t._frame.width===s.width&&t._frame.height===s.height&&0===t.rotate,!0}}var sZ=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,sK=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`;class sQ extends sT{constructor(e,t,r){let i=null;"string"!=typeof e&&void 0===t&&void 0===r&&(i=e,e=void 0,t=void 0,r=void 0),super(e||sK,t||sZ,r),this.maskSprite=i,this.maskMatrix=new nV}get maskSprite(){return this._maskSprite}set maskSprite(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)}apply(e,t,r,i){let n=this._maskSprite,s=n._texture;s.valid&&(s.uvMatrix||(s.uvMatrix=new sq(s,0)),s.uvMatrix.update(),this.uniforms.npmAlpha=s.baseTexture.alphaMode?0:1,this.uniforms.mask=s,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,n).prepend(s.uvMatrix.mapCoord),this.uniforms.alpha=n.worldAlpha,this.uniforms.maskClamp=s.uvMatrix.uClampFrame,e.applyFilter(this,t,r,i))}}class sJ{constructor(e=null){this.type=r4.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=sT.defaultMultisample,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}get filter(){return this._filters?this._filters[0]:null}set filter(e){e?this._filters?this._filters[0]=e:this._filters=[e]:this._filters=null}reset(){this.pooled&&(this.maskObject=null,this.type=r4.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null}copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)}}class s0{constructor(e){this.renderer=e,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)}push(e,t){let r=t;if(!r.isMaskData){let e=this.maskDataPool.pop()||new sJ;e.pooled=!0,e.maskObject=t,r=e}let i=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null;if(r.copyCountersOrReset(i),r._colorMask=i?i._colorMask:15,r.autoDetect&&this.detect(r),r._target=e,r.type!==r4.SPRITE&&this.maskStack.push(r),r.enabled)switch(r.type){case r4.SCISSOR:this.renderer.scissor.push(r);break;case r4.STENCIL:this.renderer.stencil.push(r);break;case r4.SPRITE:r.copyCountersOrReset(null),this.pushSpriteMask(r);break;case r4.COLOR:this.pushColorMask(r)}r.type===r4.SPRITE&&this.maskStack.push(r)}pop(e){let t=this.maskStack.pop();if(!(!t||t._target!==e)){if(t.enabled)switch(t.type){case r4.SCISSOR:this.renderer.scissor.pop(t);break;case r4.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case r4.SPRITE:this.popSpriteMask(t);break;case r4.COLOR:this.popColorMask(t)}if(t.reset(),t.pooled&&this.maskDataPool.push(t),0!==this.maskStack.length){let e=this.maskStack[this.maskStack.length-1];e.type===r4.SPRITE&&e._filters&&(e._filters[0].maskSprite=e.maskObject)}}}detect(e){let t=e.maskObject;t?t.isSprite?e.type=r4.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(e)?e.type=r4.SCISSOR:e.type=r4.STENCIL:e.type=r4.COLOR}pushSpriteMask(e){let{maskObject:t}=e,r=e._target,i=e._filters;i||(i=this.alphaMaskPool[this.alphaMaskIndex])||(i=this.alphaMaskPool[this.alphaMaskIndex]=[new sQ]),i[0].resolution=e.resolution,i[0].multisample=e.multisample,i[0].maskSprite=t;let n=r.filterArea;r.filterArea=t.getBounds(!0),this.renderer.filter.push(r,i),r.filterArea=n,e._filters||this.alphaMaskIndex++}popSpriteMask(e){this.renderer.filter.pop(),e._filters?e._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)}pushColorMask(e){let t=e._colorMask,r=e._colorMask=t&e.colorMask;r!==t&&this.renderer.gl.colorMask((1&r)!=0,(2&r)!=0,(4&r)!=0,(8&r)!=0)}popColorMask(e){let t=e._colorMask,r=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;r!==t&&this.renderer.gl.colorMask((1&r)!=0,(2&r)!=0,(4&r)!=0,(8&r)!=0)}destroy(){this.renderer=null}}s0.extension={type:na.RendererSystem,name:"mask"},nu.add(s0);class s1{constructor(e){this.renderer=e,this.maskStack=[],this.glConst=0}getStackLength(){return this.maskStack.length}setMaskStack(e){let{gl:t}=this.renderer,r=this.getStackLength();this.maskStack=e;let i=this.getStackLength();i!==r&&(0===i?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))}_useCurrent(){}destroy(){this.renderer=null,this.maskStack=null}}const s2=new nV,s3=[],s4=class e extends s1{constructor(e){super(e),this.glConst=tJ.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST}getStackLength(){let e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0}calcScissorRect(e){if(e._scissorRectLocal)return;let t=e._scissorRect,{maskObject:r}=e,{renderer:i}=this,n=i.renderTexture,s=r.getBounds(!0,s3.pop()??new nU);this.roundFrameToPixels(s,n.current?n.current.resolution:i.resolution,n.sourceFrame,n.destinationFrame,i.projection.transform),t&&s.fit(t),e._scissorRectLocal=s}static isMatrixRotated(e){if(!e)return!1;let{a:t,b:r,c:i,d:n}=e;return(Math.abs(r)>1e-4||Math.abs(i)>1e-4)&&(Math.abs(t)>1e-4||Math.abs(n)>1e-4)}testScissor(t){let{maskObject:r}=t;if(!r.isFastRect||!r.isFastRect()||e.isMatrixRotated(r.worldTransform)||e.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(t);let i=t._scissorRectLocal;return i.width>0&&i.height>0}roundFrameToPixels(t,r,i,n,s){e.isMatrixRotated(s)||((s=s?s2.copyFrom(s):s2.identity()).translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.renderer.filter.transformAABB(s,t),t.fit(n),t.x=Math.round(t.x*r),t.y=Math.round(t.y*r),t.width=Math.round(t.width*r),t.height=Math.round(t.height*r))}push(e){e._scissorRectLocal||this.calcScissorRect(e);let{gl:t}=this.renderer;e._scissorRect||t.enable(t.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()}pop(e){let{gl:t}=this.renderer;e&&s3.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():t.disable(t.SCISSOR_TEST)}_useCurrent(){let e;let t=this.maskStack[this.maskStack.length-1]._scissorRect;e=this.renderer.renderTexture.current?t.y:this.renderer.height-t.height-t.y,this.renderer.gl.scissor(t.x,e,t.width,t.height)}};s4.extension={type:na.RendererSystem,name:"scissor"},nu.add(s4);class s5 extends s1{constructor(e){super(e),this.glConst=tJ.ADAPTER.getWebGLRenderingContext().STENCIL_TEST}getStackLength(){let e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0}push(e){let t=e.maskObject,{gl:r}=this.renderer,i=e._stencilCounter;0===i&&(this.renderer.framebuffer.forceStencil(),r.clearStencil(0),r.clear(r.STENCIL_BUFFER_BIT),r.enable(r.STENCIL_TEST)),e._stencilCounter++;let n=e._colorMask;0!==n&&(e._colorMask=0,r.colorMask(!1,!1,!1,!1)),r.stencilFunc(r.EQUAL,i,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,0!==n&&(e._colorMask=n,r.colorMask((1&n)!=0,(2&n)!=0,(4&n)!=0,(8&n)!=0)),this._useCurrent()}pop(e){let t=this.renderer.gl;if(0===this.getStackLength())t.disable(t.STENCIL_TEST);else{let r=0!==this.maskStack.length?this.maskStack[this.maskStack.length-1]:null,i=r?r._colorMask:15;0!==i&&(r._colorMask=0,t.colorMask(!1,!1,!1,!1)),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,0!==i&&(r._colorMask=i,t.colorMask((1&i)!=0,(2&i)!=0,(4&i)!=0,(8&i)!=0)),this._useCurrent()}}_useCurrent(){let e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)}}s5.extension={type:na.RendererSystem,name:"stencil"},nu.add(s5);class s8{constructor(e){this.renderer=e,this.plugins={},Object.defineProperties(this.plugins,{extract:{enumerable:!1,get:()=>(rL("7.0.0","renderer.plugins.extract has moved to renderer.extract"),e.extract)},prepare:{enumerable:!1,get:()=>(rL("7.0.0","renderer.plugins.prepare has moved to renderer.prepare"),e.prepare)},interaction:{enumerable:!1,get:()=>(rL("7.0.0","renderer.plugins.interaction has been deprecated, use renderer.events"),e.events)}})}init(){let e=this.rendererPlugins;for(let t in e)this.plugins[t]=new e[t](this.renderer)}destroy(){for(let e in this.plugins)this.plugins[e].destroy(),this.plugins[e]=null}}s8.extension={type:[na.RendererSystem,na.CanvasRendererSystem],name:"_plugin"},nu.add(s8);class s6{constructor(e){this.renderer=e,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new nV,this.transform=null}update(e,t,r,i){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,r,i),this.transform&&this.projectionMatrix.append(this.transform);let n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)}calculateProjection(e,t,r,i){let n=this.projectionMatrix,s=i?-1:1;n.identity(),n.a=1/t.width*2,n.d=1/t.height*2*s,n.tx=-1-t.x*n.a,n.ty=-s-t.y*n.d}setTransform(e){}destroy(){this.renderer=null}}s6.extension={type:na.RendererSystem,name:"projection"},nu.add(s6);const s7=new n0,s9=new nU;class oe{constructor(e){this.renderer=e,this._tempMatrix=new nV}generateTexture(e,t){let{region:r,...i}=t||{},n=r?.copyTo(s9)||e.getLocalBounds(s9,!0),s=i.resolution||this.renderer.resolution;n.width=Math.max(n.width,1/s),n.height=Math.max(n.height,1/s),i.width=n.width,i.height=n.height,i.resolution=s,i.multisample??(i.multisample=this.renderer.multisample);let o=sF.create(i);this._tempMatrix.tx=-n.x,this._tempMatrix.ty=-n.y;let a=e.transform;return e.transform=s7,this.renderer.render(e,{renderTexture:o,transform:this._tempMatrix,skipUpdateTransform:!!e.parent,blit:!0}),e.transform=a,o}destroy(){}}oe.extension={type:[na.RendererSystem,na.CanvasRendererSystem],name:"textureGenerator"},nu.add(oe);const ot=new nU,or=new nU;class oi{constructor(e){this.renderer=e,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new nU,this.destinationFrame=new nU,this.viewportFrame=new nU}contextChange(){let e=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}bind(e=null,t,r){let i,n,s;let o=this.renderer;this.current=e,e?(s=(i=e.baseTexture).resolution,t||(ot.width=e.frame.width,ot.height=e.frame.height,t=ot),r||(or.x=e.frame.x,or.y=e.frame.y,or.width=t.width,or.height=t.height,r=or),n=i.framebuffer):(s=o.resolution,t||(ot.width=o._view.screen.width,ot.height=o._view.screen.height,t=ot),r||((r=ot).width=t.width,r.height=t.height));let a=this.viewportFrame;a.x=r.x*s,a.y=r.y*s,a.width=r.width*s,a.height=r.height*s,e||(a.y=o.view.height-(a.y+a.height)),a.ceil(),this.renderer.framebuffer.bind(n,a),this.renderer.projection.update(r,t,s,!n),e?this.renderer.mask.setMaskStack(i.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(t),this.destinationFrame.copyFrom(r)}clear(e,t){let r=this.current?this.current.baseTexture.clear:this.renderer.background.backgroundColor,i=iP.shared.setValue(e||r);(this.current&&this.current.baseTexture.alphaMode>0||!this.current&&this._rendererPremultipliedAlpha)&&i.premultiply(i.alpha);let n=this.destinationFrame,s=this.current?this.current.baseTexture:this.renderer._view.screen,o=n.width!==s.width||n.height!==s.height;if(o){let{x:e,y:t,width:r,height:i}=this.viewportFrame;e=Math.round(e),t=Math.round(t),r=Math.round(r),i=Math.round(i),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(e,t,r,i)}this.renderer.framebuffer.clear(i.red,i.green,i.blue,i.alpha,t),o&&this.renderer.scissor.pop()}resize(){this.bind(null)}reset(){this.bind(null)}destroy(){this.renderer=null}}oi.extension={type:na.RendererSystem,name:"renderTexture"},nu.add(oi);class on{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null}}function os(e,t,r,i,n){r.buffer.update(n)}const oo={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},oa={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:32,mat3:48,mat4:64};let ol=0;const oh={textureCount:0,uboCount:0};class ou{constructor(e){this.destroyed=!1,this.renderer=e,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=ol++}systemCheck(){if(!function(){if("boolean"==typeof i)return i;try{i=!0===Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")}catch{i=!1}return i}())throw Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")}contextChange(e){this.gl=e,this.reset()}bind(e,t){e.disposeRunner.add(this),e.uniforms.globals=this.renderer.globalUniforms;let r=e.program,i=r.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(e);return this.shader=e,this.program!==r&&(this.program=r,this.gl.useProgram(i.program)),t||(oh.textureCount=0,oh.uboCount=0,this.syncUniformGroup(e.uniformGroup,oh)),i}setUniforms(e){let t=this.shader.program,r=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(r.uniformData,e,this.renderer)}syncUniformGroup(e,t){let r=this.getGlProgram();e.static&&e.dirtyId===r.uniformDirtyGroups[e.id]||(r.uniformDirtyGroups[e.id]=e.dirtyId,this.syncUniforms(e,r,t))}syncUniforms(e,t,r){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,r)}createSyncGroups(e){let t=this.getSignature(e,this.shader.program.uniformData,"u");return this.cache[t]||(this.cache[t]=function(e,t){let r=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(let i in e.uniforms){let n=t[i];if(!n){e.uniforms[i]?.group===!0&&(e.uniforms[i].ubo?r.push(`
                        renderer.shader.syncUniformBufferGroup(uv.${i}, '${i}');
                    `):r.push(`
                        renderer.shader.syncUniformGroup(uv.${i}, syncData);
                    `));continue}let s=e.uniforms[i],o=!1;for(let e=0;e<n8.length;e++)if(n8[e].test(n,s)){r.push(n8[e].code(i,s)),o=!0;break}if(!o){let e=(1!==n.size||n.isArray?n7:n6)[n.type].replace("location",`ud["${i}"].location`);r.push(`
            cu = ud["${i}"];
            cv = cu.value;
            v = uv["${i}"];
            ${e};`)}}return Function("ud","uv","renderer","syncData",r.join(`
`))}(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]}syncUniformBufferGroup(e,t){let r=this.getGlProgram();if(!e.static||0!==e.dirtyId||!r.uniformGroups[e.id]){e.dirtyId=0;let i=r.uniformGroups[e.id]||this.createSyncBufferGroup(e,r,t);e.buffer.update(),i(r.uniformData,e.uniforms,this.renderer,oh,e.buffer)}this.renderer.buffer.bindBufferBase(e.buffer,r.uniformBufferBindings[t])}createSyncBufferGroup(e,t,r){let{gl:i}=this.renderer;this.renderer.buffer.bind(e.buffer);let n=this.gl.getUniformBlockIndex(t.program,r);t.uniformBufferBindings[r]=this.shader.uniformBindCount,i.uniformBlockBinding(t.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;let s=this.getSignature(e,this.shader.program.uniformData,"ubo"),o=this._uboCache[s];if(o||(o=this._uboCache[s]=function(e,t){if(!e.autoManage)return{size:0,syncFunc:os};let{uboElements:r,size:i}=function(e){let t=e.map(e=>({data:e,offset:0,dataLen:0,dirty:0})),r=0,i=0,n=0;for(let e=0;e<t.length;e++){let s=t[e];if(r=oa[s.data.type],s.data.size>1&&(r=Math.max(r,16)*s.data.size),s.dataLen=r,i%r!=0&&i<16){let e=i%r%16;i+=e,n+=e}i+r>16?(n=16*Math.ceil(n/16),s.offset=n,n+=r,i=r):(s.offset=n,i+=r,n+=r)}return{uboElements:t,size:n=16*Math.ceil(n/16)}}(function(e,t){let r=[];for(let i in e)t[i]&&r.push(t[i]);return r.sort((e,t)=>e.index-t.index),r}(e.uniforms,t)),n=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `];for(let t=0;t<r.length;t++){let i=r[t],s=e.uniforms[i.data.name],o=i.data.name,a=!1;for(let e=0;e<n8.length;e++){let t=n8[e];if(t.codeUbo&&t.test(i.data,s)){n.push(`offset = ${i.offset/4};`,n8[e].codeUbo(i.data.name,s)),a=!0;break}}if(!a){if(i.data.size>1){let e=sr[i.data.type],t=Math.max(oa[i.data.type]/16,1),r=e/t,s=(4-r%4)%4;n.push(`
                cv = ud.${o}.value;
                v = uv.${o};
                offset = ${i.offset/4};

                t = 0;

                for(var i=0; i < ${i.data.size*t}; i++)
                {
                    for(var j = 0; j < ${r}; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += ${s};
                }

                `)}else{let e=oo[i.data.type];n.push(`
                cv = ud.${o}.value;
                v = uv.${o};
                offset = ${i.offset/4};
                ${e};
                `)}}}return n.push(`
       renderer.buffer.update(buffer);
    `),{size:i,syncFunc:Function("ud","uv","renderer","syncData","buffer",n.join(`
`))}}(e,this.shader.program.uniformData)),e.autoManage){let t=new Float32Array(o.size/4);e.buffer.update(t)}return t.uniformGroups[e.id]=o.syncFunc,t.uniformGroups[e.id]}getSignature(e,t,r){let i=e.uniforms,n=[`${r}-`];for(let e in i)n.push(e),t[e]&&n.push(t[e].type);return n.join("-")}getGlProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null}generateProgram(e){let t=this.gl,r=e.program,i=function(e,t){let r=n3(e,e.VERTEX_SHADER,t.vertexSrc),i=n3(e,e.FRAGMENT_SHADER,t.fragmentSrc),n=e.createProgram();e.attachShader(n,r),e.attachShader(n,i);let s=t.extra?.transformFeedbackVaryings;if(s&&("function"!=typeof e.transformFeedbackVaryings?console.warn("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(n,s.names,"separate"===s.bufferMode?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)||e.getProgramParameter(n,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||st(e,r),e.getShaderParameter(i,e.COMPILE_STATUS)||st(e,i),console.error("PixiJS Error: Could not initialize shader."),""!==e.getProgramInfoLog(n)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(n))),t.attributeData=function(e,t){let r={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let n=0;n<i;n++){let i=t.getActiveAttrib(e,n);if(i.name.startsWith("gl_"))continue;let s=ss(t,i.type),o={type:s,name:i.name,size:sr[s],location:t.getAttribLocation(e,i.name)};r[i.name]=o}return r}(n,e),t.uniformData=function(e,t){let r={},i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let n=0;n<i;n++){let i=t.getActiveUniform(e,n),s=i.name.replace(/\[.*?\]$/,""),o=!!i.name.match(/\[.*?\]$/),a=ss(t,i.type);r[s]={name:s,index:n,type:a,size:i.size,isArray:o,value:n5(a,i.size)}}return r}(n,e),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){let r=Object.keys(t.attributeData);r.sort((e,t)=>e>t?1:-1);for(let i=0;i<r.length;i++)t.attributeData[r[i]].location=i,e.bindAttribLocation(n,i,r[i]);e.linkProgram(n)}e.deleteShader(r),e.deleteShader(i);let o={};for(let r in t.uniformData){let i=t.uniformData[r];o[r]={location:e.getUniformLocation(n,r),value:n5(i.type,i.size)}}return new on(n,o)}(t,r);return r.glPrograms[this.renderer.CONTEXT_UID]=i,i}reset(){this.program=null,this.shader=null}disposeShader(e){this.shader===e&&(this.shader=null)}destroy(){this.renderer=null,this.destroyed=!0}}ou.extension={type:na.RendererSystem,name:"shader"},nu.add(ou);class oc{constructor(e){this.renderer=e}run(e){let{renderer:t}=this;t.runners.init.emit(t.options),e.hello&&console.log(`PixiJS 7.3.3 - ${t.rendererLogId} - https://pixijs.com`),t.resize(t.screen.width,t.screen.height)}destroy(){}}oc.defaultOptions={hello:!1},oc.extension={type:[na.RendererSystem,na.CanvasRendererSystem],name:"startup"},nu.add(oc);const od=class e{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=rX.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.map[5]=this.setDepthMask,this.checks=[],this.defaultState=new np,this.defaultState.blend=!0}contextChange(e){this.gl=e,this.blendModes=function(e,t=[]){return t[rX.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.ADD]=[e.ONE,e.ONE],t[rX.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.NONE]=[0,0],t[rX.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[rX.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[rX.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[rX.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[rX.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[rX.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[rX.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[rX.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[rX.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[rX.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[rX.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}(e),this.set(this.defaultState),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,r=0;for(;t;)1&t&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(t){this.updateCheck(e.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this.updateCheck(e.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(e===this.blendMode)return;this.blendMode=e;let t=this.blendModes[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)}updateCheck(e,t){let r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):t||-1===r||this.checks.splice(r,1)}static checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null}};od.extension={type:na.RendererSystem,name:"state"},nu.add(od);class of extends t$(rh){constructor(){super(...arguments),this.runners={},this._systemsHash={}}setup(e){this.addRunners(...e.runners);let t=(e.priority??[]).filter(t=>e.systems[t]);for(let r of[...t,...Object.keys(e.systems).filter(e=>!t.includes(e))])this.addSystem(e.systems[r],r)}addRunners(...e){e.forEach(e=>{this.runners[e]=new nv(e)})}addSystem(e,t){let r=new e(this);if(this[t])throw Error(`Whoops! The name "${t}" is already in use`);for(let e in this[t]=r,this._systemsHash[t]=r,this.runners)this.runners[e].add(r);return this}emitWithCustomOptions(e,t){let r=Object.keys(this._systemsHash);e.items.forEach(i=>{let n=r.find(e=>this._systemsHash[e]===i);i[e.name](t[n])})}destroy(){Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash={}}}const op=class e{constructor(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=e.defaultMaxIdle,this.checkCountMax=e.defaultCheckCountMax,this.mode=e.defaultMode}postrender(){this.renderer.objectRenderer.renderingToScreen&&(this.count++,this.mode!==r2.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))}run(){let e=this.renderer.texture,t=e.managedTextures,r=!1;for(let i=0;i<t.length;i++){let n=t[i];n.resource&&this.count-n.touched>this.maxIdle&&(e.destroyTexture(n,!0),t[i]=null,r=!0)}if(r){let e=0;for(let r=0;r<t.length;r++)null!==t[r]&&(t[e++]=t[r]);t.length=e}}unload(e){let t=this.renderer.texture,r=e._texture;r&&!r.framebuffer&&t.destroyTexture(r);for(let t=e.children.length-1;t>=0;t--)this.unload(e.children[t])}destroy(){this.renderer=null}};op.defaultMode=r2.AUTO,op.defaultMaxIdle=3600,op.defaultCheckCountMax=600,op.extension={type:na.RendererSystem,name:"textureGC"},nu.add(op);class om{constructor(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=rq.UNSIGNED_BYTE,this.internalFormat=r$.RGBA,this.samplerType=0}}class og{constructor(e){this.renderer=e,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new nT,this.hasIntegerTextures=!1}contextChange(){let e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?{[rq.UNSIGNED_BYTE]:{[r$.RGBA]:e.RGBA8,[r$.RGB]:e.RGB8,[r$.RG]:e.RG8,[r$.RED]:e.R8,[r$.RGBA_INTEGER]:e.RGBA8UI,[r$.RGB_INTEGER]:e.RGB8UI,[r$.RG_INTEGER]:e.RG8UI,[r$.RED_INTEGER]:e.R8UI,[r$.ALPHA]:e.ALPHA,[r$.LUMINANCE]:e.LUMINANCE,[r$.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[rq.BYTE]:{[r$.RGBA]:e.RGBA8_SNORM,[r$.RGB]:e.RGB8_SNORM,[r$.RG]:e.RG8_SNORM,[r$.RED]:e.R8_SNORM,[r$.RGBA_INTEGER]:e.RGBA8I,[r$.RGB_INTEGER]:e.RGB8I,[r$.RG_INTEGER]:e.RG8I,[r$.RED_INTEGER]:e.R8I},[rq.UNSIGNED_SHORT]:{[r$.RGBA_INTEGER]:e.RGBA16UI,[r$.RGB_INTEGER]:e.RGB16UI,[r$.RG_INTEGER]:e.RG16UI,[r$.RED_INTEGER]:e.R16UI,[r$.DEPTH_COMPONENT]:e.DEPTH_COMPONENT16},[rq.SHORT]:{[r$.RGBA_INTEGER]:e.RGBA16I,[r$.RGB_INTEGER]:e.RGB16I,[r$.RG_INTEGER]:e.RG16I,[r$.RED_INTEGER]:e.R16I},[rq.UNSIGNED_INT]:{[r$.RGBA_INTEGER]:e.RGBA32UI,[r$.RGB_INTEGER]:e.RGB32UI,[r$.RG_INTEGER]:e.RG32UI,[r$.RED_INTEGER]:e.R32UI,[r$.DEPTH_COMPONENT]:e.DEPTH_COMPONENT24},[rq.INT]:{[r$.RGBA_INTEGER]:e.RGBA32I,[r$.RGB_INTEGER]:e.RGB32I,[r$.RG_INTEGER]:e.RG32I,[r$.RED_INTEGER]:e.R32I},[rq.FLOAT]:{[r$.RGBA]:e.RGBA32F,[r$.RGB]:e.RGB32F,[r$.RG]:e.RG32F,[r$.RED]:e.R32F,[r$.DEPTH_COMPONENT]:e.DEPTH_COMPONENT32F},[rq.HALF_FLOAT]:{[r$.RGBA]:e.RGBA16F,[r$.RGB]:e.RGB16F,[r$.RG]:e.RG16F,[r$.RED]:e.R16F},[rq.UNSIGNED_SHORT_5_6_5]:{[r$.RGB]:e.RGB565},[rq.UNSIGNED_SHORT_4_4_4_4]:{[r$.RGBA]:e.RGBA4},[rq.UNSIGNED_SHORT_5_5_5_1]:{[r$.RGBA]:e.RGB5_A1},[rq.UNSIGNED_INT_2_10_10_10_REV]:{[r$.RGBA]:e.RGB10_A2,[r$.RGBA_INTEGER]:e.RGB10_A2UI},[rq.UNSIGNED_INT_10F_11F_11F_REV]:{[r$.RGB]:e.R11F_G11F_B10F},[rq.UNSIGNED_INT_5_9_9_9_REV]:{[r$.RGB]:e.RGB9_E5},[rq.UNSIGNED_INT_24_8]:{[r$.DEPTH_STENCIL]:e.DEPTH24_STENCIL8},[rq.FLOAT_32_UNSIGNED_INT_24_8_REV]:{[r$.DEPTH_STENCIL]:e.DEPTH32F_STENCIL8}}:{[rq.UNSIGNED_BYTE]:{[r$.RGBA]:e.RGBA,[r$.RGB]:e.RGB,[r$.ALPHA]:e.ALPHA,[r$.LUMINANCE]:e.LUMINANCE,[r$.LUMINANCE_ALPHA]:e.LUMINANCE_ALPHA},[rq.UNSIGNED_SHORT_5_6_5]:{[r$.RGB]:e.RGB},[rq.UNSIGNED_SHORT_4_4_4_4]:{[r$.RGBA]:e.RGBA},[rq.UNSIGNED_SHORT_5_5_5_1]:{[r$.RGBA]:e.RGBA}},this.samplerTypes="WebGL2RenderingContext"in globalThis&&e instanceof globalThis.WebGL2RenderingContext?{[e.RGB]:rZ.FLOAT,[e.RGBA]:rZ.FLOAT,[e.ALPHA]:rZ.FLOAT,[e.LUMINANCE]:rZ.FLOAT,[e.LUMINANCE_ALPHA]:rZ.FLOAT,[e.R8]:rZ.FLOAT,[e.R8_SNORM]:rZ.FLOAT,[e.RG8]:rZ.FLOAT,[e.RG8_SNORM]:rZ.FLOAT,[e.RGB8]:rZ.FLOAT,[e.RGB8_SNORM]:rZ.FLOAT,[e.RGB565]:rZ.FLOAT,[e.RGBA4]:rZ.FLOAT,[e.RGB5_A1]:rZ.FLOAT,[e.RGBA8]:rZ.FLOAT,[e.RGBA8_SNORM]:rZ.FLOAT,[e.RGB10_A2]:rZ.FLOAT,[e.RGB10_A2UI]:rZ.FLOAT,[e.SRGB8]:rZ.FLOAT,[e.SRGB8_ALPHA8]:rZ.FLOAT,[e.R16F]:rZ.FLOAT,[e.RG16F]:rZ.FLOAT,[e.RGB16F]:rZ.FLOAT,[e.RGBA16F]:rZ.FLOAT,[e.R32F]:rZ.FLOAT,[e.RG32F]:rZ.FLOAT,[e.RGB32F]:rZ.FLOAT,[e.RGBA32F]:rZ.FLOAT,[e.R11F_G11F_B10F]:rZ.FLOAT,[e.RGB9_E5]:rZ.FLOAT,[e.R8I]:rZ.INT,[e.R8UI]:rZ.UINT,[e.R16I]:rZ.INT,[e.R16UI]:rZ.UINT,[e.R32I]:rZ.INT,[e.R32UI]:rZ.UINT,[e.RG8I]:rZ.INT,[e.RG8UI]:rZ.UINT,[e.RG16I]:rZ.INT,[e.RG16UI]:rZ.UINT,[e.RG32I]:rZ.INT,[e.RG32UI]:rZ.UINT,[e.RGB8I]:rZ.INT,[e.RGB8UI]:rZ.UINT,[e.RGB16I]:rZ.INT,[e.RGB16UI]:rZ.UINT,[e.RGB32I]:rZ.INT,[e.RGB32UI]:rZ.UINT,[e.RGBA8I]:rZ.INT,[e.RGBA8UI]:rZ.UINT,[e.RGBA16I]:rZ.INT,[e.RGBA16UI]:rZ.UINT,[e.RGBA32I]:rZ.INT,[e.RGBA32UI]:rZ.UINT,[e.DEPTH_COMPONENT16]:rZ.FLOAT,[e.DEPTH_COMPONENT24]:rZ.FLOAT,[e.DEPTH_COMPONENT32F]:rZ.FLOAT,[e.DEPTH_STENCIL]:rZ.FLOAT,[e.DEPTH24_STENCIL8]:rZ.FLOAT,[e.DEPTH32F_STENCIL8]:rZ.FLOAT}:{[e.RGB]:rZ.FLOAT,[e.RGBA]:rZ.FLOAT,[e.ALPHA]:rZ.FLOAT,[e.LUMINANCE]:rZ.FLOAT,[e.LUMINANCE_ALPHA]:rZ.FLOAT,[e.DEPTH_STENCIL]:rZ.FLOAT};let t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(let e=0;e<t;e++)this.boundTextures[e]=null;this.emptyTextures={};let r=new om(e.createTexture());e.bindTexture(e.TEXTURE_2D,r.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=r,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new om(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(let t=0;t<6;t++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+t,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(let e=0;e<this.boundTextures.length;e++)this.bind(null,e)}bind(e,t=0){let{gl:r}=this;if(e=e?.castToBaseTexture(),e?.valid&&!e.parentTextureArray){e.touched=this.renderer.textureGC.count;let i=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(e.target,i.texture)),i.dirtyId!==e.dirtyId?(this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),this.updateTexture(e)):i.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(e),this.boundTextures[t]=e}else this.currentLocation!==t&&(this.currentLocation=t,r.activeTexture(r.TEXTURE0+t)),r.bindTexture(r.TEXTURE_2D,this.emptyTextures[r.TEXTURE_2D].texture),this.boundTextures[t]=null}reset(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(let e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture}unbind(e){let{gl:t,boundTextures:r}=this;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(let e=0;e<r.length;e++)r[e]===this.unknownTexture&&this.bind(null,e)}for(let i=0;i<r.length;i++)r[i]===e&&(this.currentLocation!==i&&(t.activeTexture(t.TEXTURE0+i),this.currentLocation=i),t.bindTexture(e.target,this.emptyTextures[e.target].texture),r[i]=null)}ensureSamplerType(e){let{boundTextures:t,hasIntegerTextures:r,CONTEXT_UID:i}=this;if(r)for(let r=e-1;r>=0;--r){let e=t[r];e&&e._glTextures[i].samplerType!==rZ.FLOAT&&this.renderer.texture.unbind(e)}}initTexture(e){let t=new om(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t}initTextureType(e,t){t.internalFormat=this.internalFormats[e.type]?.[e.format]??e.format,t.samplerType=this.samplerTypes[t.internalFormat]??rZ.FLOAT,2===this.webGLVersion&&e.type===rq.HALF_FLOAT?t.type=this.gl.HALF_FLOAT:t.type=e.type}updateTexture(e){let t=e._glTextures[this.CONTEXT_UID];if(!t)return;let r=this.renderer;if(this.initTextureType(e,t),e.resource?.upload(r,e,t))t.samplerType!==rZ.FLOAT&&(this.hasIntegerTextures=!0);else{let i=e.realWidth,n=e.realHeight,s=r.gl;(t.width!==i||t.height!==n||t.dirtyId<0)&&(t.width=i,t.height=n,s.texImage2D(e.target,0,t.internalFormat,i,n,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}destroyTexture(e,t){let{gl:r}=this;if((e=e.castToBaseTexture())._glTextures[this.CONTEXT_UID]&&(this.unbind(e),r.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){let t=this.managedTextures.indexOf(e);-1!==t&&iq(this.managedTextures,t,1)}}updateTextureStyle(e){let t=e._glTextures[this.CONTEXT_UID];t&&(e.mipmap!==rJ.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=!1,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=rQ.CLAMP,e.resource?.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)}setStyle(e,t){let r=this.gl;if(t.mipmap&&e.mipmap!==rJ.ON_MANUAL&&r.generateMipmap(e.target),r.texParameteri(e.target,r.TEXTURE_WRAP_S,t.wrapMode),r.texParameteri(e.target,r.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===rK.LINEAR?r.LINEAR_MIPMAP_LINEAR:r.NEAREST_MIPMAP_NEAREST);let t=this.renderer.context.extensions.anisotropicFiltering;if(t&&e.anisotropicLevel>0&&e.scaleMode===rK.LINEAR){let i=Math.min(e.anisotropicLevel,r.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT));r.texParameterf(e.target,t.TEXTURE_MAX_ANISOTROPY_EXT,i)}}else r.texParameteri(e.target,r.TEXTURE_MIN_FILTER,e.scaleMode===rK.LINEAR?r.LINEAR:r.NEAREST);r.texParameteri(e.target,r.TEXTURE_MAG_FILTER,e.scaleMode===rK.LINEAR?r.LINEAR:r.NEAREST)}destroy(){this.renderer=null}}og.extension={type:na.RendererSystem,name:"texture"},nu.add(og);class ov{constructor(e){this.renderer=e}contextChange(){this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){let{gl:t,CONTEXT_UID:r}=this,i=e._glTransformFeedbacks[r]||this.createGLTransformFeedback(e);t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,i)}unbind(){let{gl:e}=this;e.bindTransformFeedback(e.TRANSFORM_FEEDBACK,null)}beginTransformFeedback(e,t){let{gl:r,renderer:i}=this;t&&i.shader.bind(t),r.beginTransformFeedback(e)}endTransformFeedback(){let{gl:e}=this;e.endTransformFeedback()}createGLTransformFeedback(e){let{gl:t,renderer:r,CONTEXT_UID:i}=this,n=t.createTransformFeedback();e._glTransformFeedbacks[i]=n,t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,n);for(let n=0;n<e.buffers.length;n++){let s=e.buffers[n];s&&(r.buffer.update(s),s._glBuffers[i].refCount++,t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,n,s._glBuffers[i].buffer||null))}return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),e.disposeRunner.add(this),n}disposeTransformFeedback(e,t){let r=e._glTransformFeedbacks[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this);let n=this.renderer.buffer;if(n)for(let r=0;r<e.buffers.length;r++){let i=e.buffers[r];if(!i)continue;let s=i._glBuffers[this.CONTEXT_UID];s&&(s.refCount--,0!==s.refCount||t||n.dispose(i,t))}r&&(t||i.deleteTransformFeedback(r),delete e._glTransformFeedbacks[this.CONTEXT_UID])}destroy(){this.renderer=null}}ov.extension={type:na.RendererSystem,name:"transformFeedback"},nu.add(ov);class oy{constructor(e){this.renderer=e}init(e){this.screen=new nU(0,0,e.width,e.height),this.element=e.view||tJ.ADAPTER.createCanvas(),this.resolution=e.resolution||tJ.RESOLUTION,this.autoDensity=!!e.autoDensity}resizeView(e,t){this.element.width=Math.round(e*this.resolution),this.element.height=Math.round(t*this.resolution);let r=this.element.width/this.resolution,i=this.element.height/this.resolution;this.screen.width=r,this.screen.height=i,this.autoDensity&&(this.element.style.width=`${r}px`,this.element.style.height=`${i}px`),this.renderer.emit("resize",r,i),this.renderer.runners.resize.emit(this.screen.width,this.screen.height)}destroy(e){e&&this.element.parentNode?.removeChild(this.element),this.renderer=null,this.element=null,this.screen=null}}oy.defaultOptions={width:800,height:600,resolution:void 0,autoDensity:!1},oy.extension={type:[na.RendererSystem,na.CanvasRendererSystem],name:"_view"},nu.add(oy),tJ.PREFER_ENV=rj.WEBGL2,tJ.STRICT_TEXTURE_CACHE=!1,tJ.RENDER_OPTIONS={...sC.defaultOptions,...sA.defaultOptions,...oy.defaultOptions,...oc.defaultOptions},Object.defineProperties(tJ,{WRAP_MODE:{get:()=>nT.defaultOptions.wrapMode,set(e){rL("7.1.0","settings.WRAP_MODE is deprecated, use BaseTexture.defaultOptions.wrapMode"),nT.defaultOptions.wrapMode=e}},SCALE_MODE:{get:()=>nT.defaultOptions.scaleMode,set(e){rL("7.1.0","settings.SCALE_MODE is deprecated, use BaseTexture.defaultOptions.scaleMode"),nT.defaultOptions.scaleMode=e}},MIPMAP_TEXTURES:{get:()=>nT.defaultOptions.mipmap,set(e){rL("7.1.0","settings.MIPMAP_TEXTURES is deprecated, use BaseTexture.defaultOptions.mipmap"),nT.defaultOptions.mipmap=e}},ANISOTROPIC_LEVEL:{get:()=>nT.defaultOptions.anisotropicLevel,set(e){rL("7.1.0","settings.ANISOTROPIC_LEVEL is deprecated, use BaseTexture.defaultOptions.anisotropicLevel"),nT.defaultOptions.anisotropicLevel=e}},FILTER_RESOLUTION:{get:()=>(rL("7.1.0","settings.FILTER_RESOLUTION is deprecated, use Filter.defaultResolution"),sT.defaultResolution),set(e){sT.defaultResolution=e}},FILTER_MULTISAMPLE:{get:()=>(rL("7.1.0","settings.FILTER_MULTISAMPLE is deprecated, use Filter.defaultMultisample"),sT.defaultMultisample),set(e){sT.defaultMultisample=e}},SPRITE_MAX_TEXTURES:{get:()=>sy.defaultMaxTextures,set(e){rL("7.1.0","settings.SPRITE_MAX_TEXTURES is deprecated, use BatchRenderer.defaultMaxTextures"),sy.defaultMaxTextures=e}},SPRITE_BATCH_SIZE:{get:()=>sy.defaultBatchSize,set(e){rL("7.1.0","settings.SPRITE_BATCH_SIZE is deprecated, use BatchRenderer.defaultBatchSize"),sy.defaultBatchSize=e}},CAN_UPLOAD_SAME_BUFFER:{get:()=>sy.canUploadSameBuffer,set(e){rL("7.1.0","settings.CAN_UPLOAD_SAME_BUFFER is deprecated, use BatchRenderer.canUploadSameBuffer"),sy.canUploadSameBuffer=e}},GC_MODE:{get:()=>op.defaultMode,set(e){rL("7.1.0","settings.GC_MODE is deprecated, use TextureGCSystem.defaultMode"),op.defaultMode=e}},GC_MAX_IDLE:{get:()=>op.defaultMaxIdle,set(e){rL("7.1.0","settings.GC_MAX_IDLE is deprecated, use TextureGCSystem.defaultMaxIdle"),op.defaultMaxIdle=e}},GC_MAX_CHECK_COUNT:{get:()=>op.defaultCheckCountMax,set(e){rL("7.1.0","settings.GC_MAX_CHECK_COUNT is deprecated, use TextureGCSystem.defaultCheckCountMax"),op.defaultCheckCountMax=e}},PRECISION_VERTEX:{get:()=>sh.defaultVertexPrecision,set(e){rL("7.1.0","settings.PRECISION_VERTEX is deprecated, use Program.defaultVertexPrecision"),sh.defaultVertexPrecision=e}},PRECISION_FRAGMENT:{get:()=>sh.defaultFragmentPrecision,set(e){rL("7.1.0","settings.PRECISION_FRAGMENT is deprecated, use Program.defaultFragmentPrecision"),sh.defaultFragmentPrecision=e}}});const o_=[];nu.handleByList(na.Renderer,o_);var ox=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ob=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`;class oT{constructor(e){this.renderer=e}contextChange(e){let t;if(1===this.renderer.context.webGLVersion){let r=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,r)}else{let r=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),t=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,r)}t>=r8.HIGH?this.multisample=r8.HIGH:t>=r8.MEDIUM?this.multisample=r8.MEDIUM:t>=r8.LOW?this.multisample=r8.LOW:this.multisample=r8.NONE}destroy(){}}oT.extension={type:na.RendererSystem,name:"_multisample"},nu.add(oT);class oA{constructor(e){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}}class oE{constructor(e){this.renderer=e,this.managedBuffers={},this.boundBufferBases={}}destroy(){this.renderer=null}contextChange(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID}bind(e){let{gl:t,CONTEXT_UID:r}=this,i=e._glBuffers[r]||this.createGLBuffer(e);t.bindBuffer(e.type,i.buffer)}unbind(e){let{gl:t}=this;t.bindBuffer(e,null)}bindBufferBase(e,t){let{gl:r,CONTEXT_UID:i}=this;if(this.boundBufferBases[t]!==e){let n=e._glBuffers[i]||this.createGLBuffer(e);this.boundBufferBases[t]=e,r.bindBufferBase(r.UNIFORM_BUFFER,t,n.buffer)}}bindBufferRange(e,t,r){let{gl:i,CONTEXT_UID:n}=this;r=r||0;let s=e._glBuffers[n]||this.createGLBuffer(e);i.bindBufferRange(i.UNIFORM_BUFFER,t||0,s.buffer,256*r,256)}update(e){let{gl:t,CONTEXT_UID:r}=this,i=e._glBuffers[r]||this.createGLBuffer(e);if(e._updateID!==i.updateID){if(i.updateID=e._updateID,t.bindBuffer(e.type,i.buffer),i.byteLength>=e.data.byteLength)t.bufferSubData(e.type,0,e.data);else{let r=e.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;i.byteLength=e.data.byteLength,t.bufferData(e.type,e.data,r)}}}dispose(e,t){if(!this.managedBuffers[e.id])return;delete this.managedBuffers[e.id];let r=e._glBuffers[this.CONTEXT_UID],i=this.gl;e.disposeRunner.remove(this),r&&(t||i.deleteBuffer(r.buffer),delete e._glBuffers[this.CONTEXT_UID])}disposeAll(e){let t=Object.keys(this.managedBuffers);for(let r=0;r<t.length;r++)this.dispose(this.managedBuffers[t[r]],e)}createGLBuffer(e){let{CONTEXT_UID:t,gl:r}=this;return e._glBuffers[t]=new oA(r.createBuffer()),this.managedBuffers[e.id]=e,e.disposeRunner.add(this),e._glBuffers[t]}}oE.extension={type:na.RendererSystem,name:"buffer"},nu.add(oE);class ow{constructor(e){this.renderer=e}render(e,t){let r,i,n,s;let o=this.renderer;if(t&&(r=t.renderTexture,i=t.clear,n=t.transform,s=t.skipUpdateTransform),this.renderingToScreen=!r,o.runners.prerender.emit(),o.emit("prerender"),o.projection.transform=n,!o.context.isLost){if(r||(this.lastObjectRendered=e),!s){let t=e.enableTempParent();e.updateTransform(),e.disableTempParent(t)}o.renderTexture.bind(r),o.batch.currentRenderer.start(),(i??o.background.clearBeforeRender)&&o.renderTexture.clear(),e.render(o),o.batch.currentRenderer.flush(),r&&(t.blit&&o.framebuffer.blit(),r.baseTexture.update()),o.runners.postrender.emit(),o.projection.transform=null,o.emit("postrender")}}destroy(){this.renderer=null,this.lastObjectRendered=null}}ow.extension={type:na.RendererSystem,name:"objectRenderer"},nu.add(ow);const oC=class e extends of{constructor(t){super(),this.type=rH.WEBGL,t=Object.assign({},tJ.RENDER_OPTIONS,t),this.gl=null,this.CONTEXT_UID=0,this.globalUniforms=new sc({projectionMatrix:new nV},!0);let r={runners:["init","destroy","contextChange","resolutionChange","reset","update","postrender","prerender","resize"],systems:e.__systems,priority:["_view","textureGenerator","background","_plugin","startup","context","state","texture","buffer","geometry","framebuffer","transformFeedback","mask","scissor","stencil","projection","textureGC","filter","renderTexture","batch","objectRenderer","_multisample"]};this.setup(r),"useContextAlpha"in t&&(rL("7.0.0","options.useContextAlpha is deprecated, use options.premultipliedAlpha and options.backgroundAlpha instead"),t.premultipliedAlpha=t.useContextAlpha&&"notMultiplied"!==t.useContextAlpha,t.backgroundAlpha=!1===t.useContextAlpha?1:t.backgroundAlpha),this._plugin.rendererPlugins=e.__plugins,this.options=t,this.startup.run(this.options)}static test(e){return!e?.forceCanvas&&it()}render(e,t){this.objectRenderer.render(e,t)}resize(e,t){this._view.resizeView(e,t)}reset(){return this.runners.reset.emit(),this}clear(){this.renderTexture.bind(),this.renderTexture.clear()}destroy(e=!1){this.runners.destroy.items.reverse(),this.emitWithCustomOptions(this.runners.destroy,{_view:e}),super.destroy()}get plugins(){return this._plugin.plugins}get multisample(){return this._multisample.multisample}get width(){return this._view.element.width}get height(){return this._view.element.height}get resolution(){return this._view.resolution}set resolution(e){this._view.resolution=e,this.runners.resolutionChange.emit(e)}get autoDensity(){return this._view.autoDensity}get view(){return this._view.element}get screen(){return this._view.screen}get lastObjectRendered(){return this.objectRenderer.lastObjectRendered}get renderingToScreen(){return this.objectRenderer.renderingToScreen}get rendererLogId(){return`WebGL ${this.context.webGLVersion}`}get clearBeforeRender(){return rL("7.0.0","renderer.clearBeforeRender has been deprecated, please use renderer.background.clearBeforeRender instead."),this.background.clearBeforeRender}get useContextAlpha(){return rL("7.0.0","renderer.useContextAlpha has been deprecated, please use renderer.context.premultipliedAlpha instead."),this.context.useContextAlpha}get preserveDrawingBuffer(){return rL("7.0.0","renderer.preserveDrawingBuffer has been deprecated, we cannot truly know this unless pixi created the context"),this.context.preserveDrawingBuffer}get backgroundColor(){return rL("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color}set backgroundColor(e){rL("7.0.0","renderer.backgroundColor has been deprecated, use renderer.background.color instead."),this.background.color=e}get backgroundAlpha(){return rL("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha}set backgroundAlpha(e){rL("7.0.0","renderer.backgroundAlpha has been deprecated, use renderer.background.alpha instead."),this.background.alpha=e}get powerPreference(){return rL("7.0.0","renderer.powerPreference has been deprecated, we can only know this if pixi creates the context"),this.context.powerPreference}generateTexture(e,t){return this.textureGenerator.generateTexture(e,t)}};oC.extension={type:na.Renderer,priority:1},oC.__plugins={},oC.__systems={},nu.handleByMap(na.RendererPlugin,oC.__plugins),nu.handleByMap(na.RendererSystem,oC.__systems),nu.add(oC);class oS extends ny{constructor(e,t){let{width:r,height:i}=t||{};super(r,i),this.items=[],this.itemDirtyIds=[];for(let t=0;t<e;t++){let e=new nT;this.items.push(e),this.itemDirtyIds.push(-2)}this.length=e,this._load=null,this.baseTexture=null}initFromArray(e,t){for(let r=0;r<this.length;r++)e[r]&&(e[r].castToBaseTexture?this.addBaseTextureAt(e[r].castToBaseTexture(),r):e[r]instanceof ny?this.addResourceAt(e[r],r):this.addResourceAt(ng(e[r],t),r))}dispose(){for(let e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null}addResourceAt(e,t){if(!this.items[t])throw Error(`Index ${t} is out of bounds`);return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this}bind(e){if(null!==this.baseTexture)throw Error("Only one base texture per TextureArray is allowed");super.bind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=e,this.items[t].on("update",e.update,e)}unbind(e){super.unbind(e);for(let t=0;t<this.length;t++)this.items[t].parentTextureArray=null,this.items[t].off("update",e.update,e)}load(){if(this._load)return this._load;let e=this.items.map(e=>e.resource).filter(e=>e).map(e=>e.load());return this._load=Promise.all(e).then(()=>{let{realWidth:e,realHeight:t}=this.items[0];return this.resize(e,t),this.update(),Promise.resolve(this)}),this._load}}const oI=class e extends oS{constructor(t,r){let{width:i,height:n,autoLoad:s,linkBaseTexture:o}=r||{};if(t&&t.length!==e.SIDES)throw Error(`Invalid length. Got ${t.length}, expected 6`);super(6,{width:i,height:n});for(let t=0;t<e.SIDES;t++)this.items[t].target=rY.TEXTURE_CUBE_MAP_POSITIVE_X+t;this.linkBaseTexture=!1!==o,t&&this.initFromArray(t,r),!1!==s&&this.load()}bind(e){super.bind(e),e.target=rY.TEXTURE_CUBE_MAP}addBaseTextureAt(e,t,r){if(void 0===r&&(r=this.linkBaseTexture),!this.items[t])throw Error(`Index ${t} is out of bounds`);if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0){if(e.resource)this.addResourceAt(e.resource,t);else throw Error("CubeResource does not support copying of renderTexture.")}else e.target=rY.TEXTURE_CUBE_MAP_POSITIVE_X+t,e.parentTextureArray=this.baseTexture,this.items[t]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[t]=e,this}upload(t,r,i){let n=this.itemDirtyIds;for(let s=0;s<e.SIDES;s++){let e=this.items[s];(n[s]<e.dirtyId||i.dirtyId<r.dirtyId)&&(e.valid&&e.resource?(e.resource.upload(t,e,i),n[s]=e.dirtyId):n[s]<-1&&(t.gl.texImage2D(e.target,0,i.internalFormat,r.realWidth,r.realHeight,0,r.format,i.type,null),n[s]=-1))}return!0}static test(t){return Array.isArray(t)&&t.length===e.SIDES}};oI.SIDES=6;class oR extends sR{constructor(e,t){let r,i,n;t=t||{},"string"==typeof e?(r=oR.EMPTY,i=e,n=!0):(r=e,i=null,n=!1),super(r),this.url=i,this.crossOrigin=t.crossOrigin??!0,this.alphaMode="number"==typeof t.alphaMode?t.alphaMode:null,this.ownsImageBitmap=t.ownsImageBitmap??n,this._load=null,!1!==t.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise(async(e,t)=>{if(null===this.url){e(this);return}try{let t=await tJ.ADAPTER.fetch(this.url,{mode:this.crossOrigin?"cors":"no-cors"});if(this.destroyed)return;let r=await t.blob();if(this.destroyed)return;let i=await createImageBitmap(r,{premultiplyAlpha:null===this.alphaMode||this.alphaMode===r0.UNPACK?"premultiply":"none"});if(this.destroyed){i.close();return}this.source=i,this.update(),e(this)}catch(e){if(this.destroyed)return;t(e),this.onError.emit(e)}})),this._load}upload(e,t,r){return this.source instanceof ImageBitmap?("number"==typeof this.alphaMode&&(t.alphaMode=this.alphaMode),super.upload(e,t,r)):(this.load(),!1)}dispose(){this.ownsImageBitmap&&this.source instanceof ImageBitmap&&this.source.close(),super.dispose(),this._load=null}static test(e){return!!globalThis.createImageBitmap&&"u">typeof ImageBitmap&&("string"==typeof e||e instanceof ImageBitmap)}static get EMPTY(){return oR._EMPTY=oR._EMPTY??tJ.ADAPTER.createCanvas(0,0),oR._EMPTY}}const oM=class e extends sR{constructor(e,t){t=t||{},super(tJ.ADAPTER.createCanvas()),this._width=0,this._height=0,this.svg=e,this.scale=t.scale||1,this._overrideWidth=t.width,this._overrideHeight=t.height,this._resolve=null,this._crossorigin=t.crossorigin,this._load=null,!1!==t.autoLoad&&this.load()}load(){return this._load||(this._load=new Promise(t=>{if(this._resolve=()=>{this.update(),t(this)},e.SVG_XML.test(this.svg.trim())){if(!btoa)throw Error("Your browser doesn't support base64 conversions.");this.svg=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(this.svg)))}`}this._loadSvg()})),this._load}_loadSvg(){let e=new Image;sR.crossOrigin(e,this.svg,this._crossorigin),e.src=this.svg,e.onerror=t=>{this._resolve&&(e.onerror=null,this.onError.emit(t))},e.onload=()=>{if(!this._resolve)return;let t=e.width,r=e.height;if(!t||!r)throw Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");let i=t*this.scale,n=r*this.scale;(this._overrideWidth||this._overrideHeight)&&(i=this._overrideWidth||this._overrideHeight/r*t,n=this._overrideHeight||this._overrideWidth/t*r),i=Math.round(i),n=Math.round(n);let s=this.source;s.width=i,s.height=n,s._pixiId=`canvas_${iQ()}`,s.getContext("2d").drawImage(e,0,0,t,r,0,0,i,n),this._resolve(),this._resolve=null}}static getSize(t){let r=e.SVG_SIZE.exec(t),i={};return r&&(i[r[1]]=Math.round(parseFloat(r[3])),i[r[5]]=Math.round(parseFloat(r[7]))),i}dispose(){super.dispose(),this._resolve=null,this._crossorigin=null}static test(t,r){return"svg"===r||"string"==typeof t&&t.startsWith("data:image/svg+xml")||"string"==typeof t&&e.SVG_XML.test(t)}};oM.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,oM.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;const oP=class e extends sR{constructor(t,r){if(r=r||{},!(t instanceof HTMLVideoElement)){let i=document.createElement("video");!1!==r.autoLoad&&i.setAttribute("preload","auto"),!1!==r.playsinline&&(i.setAttribute("webkit-playsinline",""),i.setAttribute("playsinline","")),!0===r.muted&&(i.setAttribute("muted",""),i.muted=!0),!0===r.loop&&i.setAttribute("loop",""),!1!==r.autoPlay&&i.setAttribute("autoplay",""),"string"==typeof t&&(t=[t]);let n=t[0].src||t[0];sR.crossOrigin(i,n,r.crossorigin);for(let r=0;r<t.length;++r){let n=document.createElement("source"),{src:s,mime:o}=t[r];if((s=s||t[r]).startsWith("data:"))o=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){let t=s.split("?").shift().toLowerCase(),r=t.slice(t.lastIndexOf(".")+1);o=o||e.MIME_TYPES[r]||`video/${r}`}n.src=s,o&&(n.type=o),i.appendChild(n)}t=i}super(t),this.noSubImage=!0,this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=r.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==r.autoPlay,this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==r.autoLoad&&this.load()}update(e=0){if(!this.destroyed){if(this._updateFPS){let e=no.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-e)}(!this._updateFPS||this._msToNextUpdate<=0)&&(super.update(),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}}_videoFrameRequestCallback(){this.update(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback)}load(){if(this._load)return this._load;let e=this.source;return(e.readyState===e.HAVE_ENOUGH_DATA||e.readyState===e.HAVE_FUTURE_DATA)&&e.width&&e.height&&(e.complete=!0),e.addEventListener("play",this._onPlayStart),e.addEventListener("pause",this._onPlayStop),e.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._onCanPlay():(e.addEventListener("canplay",this._onCanPlay),e.addEventListener("canplaythrough",this._onCanPlay),e.addEventListener("error",this._onError,!0)),this._load=new Promise((t,r)=>{this.valid?t(this):(this._resolve=t,this._reject=r,e.load())}),this._load}_onError(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e),this._reject&&(this._reject(e),this._reject=null,this._resolve=null)}_isSourcePlaying(){let e=this.source;return!e.paused&&!e.ended}_isSourceReady(){return this.source.readyState>2}_onPlayStart(){this.valid||this._onCanPlay(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0)}_onCanPlay(){let e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);let t=this.valid;this._msToNextUpdate=0,this.update(),this._msToNextUpdate=0,!t&&this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()}dispose(){this._configureAutoUpdate();let e=this.source;e&&(e.removeEventListener("play",this._onPlayStart),e.removeEventListener("pause",this._onPlayStop),e.removeEventListener("seeked",this._onSeeked),e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay),e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),super.dispose()}get autoUpdate(){return this._autoUpdate}set autoUpdate(e){e!==this._autoUpdate&&(this._autoUpdate=e,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(e){e!==this._updateFPS&&(this._updateFPS=e,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.source.requestVideoFrameCallback?(this._isConnectedToTicker&&(no.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.source.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(no.shared.add(this.update,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.source.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(no.shared.remove(this.update,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t,r){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement||e.TYPES.includes(r)}};oP.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],oP.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},nm.push(oR,sM,class extends sR{constructor(e){super(e)}static test(e){let{OffscreenCanvas:t}=globalThis;return!!t&&e instanceof t||globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement}},oP,oM,n_,oI,class extends oS{constructor(e,t){let r,i;let{width:n,height:s}=t||{};Array.isArray(e)?(r=e,i=e.length):i=e,super(i,{width:n,height:s}),r&&this.initFromArray(r,t)}addBaseTextureAt(e,t){if(e.resource)this.addResourceAt(e.resource,t);else throw Error("ArrayResource does not support RenderTexture");return this}bind(e){super.bind(e),e.target=rY.TEXTURE_2D_ARRAY}upload(e,t,r){let{length:i,itemDirtyIds:n,items:s}=this,{gl:o}=e;r.dirtyId<0&&o.texImage3D(o.TEXTURE_2D_ARRAY,0,r.internalFormat,this._width,this._height,i,0,t.format,r.type,null);for(let e=0;e<i;e++){let i=s[e];n[e]<i.dirtyId&&(n[e]=i.dirtyId,i.valid&&o.texSubImage3D(o.TEXTURE_2D_ARRAY,0,0,0,e,i.resource.width,i.resource.height,1,t.format,r.type,i.resource.source))}return!0}});/*!
 * @pixi/filter-advanced-bloom - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-advanced-bloom is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*!
 * @pixi/filter-kawase-blur - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-kawase-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var oO=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,oD=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample top right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y));

    // Sample bottom right pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y));

    // Sample bottom left pixel
    color += texture2D(uSampler, vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}`,oN=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec2 uOffset;
uniform vec4 filterClamp;

void main(void)
{
    vec4 color = vec4(0.0);

    // Sample top left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample top right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y + uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom right pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x + uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Sample bottom left pixel
    color += texture2D(uSampler, clamp(vec2(vTextureCoord.x - uOffset.x, vTextureCoord.y - uOffset.y), filterClamp.xy, filterClamp.zw));

    // Average
    color *= 0.25;

    gl_FragColor = color;
}
`;class oF extends sT{constructor(e=4,t=3,r=!1){super(oO,r?oN:oD),this._kernels=[],this._blur=4,this._quality=3,this.uniforms.uOffset=new Float32Array(2),this._pixelSize=new nL,this.pixelSize=1,this._clamp=r,Array.isArray(e)?this.kernels=e:(this._blur=e,this.quality=t)}apply(e,t,r,i){let n;let s=this._pixelSize.x/t._frame.width,o=this._pixelSize.y/t._frame.height;if(1===this._quality||0===this._blur)n=this._kernels[0]+.5,this.uniforms.uOffset[0]=n*s,this.uniforms.uOffset[1]=n*o,e.applyFilter(this,t,r,i);else{let a=e.getFilterTexture(),l=t,h=a,u,c=this._quality-1;for(let t=0;t<c;t++)n=this._kernels[t]+.5,this.uniforms.uOffset[0]=n*s,this.uniforms.uOffset[1]=n*o,e.applyFilter(this,l,h,1),u=l,l=h,h=u;n=this._kernels[c]+.5,this.uniforms.uOffset[0]=n*s,this.uniforms.uOffset[1]=n*o,e.applyFilter(this,l,r,i),e.returnFilterTexture(a)}}_updatePadding(){this.padding=Math.ceil(this._kernels.reduce((e,t)=>e+t+.5,0))}_generateKernels(){let e=this._blur,t=this._quality,r=[e];if(e>0){let i=e,n=e/t;for(let e=1;e<t;e++)i-=n,r.push(i)}this._kernels=r,this._updatePadding()}get kernels(){return this._kernels}set kernels(e){Array.isArray(e)&&e.length>0?(this._kernels=e,this._quality=e.length,this._blur=Math.max(...e)):(this._kernels=[0],this._quality=1)}get clamp(){return this._clamp}set pixelSize(e){"number"==typeof e?(this._pixelSize.x=e,this._pixelSize.y=e):Array.isArray(e)?(this._pixelSize.x=e[0],this._pixelSize.y=e[1]):e instanceof nL?(this._pixelSize.x=e.x,this._pixelSize.y=e.y):(this._pixelSize.x=1,this._pixelSize.y=1)}get pixelSize(){return this._pixelSize}get quality(){return this._quality}set quality(e){this._quality=Math.max(1,Math.round(e)),this._generateKernels()}get blur(){return this._blur}set blur(e){this._blur=e,this._generateKernels()}}var oB=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,oL=`
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform float threshold;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);

    // A simple & fast algorithm for getting brightness.
    // It's inaccuracy , but good enought for this feature.
    float _max = max(max(color.r, color.g), color.b);
    float _min = min(min(color.r, color.g), color.b);
    float brightness = (_max + _min) * 0.5;

    if(brightness > threshold) {
        gl_FragColor = color;
    } else {
        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
    }
}
`;class ok extends sT{constructor(e=.5){super(oB,oL),this.threshold=e}get threshold(){return this.uniforms.threshold}set threshold(e){this.uniforms.threshold=e}}var oU=`uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform sampler2D bloomTexture;
uniform float bloomScale;
uniform float brightness;

void main() {
    vec4 color = texture2D(uSampler, vTextureCoord);
    color.rgb *= brightness;
    vec4 bloomColor = vec4(texture2D(bloomTexture, vTextureCoord).rgb, 0.0);
    bloomColor.rgb *= bloomScale;
    gl_FragColor = color + bloomColor;
}
`;const oG=class extends sT{constructor(e){super(oB,oU),this.bloomScale=1,this.brightness=1,this._resolution=tJ.FILTER_RESOLUTION,"number"==typeof e&&(e={threshold:e});let t=Object.assign(oG.defaults,e);this.bloomScale=t.bloomScale,this.brightness=t.brightness;let{kernels:r,blur:i,quality:n,pixelSize:s,resolution:o}=t;this._extractFilter=new ok(t.threshold),this._extractFilter.resolution=o,this._blurFilter=r?new oF(r):new oF(i,n),this.pixelSize=s,this.resolution=o}apply(e,t,r,i,n){let s=e.getFilterTexture();this._extractFilter.apply(e,t,s,1,n);let o=e.getFilterTexture();this._blurFilter.apply(e,s,o,1),this.uniforms.bloomScale=this.bloomScale,this.uniforms.brightness=this.brightness,this.uniforms.bloomTexture=o,e.applyFilter(this,t,r,i),e.returnFilterTexture(o),e.returnFilterTexture(s)}get resolution(){return this._resolution}set resolution(e){this._resolution=e,this._extractFilter&&(this._extractFilter.resolution=e),this._blurFilter&&(this._blurFilter.resolution=e)}get threshold(){return this._extractFilter.threshold}set threshold(e){this._extractFilter.threshold=e}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get blur(){return this._blurFilter.blur}set blur(e){this._blurFilter.blur=e}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){this._blurFilter.pixelSize=e}};oG.defaults={threshold:.5,bloomScale:1,brightness:1,kernels:null,blur:8,quality:4,pixelSize:1,resolution:tJ.FILTER_RESOLUTION};/*!
 * @pixi/filter-bloom - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-bloom is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var oz=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`;const oj={5:[.153388,.221461,.250301],7:[.071303,.131514,.189879,.214607],9:[.028532,.067234,.124009,.179044,.20236],11:[.0093,.028002,.065984,.121703,.175713,.198596],13:[.002406,.009255,.027867,.065666,.121117,.174868,.197641],15:[489e-6,.002403,.009246,.02784,.065602,.120999,.174697,.197448]},oH=["varying vec2 vBlurTexCoords[%size%];","uniform sampler2D uSampler;","void main(void)","{","    gl_FragColor = vec4(0.0);","    %blur%","}"].join(`
`),oV=`
    attribute vec2 aVertexPosition;

    uniform mat3 projectionMatrix;

    uniform float strength;

    varying vec2 vBlurTexCoords[%size%];

    uniform vec4 inputSize;
    uniform vec4 outputFrame;

    vec4 filterVertexPosition( void )
    {
        vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

        return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
    }

    vec2 filterTextureCoord( void )
    {
        return aVertexPosition * (outputFrame.zw * inputSize.zw);
    }

    void main(void)
    {
        gl_Position = filterVertexPosition();

        vec2 textureCoord = filterTextureCoord();
        %blur%
    }`;class oX extends sT{constructor(e,t=8,r=4,i=sT.defaultResolution,n=5){super(function(e,t){let r=Math.ceil(e/2),i=oV,n="",s;s=t?"vBlurTexCoords[%index%] =  textureCoord + vec2(%sampleIndex% * strength, 0.0);":"vBlurTexCoords[%index%] =  textureCoord + vec2(0.0, %sampleIndex% * strength);";for(let t=0;t<e;t++){let e=s.replace("%index%",t.toString());n+=(e=e.replace("%sampleIndex%",`${t-(r-1)}.0`))+`
`}return(i=i.replace("%blur%",n)).replace("%size%",e.toString())}(n,e),function(e){let t;let r=oj[e],i=r.length,n=oH,s="";for(let n=0;n<e;n++){let o="gl_FragColor += texture2D(uSampler, vBlurTexCoords[%index%]) * %value%;".replace("%index%",n.toString());t=n,n>=i&&(t=e-n-1),s+=(o=o.replace("%value%",r[t].toString()))+`
`}return(n=n.replace("%blur%",s)).replace("%size%",e.toString())}(n)),this.horizontal=e,this.resolution=i,this._quality=0,this.quality=r,this.blur=t}apply(e,t,r,i){if(r?this.horizontal?this.uniforms.strength=1/r.width*(r.width/t.width):this.uniforms.strength=1/r.height*(r.height/t.height):this.horizontal?this.uniforms.strength=1/e.renderer.width*(e.renderer.width/t.width):this.uniforms.strength=1/e.renderer.height*(e.renderer.height/t.height),this.uniforms.strength*=this.strength,this.uniforms.strength/=this.passes,1===this.passes)e.applyFilter(this,t,r,i);else{let n=e.getFilterTexture(),s=e.renderer,o=t,a=n;this.state.blend=!1,e.applyFilter(this,o,a,r1.CLEAR);for(let t=1;t<this.passes-1;t++){e.bindAndClear(o,r1.BLIT),this.uniforms.uSampler=a;let t=a;a=o,o=t,s.shader.bind(this),s.geometry.draw(5)}this.state.blend=!0,e.applyFilter(this,a,r,i),e.returnFilterTexture(n)}}get blur(){return this.strength}set blur(e){this.padding=1+2*Math.abs(e),this.strength=e}get quality(){return this._quality}set quality(e){this._quality=e,this.passes=e}}/*!
 * @pixi/filter-bulge-pinch - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-bulge-pinch is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var oW=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,o$=`uniform float radius;
uniform float strength;
uniform vec2 center;
uniform sampler2D uSampler;
varying vec2 vTextureCoord;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

void main()
{
    vec2 coord = vTextureCoord * filterArea.xy;
    coord -= center * dimensions.xy;
    float distance = length(coord);
    if (distance < radius) {
        float percent = distance / radius;
        if (strength > 0.0) {
            coord *= mix(1.0, smoothstep(0.0, radius / distance, percent), strength * 0.75);
        } else {
            coord *= mix(1.0, pow(percent, 1.0 + strength * 0.75) * radius / distance, 1.0 - percent);
        }
    }
    coord += center * dimensions.xy;
    coord /= filterArea.xy;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    gl_FragColor = color;
}
`;const oY=class extends sT{constructor(e){super(oW,o$),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,oY.defaults,e)}apply(e,t,r,i){let{width:n,height:s}=t.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=s,e.applyFilter(this,t,r,i)}get radius(){return this.uniforms.radius}set radius(e){this.uniforms.radius=e}get strength(){return this.uniforms.strength}set strength(e){this.uniforms.strength=e}get center(){return this.uniforms.center}set center(e){this.uniforms.center=e}};oY.defaults={center:[.5,.5],radius:100,strength:1};/*!
 * @pixi/filter-color-gradient - v5.2.0
 * Compiled Tue, 28 Feb 2023 14:24:35 UTC
 *
 * @pixi/filter-color-gradient is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var oq=`const float PI = 3.1415926538;
const float PI_2 = PI*2.;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;
uniform sampler2D uSampler;

const int TYPE_LINEAR = 0;
const int TYPE_RADIAL = 1;
const int TYPE_CONIC = 2;
const int MAX_STOPS = 32;

uniform int uNumStops;
uniform float uAlphas[3*MAX_STOPS];
uniform vec3 uColors[MAX_STOPS];
uniform float uOffsets[MAX_STOPS];
uniform int uType;
uniform float uAngle;
uniform float uAlpha;
uniform int uMaxColors;

struct ColorStop {
    float offset;
    vec3 color;
    float alpha;
};

mat2 rotate2d(float angle){
    return mat2(cos(angle), -sin(angle),
    sin(angle), cos(angle));
}

float projectLinearPosition(vec2 pos, float angle){
    vec2 center = vec2(0.5);
    vec2 result = pos - center;
    result = rotate2d(angle) * result;
    result = result + center;
    return clamp(result.x, 0., 1.);
}

float projectRadialPosition(vec2 pos) {
    float r = distance(vFilterCoord, vec2(0.5));
    return clamp(2.*r, 0., 1.);
}

float projectAnglePosition(vec2 pos, float angle) {
    vec2 center = pos - vec2(0.5);
    float polarAngle=atan(-center.y, center.x);
    return mod(polarAngle + angle, PI_2) / PI_2;
}

float projectPosition(vec2 pos, int type, float angle) {
    if (type == TYPE_LINEAR) {
        return projectLinearPosition(pos, angle);
    } else if (type == TYPE_RADIAL) {
        return projectRadialPosition(pos);
    } else if (type == TYPE_CONIC) {
        return projectAnglePosition(pos, angle);
    }

    return pos.y;
}

void main(void) {
    // current/original color
    vec4 currentColor = texture2D(uSampler, vTextureCoord);

    // skip calculations if gradient alpha is 0
    if (0.0 == uAlpha) {
        gl_FragColor = currentColor;
        return;
    }

    // project position
    float y = projectPosition(vFilterCoord, uType, radians(uAngle));

    // check gradient bounds
    float offsetMin = uOffsets[0];
    float offsetMax = 0.0;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (i == uNumStops-1){ // last index
            offsetMax = uOffsets[i];
        }
    }

    if (y  < offsetMin || y > offsetMax) {
        gl_FragColor = currentColor;
        return;
    }

    // limit colors
    if (uMaxColors > 0) {
        float stepSize = 1./float(uMaxColors);
        float stepNumber = float(floor(y/stepSize));
        y = stepSize * (stepNumber + 0.5);// offset by 0.5 to use color from middle of segment
    }

    // find color stops
    ColorStop from;
    ColorStop to;

    for (int i = 0; i < MAX_STOPS; i++) {
        if (y >= uOffsets[i]) {
            from = ColorStop(uOffsets[i], uColors[i], uAlphas[i]);
            to = ColorStop(uOffsets[i+1], uColors[i+1], uAlphas[i+1]);
        }

        if (i == uNumStops-1){ // last index
            break;
        }
    }

    // mix colors from stops
    vec4 colorFrom = vec4(from.color * from.alpha, from.alpha);
    vec4 colorTo = vec4(to.color * to.alpha, to.alpha);

    float segmentHeight = to.offset - from.offset;
    float relativePos = y - from.offset;// position from 0 to [segmentHeight]
    float relativePercent = relativePos / segmentHeight;// position in percent between [from.offset] and [to.offset].

    float gradientAlpha = uAlpha * currentColor.a;
    vec4 gradientColor = mix(colorFrom, colorTo, relativePercent) * gradientAlpha;

    // mix resulting color with current color
    gl_FragColor = gradientColor + currentColor*(1.-gradientColor.a);
}
`,oZ=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform vec4 inputSize;
uniform vec4 outputFrame;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
    vFilterCoord = vTextureCoord * inputSize.xy / outputFrame.zw;
}
`,oK=oK||{};oK.stringify=(eh={"visit_linear-gradient":function(e){return eh.visit_gradient(e)},"visit_repeating-linear-gradient":function(e){return eh.visit_gradient(e)},"visit_radial-gradient":function(e){return eh.visit_gradient(e)},"visit_repeating-radial-gradient":function(e){return eh.visit_gradient(e)},visit_gradient:function(e){var t=eh.visit(e.orientation);return t&&(t+=", "),e.type+"("+t+eh.visit(e.colorStops)+")"},visit_shape:function(e){var t=e.value,r=eh.visit(e.at),i=eh.visit(e.style);return i&&(t+=" "+i),r&&(t+=" at "+r),t},"visit_default-radial":function(e){var t="",r=eh.visit(e.at);return r&&(t+=r),t},"visit_extent-keyword":function(e){var t=e.value,r=eh.visit(e.at);return r&&(t+=" at "+r),t},"visit_position-keyword":function(e){return e.value},visit_position:function(e){return eh.visit(e.value.x)+" "+eh.visit(e.value.y)},"visit_%":function(e){return e.value+"%"},visit_em:function(e){return e.value+"em"},visit_px:function(e){return e.value+"px"},visit_literal:function(e){return eh.visit_color(e.value,e)},visit_hex:function(e){return eh.visit_color("#"+e.value,e)},visit_rgb:function(e){return eh.visit_color("rgb("+e.value.join(", ")+")",e)},visit_rgba:function(e){return eh.visit_color("rgba("+e.value.join(", ")+")",e)},visit_color:function(e,t){var r=e,i=eh.visit(t.length);return i&&(r+=" "+i),r},visit_angular:function(e){return e.value+"deg"},visit_directional:function(e){return"to "+e.value},visit_array:function(e){var t="",r=e.length;return e.forEach(function(e,i){t+=eh.visit(e),i<r-1&&(t+=", ")}),t},visit:function(e){if(!e)return"";if(e instanceof Array)return eh.visit_array(e,"");if(e.type){var t=eh["visit_"+e.type];if(t)return t(e);throw Error("Missing visitor visit_"+e.type)}throw Error("Invalid node.")}},function(e){return eh.visit(e)});var oK=oK||{};oK.parse=function(){var e={linearGradient:/^(\-(webkit|o|ms|moz)\-)?(linear\-gradient)/i,repeatingLinearGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-linear\-gradient)/i,radialGradient:/^(\-(webkit|o|ms|moz)\-)?(radial\-gradient)/i,repeatingRadialGradient:/^(\-(webkit|o|ms|moz)\-)?(repeating\-radial\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},t="";function r(e){var r=Error(t+": "+e);throw r.source=t,r}function i(){return n("linear-gradient",e.linearGradient,o)||n("repeating-linear-gradient",e.repeatingLinearGradient,o)||n("radial-gradient",e.radialGradient,a)||n("repeating-radial-gradient",e.repeatingRadialGradient,a)}function n(t,i,n){return s(i,function(i){var s=n();return s&&(y(e.comma)||r("Missing comma before color stops")),{type:t,orientation:s,colorStops:d(f)}})}function s(t,i){var n=y(t);if(n){y(e.startCall)||r("Missing (");var s=i(n);return y(e.endCall)||r("Missing )"),s}}function o(){return v("directional",e.sideOrCorner,1)||v("angular",e.angleValue,1)}function a(){var r,i,n=l();return n&&((r=[]).push(n),i=t,y(e.comma)&&((n=l())?r.push(n):t=i)),r}function l(){var e,t,r=((e=v("shape",/^(circle)/i,0))&&(e.style=g()||h()),e||((t=v("shape",/^(ellipse)/i,0))&&(t.style=m()||h()),t));if(r)r.at=u();else{var i=h();if(i){r=i;var n=u();n&&(r.at=n)}else{var s=c();s&&(r={type:"default-radial",at:s})}}return r}function h(){return v("extent-keyword",e.extentKeywords,1)}function u(){if(v("position",/^at/,0)){var e=c();return e||r("Missing positioning value"),e}}function c(){var e={x:m(),y:m()};if(e.x||e.y)return{type:"position",value:e}}function d(t){var i=t(),n=[];if(i)for(n.push(i);y(e.comma);)(i=t())?n.push(i):r("One extra comma");return n}function f(){var t=v("hex",e.hexColor,1)||s(e.rgbaColor,function(){return{type:"rgba",value:d(p)}})||s(e.rgbColor,function(){return{type:"rgb",value:d(p)}})||v("literal",e.literalColor,0);return t||r("Expected color definition"),t.length=m(),t}function p(){return y(e.number)[1]}function m(){return v("%",e.percentageValue,1)||v("position-keyword",e.positionKeywords,1)||g()}function g(){return v("px",e.pixelValue,1)||v("em",e.emValue,1)}function v(e,t,r){var i=y(t);if(i)return{type:e,value:i[r]}}function y(e){var r,i;return(i=/^[\n\r\t\s]+/.exec(t))&&x(i[0].length),(r=e.exec(t))&&x(r[0].length),r}function x(e){t=t.substr(e)}return function(e){var n;return t=e.toString(),n=d(i),t.length>0&&r("Invalid input not EOF"),n}}();var oQ=oK.parse;oK.stringify;var oJ={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},o0={red:0,orange:60,yellow:120,green:180,blue:240,purple:300},o1={min:[0,0,0],max:[255,255,255]},o2={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(e){var t,r,i,n,s,o=e[0]/360,a=e[1]/100,l=e[2]/100;if(0===a)return[s=255*l,s,s];r=l<.5?l*(1+a):l+a-l*a,t=2*l-r,n=[0,0,0];for(var h=0;h<3;h++)(i=o+-(1/3*(h-1)))<0?i++:i>1&&i--,s=6*i<1?t+(r-t)*6*i:2*i<1?r:3*i<2?t+(r-t)*(2/3-i)*6:t,n[h]=255*s;return n}};function o3(e){switch(typeof e){case"string":return function(e){let t=function(e){Array.isArray(e)&&e.raw&&(e=String.raw(...arguments));var t,r=function(e){var t,r,i=[],n=1;if("string"==typeof e){if(oJ[e])i=oJ[e].slice(),r="rgb";else if("transparent"===e)n=0,r="rgb",i=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(e)){var s=e.slice(1),o=s.length;n=1,o<=4?(i=[parseInt(s[0]+s[0],16),parseInt(s[1]+s[1],16),parseInt(s[2]+s[2],16)],4===o&&(n=parseInt(s[3]+s[3],16)/255)):(i=[parseInt(s[0]+s[1],16),parseInt(s[2]+s[3],16),parseInt(s[4]+s[5],16)],8===o&&(n=parseInt(s[6]+s[7],16)/255)),i[0]||(i[0]=0),i[1]||(i[1]=0),i[2]||(i[2]=0),r="rgb"}else if(t=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(e)){var a=t[1],s=a.replace(/a$/,"");r=s;var o="cmyk"===s?4:"gray"===s?1:3;i=t[2].trim().split(/\s*[,\/]\s*|\s+/).map(function(e,t){if(/%$/.test(e))return t===o?parseFloat(e)/100:"rgb"===s?255*parseFloat(e)/100:parseFloat(e);if("h"===s[t]){if(/deg$/.test(e))return parseFloat(e);if(void 0!==o0[e])return o0[e]}return parseFloat(e)}),a===s&&i.push(1),n="rgb"===a||void 0===i[o]?1:i[o],i=i.slice(0,o)}else e.length>10&&/[0-9](?:\s|\/)/.test(e)&&(i=e.match(/([0-9]+)/g).map(function(e){return parseFloat(e)}),r=e.match(/([a-z])/ig).join("").toLowerCase())}else isNaN(e)?Array.isArray(e)||e.length?(i=[e[0],e[1],e[2]],r="rgb",n=4===e.length?e[3]:1):e instanceof Object&&(null!=e.r||null!=e.red||null!=e.R?(r="rgb",i=[e.r||e.red||e.R||0,e.g||e.green||e.G||0,e.b||e.blue||e.B||0]):(r="hsl",i=[e.h||e.hue||e.H||0,e.s||e.saturation||e.S||0,e.l||e.lightness||e.L||e.b||e.brightness]),n=e.a||e.alpha||e.opacity||1,null!=e.opacity&&(n/=100)):(r="rgb",i=[e>>>16,(65280&e)>>>8,255&e]);return{space:r,values:i,alpha:n}}(e);if(!r.space)return[];let i="h"===r.space[0]?o2.min:o1.min,n="h"===r.space[0]?o2.max:o1.max;return(t=[,,,])[0]=Math.min(Math.max(r.values[0],i[0]),n[0]),t[1]=Math.min(Math.max(r.values[1],i[1]),n[1]),t[2]=Math.min(Math.max(r.values[2],i[2]),n[2]),"h"===r.space[0]&&(t=o2.rgb(t)),t.push(Math.min(Math.max(r.alpha,0),1)),t}(e);if(!t)throw Error(`Unable to parse color "${e}" as RGBA.`);return[t[0]/255,t[1]/255,t[2]/255,t[3]]}(e);case"number":return rl.hex2rgb(e);default:return e}}function o4(e){return e.toString().length>6?parseFloat(e.toString().substring(0,6)):e}o1.hsl=function(e){var t,r,i=e[0]/255,n=e[1]/255,s=e[2]/255,o=Math.min(i,n,s),a=Math.max(i,n,s),l=a-o;return a===o?t=0:i===a?t=(n-s)/l:n===a?t=2+(s-i)/l:s===a&&(t=4+(i-n)/l),(t=Math.min(60*t,360))<0&&(t+=360),r=(o+a)/2,[t,100*(a===o?0:r<=.5?l/(a+o):l/(2-a-o)),100*r]};var o5=Object.defineProperty,o8=Object.defineProperties,o6=Object.getOwnPropertyDescriptors,o7=Object.getOwnPropertySymbols,o9=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,at=(e,t,r)=>t in e?o5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ar=(e,t)=>{for(var r in t||(t={}))o9.call(t,r)&&at(e,r,t[r]);if(o7)for(var r of o7(t))ae.call(t,r)&&at(e,r,t[r]);return e},ai=(e,t)=>o8(e,o6(t));const an=class extends sT{constructor(e){e&&"css"in e&&(e=ai(ar({},function(e){let t;let r=oQ(e.replace(/\s{2,}/gu," ").replace(/;/g,"").replace(/ ,/g,",").replace(/\( /g,"(").replace(/ \)/g,")").trim());if(0===r.length)throw Error("Invalid CSS gradient.");if(1!==r.length)throw Error("Unsupported CSS gradient (multiple gradients is not supported).");let i=r[0];return{type:function(e){let t={"linear-gradient":0,"radial-gradient":1};if(!(e in t))throw Error(`Unsupported gradient type "${e}"`);return t[e]}(i.type),stops:function(e){let t=function(e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],n=-1;"literal"===i.type&&i.length&&"type"in i.length&&"%"===i.length.type&&"value"in i.length&&(n=parseFloat(i.length.value)/100),t.push(n)}let r=e=>{for(let r=e;r<t.length;r++)if(-1!==t[r])return{indexDelta:r-e,offset:t[r]};return{indexDelta:t.length-1-e,offset:1}},i=0;for(let e=0;e<t.length;e++){let n=t[e];if(-1!==n)i=n;else if(0===e)t[e]=0;else if(e+1===t.length)t[e]=1;else{let n=r(e),s=(n.offset-i)/(1+n.indexDelta);for(let r=0;r<=n.indexDelta;r++)t[e+r]=i+(r+1)*s;e+=n.indexDelta,i=t[e]}}return t.map(o4)}(e),r=[];for(let i=0;i<e.length;i++){let n=o3(function(e){switch(e.type){case"hex":return`#${e.value}`;case"literal":return e.value;default:return`${e.type}(${e.value.join(",")})`}}(e[i]));r.push({offset:t[i],color:n.slice(0,3),alpha:n[3]})}return r}(i.colorStops),angle:function(e){if(void 0===e)return 0;if("type"in e&&"value"in e)switch(e.type){case"angular":return parseFloat(e.value);case"directional":return function(e){let t={left:270,top:0,bottom:180,right:90,"left top":315,"top left":315,"left bottom":225,"bottom left":225,"right top":45,"top right":45,"right bottom":135,"bottom right":135};if(!(e in t))throw Error(`Unsupported directional value "${e}"`);return t[e]}(e.value)}return 0}(i.orientation)}}(e.css||"")),{alpha:e.alpha,maxColors:e.maxColors}));let t=ar(ar({},an.defaults),e);if(!t.stops||t.stops.length<2)throw Error("ColorGradientFilter requires at least 2 color stops.");super(oZ,oq),this._stops=[],this.autoFit=!1,Object.assign(this,t)}get stops(){return this._stops}set stops(e){let t=[...e].sort((e,t)=>e.offset-t.offset),r=new Float32Array(3*t.length);for(let e=0;e<t.length;e++){let i=o3(t[e].color),n=3*e;r[n+0]=i[0],r[n+1]=i[1],r[n+2]=i[2]}this.uniforms.uColors=r,this.uniforms.uOffsets=t.map(e=>e.offset),this.uniforms.uAlphas=t.map(e=>e.alpha),this.uniforms.uNumStops=t.length,this._stops=t}set type(e){this.uniforms.uType=e}get type(){return this.uniforms.uType}set angle(e){this.uniforms.uAngle=e-90}get angle(){return this.uniforms.uAngle+90}set alpha(e){this.uniforms.uAlpha=e}get alpha(){return this.uniforms.uAlpha}set maxColors(e){this.uniforms.uMaxColors=e}get maxColors(){return this.uniforms.uMaxColors}};an.LINEAR=0,an.RADIAL=1,an.CONIC=2,an.defaults={type:an.LINEAR,stops:[{offset:0,color:16711680,alpha:1},{offset:1,color:255,alpha:1}],alpha:1,angle:90,maxColors:0};/*!
 * @pixi/filter-crt - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-crt is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var as=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ao=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec2 dimensions;

const float SQRT_2 = 1.414213;

const float light = 1.0;

uniform float curvature;
uniform float lineWidth;
uniform float lineContrast;
uniform bool verticalLine;
uniform float noise;
uniform float noiseSize;

uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;

uniform float seed;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 dir = vec2(vTextureCoord.xy * filterArea.xy / dimensions - vec2(0.5, 0.5));
    
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 rgb = gl_FragColor.rgb;

    if (noise > 0.0 && noiseSize > 0.0)
    {
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        rgb += _noise * noise;
    }

    if (lineWidth > 0.0)
    {
        float _c = curvature > 0. ? curvature : 1.;
        float k = curvature > 0. ?(length(dir * dir) * 0.25 * _c * _c + 0.935 * _c) : 1.;
        vec2 uv = dir * k;

        float v = (verticalLine ? uv.x * dimensions.x : uv.y * dimensions.y) * min(1.0, 2.0 / lineWidth ) / _c;
        float j = 1. + cos(v * 1.2 - time) * 0.5 * lineContrast;
        rgb *= j;
        float segment = verticalLine ? mod((dir.x + .5) * dimensions.x, 4.) : mod((dir.y + .5) * dimensions.y, 4.);
        rgb *= 0.99 + ceil(segment) * 0.015;
    }

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    gl_FragColor.rgb = rgb;
}
`;const aa=class extends sT{constructor(e){super(as,ao),this.time=0,this.seed=0,this.uniforms.dimensions=new Float32Array(2),Object.assign(this,aa.defaults,e)}apply(e,t,r,i){let{width:n,height:s}=t.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=s,this.uniforms.seed=this.seed,this.uniforms.time=this.time,e.applyFilter(this,t,r,i)}set curvature(e){this.uniforms.curvature=e}get curvature(){return this.uniforms.curvature}set lineWidth(e){this.uniforms.lineWidth=e}get lineWidth(){return this.uniforms.lineWidth}set lineContrast(e){this.uniforms.lineContrast=e}get lineContrast(){return this.uniforms.lineContrast}set verticalLine(e){this.uniforms.verticalLine=e}get verticalLine(){return this.uniforms.verticalLine}set noise(e){this.uniforms.noise=e}get noise(){return this.uniforms.noise}set noiseSize(e){this.uniforms.noiseSize=e}get noiseSize(){return this.uniforms.noiseSize}set vignetting(e){this.uniforms.vignetting=e}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(e){this.uniforms.vignettingAlpha=e}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(e){this.uniforms.vignettingBlur=e}get vignettingBlur(){return this.uniforms.vignettingBlur}};aa.defaults={curvature:1,lineWidth:1,lineContrast:.25,verticalLine:!1,noise:0,noiseSize:1,seed:0,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3,time:0};/*!
 * @pixi/filter-drop-shadow - v5.2.0
 * Compiled Tue, 28 Feb 2023 14:24:35 UTC
 *
 * @pixi/filter-drop-shadow is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var al=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ah=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float alpha;
uniform vec3 color;

uniform vec2 shift;
uniform vec4 inputSize;

void main(void){
    vec4 sample = texture2D(uSampler, vTextureCoord - shift * inputSize.zw);

    // Premultiply alpha
    sample.rgb = color.rgb * sample.a;

    // alpha user alpha
    sample *= alpha;

    gl_FragColor = sample;
}`,au=Object.defineProperty,ac=Object.getOwnPropertySymbols,ad=Object.prototype.hasOwnProperty,af=Object.prototype.propertyIsEnumerable,ap=(e,t,r)=>t in e?au(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,am=(e,t)=>{for(var r in t||(t={}))ad.call(t,r)&&ap(e,r,t[r]);if(ac)for(var r of ac(t))af.call(t,r)&&ap(e,r,t[r]);return e};const ag=class extends sT{constructor(e){super(),this.angle=45,this._distance=5,this._resolution=tJ.FILTER_RESOLUTION;let t=e?am(am({},ag.defaults),e):ag.defaults,{kernels:r,blur:i,quality:n,pixelSize:s,resolution:o}=t;this._offset=new nJ(this._updatePadding,this),this._tintFilter=new sT(al,ah),this._tintFilter.uniforms.color=new Float32Array(4),this._tintFilter.uniforms.shift=this._offset,this._tintFilter.resolution=o,this._blurFilter=r?new oF(r):new oF(i,n),this.pixelSize=s,this.resolution=o;let{shadowOnly:a,rotation:l,distance:h,offset:u,alpha:c,color:d}=t;this.shadowOnly=a,void 0!==l&&void 0!==h?(this.rotation=l,this.distance=h):this.offset=u,this.alpha=c,this.color=d}apply(e,t,r,i){let n=e.getFilterTexture();this._tintFilter.apply(e,t,n,1),this._blurFilter.apply(e,n,r,i),!0!==this.shadowOnly&&e.applyFilter(this,t,r,0),e.returnFilterTexture(n)}_updatePadding(){let e=Math.max(Math.abs(this._offset.x),Math.abs(this._offset.y));this.padding=e+2*this.blur}_updateShift(){this._tintFilter.uniforms.shift.set(this.distance*Math.cos(this.angle),this.distance*Math.sin(this.angle))}set offset(e){this._offset.copyFrom(e),this._updatePadding()}get offset(){return this._offset}get resolution(){return this._resolution}set resolution(e){this._resolution=e,this._tintFilter&&(this._tintFilter.resolution=e),this._blurFilter&&(this._blurFilter.resolution=e)}get distance(){return this._distance}set distance(e){rl.deprecation("5.3.0","DropShadowFilter distance is deprecated, use offset"),this._distance=e,this._updatePadding(),this._updateShift()}get rotation(){return this.angle/nF}set rotation(e){rl.deprecation("5.3.0","DropShadowFilter rotation is deprecated, use offset"),this.angle=e*nF,this._updateShift()}get alpha(){return this._tintFilter.uniforms.alpha}set alpha(e){this._tintFilter.uniforms.alpha=e}get color(){return rl.rgb2hex(this._tintFilter.uniforms.color)}set color(e){rl.hex2rgb(e,this._tintFilter.uniforms.color)}get kernels(){return this._blurFilter.kernels}set kernels(e){this._blurFilter.kernels=e}get blur(){return this._blurFilter.blur}set blur(e){this._blurFilter.blur=e,this._updatePadding()}get quality(){return this._blurFilter.quality}set quality(e){this._blurFilter.quality=e}get pixelSize(){return this._blurFilter.pixelSize}set pixelSize(e){this._blurFilter.pixelSize=e}};ag.defaults={offset:{x:4,y:4},color:0,alpha:.5,shadowOnly:!1,kernels:null,blur:2,quality:3,pixelSize:1,resolution:tJ.FILTER_RESOLUTION};/*!
 * @pixi/filter-glitch - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-glitch is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var av=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ay=`// precision highp float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;
uniform float aspect;

uniform sampler2D displacementMap;
uniform float offset;
uniform float sinDir;
uniform float cosDir;
uniform int fillMode;

uniform float seed;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

const int TRANSPARENT = 0;
const int ORIGINAL = 1;
const int LOOP = 2;
const int CLAMP = 3;
const int MIRROR = 4;

void main(void)
{
    vec2 coord = (vTextureCoord * filterArea.xy) / dimensions;

    if (coord.x > 1.0 || coord.y > 1.0) {
        return;
    }

    float cx = coord.x - 0.5;
    float cy = (coord.y - 0.5) * aspect;
    float ny = (-sinDir * cx + cosDir * cy) / aspect + 0.5;

    // displacementMap: repeat
    // ny = ny > 1.0 ? ny - 1.0 : (ny < 0.0 ? 1.0 + ny : ny);

    // displacementMap: mirror
    ny = ny > 1.0 ? 2.0 - ny : (ny < 0.0 ? -ny : ny);

    vec4 dc = texture2D(displacementMap, vec2(0.5, ny));

    float displacement = (dc.r - dc.g) * (offset / filterArea.x);

    coord = vTextureCoord + vec2(cosDir * displacement, sinDir * displacement * aspect);

    if (fillMode == CLAMP) {
        coord = clamp(coord, filterClamp.xy, filterClamp.zw);
    } else {
        if( coord.x > filterClamp.z ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x -= filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x = filterClamp.z * 2.0 - coord.x;
            }
        } else if( coord.x < filterClamp.x ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.x += filterClamp.z;
            } else if (fillMode == MIRROR) {
                coord.x *= -filterClamp.z;
            }
        }

        if( coord.y > filterClamp.w ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y -= filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y = filterClamp.w * 2.0 - coord.y;
            }
        } else if( coord.y < filterClamp.y ) {
            if (fillMode == TRANSPARENT) {
                discard;
            } else if (fillMode == LOOP) {
                coord.y += filterClamp.w;
            } else if (fillMode == MIRROR) {
                coord.y *= -filterClamp.w;
            }
        }
    }

    gl_FragColor.r = texture2D(uSampler, coord + red * (1.0 - seed * 0.4) / filterArea.xy).r;
    gl_FragColor.g = texture2D(uSampler, coord + green * (1.0 - seed * 0.3) / filterArea.xy).g;
    gl_FragColor.b = texture2D(uSampler, coord + blue * (1.0 - seed * 0.2) / filterArea.xy).b;
    gl_FragColor.a = texture2D(uSampler, coord).a;
}
`;const a_=class extends sT{constructor(e){super(av,ay),this.offset=100,this.fillMode=a_.TRANSPARENT,this.average=!1,this.seed=0,this.minSize=8,this.sampleSize=512,this._slices=0,this._offsets=new Float32Array(1),this._sizes=new Float32Array(1),this._direction=-1,this.uniforms.dimensions=new Float32Array(2),this._canvas=document.createElement("canvas"),this._canvas.width=4,this._canvas.height=this.sampleSize,this.texture=sN.from(this._canvas,{scaleMode:rK.NEAREST}),Object.assign(this,a_.defaults,e)}apply(e,t,r,i){let{width:n,height:s}=t.filterFrame;this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=s,this.uniforms.aspect=s/n,this.uniforms.seed=this.seed,this.uniforms.offset=this.offset,this.uniforms.fillMode=this.fillMode,e.applyFilter(this,t,r,i)}_randomizeSizes(){let e=this._sizes,t=this._slices-1,r=this.sampleSize,i=Math.min(this.minSize/r,.9/this._slices);if(this.average){let r=this._slices,n=1;for(let s=0;s<t;s++){let t=Math.max(n/(r-s)*(1-.6*Math.random()),i);e[s]=t,n-=t}e[t]=n}else{let r=1,n=Math.sqrt(1/this._slices);for(let s=0;s<t;s++){let t=Math.max(n*r*Math.random(),i);e[s]=t,r-=t}e[t]=r}this.shuffle()}shuffle(){let e=this._sizes,t=this._slices-1;for(let r=t;r>0;r--){let t=Math.random()*r>>0,i=e[r];e[r]=e[t],e[t]=i}}_randomizeOffsets(){for(let e=0;e<this._slices;e++)this._offsets[e]=Math.random()*(.5>Math.random()?-1:1)}refresh(){this._randomizeSizes(),this._randomizeOffsets(),this.redraw()}redraw(){let e=this.sampleSize,t=this.texture,r=this._canvas.getContext("2d");r.clearRect(0,0,8,e);let i,n=0;for(let t=0;t<this._slices;t++){i=Math.floor(256*this._offsets[t]);let s=this._sizes[t]*e,o=i>0?i:0,a=i<0?-i:0;r.fillStyle=`rgba(${o}, ${a}, 0, 1)`,r.fillRect(0,n>>0,e,s+1>>0),n+=s}t.baseTexture.update(),this.uniforms.displacementMap=t}set sizes(e){let t=Math.min(this._slices,e.length);for(let r=0;r<t;r++)this._sizes[r]=e[r]}get sizes(){return this._sizes}set offsets(e){let t=Math.min(this._slices,e.length);for(let r=0;r<t;r++)this._offsets[r]=e[r]}get offsets(){return this._offsets}get slices(){return this._slices}set slices(e){this._slices!==e&&(this._slices=e,this.uniforms.slices=e,this._sizes=this.uniforms.slicesWidth=new Float32Array(e),this._offsets=this.uniforms.slicesOffset=new Float32Array(e),this.refresh())}get direction(){return this._direction}set direction(e){if(this._direction===e)return;this._direction=e;let t=e*nF;this.uniforms.sinDir=Math.sin(t),this.uniforms.cosDir=Math.cos(t)}get red(){return this.uniforms.red}set red(e){this.uniforms.red=e}get green(){return this.uniforms.green}set green(e){this.uniforms.green=e}get blue(){return this.uniforms.blue}set blue(e){this.uniforms.blue=e}destroy(){var e;null==(e=this.texture)||e.destroy(!0),this.texture=this._canvas=this.red=this.green=this.blue=this._sizes=this._offsets=null}};a_.defaults={slices:5,offset:100,direction:0,fillMode:0,average:!1,seed:0,red:[0,0],green:[0,0],blue:[0,0],minSize:8,sampleSize:512},a_.TRANSPARENT=0,a_.ORIGINAL=1,a_.LOOP=2,a_.CLAMP=3,a_.MIRROR=4;/*!
 * @pixi/filter-glow - v5.2.1
 * Compiled Fri, 24 Mar 2023 22:12:11 UTC
 *
 * @pixi/filter-glow is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ax=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,ab=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

uniform float outerStrength;
uniform float innerStrength;

uniform vec4 glowColor;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform bool knockout;
uniform float alpha;

const float PI = 3.14159265358979323846264;

const float DIST = __DIST__;
const float ANGLE_STEP_SIZE = min(__ANGLE_STEP_SIZE__, PI * 2.0);
const float ANGLE_STEP_NUM = ceil(PI * 2.0 / ANGLE_STEP_SIZE);

const float MAX_TOTAL_ALPHA = ANGLE_STEP_NUM * DIST * (DIST + 1.0) / 2.0;

void main(void) {
    vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);

    float totalAlpha = 0.0;

    vec2 direction;
    vec2 displaced;
    vec4 curColor;

    for (float angle = 0.0; angle < PI * 2.0; angle += ANGLE_STEP_SIZE) {
       direction = vec2(cos(angle), sin(angle)) * px;

       for (float curDistance = 0.0; curDistance < DIST; curDistance++) {
           displaced = clamp(vTextureCoord + direction * 
                   (curDistance + 1.0), filterClamp.xy, filterClamp.zw);

           curColor = texture2D(uSampler, displaced);

           totalAlpha += (DIST - curDistance) * curColor.a;
       }
    }
    
    curColor = texture2D(uSampler, vTextureCoord);

    float alphaRatio = (totalAlpha / MAX_TOTAL_ALPHA);

    float innerGlowAlpha = (1.0 - alphaRatio) * innerStrength * curColor.a;
    float innerGlowStrength = min(1.0, innerGlowAlpha);
    
    vec4 innerColor = mix(curColor, glowColor, innerGlowStrength);

    float outerGlowAlpha = alphaRatio * outerStrength * (1. - curColor.a);
    float outerGlowStrength = min(1.0 - innerColor.a, outerGlowAlpha);

    if (knockout) {
      float resultAlpha = (outerGlowAlpha + innerGlowAlpha) * alpha;
      gl_FragColor = vec4(glowColor.rgb * resultAlpha, resultAlpha);
    }
    else {
      vec4 outerGlowColor = outerGlowStrength * glowColor.rgba * alpha;
      gl_FragColor = innerColor + outerGlowColor;
    }
}
`;const aT=class extends sT{constructor(e){let t=Object.assign({},aT.defaults,e),{outerStrength:r,innerStrength:i,color:n,knockout:s,quality:o,alpha:a}=t,l=Math.round(t.distance);super(ax,ab.replace(/__ANGLE_STEP_SIZE__/gi,`${(1/o/l).toFixed(7)}`).replace(/__DIST__/gi,`${l.toFixed(0)}.0`)),this.uniforms.glowColor=new Float32Array([0,0,0,1]),this.uniforms.alpha=1,Object.assign(this,{color:n,outerStrength:r,innerStrength:i,padding:l,knockout:s,alpha:a})}get color(){return rl.rgb2hex(this.uniforms.glowColor)}set color(e){rl.hex2rgb(e,this.uniforms.glowColor)}get outerStrength(){return this.uniforms.outerStrength}set outerStrength(e){this.uniforms.outerStrength=e}get innerStrength(){return this.uniforms.innerStrength}set innerStrength(e){this.uniforms.innerStrength=e}get knockout(){return this.uniforms.knockout}set knockout(e){this.uniforms.knockout=e}get alpha(){return this.uniforms.alpha}set alpha(e){this.uniforms.alpha=e}};aT.defaults={distance:10,outerStrength:4,innerStrength:0,color:16777215,quality:.1,knockout:!1,alpha:1};/*!
 * @pixi/filter-godray - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-godray is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var aA=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aE=`vec3 mod289(vec3 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 mod289(vec4 x)
{
    return x - floor(x * (1.0 / 289.0)) * 289.0;
}
vec4 permute(vec4 x)
{
    return mod289(((x * 34.0) + 1.0) * x);
}
vec4 taylorInvSqrt(vec4 r)
{
    return 1.79284291400159 - 0.85373472095314 * r;
}
vec3 fade(vec3 t)
{
    return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);
}
// Classic Perlin noise, periodic variant
float pnoise(vec3 P, vec3 rep)
{
    vec3 Pi0 = mod(floor(P), rep); // Integer part, modulo period
    vec3 Pi1 = mod(Pi0 + vec3(1.0), rep); // Integer part + 1, mod period
    Pi0 = mod289(Pi0);
    Pi1 = mod289(Pi1);
    vec3 Pf0 = fract(P); // Fractional part for interpolation
    vec3 Pf1 = Pf0 - vec3(1.0); // Fractional part - 1.0
    vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);
    vec4 iy = vec4(Pi0.yy, Pi1.yy);
    vec4 iz0 = Pi0.zzzz;
    vec4 iz1 = Pi1.zzzz;
    vec4 ixy = permute(permute(ix) + iy);
    vec4 ixy0 = permute(ixy + iz0);
    vec4 ixy1 = permute(ixy + iz1);
    vec4 gx0 = ixy0 * (1.0 / 7.0);
    vec4 gy0 = fract(floor(gx0) * (1.0 / 7.0)) - 0.5;
    gx0 = fract(gx0);
    vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);
    vec4 sz0 = step(gz0, vec4(0.0));
    gx0 -= sz0 * (step(0.0, gx0) - 0.5);
    gy0 -= sz0 * (step(0.0, gy0) - 0.5);
    vec4 gx1 = ixy1 * (1.0 / 7.0);
    vec4 gy1 = fract(floor(gx1) * (1.0 / 7.0)) - 0.5;
    gx1 = fract(gx1);
    vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);
    vec4 sz1 = step(gz1, vec4(0.0));
    gx1 -= sz1 * (step(0.0, gx1) - 0.5);
    gy1 -= sz1 * (step(0.0, gy1) - 0.5);
    vec3 g000 = vec3(gx0.x, gy0.x, gz0.x);
    vec3 g100 = vec3(gx0.y, gy0.y, gz0.y);
    vec3 g010 = vec3(gx0.z, gy0.z, gz0.z);
    vec3 g110 = vec3(gx0.w, gy0.w, gz0.w);
    vec3 g001 = vec3(gx1.x, gy1.x, gz1.x);
    vec3 g101 = vec3(gx1.y, gy1.y, gz1.y);
    vec3 g011 = vec3(gx1.z, gy1.z, gz1.z);
    vec3 g111 = vec3(gx1.w, gy1.w, gz1.w);
    vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));
    g000 *= norm0.x;
    g010 *= norm0.y;
    g100 *= norm0.z;
    g110 *= norm0.w;
    vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));
    g001 *= norm1.x;
    g011 *= norm1.y;
    g101 *= norm1.z;
    g111 *= norm1.w;
    float n000 = dot(g000, Pf0);
    float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));
    float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));
    float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));
    float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));
    float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));
    float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));
    float n111 = dot(g111, Pf1);
    vec3 fade_xyz = fade(Pf0);
    vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);
    vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);
    float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x);
    return 2.2 * n_xyz;
}
float turb(vec3 P, vec3 rep, float lacunarity, float gain)
{
    float sum = 0.0;
    float sc = 1.0;
    float totalgain = 1.0;
    for (float i = 0.0; i < 6.0; i++)
    {
        sum += totalgain * pnoise(P * sc, rep);
        sc *= lacunarity;
        totalgain *= gain;
    }
    return abs(sum);
}
`,aw=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform vec2 light;
uniform bool parallel;
uniform float aspect;

uniform float gain;
uniform float lacunarity;
uniform float time;
uniform float alpha;

\${perlin}

void main(void) {
    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    float d;

    if (parallel) {
        float _cos = light.x;
        float _sin = light.y;
        d = (_cos * coord.x) + (_sin * coord.y * aspect);
    } else {
        float dx = coord.x - light.x / dimensions.x;
        float dy = (coord.y - light.y / dimensions.y) * aspect;
        float dis = sqrt(dx * dx + dy * dy) + 0.00001;
        d = dy / dis;
    }

    vec3 dir = vec3(d, d, 0.0);

    float noise = turb(dir + vec3(time, 0.0, 62.1 + time) * 0.05, vec3(480.0, 320.0, 480.0), lacunarity, gain);
    noise = mix(noise, 0.0, 0.3);
    //fade vertically.
    vec4 mist = vec4(noise, noise, noise, 1.0) * (1.0 - coord.y);
    mist.a = 1.0;
    // apply user alpha
    mist *= alpha;

    gl_FragColor = texture2D(uSampler, vTextureCoord) + mist;

}
`;const aC=class extends sT{constructor(e){super(aA,aw.replace("${perlin}",aE)),this.parallel=!0,this.time=0,this._angle=0,this.uniforms.dimensions=new Float32Array(2);let t=Object.assign(aC.defaults,e);this._angleLight=new nL,this.angle=t.angle,this.gain=t.gain,this.lacunarity=t.lacunarity,this.alpha=t.alpha,this.parallel=t.parallel,this.center=t.center,this.time=t.time}apply(e,t,r,i){let{width:n,height:s}=t.filterFrame;this.uniforms.light=this.parallel?this._angleLight:this.center,this.uniforms.parallel=this.parallel,this.uniforms.dimensions[0]=n,this.uniforms.dimensions[1]=s,this.uniforms.aspect=s/n,this.uniforms.time=this.time,this.uniforms.alpha=this.alpha,e.applyFilter(this,t,r,i)}get angle(){return this._angle}set angle(e){this._angle=e;let t=e*nF;this._angleLight.x=Math.cos(t),this._angleLight.y=Math.sin(t)}get gain(){return this.uniforms.gain}set gain(e){this.uniforms.gain=e}get lacunarity(){return this.uniforms.lacunarity}set lacunarity(e){this.uniforms.lacunarity=e}get alpha(){return this.uniforms.alpha}set alpha(e){this.uniforms.alpha=e}};aC.defaults={angle:30,gain:.5,lacunarity:2.5,time:0,parallel:!0,center:[0,0],alpha:1};/*!
 * @pixi/filter-hsl-adjustment - v5.2.0
 * Compiled Tue, 28 Feb 2023 14:24:35 UTC
 *
 * @pixi/filter-hsl-adjustment is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var aS=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aI=`precision mediump float;

varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float uHue;
uniform float uAlpha;
uniform bool uColorize;
uniform float uSaturation;
uniform float uLightness;

// https://en.wikipedia.org/wiki/Luma_(video)
const vec3 weight = vec3(0.299, 0.587, 0.114);

float getWeightedAverage(vec3 rgb) {
    return rgb.r * weight.r + rgb.g * weight.g + rgb.b * weight.b;
}

// https://gist.github.com/mairod/a75e7b44f68110e1576d77419d608786?permalink_comment_id=3195243#gistcomment-3195243
const vec3 k = vec3(0.57735, 0.57735, 0.57735);

vec3 hueShift(vec3 color, float angle) {
    float cosAngle = cos(angle);
    return vec3(
    color * cosAngle +
    cross(k, color) * sin(angle) +
    k * dot(k, color) * (1.0 - cosAngle)
    );
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    vec4 result = color;

    // colorize
    if (uColorize) {
        result.rgb = vec3(getWeightedAverage(result.rgb), 0., 0.);
    }

    // hue
    result.rgb = hueShift(result.rgb, uHue);

    // saturation
    // https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/huesaturation.js
    float average = (result.r + result.g + result.b) / 3.0;

    if (uSaturation > 0.) {
        result.rgb += (average - result.rgb) * (1. - 1. / (1.001 - uSaturation));
    } else {
        result.rgb -= (average - result.rgb) * uSaturation;
    }

    // lightness
    result.rgb = mix(result.rgb, vec3(ceil(uLightness)) * color.a, abs(uLightness));

    // alpha
    gl_FragColor = mix(color, result, uAlpha);
}
`;const aR=class extends sT{constructor(e){super(aS,aI),this._hue=0,Object.assign(this,Object.assign({},aR.defaults,e))}get hue(){return this._hue}set hue(e){this._hue=e,this.uniforms.uHue=this._hue*(Math.PI/180)}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}get colorize(){return this.uniforms.uColorize}set colorize(e){this.uniforms.uColorize=e}get lightness(){return this.uniforms.uLightness}set lightness(e){this.uniforms.uLightness=e}get saturation(){return this.uniforms.uSaturation}set saturation(e){this.uniforms.uSaturation=e}};aR.defaults={hue:0,saturation:0,lightness:0,colorize:!1,alpha:1};/*!
 * @pixi/filter-motion-blur - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-motion-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var aM=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aP=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uVelocity;
uniform int uKernelSize;
uniform float uOffset;

const int MAX_KERNEL_SIZE = 2048;

// Notice:
// the perfect way:
//    int kernelSize = min(uKernelSize, MAX_KERNELSIZE);
// BUT in real use-case , uKernelSize < MAX_KERNELSIZE almost always.
// So use uKernelSize directly.

void main(void)
{
    vec4 color = texture2D(uSampler, vTextureCoord);

    if (uKernelSize == 0)
    {
        gl_FragColor = color;
        return;
    }

    vec2 velocity = uVelocity / filterArea.xy;
    float offset = -uOffset / length(uVelocity) - 0.5;
    int k = uKernelSize - 1;

    for(int i = 0; i < MAX_KERNEL_SIZE - 1; i++) {
        if (i == k) {
            break;
        }
        vec2 bias = velocity * (float(i) / float(k) + offset);
        color += texture2D(uSampler, vTextureCoord + bias);
    }
    gl_FragColor = color / float(uKernelSize);
}
`;class aO extends sT{constructor(e=[0,0],t=5,r=0){super(aM,aP),this.kernelSize=5,this.uniforms.uVelocity=new Float32Array(2),this._velocity=new nJ(this.velocityChanged,this),this.setVelocity(e),this.kernelSize=t,this.offset=r}apply(e,t,r,i){let{x:n,y:s}=this.velocity;this.uniforms.uKernelSize=0!==n||0!==s?this.kernelSize:0,e.applyFilter(this,t,r,i)}set velocity(e){this.setVelocity(e)}get velocity(){return this._velocity}setVelocity(e){if(Array.isArray(e)){let[t,r]=e;this._velocity.set(t,r)}else this._velocity.copyFrom(e)}velocityChanged(){this.uniforms.uVelocity[0]=this._velocity.x,this.uniforms.uVelocity[1]=this._velocity.y,this.padding=(Math.max(Math.abs(this._velocity.x),Math.abs(this._velocity.y))>>0)+1}set offset(e){this.uniforms.uOffset=e}get offset(){return this.uniforms.uOffset}}/*!
 * @pixi/filter-old-film - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-old-film is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var aD=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aN=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 dimensions;

uniform float sepia;
uniform float noise;
uniform float noiseSize;
uniform float scratch;
uniform float scratchDensity;
uniform float scratchWidth;
uniform float vignetting;
uniform float vignettingAlpha;
uniform float vignettingBlur;
uniform float seed;

const float SQRT_2 = 1.414213;
const vec3 SEPIA_RGB = vec3(112.0 / 255.0, 66.0 / 255.0, 20.0 / 255.0);

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

vec3 Overlay(vec3 src, vec3 dst)
{
    // if (dst <= 0.5) then: 2 * src * dst
    // if (dst > 0.5) then: 1 - 2 * (1 - dst) * (1 - src)
    return vec3((dst.x <= 0.5) ? (2.0 * src.x * dst.x) : (1.0 - 2.0 * (1.0 - dst.x) * (1.0 - src.x)),
                (dst.y <= 0.5) ? (2.0 * src.y * dst.y) : (1.0 - 2.0 * (1.0 - dst.y) * (1.0 - src.y)),
                (dst.z <= 0.5) ? (2.0 * src.z * dst.z) : (1.0 - 2.0 * (1.0 - dst.z) * (1.0 - src.z)));
}


void main()
{
    gl_FragColor = texture2D(uSampler, vTextureCoord);
    vec3 color = gl_FragColor.rgb;

    if (sepia > 0.0)
    {
        float gray = (color.x + color.y + color.z) / 3.0;
        vec3 grayscale = vec3(gray);

        color = Overlay(SEPIA_RGB, grayscale);

        color = grayscale + sepia * (color - grayscale);
    }

    vec2 coord = vTextureCoord * filterArea.xy / dimensions.xy;

    if (vignetting > 0.0)
    {
        float outter = SQRT_2 - vignetting * SQRT_2;
        vec2 dir = vec2(vec2(0.5, 0.5) - coord);
        dir.y *= dimensions.y / dimensions.x;
        float darker = clamp((outter - length(dir) * SQRT_2) / ( 0.00001 + vignettingBlur * SQRT_2), 0.0, 1.0);
        color.rgb *= darker + (1.0 - darker) * (1.0 - vignettingAlpha);
    }

    if (scratchDensity > seed && scratch != 0.0)
    {
        float phase = seed * 256.0;
        float s = mod(floor(phase), 2.0);
        float dist = 1.0 / scratchDensity;
        float d = distance(coord, vec2(seed * dist, abs(s - seed * dist)));
        if (d < seed * 0.6 + 0.4)
        {
            highp float period = scratchDensity * 10.0;

            float xx = coord.x * period + phase;
            float aa = abs(mod(xx, 0.5) * 4.0);
            float bb = mod(floor(xx / 0.5), 2.0);
            float yy = (1.0 - bb) * aa + bb * (2.0 - aa);

            float kk = 2.0 * period;
            float dw = scratchWidth / dimensions.x * (0.75 + seed);
            float dh = dw * kk;

            float tine = (yy - (2.0 - dh));

            if (tine > 0.0) {
                float _sign = sign(scratch);

                tine = s * tine / period + scratch + 0.1;
                tine = clamp(tine + 1.0, 0.5 + _sign * 0.5, 1.5 + _sign * 0.5);

                color.rgb *= tine;
            }
        }
    }

    if (noise > 0.0 && noiseSize > 0.0)
    {
        vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
        pixelCoord.x = floor(pixelCoord.x / noiseSize);
        pixelCoord.y = floor(pixelCoord.y / noiseSize);
        // vec2 d = pixelCoord * noiseSize * vec2(1024.0 + seed * 512.0, 1024.0 - seed * 512.0);
        // float _noise = snoise(d) * 0.5;
        float _noise = rand(pixelCoord * noiseSize * seed) - 0.5;
        color += _noise * noise;
    }

    gl_FragColor.rgb = color;
}
`;const aF=class extends sT{constructor(e,t=0){super(aD,aN),this.seed=0,this.uniforms.dimensions=new Float32Array(2),"number"==typeof e?(this.seed=e,e=void 0):this.seed=t,Object.assign(this,aF.defaults,e)}apply(e,t,r,i){var n,s;this.uniforms.dimensions[0]=null==(n=t.filterFrame)?void 0:n.width,this.uniforms.dimensions[1]=null==(s=t.filterFrame)?void 0:s.height,this.uniforms.seed=this.seed,e.applyFilter(this,t,r,i)}set sepia(e){this.uniforms.sepia=e}get sepia(){return this.uniforms.sepia}set noise(e){this.uniforms.noise=e}get noise(){return this.uniforms.noise}set noiseSize(e){this.uniforms.noiseSize=e}get noiseSize(){return this.uniforms.noiseSize}set scratch(e){this.uniforms.scratch=e}get scratch(){return this.uniforms.scratch}set scratchDensity(e){this.uniforms.scratchDensity=e}get scratchDensity(){return this.uniforms.scratchDensity}set scratchWidth(e){this.uniforms.scratchWidth=e}get scratchWidth(){return this.uniforms.scratchWidth}set vignetting(e){this.uniforms.vignetting=e}get vignetting(){return this.uniforms.vignetting}set vignettingAlpha(e){this.uniforms.vignettingAlpha=e}get vignettingAlpha(){return this.uniforms.vignettingAlpha}set vignettingBlur(e){this.uniforms.vignettingBlur=e}get vignettingBlur(){return this.uniforms.vignettingBlur}};aF.defaults={sepia:.3,noise:.3,noiseSize:1,scratch:.5,scratchDensity:.3,scratchWidth:1,vignetting:.3,vignettingAlpha:1,vignettingBlur:.3};/*!
 * @pixi/filter-outline - v5.2.0
 * Compiled Tue, 28 Feb 2023 14:24:35 UTC
 *
 * @pixi/filter-outline is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var aB=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aL=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterClamp;

uniform float uAlpha;
uniform vec2 uThickness;
uniform vec4 uColor;
uniform bool uKnockout;

const float DOUBLE_PI = 2. * 3.14159265358979323846264;
const float ANGLE_STEP = \${angleStep};

float outlineMaxAlphaAtPos(vec2 pos) {
    if (uThickness.x == 0. || uThickness.y == 0.) {
        return 0.;
    }

    vec4 displacedColor;
    vec2 displacedPos;
    float maxAlpha = 0.;

    for (float angle = 0.; angle <= DOUBLE_PI; angle += ANGLE_STEP) {
        displacedPos.x = vTextureCoord.x + uThickness.x * cos(angle);
        displacedPos.y = vTextureCoord.y + uThickness.y * sin(angle);
        displacedColor = texture2D(uSampler, clamp(displacedPos, filterClamp.xy, filterClamp.zw));
        maxAlpha = max(maxAlpha, displacedColor.a);
    }

    return maxAlpha;
}

void main(void) {
    vec4 sourceColor = texture2D(uSampler, vTextureCoord);
    vec4 contentColor = sourceColor * float(!uKnockout);
    float outlineAlpha = uAlpha * outlineMaxAlphaAtPos(vTextureCoord.xy) * (1.-sourceColor.a);
    vec4 outlineColor = vec4(vec3(uColor) * outlineAlpha, outlineAlpha);
    gl_FragColor = contentColor + outlineColor;
}
`;const ak=class extends sT{constructor(e=1,t=0,r=.1,i=1,n=!1){super(aB,aL.replace(/\$\{angleStep\}/,ak.getAngleStep(r))),this._thickness=1,this._alpha=1,this._knockout=!1,this.uniforms.uThickness=new Float32Array([0,0]),this.uniforms.uColor=new Float32Array([0,0,0,1]),this.uniforms.uAlpha=i,this.uniforms.uKnockout=n,Object.assign(this,{thickness:e,color:t,quality:r,alpha:i,knockout:n})}static getAngleStep(e){return(2*Math.PI/Math.max(e*ak.MAX_SAMPLES,ak.MIN_SAMPLES)).toFixed(7)}apply(e,t,r,i){this.uniforms.uThickness[0]=this._thickness/t._frame.width,this.uniforms.uThickness[1]=this._thickness/t._frame.height,this.uniforms.uAlpha=this._alpha,this.uniforms.uKnockout=this._knockout,e.applyFilter(this,t,r,i)}get alpha(){return this._alpha}set alpha(e){this._alpha=e}get color(){return rl.rgb2hex(this.uniforms.uColor)}set color(e){rl.hex2rgb(e,this.uniforms.uColor)}get knockout(){return this._knockout}set knockout(e){this._knockout=e}get thickness(){return this._thickness}set thickness(e){this._thickness=e,this.padding=e}};ak.MIN_SAMPLES=1,ak.MAX_SAMPLES=100;/*!
 * @pixi/filter-reflection - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-reflection is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var aU=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aG=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;

uniform vec4 filterArea;
uniform vec4 filterClamp;
uniform vec2 dimensions;

uniform bool mirror;
uniform float boundary;
uniform vec2 amplitude;
uniform vec2 waveLength;
uniform vec2 alpha;
uniform float time;

float rand(vec2 co) {
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main(void)
{
    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;
    vec2 coord = pixelCoord / dimensions;

    if (coord.y < boundary) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    float k = (coord.y - boundary) / (1. - boundary + 0.0001);
    float areaY = boundary * dimensions.y / filterArea.y;
    float v = areaY + areaY - vTextureCoord.y;
    float y = mirror ? v : vTextureCoord.y;

    float _amplitude = ((amplitude.y - amplitude.x) * k + amplitude.x ) / filterArea.x;
    float _waveLength = ((waveLength.y - waveLength.x) * k + waveLength.x) / filterArea.y;
    float _alpha = (alpha.y - alpha.x) * k + alpha.x;

    float x = vTextureCoord.x + cos(v * 6.28 / _waveLength - time) * _amplitude;
    x = clamp(x, filterClamp.x, filterClamp.z);

    vec4 color = texture2D(uSampler, vec2(x, y));

    gl_FragColor = color * _alpha;
}
`;const az=class extends sT{constructor(e){super(aU,aG),this.time=0,this.uniforms.amplitude=new Float32Array(2),this.uniforms.waveLength=new Float32Array(2),this.uniforms.alpha=new Float32Array(2),this.uniforms.dimensions=new Float32Array(2),Object.assign(this,az.defaults,e)}apply(e,t,r,i){var n,s;this.uniforms.dimensions[0]=null==(n=t.filterFrame)?void 0:n.width,this.uniforms.dimensions[1]=null==(s=t.filterFrame)?void 0:s.height,this.uniforms.time=this.time,e.applyFilter(this,t,r,i)}set mirror(e){this.uniforms.mirror=e}get mirror(){return this.uniforms.mirror}set boundary(e){this.uniforms.boundary=e}get boundary(){return this.uniforms.boundary}set amplitude(e){this.uniforms.amplitude[0]=e[0],this.uniforms.amplitude[1]=e[1]}get amplitude(){return this.uniforms.amplitude}set waveLength(e){this.uniforms.waveLength[0]=e[0],this.uniforms.waveLength[1]=e[1]}get waveLength(){return this.uniforms.waveLength}set alpha(e){this.uniforms.alpha[0]=e[0],this.uniforms.alpha[1]=e[1]}get alpha(){return this.uniforms.alpha}};az.defaults={mirror:!0,boundary:.5,amplitude:[0,20],waveLength:[30,100],alpha:[1,1],time:0};/*!
 * @pixi/filter-rgb-split - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-rgb-split is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var aj=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aH=`precision mediump float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec2 red;
uniform vec2 green;
uniform vec2 blue;

void main(void)
{
   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/filterArea.xy).r;
   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/filterArea.xy).g;
   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/filterArea.xy).b;
   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;
}
`;class aV extends sT{constructor(e=[-10,0],t=[0,10],r=[0,0]){super(aj,aH),this.red=e,this.green=t,this.blue=r}get red(){return this.uniforms.red}set red(e){this.uniforms.red=e}get green(){return this.uniforms.green}set green(e){this.uniforms.green=e}get blue(){return this.uniforms.blue}set blue(e){this.uniforms.blue=e}}/*!
 * @pixi/filter-shockwave - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-shockwave is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var aX=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aW=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;
uniform vec4 filterClamp;

uniform vec2 center;

uniform float amplitude;
uniform float wavelength;
// uniform float power;
uniform float brightness;
uniform float speed;
uniform float radius;

uniform float time;

const float PI = 3.14159;

void main()
{
    float halfWavelength = wavelength * 0.5 / filterArea.x;
    float maxRadius = radius / filterArea.x;
    float currentRadius = time * speed / filterArea.x;

    float fade = 1.0;

    if (maxRadius > 0.0) {
        if (currentRadius > maxRadius) {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
        fade = 1.0 - pow(currentRadius / maxRadius, 2.0);
    }

    vec2 dir = vec2(vTextureCoord - center / filterArea.xy);
    dir.y *= filterArea.y / filterArea.x;
    float dist = length(dir);

    if (dist <= 0.0 || dist < currentRadius - halfWavelength || dist > currentRadius + halfWavelength) {
        gl_FragColor = texture2D(uSampler, vTextureCoord);
        return;
    }

    vec2 diffUV = normalize(dir);

    float diff = (dist - currentRadius) / halfWavelength;

    float p = 1.0 - pow(abs(diff), 2.0);

    // float powDiff = diff * pow(p, 2.0) * ( amplitude * fade );
    float powDiff = 1.25 * sin(diff * PI) * p * ( amplitude * fade );

    vec2 offset = diffUV * powDiff / filterArea.xy;

    // Do clamp :
    vec2 coord = vTextureCoord + offset;
    vec2 clampedCoord = clamp(coord, filterClamp.xy, filterClamp.zw);
    vec4 color = texture2D(uSampler, clampedCoord);
    if (coord != clampedCoord) {
        color *= max(0.0, 1.0 - length(coord - clampedCoord));
    }

    // No clamp :
    // gl_FragColor = texture2D(uSampler, vTextureCoord + offset);

    color.rgb *= 1.0 + (brightness - 1.0) * p * fade;

    gl_FragColor = color;
}
`;const a$=class extends sT{constructor(e=[0,0],t,r=0){super(aX,aW),this.center=e,Object.assign(this,a$.defaults,t),this.time=r}apply(e,t,r,i){this.uniforms.time=this.time,e.applyFilter(this,t,r,i)}get center(){return this.uniforms.center}set center(e){this.uniforms.center=e}get amplitude(){return this.uniforms.amplitude}set amplitude(e){this.uniforms.amplitude=e}get wavelength(){return this.uniforms.wavelength}set wavelength(e){this.uniforms.wavelength=e}get brightness(){return this.uniforms.brightness}set brightness(e){this.uniforms.brightness=e}get speed(){return this.uniforms.speed}set speed(e){this.uniforms.speed=e}get radius(){return this.uniforms.radius}set radius(e){this.uniforms.radius=e}};a$.defaults={amplitude:30,wavelength:160,brightness:1,speed:500,radius:-1};/*!
 * @pixi/filter-tilt-shift - v5.2.0
 * Compiled Tue, 28 Feb 2023 14:24:35 UTC
 *
 * @pixi/filter-tilt-shift is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var aY=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,aq=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float blur;
uniform float gradientBlur;
uniform vec2 start;
uniform vec2 end;
uniform vec2 delta;
uniform vec2 texSize;

float random(vec3 scale, float seed)
{
    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
}

void main(void)
{
    vec4 color = vec4(0.0);
    float total = 0.0;

    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);
    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));
    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;

    for (float t = -30.0; t <= 30.0; t++)
    {
        float percent = (t + offset - 0.5) / 30.0;
        float weight = 1.0 - abs(percent);
        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);
        sample.rgb *= sample.a;
        color += sample * weight;
        total += weight;
    }

    color /= total;
    color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`;class aZ extends sT{constructor(e){var t,r;super(aY,aq),this.uniforms.blur=e.blur,this.uniforms.gradientBlur=e.gradientBlur,this.uniforms.start=null!=(t=e.start)?t:new nL(0,window.innerHeight/2),this.uniforms.end=null!=(r=e.end)?r:new nL(600,window.innerHeight/2),this.uniforms.delta=new nL(30,30),this.uniforms.texSize=new nL(window.innerWidth,window.innerHeight),this.updateDelta()}updateDelta(){this.uniforms.delta.x=0,this.uniforms.delta.y=0}get blur(){return this.uniforms.blur}set blur(e){this.uniforms.blur=e}get gradientBlur(){return this.uniforms.gradientBlur}set gradientBlur(e){this.uniforms.gradientBlur=e}get start(){return this.uniforms.start}set start(e){this.uniforms.start=e,this.updateDelta()}get end(){return this.uniforms.end}set end(e){this.uniforms.end=e,this.updateDelta()}}class aK extends aZ{updateDelta(){let e=this.uniforms.end.x-this.uniforms.start.x,t=this.uniforms.end.y-this.uniforms.start.y,r=Math.sqrt(e*e+t*t);this.uniforms.delta.x=e/r,this.uniforms.delta.y=t/r}}class aQ extends aZ{updateDelta(){let e=this.uniforms.end.x-this.uniforms.start.x,t=this.uniforms.end.y-this.uniforms.start.y,r=Math.sqrt(e*e+t*t);this.uniforms.delta.x=-t/r,this.uniforms.delta.y=e/r}}const aJ=class extends sT{constructor(e,t,r,i){super(),"number"==typeof e&&(rl.deprecation("5.3.0","TiltShiftFilter constructor arguments is deprecated, use options."),e={blur:e,gradientBlur:t,start:r,end:i}),e=Object.assign({},aJ.defaults,e),this.tiltShiftXFilter=new aK(e),this.tiltShiftYFilter=new aQ(e)}apply(e,t,r,i){let n=e.getFilterTexture();this.tiltShiftXFilter.apply(e,t,n,1),this.tiltShiftYFilter.apply(e,n,r,i),e.returnFilterTexture(n)}get blur(){return this.tiltShiftXFilter.blur}set blur(e){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=e}get gradientBlur(){return this.tiltShiftXFilter.gradientBlur}set gradientBlur(e){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=e}get start(){return this.tiltShiftXFilter.start}set start(e){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=e}get end(){return this.tiltShiftXFilter.end}set end(e){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=e}};aJ.defaults={blur:100,gradientBlur:600,start:void 0,end:void 0};/*!
 * @pixi/filter-twist - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-twist is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var a0=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,a1=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform vec4 filterArea;

vec2 mapCoord( vec2 coord )
{
    coord *= filterArea.xy;
    coord += filterArea.zw;

    return coord;
}

vec2 unmapCoord( vec2 coord )
{
    coord -= filterArea.zw;
    coord /= filterArea.xy;

    return coord;
}

vec2 twist(vec2 coord)
{
    coord -= offset;

    float dist = length(coord);

    if (dist < radius)
    {
        float ratioDist = (radius - dist) / radius;
        float angleMod = ratioDist * ratioDist * angle;
        float s = sin(angleMod);
        float c = cos(angleMod);
        coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);
    }

    coord += offset;

    return coord;
}

void main(void)
{

    vec2 coord = mapCoord(vTextureCoord);

    coord = twist(coord);

    coord = unmapCoord(coord);

    gl_FragColor = texture2D(uSampler, coord );

}
`;const a2=class extends sT{constructor(e){super(a0,a1),Object.assign(this,a2.defaults,e)}get offset(){return this.uniforms.offset}set offset(e){this.uniforms.offset=e}get radius(){return this.uniforms.radius}set radius(e){this.uniforms.radius=e}get angle(){return this.uniforms.angle}set angle(e){this.uniforms.angle=e}};a2.defaults={radius:200,angle:4,padding:20,offset:new nL};/*!
 * @pixi/filter-zoom-blur - v5.1.1
 * Compiled Wed, 11 Jan 2023 23:10:33 UTC
 *
 * @pixi/filter-zoom-blur is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var a3=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,a4=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec4 filterArea;

uniform vec2 uCenter;
uniform float uStrength;
uniform float uInnerRadius;
uniform float uRadius;

const float MAX_KERNEL_SIZE = \${maxKernelSize};

// author: http://byteblacksmith.com/improvements-to-the-canonical-one-liner-glsl-rand-for-opengl-es-2-0/
highp float rand(vec2 co, float seed) {
    const highp float a = 12.9898, b = 78.233, c = 43758.5453;
    highp float dt = dot(co + seed, vec2(a, b)), sn = mod(dt, 3.14159);
    return fract(sin(sn) * c + seed);
}

void main() {

    float minGradient = uInnerRadius * 0.3;
    float innerRadius = (uInnerRadius + minGradient * 0.5) / filterArea.x;

    float gradient = uRadius * 0.3;
    float radius = (uRadius - gradient * 0.5) / filterArea.x;

    float countLimit = MAX_KERNEL_SIZE;

    vec2 dir = vec2(uCenter.xy / filterArea.xy - vTextureCoord);
    float dist = length(vec2(dir.x, dir.y * filterArea.y / filterArea.x));

    float strength = uStrength;

    float delta = 0.0;
    float gap;
    if (dist < innerRadius) {
        delta = innerRadius - dist;
        gap = minGradient;
    } else if (radius >= 0.0 && dist > radius) { // radius < 0 means it's infinity
        delta = dist - radius;
        gap = gradient;
    }

    if (delta > 0.0) {
        float normalCount = gap / filterArea.x;
        delta = (normalCount - delta) / normalCount;
        countLimit *= delta;
        strength *= delta;
        if (countLimit < 1.0)
        {
            gl_FragColor = texture2D(uSampler, vTextureCoord);
            return;
        }
    }

    // randomize the lookup values to hide the fixed number of samples
    float offset = rand(vTextureCoord, 0.0);

    float total = 0.0;
    vec4 color = vec4(0.0);

    dir *= strength;

    for (float t = 0.0; t < MAX_KERNEL_SIZE; t++) {
        float percent = (t + offset) / MAX_KERNEL_SIZE;
        float weight = 4.0 * (percent - percent * percent);
        vec2 p = vTextureCoord + dir * percent;
        vec4 sample = texture2D(uSampler, p);

        // switch to pre-multiplied alpha to correctly blur transparent images
        // sample.rgb *= sample.a;

        color += sample * weight;
        total += weight;

        if (t > countLimit){
            break;
        }
    }

    color /= total;
    // switch back from pre-multiplied alpha
    // color.rgb /= color.a + 0.00001;

    gl_FragColor = color;
}
`,a5=Object.getOwnPropertySymbols,a8=Object.prototype.hasOwnProperty,a6=Object.prototype.propertyIsEnumerable,a7=(e,t)=>{var r={};for(var i in e)a8.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&a5)for(var i of a5(e))0>t.indexOf(i)&&a6.call(e,i)&&(r[i]=e[i]);return r};const a9=class extends sT{constructor(e){let t=Object.assign(a9.defaults,e),{maxKernelSize:r}=t,i=a7(t,["maxKernelSize"]);super(a3,a4.replace("${maxKernelSize}",r.toFixed(1))),Object.assign(this,i)}get center(){return this.uniforms.uCenter}set center(e){this.uniforms.uCenter=e}get strength(){return this.uniforms.uStrength}set strength(e){this.uniforms.uStrength=e}get innerRadius(){return this.uniforms.uInnerRadius}set innerRadius(e){this.uniforms.uInnerRadius=e}get radius(){return this.uniforms.uRadius}set radius(e){(e<0||e===1/0)&&(e=-1),this.uniforms.uRadius=e}};a9.defaults={strength:.1,center:[0,0],innerRadius:0,radius:-1,maxKernelSize:32};class le{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?nU.EMPTY:((e=e||new nU(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)}addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)}addPointMatrix(e,t){let{a:r,b:i,c:n,d:s,tx:o,ty:a}=e,l=r*t.x+n*t.y+o,h=i*t.x+s*t.y+a;this.minX=Math.min(this.minX,l),this.maxX=Math.max(this.maxX,l),this.minY=Math.min(this.minY,h),this.maxY=Math.max(this.maxY,h)}addQuad(e){let t=this.minX,r=this.minY,i=this.maxX,n=this.maxY,s=e[0],o=e[1];t=s<t?s:t,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,s=e[2],o=e[3],t=s<t?s:t,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,s=e[4],o=e[5],t=s<t?s:t,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,s=e[6],o=e[7],t=s<t?s:t,r=o<r?o:r,i=s>i?s:i,n=o>n?o:n,this.minX=t,this.minY=r,this.maxX=i,this.maxY=n}addFrame(e,t,r,i,n){this.addFrameMatrix(e.worldTransform,t,r,i,n)}addFrameMatrix(e,t,r,i,n){let s=e.a,o=e.b,a=e.c,l=e.d,h=e.tx,u=e.ty,c=this.minX,d=this.minY,f=this.maxX,p=this.maxY,m=s*t+a*r+h,g=o*t+l*r+u;c=m<c?m:c,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,m=s*i+a*r+h,g=o*i+l*r+u,c=m<c?m:c,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,m=s*t+a*n+h,g=o*t+l*n+u,c=m<c?m:c,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,m=s*i+a*n+h,g=o*i+l*n+u,c=m<c?m:c,d=g<d?g:d,f=m>f?m:f,p=g>p?g:p,this.minX=c,this.minY=d,this.maxX=f,this.maxY=p}addVertexData(e,t,r){let i=this.minX,n=this.minY,s=this.maxX,o=this.maxY;for(let a=t;a<r;a+=2){let t=e[a],r=e[a+1];i=t<i?t:i,n=r<n?r:n,s=t>s?t:s,o=r>o?r:o}this.minX=i,this.minY=n,this.maxX=s,this.maxY=o}addVertices(e,t,r,i){this.addVerticesMatrix(e.worldTransform,t,r,i)}addVerticesMatrix(e,t,r,i,n=0,s=n){let o=e.a,a=e.b,l=e.c,h=e.d,u=e.tx,c=e.ty,d=this.minX,f=this.minY,p=this.maxX,m=this.maxY;for(let e=r;e<i;e+=2){let r=t[e],i=t[e+1],g=o*r+l*i+u,v=h*i+a*r+c;d=Math.min(d,g-n),p=Math.max(p,g+n),f=Math.min(f,v-s),m=Math.max(m,v+s)}this.minX=d,this.minY=f,this.maxX=p,this.maxY=m}addBounds(e){let t=this.minX,r=this.minY,i=this.maxX,n=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<r?e.minY:r,this.maxX=e.maxX>i?e.maxX:i,this.maxY=e.maxY>n?e.maxY:n}addBoundsMask(e,t){let r=e.minX>t.minX?e.minX:t.minX,i=e.minY>t.minY?e.minY:t.minY,n=e.maxX<t.maxX?e.maxX:t.maxX,s=e.maxY<t.maxY?e.maxY:t.maxY;if(r<=n&&i<=s){let e=this.minX,t=this.minY,o=this.maxX,a=this.maxY;this.minX=r<e?r:e,this.minY=i<t?i:t,this.maxX=n>o?n:o,this.maxY=s>a?s:a}}addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)}addBoundsArea(e,t){let r=e.minX>t.x?e.minX:t.x,i=e.minY>t.y?e.minY:t.y,n=e.maxX<t.x+t.width?e.maxX:t.x+t.width,s=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(r<=n&&i<=s){let e=this.minX,t=this.minY,o=this.maxX,a=this.maxY;this.minX=r<e?r:e,this.minY=i<t?i:t,this.maxX=n>o?n:o,this.maxY=s>a?s:a}}pad(e=0,t=e){this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)}addFramePad(e,t,r,i,n,s){e-=n,t-=s,r+=n,i+=s,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>r?this.maxX:r,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>i?this.maxY:i}}class lt extends rl.EventEmitter{constructor(){super(),this.tempDisplayObjectParent=null,this.transform=new n0,this.alpha=1,this.visible=!0,this.renderable=!0,this.cullable=!1,this.cullArea=null,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new le,this._localBounds=null,this._boundsID=0,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._maskRefCount=0,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}static mixin(e){let t=Object.keys(e);for(let r=0;r<t.length;++r){let i=t[r];Object.defineProperty(lt.prototype,i,Object.getOwnPropertyDescriptor(e,i))}}get destroyed(){return this._destroyed}_recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)}updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha}getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new nU),t=this._boundsRect),this._bounds.getRectangle(t)}getLocalBounds(e){e||(this._localBoundsRect||(this._localBoundsRect=new nU),e=this._localBoundsRect),this._localBounds||(this._localBounds=new le);let t=this.transform,r=this.parent;this.parent=null,this._tempDisplayObjectParent.worldAlpha=r?.worldAlpha??1,this.transform=this._tempDisplayObjectParent.transform;let i=this._bounds,n=this._boundsID;this._bounds=this._localBounds;let s=this.getBounds(!1,e);return this.parent=r,this.transform=t,this._bounds=i,this._bounds.updateID+=this._boundsID-n,s}toGlobal(e,t,r=!1){return r||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)}toLocal(e,t,r,i){return t&&(e=t.toGlobal(e,r,i)),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,r)}setParent(e){if(!e||!e.addChild)throw Error("setParent: Argument must be a Container");return e.addChild(this),e}removeFromParent(){this.parent?.removeChild(this)}setTransform(e=0,t=0,r=1,i=1,n=0,s=0,o=0,a=0,l=0){return this.position.x=e,this.position.y=t,this.scale.x=r||1,this.scale.y=i||1,this.rotation=n,this.skew.x=s,this.skew.y=o,this.pivot.x=a,this.pivot.y=l,this}destroy(e){this.removeFromParent(),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.eventMode="auto",this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()}get _tempDisplayObjectParent(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new lr),this.tempDisplayObjectParent}enableTempParent(){let e=this.parent;return this.parent=this._tempDisplayObjectParent,e}disableTempParent(e){this.parent=e}get x(){return this.position.x}set x(e){this.transform.position.x=e}get y(){return this.position.y}set y(e){this.transform.position.y=e}get worldTransform(){return this.transform.worldTransform}get localTransform(){return this.transform.localTransform}get position(){return this.transform.position}set position(e){this.transform.position.copyFrom(e)}get scale(){return this.transform.scale}set scale(e){this.transform.scale.copyFrom(e)}get pivot(){return this.transform.pivot}set pivot(e){this.transform.pivot.copyFrom(e)}get skew(){return this.transform.skew}set skew(e){this.transform.skew.copyFrom(e)}get rotation(){return this.transform.rotation}set rotation(e){this.transform.rotation=e}get angle(){return this.transform.rotation*nN}set angle(e){this.transform.rotation=e*nF}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex!==e&&(this._zIndex=e,this.parent&&(this.parent.sortDirty=!0))}get worldVisible(){let e=this;do{if(!e.visible)return!1;e=e.parent}while(e)return!0}get mask(){return this._mask}set mask(e){if(this._mask!==e){if(this._mask){let e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(e._maskRefCount--,0===e._maskRefCount&&(e.renderable=!0,e.isMask=!1))}if(this._mask=e,this._mask){let e=this._mask.isMaskData?this._mask.maskObject:this._mask;e&&(0===e._maskRefCount&&(e.renderable=!1,e.isMask=!0),e._maskRefCount++)}}}}class lr extends lt{constructor(){super(...arguments),this.sortDirty=null}}lt.prototype.displayObjectUpdateTransform=lt.prototype.updateTransform;const li=new nV;function ln(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}const ls=class e extends lt{constructor(){super(),this.children=[],this.sortableChildren=e.defaultSortableChildren,this.sortDirty=!1}onChildrenChange(e){}addChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.addChild(e[t]);else{let t=e[0];t.parent&&t.parent.removeChild(t),t.parent=this,this.sortDirty=!0,t.transform._parentID=-1,this.children.push(t),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",t,this,this.children.length-1),t.emit("added",this)}return e[0]}addChildAt(e,t){if(t<0||t>this.children.length)throw Error(`${e}addChildAt: The index ${t} supplied is out of bounds ${this.children.length}`);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e}swapChildren(e,t){if(e===t)return;let r=this.getChildIndex(e),i=this.getChildIndex(t);this.children[r]=t,this.children[i]=e,this.onChildrenChange(r<i?r:i)}getChildIndex(e){let t=this.children.indexOf(e);if(-1===t)throw Error("The supplied DisplayObject must be a child of the caller");return t}setChildIndex(e,t){if(t<0||t>=this.children.length)throw Error(`The index ${t} supplied is out of bounds ${this.children.length}`);let r=this.getChildIndex(e);rl.removeItems(this.children,r,1),this.children.splice(t,0,e),this.onChildrenChange(t)}getChildAt(e){if(e<0||e>=this.children.length)throw Error(`getChildAt: Index (${e}) does not exist.`);return this.children[e]}removeChild(...e){if(e.length>1)for(let t=0;t<e.length;t++)this.removeChild(e[t]);else{let t=e[0],r=this.children.indexOf(t);if(-1===r)return null;t.parent=null,t.transform._parentID=-1,rl.removeItems(this.children,r,1),this._boundsID++,this.onChildrenChange(r),t.emit("removed",this),this.emit("childRemoved",t,this,r)}return e[0]}removeChildAt(e){let t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,rl.removeItems(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t}removeChildren(e=0,t=this.children.length){let r;let i=t-e;if(i>0&&i<=t){r=this.children.splice(e,i);for(let e=0;e<r.length;++e)r[e].parent=null,r[e].transform&&(r[e].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(let e=0;e<r.length;++e)r[e].emit("removed",this),this.emit("childRemoved",r[e],this,e);return r}if(0===i&&0===this.children.length)return[];throw RangeError("removeChildren: numeric values are outside the acceptable range.")}sortChildren(){let e=!1;for(let t=0,r=this.children.length;t<r;++t){let r=this.children[t];r._lastSortedIndex=t,e||0===r.zIndex||(e=!0)}e&&this.children.length>1&&this.children.sort(ln),this.sortDirty=!1}updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(let e=0,t=this.children.length;e<t;++e){let t=this.children[e];t.visible&&t.updateTransform()}}calculateBounds(){this._bounds.clear(),this._calculateBounds();for(let e=0;e<this.children.length;e++){let t=this.children[e];if(!(!t.visible||!t.renderable)){if(t.calculateBounds(),t._mask){let e=t._mask.isMaskData?t._mask.maskObject:t._mask;e?(e.calculateBounds(),this._bounds.addBoundsMask(t._bounds,e._bounds)):this._bounds.addBounds(t._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}}this._bounds.updateID=this._boundsID}getLocalBounds(e,t=!1){let r=super.getLocalBounds(e);if(!t)for(let e=0,t=this.children.length;e<t;++e){let t=this.children[e];t.visible&&t.updateTransform()}return r}_calculateBounds(){}_renderWithCulling(t){let r,i;let n=t.renderTexture.sourceFrame;if(!(n.width>0&&n.height>0))return;this.cullArea?(r=this.cullArea,i=this.worldTransform):this._render!==e.prototype._render&&(r=this.getBounds(!0));let s=t.projection.transform;if(s&&(i?(i=li.copyFrom(i)).prepend(s):i=s),r&&n.intersects(r,i))this._render(t);else if(this.cullArea)return;for(let e=0,r=this.children.length;e<r;++e){let r=this.children[e],i=r.cullable;r.cullable=i||!this.cullArea,r.render(t),r.cullable=i}}render(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable)){if(this._mask||this.filters?.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}}}renderAdvanced(e){let t=this.filters,r=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(let e=0;e<t.length;e++)t[e].enabled&&this._enabledFilters.push(t[e])}let i=t&&this._enabledFilters?.length||r&&(!r.isMaskData||r.enabled&&(r.autoDetect||r.type!==r4.NONE));if(i&&e.batch.flush(),t&&this._enabledFilters?.length&&e.filter.push(this,this._enabledFilters),r&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(let t=0,r=this.children.length;t<r;++t)this.children[t].render(e)}i&&e.batch.flush(),r&&e.mask.pop(this),t&&this._enabledFilters?.length&&e.filter.pop()}_render(e){}destroy(e){super.destroy(),this.sortDirty=!1;let t="boolean"==typeof e?e:e?.children,r=this.removeChildren(0,this.children.length);if(t)for(let t=0;t<r.length;++t)r[t].destroy(e)}get width(){return this.scale.x*this.getLocalBounds().width}set width(e){let t=this.getLocalBounds().width;0!==t?this.scale.x=e/t:this.scale.x=1,this._width=e}get height(){return this.scale.y*this.getLocalBounds().height}set height(e){let t=this.getLocalBounds().height;0!==t?this.scale.y=e/t:this.scale.y=1,this._height=e}};ls.defaultSortableChildren=!1;let lo=ls;lo.prototype.containerUpdateTransform=lo.prototype.updateTransform,Object.defineProperties(tJ,{SORTABLE_CHILDREN:{get:()=>lo.defaultSortableChildren,set(e){rl.deprecation("7.1.0","settings.SORTABLE_CHILDREN is deprecated, use Container.defaultSortableChildren"),lo.defaultSortableChildren=e}}});const la=new nL,ll=new Uint16Array([0,1,2,0,2,3]);class lh extends lo{constructor(e){super(),this._anchor=new nJ(this._onAnchorUpdate,this,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),this._texture=null,this._width=0,this._height=0,this._tintColor=new iP(16777215),this._tintRGB=null,this.tint=16777215,this.blendMode=rX.NORMAL,this._cachedTint=16777215,this.uvs=null,this.texture=e||sN.EMPTY,this.vertexData=new Float32Array(8),this.vertexTrimmedData=null,this._transformID=-1,this._textureID=-1,this._transformTrimmedID=-1,this._textureTrimmedID=-1,this.indices=ll,this.pluginName="batch",this.isSprite=!0,this._roundPixels=tJ.ROUND_PIXELS}_onTextureUpdate(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=rl.sign(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=rl.sign(this.scale.y)*this._height/this._texture.orig.height)}_onAnchorUpdate(){this._transformID=-1,this._transformTrimmedID=-1}calculateVertices(){let e=this._texture;if(this._transformID===this.transform._worldID&&this._textureID===e._updateID)return;this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;let t=this.transform.worldTransform,r=t.a,i=t.b,n=t.c,s=t.d,o=t.tx,a=t.ty,l=this.vertexData,h=e.trim,u=e.orig,c=this._anchor,d=0,f=0,p=0,m=0;if(h?(d=(f=h.x-c._x*u.width)+h.width,p=(m=h.y-c._y*u.height)+h.height):(d=(f=-c._x*u.width)+u.width,p=(m=-c._y*u.height)+u.height),l[0]=r*f+n*m+o,l[1]=s*m+i*f+a,l[2]=r*d+n*m+o,l[3]=s*m+i*d+a,l[4]=r*d+n*p+o,l[5]=s*p+i*d+a,l[6]=r*f+n*p+o,l[7]=s*p+i*f+a,this._roundPixels){let e=tJ.RESOLUTION;for(let t=0;t<l.length;++t)l[t]=Math.round(l[t]*e)/e}}calculateTrimmedVertices(){if(this.vertexTrimmedData){if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return}else this.vertexTrimmedData=new Float32Array(8);this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;let e=this._texture,t=this.vertexTrimmedData,r=e.orig,i=this._anchor,n=this.transform.worldTransform,s=n.a,o=n.b,a=n.c,l=n.d,h=n.tx,u=n.ty,c=-i._x*r.width,d=c+r.width,f=-i._y*r.height,p=f+r.height;if(t[0]=s*c+a*f+h,t[1]=l*f+o*c+u,t[2]=s*d+a*f+h,t[3]=l*f+o*d+u,t[4]=s*d+a*p+h,t[5]=l*p+o*d+u,t[6]=s*c+a*p+h,t[7]=l*p+o*c+u,this._roundPixels){let e=tJ.RESOLUTION;for(let r=0;r<t.length;++r)t[r]=Math.round(t[r]*e)/e}}_render(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)}_calculateBounds(){let e=this._texture.trim,t=this._texture.orig;e&&(e.width!==t.width||e.height!==t.height)?(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData)):(this.calculateVertices(),this._bounds.addQuad(this.vertexData))}getLocalBounds(e){return 0===this.children.length?(this._localBounds||(this._localBounds=new le),this._localBounds.minX=-(this._texture.orig.width*this._anchor._x),this._localBounds.minY=-(this._texture.orig.height*this._anchor._y),this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new nU),e=this._localBoundsRect),this._localBounds.getRectangle(e)):super.getLocalBounds.call(this,e)}containsPoint(e){this.worldTransform.applyInverse(e,la);let t=this._texture.orig.width,r=this._texture.orig.height,i=-t*this.anchor.x,n=0;return la.x>=i&&la.x<i+t&&(n=-r*this.anchor.y,la.y>=n&&la.y<n+r)}destroy(e){if(super.destroy(e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null,"boolean"==typeof e?e:e?.texture){let t="boolean"==typeof e?e:e?.baseTexture;this._texture.destroy(!!t)}this._texture=null}static from(e,t){return new lh(e instanceof sN?e:sN.from(e,t))}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1,this._transformTrimmedID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(e){let t=rl.sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(e){let t=rl.sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get anchor(){return this._anchor}set anchor(e){this._anchor.copyFrom(e)}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e),this._tintRGB=this._tintColor.toLittleEndianNumber()}get tintValue(){return this._tintColor.toNumber()}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||sN.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))}}const lu=new nV;lt.prototype._cacheAsBitmap=!1,lt.prototype._cacheData=null,lt.prototype._cacheAsBitmapResolution=null,lt.prototype._cacheAsBitmapMultisample=null;class lc{constructor(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}}Object.defineProperties(lt.prototype,{cacheAsBitmapResolution:{get(){return this._cacheAsBitmapResolution},set(e){e!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get(){return this._cacheAsBitmapMultisample},set(e){e!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=e,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get(){return this._cacheAsBitmap},set(e){let t;this._cacheAsBitmap!==e&&(this._cacheAsBitmap=e,e?(this._cacheData||(this._cacheData=new lc),(t=this._cacheData).originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):((t=this._cacheData).sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea))}}}),lt.prototype._renderCached=function(e){this.visible&&!(this.worldAlpha<=0)&&this.renderable&&(this._initCachedDisplayObject(e),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(e))},lt.prototype._initCachedDisplayObject=function(e){if(this._cacheData?.sprite)return;let t=this.alpha;this.alpha=1,e.batch.flush();let r=this.getLocalBounds(new nU,!0);if(this.filters?.length){let e=this.filters[0].padding;r.pad(e)}let i=this.cacheAsBitmapResolution||e.resolution;r.ceil(i),r.width=Math.max(r.width,1/i),r.height=Math.max(r.height,1/i);let n=e.renderTexture.current,s=e.renderTexture.sourceFrame.clone(),o=e.renderTexture.destinationFrame.clone(),a=e.projection.transform,l=sF.create({width:r.width,height:r.height,resolution:i,multisample:this.cacheAsBitmapMultisample??e.multisample}),h=`cacheAsBitmap_${rl.uid()}`;this._cacheData.textureCacheId=h,nT.addToCache(l.baseTexture,h),sN.addToCache(l,h);let u=this.transform.localTransform.copyTo(lu).invert().translate(-r.x,-r.y);this.render=this._cacheData.originalRender,e.render(this,{renderTexture:l,clear:!0,transform:u,skipUpdateTransform:!1}),e.framebuffer.blit(),e.projection.transform=a,e.renderTexture.bind(n,s,o),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=t;let c=new lh(l);c.transform.worldTransform=this.transform.worldTransform,c.anchor.x=-(r.x/r.width),c.anchor.y=-(r.y/r.height),c.alpha=t,c._bounds=this._bounds,this._cacheData.sprite=c,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=c.containsPoint.bind(c)},lt.prototype._renderCachedCanvas=function(e){this.visible&&!(this.worldAlpha<=0)&&this.renderable&&(this._initCachedDisplayObjectCanvas(e),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(e))},lt.prototype._initCachedDisplayObjectCanvas=function(e){if(this._cacheData?.sprite)return;let t=this.getLocalBounds(new nU,!0),r=this.alpha;this.alpha=1;let i=e.canvasContext.activeContext,n=e._projTransform,s=this.cacheAsBitmapResolution||e.resolution;t.ceil(s),t.width=Math.max(t.width,1/s),t.height=Math.max(t.height,1/s);let o=sF.create({width:t.width,height:t.height,resolution:s}),a=`cacheAsBitmap_${rl.uid()}`;this._cacheData.textureCacheId=a,nT.addToCache(o.baseTexture,a),sN.addToCache(o,a),this.transform.localTransform.copyTo(lu),lu.invert(),lu.tx-=t.x,lu.ty-=t.y,this.renderCanvas=this._cacheData.originalRenderCanvas,e.render(this,{renderTexture:o,clear:!0,transform:lu,skipUpdateTransform:!1}),e.canvasContext.activeContext=i,e._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=r;let l=new lh(o);l.transform.worldTransform=this.transform.worldTransform,l.anchor.x=-(t.x/t.width),l.anchor.y=-(t.y/t.height),l.alpha=r,l._bounds=this._bounds,this._cacheData.sprite=l,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=e._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=l.containsPoint.bind(l)},lt.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID},lt.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)},lt.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,nT.removeFromCache(this._cacheData.textureCacheId),sN.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null},lt.prototype._cacheAsBitmapDestroy=function(e){this.cacheAsBitmap=!1,this.destroy(e)},lt.prototype.name=null,lo.prototype.getChildByName=function(e,t){for(let t=0,r=this.children.length;t<r;t++)if(this.children[t].name===e)return this.children[t];if(t)for(let t=0,r=this.children.length;t<r;t++){let r=this.children[t];if(!r.getChildByName)continue;let i=r.getChildByName(e,!0);if(i)return i}return null},lt.prototype.getGlobalPosition=function(e=new nL,t=!1){return this.parent?this.parent.toGlobal(this.position,e,t):(e.x=this.position.x,e.y=this.position.y),e};var ld=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`;class lf extends sT{constructor(){super(ob,ld,{m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1}),this.alpha=1}_loadMatrix(e,t=!1){let r=e;t&&(this._multiply(r,this.uniforms.m,e),r=this._colorMatrix(r)),this.uniforms.m=r}_multiply(e,t,r){return e[0]=t[0]*r[0]+t[1]*r[5]+t[2]*r[10]+t[3]*r[15],e[1]=t[0]*r[1]+t[1]*r[6]+t[2]*r[11]+t[3]*r[16],e[2]=t[0]*r[2]+t[1]*r[7]+t[2]*r[12]+t[3]*r[17],e[3]=t[0]*r[3]+t[1]*r[8]+t[2]*r[13]+t[3]*r[18],e[4]=t[0]*r[4]+t[1]*r[9]+t[2]*r[14]+t[3]*r[19]+t[4],e[5]=t[5]*r[0]+t[6]*r[5]+t[7]*r[10]+t[8]*r[15],e[6]=t[5]*r[1]+t[6]*r[6]+t[7]*r[11]+t[8]*r[16],e[7]=t[5]*r[2]+t[6]*r[7]+t[7]*r[12]+t[8]*r[17],e[8]=t[5]*r[3]+t[6]*r[8]+t[7]*r[13]+t[8]*r[18],e[9]=t[5]*r[4]+t[6]*r[9]+t[7]*r[14]+t[8]*r[19]+t[9],e[10]=t[10]*r[0]+t[11]*r[5]+t[12]*r[10]+t[13]*r[15],e[11]=t[10]*r[1]+t[11]*r[6]+t[12]*r[11]+t[13]*r[16],e[12]=t[10]*r[2]+t[11]*r[7]+t[12]*r[12]+t[13]*r[17],e[13]=t[10]*r[3]+t[11]*r[8]+t[12]*r[13]+t[13]*r[18],e[14]=t[10]*r[4]+t[11]*r[9]+t[12]*r[14]+t[13]*r[19]+t[14],e[15]=t[15]*r[0]+t[16]*r[5]+t[17]*r[10]+t[18]*r[15],e[16]=t[15]*r[1]+t[16]*r[6]+t[17]*r[11]+t[18]*r[16],e[17]=t[15]*r[2]+t[16]*r[7]+t[17]*r[12]+t[18]*r[17],e[18]=t[15]*r[3]+t[16]*r[8]+t[17]*r[13]+t[18]*r[18],e[19]=t[15]*r[4]+t[16]*r[9]+t[17]*r[14]+t[18]*r[19]+t[19],e}_colorMatrix(e){let t=new Float32Array(e);return t[4]/=255,t[9]/=255,t[14]/=255,t[19]/=255,t}brightness(e,t){this._loadMatrix([e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0],t)}tint(e,t){let[r,i,n]=iP.shared.setValue(e).toArray();this._loadMatrix([r,0,0,0,0,0,i,0,0,0,0,0,n,0,0,0,0,0,1,0],t)}greyscale(e,t){this._loadMatrix([e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0],t)}blackAndWhite(e){this._loadMatrix([.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0],e)}hue(e,t){let r=Math.cos(e=(e||0)/180*Math.PI),i=Math.sin(e),n=1/3,s=(0,Math.sqrt)(1/3);this._loadMatrix([r+(1-r)*n,n*(1-r)-s*i,n*(1-r)+s*i,0,0,n*(1-r)+s*i,r+n*(1-r),n*(1-r)-s*i,0,0,n*(1-r)-s*i,n*(1-r)+s*i,r+n*(1-r),0,0,0,0,0,1,0],t)}contrast(e,t){let r=(e||0)+1,i=-.5*(r-1);this._loadMatrix([r,0,0,0,i,0,r,0,0,i,0,0,r,0,i,0,0,0,1,0],t)}saturate(e=0,t){let r=2*e/3+1,i=-((r-1)*.5);this._loadMatrix([r,i,i,0,0,i,r,i,0,0,i,i,r,0,0,0,0,0,1,0],t)}desaturate(){this.saturate(-1)}negative(e){this._loadMatrix([-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0],e)}sepia(e){this._loadMatrix([.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0],e)}technicolor(e){this._loadMatrix([1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0],e)}polaroid(e){this._loadMatrix([1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],e)}toBGR(e){this._loadMatrix([0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0],e)}kodachrome(e){this._loadMatrix([1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0],e)}browni(e){this._loadMatrix([.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0],e)}vintage(e){this._loadMatrix([.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0],e)}colorTone(e,t,r,i,n){e=e||.2,t=t||.15,r=r||16770432,i=i||3375104;let s=iP.shared,[o,a,l]=s.setValue(r).toArray(),[h,u,c]=s.setValue(i).toArray(),d=[.3,.59,.11,0,0,o,a,l,e,0,h,u,c,t,0,o-h,a-u,l-c,0,0];this._loadMatrix(d,n)}night(e,t){let r=[-2*(e=e||.1),-e,0,0,0,-e,0,e,0,0,0,e,2*e,0,0,0,0,0,1,0];this._loadMatrix(r,t)}predator(e,t){this._loadMatrix([11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0],t)}lsd(e){this._loadMatrix([2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0],e)}reset(){this._loadMatrix([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],!1)}get matrix(){return this.uniforms.m}set matrix(e){this.uniforms.m=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}}lf.prototype.grayscale=lf.prototype.greyscale;var lp=`varying vec2 vFilterCoord;
varying vec2 vTextureCoord;

uniform vec2 scale;
uniform mat2 rotation;
uniform sampler2D uSampler;
uniform sampler2D mapSampler;

uniform highp vec4 inputSize;
uniform vec4 inputClamp;

void main(void)
{
  vec4 map =  texture2D(mapSampler, vFilterCoord);

  map -= 0.5;
  map.xy = scale * inputSize.zw * (rotation * map.xy);

  gl_FragColor = texture2D(uSampler, clamp(vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y), inputClamp.xy, inputClamp.zw));
}
`,lm=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;
uniform mat3 filterMatrix;

varying vec2 vTextureCoord;
varying vec2 vFilterCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
	gl_Position = filterVertexPosition();
	vTextureCoord = filterTextureCoord();
	vFilterCoord = ( filterMatrix * vec3( vTextureCoord, 1.0)  ).xy;
}
`,lg=`varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;
uniform sampler2D uSampler;
uniform highp vec4 inputSize;


/**
 Basic FXAA implementation based on the code on geeks3d.com with the
 modification that the texture2DLod stuff was removed since it's
 unsupported by WebGL.

 --

 From:
 https://github.com/mitsuhiko/webgl-meincraft

 Copyright (c) 2011 by Armin Ronacher.

 Some rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.

 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following
 disclaimer in the documentation and/or other materials provided
 with the distribution.

 * The names of the contributors may not be used to endorse or
 promote products derived from this software without specific
 prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef FXAA_REDUCE_MIN
#define FXAA_REDUCE_MIN   (1.0/ 128.0)
#endif
#ifndef FXAA_REDUCE_MUL
#define FXAA_REDUCE_MUL   (1.0 / 8.0)
#endif
#ifndef FXAA_SPAN_MAX
#define FXAA_SPAN_MAX     8.0
#endif

//optimized version for mobile, where dependent
//texture reads can be a bottleneck
vec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 inverseVP,
          vec2 v_rgbNW, vec2 v_rgbNE,
          vec2 v_rgbSW, vec2 v_rgbSE,
          vec2 v_rgbM) {
    vec4 color;
    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;
    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;
    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;
    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;
    vec4 texColor = texture2D(tex, v_rgbM);
    vec3 rgbM  = texColor.xyz;
    vec3 luma = vec3(0.299, 0.587, 0.114);
    float lumaNW = dot(rgbNW, luma);
    float lumaNE = dot(rgbNE, luma);
    float lumaSW = dot(rgbSW, luma);
    float lumaSE = dot(rgbSE, luma);
    float lumaM  = dot(rgbM,  luma);
    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

    mediump vec2 dir;
    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                  dir * rcpDirMin)) * inverseVP;

    vec3 rgbA = 0.5 * (
                       texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +
                       texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);
    vec3 rgbB = rgbA * 0.5 + 0.25 * (
                                     texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +
                                     texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);

    float lumaB = dot(rgbB, luma);
    if ((lumaB < lumaMin) || (lumaB > lumaMax))
        color = vec4(rgbA, texColor.a);
    else
        color = vec4(rgbB, texColor.a);
    return color;
}

void main() {

      vec4 color;

      color = fxaa(uSampler, vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);

      gl_FragColor = color;
}
`,lv=`
attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 v_rgbNW;
varying vec2 v_rgbNE;
varying vec2 v_rgbSW;
varying vec2 v_rgbSE;
varying vec2 v_rgbM;

varying vec2 vFragCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

void texcoords(vec2 fragCoord, vec2 inverseVP,
               out vec2 v_rgbNW, out vec2 v_rgbNE,
               out vec2 v_rgbSW, out vec2 v_rgbSE,
               out vec2 v_rgbM) {
    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;
    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;
    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;
    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;
    v_rgbM = vec2(fragCoord * inverseVP);
}

void main(void) {

   gl_Position = filterVertexPosition();

   vFragCoord = aVertexPosition * outputFrame.zw;

   texcoords(vFragCoord, inputSize.zw, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);
}
`,ly=`precision highp float;

varying vec2 vTextureCoord;
varying vec4 vColor;

uniform float uNoise;
uniform float uSeed;
uniform sampler2D uSampler;

float rand(vec2 co)
{
    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);
}

void main()
{
    vec4 color = texture2D(uSampler, vTextureCoord);
    float randomValue = rand(gl_FragCoord.xy * uSeed);
    float diff = (randomValue - 0.5) * uNoise;

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (color.a > 0.0) {
        color.rgb /= color.a;
    }

    color.r += diff;
    color.g += diff;
    color.b += diff;

    // Premultiply alpha again.
    color.rgb *= color.a;

    gl_FragColor = color;
}
`;const l_={AlphaFilter:class extends sT{constructor(e=1){super(ox,oz,{uAlpha:1}),this.alpha=e}get alpha(){return this.uniforms.uAlpha}set alpha(e){this.uniforms.uAlpha=e}},BlurFilter:class extends sT{constructor(e=8,t=4,r=sT.defaultResolution,i=5){super(),this._repeatEdgePixels=!1,this.blurXFilter=new oX(!0,e,t,r,i),this.blurYFilter=new oX(!1,e,t,r,i),this.resolution=r,this.quality=t,this.blur=e,this.repeatEdgePixels=!1}apply(e,t,r,i){let n=Math.abs(this.blurXFilter.strength),s=Math.abs(this.blurYFilter.strength);if(n&&s){let n=e.getFilterTexture();this.blurXFilter.apply(e,t,n,r1.CLEAR),this.blurYFilter.apply(e,n,r,i),e.returnFilterTexture(n)}else s?this.blurYFilter.apply(e,t,r,i):this.blurXFilter.apply(e,t,r,i)}updatePadding(){this._repeatEdgePixels?this.padding=0:this.padding=2*Math.max(Math.abs(this.blurXFilter.strength),Math.abs(this.blurYFilter.strength))}get blur(){return this.blurXFilter.blur}set blur(e){this.blurXFilter.blur=this.blurYFilter.blur=e,this.updatePadding()}get quality(){return this.blurXFilter.quality}set quality(e){this.blurXFilter.quality=this.blurYFilter.quality=e}get blurX(){return this.blurXFilter.blur}set blurX(e){this.blurXFilter.blur=e,this.updatePadding()}get blurY(){return this.blurYFilter.blur}set blurY(e){this.blurYFilter.blur=e,this.updatePadding()}get blendMode(){return this.blurYFilter.blendMode}set blendMode(e){this.blurYFilter.blendMode=e}get repeatEdgePixels(){return this._repeatEdgePixels}set repeatEdgePixels(e){this._repeatEdgePixels=e,this.updatePadding()}},BlurFilterPass:oX,ColorMatrixFilter:lf,DisplacementFilter:class extends sT{constructor(e,t){let r=new nV;e.renderable=!1,super(lm,lp,{mapSampler:e._texture,filterMatrix:r,scale:{x:1,y:1},rotation:new Float32Array([1,0,0,1])}),this.maskSprite=e,this.maskMatrix=r,null==t&&(t=20),this.scale=new nL(t,t)}apply(e,t,r,i){this.uniforms.filterMatrix=e.calculateSpriteMatrix(this.maskMatrix,this.maskSprite),this.uniforms.scale.x=this.scale.x,this.uniforms.scale.y=this.scale.y;let n=this.maskSprite.worldTransform,s=Math.sqrt(n.a*n.a+n.b*n.b),o=Math.sqrt(n.c*n.c+n.d*n.d);0!==s&&0!==o&&(this.uniforms.rotation[0]=n.a/s,this.uniforms.rotation[1]=n.b/s,this.uniforms.rotation[2]=n.c/o,this.uniforms.rotation[3]=n.d/o),e.applyFilter(this,t,r,i)}get map(){return this.uniforms.mapSampler}set map(e){this.uniforms.mapSampler=e}},FXAAFilter:class extends sT{constructor(){super(lv,lg)}},NoiseFilter:class extends sT{constructor(e=.5,t=Math.random()){super(ob,ly,{uNoise:0,uSeed:0}),this.noise=e,this.seed=t}get noise(){return this.uniforms.uNoise}set noise(e){this.uniforms.uNoise=e}get seed(){return this.uniforms.uSeed}set seed(e){this.uniforms.uSeed=e}}};Object.entries(l_).forEach(([e,t])=>{Object.defineProperty(l_,e,{get:()=>(rl.deprecation("7.1.0",`filters.${e} has moved to ${e}`),t)})});const lx=new class{constructor(){this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}init(e){this.removeTickerListener(),this.events=e,this.interactionFrequency=10,this._deltaTime=0,this._didMove=!1,this.tickerAdded=!1,this._pauseUpdate=!0}get pauseUpdate(){return this._pauseUpdate}set pauseUpdate(e){this._pauseUpdate=e}addTickerListener(){this.tickerAdded||!this.domElement||(no.system.add(this.tickerUpdate,this,nn.INTERACTION),this.tickerAdded=!0)}removeTickerListener(){this.tickerAdded&&(no.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)}pointerMoved(){this._didMove=!0}update(){if(!this.domElement||this._pauseUpdate)return;if(this._didMove){this._didMove=!1;return}let e=this.events.rootPointerEvent;this.events.supportsTouchEvents&&"touch"===e.pointerType||globalThis.document.dispatchEvent(new PointerEvent("pointermove",{clientX:e.clientX,clientY:e.clientY}))}tickerUpdate(e){this._deltaTime+=e,this._deltaTime<this.interactionFrequency||(this._deltaTime=0,this.update())}};class lb{constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=lb.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new nL,this.page=new nL,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get data(){return this}composedPath(){return this.manager&&(!this.path||this.path[this.path.length-1]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path}initEvent(e,t,r){throw Error("initEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}initUIEvent(e,t,r,i,n){throw Error("initUIEvent() is a legacy DOM API. It is not implemented in the Federated Events API.")}preventDefault(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){this.propagationStopped=!0}}class lT extends lb{constructor(){super(...arguments),this.client=new nL,this.movement=new nL,this.offset=new nL,this.global=new nL,this.screen=new nL}get clientX(){return this.client.x}get clientY(){return this.client.y}get x(){return this.clientX}get y(){return this.clientY}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getLocalPosition(e,t,r){return e.worldTransform.applyInverse(r||this.global,t)}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,t,r,i,n,s,o,a,l,h,u,c,d,f,p){throw Error("Method not implemented.")}}class lA extends lT{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return"pointermove"===this.type||"mousemove"===this.type||"touchmove"===this.type?[this]:[]}getPredictedEvents(){throw Error("getPredictedEvents is not supported!")}}class lE extends lT{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}}lE.DOM_DELTA_PIXEL=0,lE.DOM_DELTA_LINE=1,lE.DOM_DELTA_PAGE=2;const lw=new nL,lC=new nL;class lS{constructor(e){this.dispatch=new rl.EventEmitter,this.moveOnAll=!1,this.enableGlobalMoveEvents=!0,this.mappingState={trackingData:{}},this.eventPool=new Map,this._allInteractiveElements=[],this._hitElements=[],this._isPointerMoveEvent=!1,this.rootTarget=e,this.hitPruneFn=this.hitPruneFn.bind(this),this.hitTestFn=this.hitTestFn.bind(this),this.mapPointerDown=this.mapPointerDown.bind(this),this.mapPointerMove=this.mapPointerMove.bind(this),this.mapPointerOut=this.mapPointerOut.bind(this),this.mapPointerOver=this.mapPointerOver.bind(this),this.mapPointerUp=this.mapPointerUp.bind(this),this.mapPointerUpOutside=this.mapPointerUpOutside.bind(this),this.mapWheel=this.mapWheel.bind(this),this.mappingTable={},this.addEventMapping("pointerdown",this.mapPointerDown),this.addEventMapping("pointermove",this.mapPointerMove),this.addEventMapping("pointerout",this.mapPointerOut),this.addEventMapping("pointerleave",this.mapPointerOut),this.addEventMapping("pointerover",this.mapPointerOver),this.addEventMapping("pointerup",this.mapPointerUp),this.addEventMapping("pointerupoutside",this.mapPointerUpOutside),this.addEventMapping("wheel",this.mapWheel)}addEventMapping(e,t){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:t,priority:0}),this.mappingTable[e].sort((e,t)=>e.priority-t.priority)}dispatchEvent(e,t){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,t),this.dispatch.emit(t||e.type,e)}mapEvent(e){if(!this.rootTarget)return;let t=this.mappingTable[e.type];if(t)for(let r=0,i=t.length;r<i;r++)t[r].fn(e);else console.warn(`[EventBoundary]: Event mapping not defined for ${e.type}`)}hitTest(e,t){lx.pauseUpdate=!0;let r=this[this._isPointerMoveEvent&&this.enableGlobalMoveEvents?"hitTestMoveRecursive":"hitTestRecursive"](this.rootTarget,this.rootTarget.eventMode,lw.set(e,t),this.hitTestFn,this.hitPruneFn);return r&&r[0]}propagate(e,t){if(!e.target)return;let r=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let i=0,n=r.length-1;i<n;i++)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,t),!(e.propagationStopped||e.propagationImmediatelyStopped)){e.eventPhase=e.BUBBLING_PHASE;for(let i=r.length-2;i>=0;i--)if(e.currentTarget=r[i],this.notifyTarget(e,t),e.propagationStopped||e.propagationImmediatelyStopped)return}}all(e,t,r=this._allInteractiveElements){if(0===r.length)return;e.eventPhase=e.BUBBLING_PHASE;let i=Array.isArray(t)?t:[t];for(let t=r.length-1;t>=0;t--)i.forEach(i=>{e.currentTarget=r[t],this.notifyTarget(e,i)})}propagationPath(e){let t=[e];for(let r=0;r<2048&&e!==this.rootTarget;r++){if(!e.parent)throw Error("Cannot find propagation path to disconnected target");t.push(e.parent),e=e.parent}return t.reverse(),t}hitTestMoveRecursive(e,t,r,i,n,s=!1){let o=!1;if(this._interactivePrune(e))return null;if(("dynamic"===e.eventMode||"dynamic"===t)&&(lx.pauseUpdate=!1),e.interactiveChildren&&e.children){let a=e.children;for(let l=a.length-1;l>=0;l--){let h=a[l],u=this.hitTestMoveRecursive(h,this._isInteractive(t)?t:h.eventMode,r,i,n,s||n(e,r));if(u){if(u.length>0&&!u[u.length-1].parent)continue;let t=e.isInteractive();(u.length>0||t)&&(t&&this._allInteractiveElements.push(e),u.push(e)),0===this._hitElements.length&&(this._hitElements=u),o=!0}}}let a=this._isInteractive(t),l=e.isInteractive();return a&&l&&this._allInteractiveElements.push(e),s||this._hitElements.length>0?null:o?this._hitElements:a&&!n(e,r)&&i(e,r)?l?[e]:[]:null}hitTestRecursive(e,t,r,i,n){if(this._interactivePrune(e)||n(e,r))return null;if(("dynamic"===e.eventMode||"dynamic"===t)&&(lx.pauseUpdate=!1),e.interactiveChildren&&e.children){let s=e.children;for(let o=s.length-1;o>=0;o--){let a=s[o],l=this.hitTestRecursive(a,this._isInteractive(t)?t:a.eventMode,r,i,n);if(l){if(l.length>0&&!l[l.length-1].parent)continue;let t=e.isInteractive();return(l.length>0||t)&&l.push(e),l}}}let s=this._isInteractive(t),o=e.isInteractive();return s&&i(e,r)?o?[e]:[]:null}_isInteractive(e){return"static"===e||"dynamic"===e}_interactivePrune(e){return!!(!e||e.isMask||!e.visible||!e.renderable||"none"===e.eventMode||"passive"===e.eventMode&&!e.interactiveChildren||e.isMask)}hitPruneFn(e,t){if(e.hitArea&&(e.worldTransform.applyInverse(t,lC),!e.hitArea.contains(lC.x,lC.y)))return!0;if(e._mask){let r=e._mask.isMaskData?e._mask.maskObject:e._mask;if(r&&!r.containsPoint?.(t))return!0}return!1}hitTestFn(e,t){return"passive"!==e.eventMode&&(!!e.hitArea||!!e.containsPoint&&e.containsPoint(t))}notifyTarget(e,t){t=t??e.type;let r=`on${t}`;e.currentTarget[r]?.(e);let i=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${t}capture`:t;this.notifyListeners(e,i),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,t)}mapPointerDown(e){if(!(e instanceof lA)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let t=this.createPointerEvent(e);if(this.dispatchEvent(t,"pointerdown"),"touch"===t.pointerType)this.dispatchEvent(t,"touchstart");else if("mouse"===t.pointerType||"pen"===t.pointerType){let e=2===t.button;this.dispatchEvent(t,e?"rightdown":"mousedown")}this.trackingData(e.pointerId).pressTargetsByButton[e.button]=t.composedPath(),this.freeEvent(t)}mapPointerMove(e){if(!(e instanceof lA)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}this._allInteractiveElements.length=0,this._hitElements.length=0,this._isPointerMoveEvent=!0;let t=this.createPointerEvent(e);this._isPointerMoveEvent=!1;let r="mouse"===t.pointerType||"pen"===t.pointerType,i=this.trackingData(e.pointerId),n=this.findMountedTarget(i.overTargets);if(i.overTargets?.length>0&&n!==t.target){let i="mousemove"===e.type?"mouseout":"pointerout",s=this.createPointerEvent(e,i,n);if(this.dispatchEvent(s,"pointerout"),r&&this.dispatchEvent(s,"mouseout"),!t.composedPath().includes(n)){let i=this.createPointerEvent(e,"pointerleave",n);for(i.eventPhase=i.AT_TARGET;i.target&&!t.composedPath().includes(i.target);)i.currentTarget=i.target,this.notifyTarget(i),r&&this.notifyTarget(i,"mouseleave"),i.target=i.target.parent;this.freeEvent(i)}this.freeEvent(s)}if(n!==t.target){let i="mousemove"===e.type?"mouseover":"pointerover",s=this.clonePointerEvent(t,i);this.dispatchEvent(s,"pointerover"),r&&this.dispatchEvent(s,"mouseover");let o=n?.parent;for(;o&&o!==this.rootTarget.parent&&o!==t.target;)o=o.parent;if(!o||o===this.rootTarget.parent){let e=this.clonePointerEvent(t,"pointerenter");for(e.eventPhase=e.AT_TARGET;e.target&&e.target!==n&&e.target!==this.rootTarget.parent;)e.currentTarget=e.target,this.notifyTarget(e),r&&this.notifyTarget(e,"mouseenter"),e.target=e.target.parent;this.freeEvent(e)}this.freeEvent(s)}let s=[],o=this.enableGlobalMoveEvents??!0;this.moveOnAll?s.push("pointermove"):this.dispatchEvent(t,"pointermove"),o&&s.push("globalpointermove"),"touch"===t.pointerType&&(this.moveOnAll?s.splice(1,0,"touchmove"):this.dispatchEvent(t,"touchmove"),o&&s.push("globaltouchmove")),r&&(this.moveOnAll?s.splice(1,0,"mousemove"):this.dispatchEvent(t,"mousemove"),o&&s.push("globalmousemove"),this.cursor=t.target?.cursor),s.length>0&&this.all(t,s),this._allInteractiveElements.length=0,this._hitElements.length=0,i.overTargets=t.composedPath(),this.freeEvent(t)}mapPointerOver(e){if(!(e instanceof lA)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let t=this.trackingData(e.pointerId),r=this.createPointerEvent(e),i="mouse"===r.pointerType||"pen"===r.pointerType;this.dispatchEvent(r,"pointerover"),i&&this.dispatchEvent(r,"mouseover"),"mouse"===r.pointerType&&(this.cursor=r.target?.cursor);let n=this.clonePointerEvent(r,"pointerenter");for(n.eventPhase=n.AT_TARGET;n.target&&n.target!==this.rootTarget.parent;)n.currentTarget=n.target,this.notifyTarget(n),i&&this.notifyTarget(n,"mouseenter"),n.target=n.target.parent;t.overTargets=r.composedPath(),this.freeEvent(r),this.freeEvent(n)}mapPointerOut(e){if(!(e instanceof lA)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let t=this.trackingData(e.pointerId);if(t.overTargets){let r="mouse"===e.pointerType||"pen"===e.pointerType,i=this.findMountedTarget(t.overTargets),n=this.createPointerEvent(e,"pointerout",i);this.dispatchEvent(n),r&&this.dispatchEvent(n,"mouseout");let s=this.createPointerEvent(e,"pointerleave",i);for(s.eventPhase=s.AT_TARGET;s.target&&s.target!==this.rootTarget.parent;)s.currentTarget=s.target,this.notifyTarget(s),r&&this.notifyTarget(s,"mouseleave"),s.target=s.target.parent;t.overTargets=null,this.freeEvent(n),this.freeEvent(s)}this.cursor=null}mapPointerUp(e){if(!(e instanceof lA)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let t=performance.now(),r=this.createPointerEvent(e);if(this.dispatchEvent(r,"pointerup"),"touch"===r.pointerType)this.dispatchEvent(r,"touchend");else if("mouse"===r.pointerType||"pen"===r.pointerType){let e=2===r.button;this.dispatchEvent(r,e?"rightup":"mouseup")}let i=this.trackingData(e.pointerId),n=this.findMountedTarget(i.pressTargetsByButton[e.button]),s=n;if(n&&!r.composedPath().includes(n)){let t=n;for(;t&&!r.composedPath().includes(t);){if(r.currentTarget=t,this.notifyTarget(r,"pointerupoutside"),"touch"===r.pointerType)this.notifyTarget(r,"touchendoutside");else if("mouse"===r.pointerType||"pen"===r.pointerType){let e=2===r.button;this.notifyTarget(r,e?"rightupoutside":"mouseupoutside")}t=t.parent}delete i.pressTargetsByButton[e.button],s=t}if(s){let n=this.clonePointerEvent(r,"click");n.target=s,n.path=null,i.clicksByButton[e.button]||(i.clicksByButton[e.button]={clickCount:0,target:n.target,timeStamp:t});let o=i.clicksByButton[e.button];if(o.target===n.target&&t-o.timeStamp<200?++o.clickCount:o.clickCount=1,o.target=n.target,o.timeStamp=t,n.detail=o.clickCount,"mouse"===n.pointerType){let e=2===n.button;this.dispatchEvent(n,e?"rightclick":"click")}else"touch"===n.pointerType&&this.dispatchEvent(n,"tap");this.dispatchEvent(n,"pointertap"),this.freeEvent(n)}this.freeEvent(r)}mapPointerUpOutside(e){if(!(e instanceof lA)){console.warn("EventBoundary cannot map a non-pointer event as a pointer event");return}let t=this.trackingData(e.pointerId),r=this.findMountedTarget(t.pressTargetsByButton[e.button]),i=this.createPointerEvent(e);if(r){let n=r;for(;n;)i.currentTarget=n,this.notifyTarget(i,"pointerupoutside"),"touch"===i.pointerType?this.notifyTarget(i,"touchendoutside"):("mouse"===i.pointerType||"pen"===i.pointerType)&&this.notifyTarget(i,2===i.button?"rightupoutside":"mouseupoutside"),n=n.parent;delete t.pressTargetsByButton[e.button]}this.freeEvent(i)}mapWheel(e){if(!(e instanceof lE)){console.warn("EventBoundary cannot map a non-wheel event as a wheel event");return}let t=this.createWheelEvent(e);this.dispatchEvent(t),this.freeEvent(t)}findMountedTarget(e){if(!e)return null;let t=e[0];for(let r=1;r<e.length&&e[r].parent===t;r++)t=e[r];return t}createPointerEvent(e,t,r){let i=this.allocateEvent(lA);return this.copyPointerData(e,i),this.copyMouseData(e,i),this.copyData(e,i),i.nativeEvent=e.nativeEvent,i.originalEvent=e,i.target=r??this.hitTest(i.global.x,i.global.y)??this._hitElements[0],"string"==typeof t&&(i.type=t),i}createWheelEvent(e){let t=this.allocateEvent(lE);return this.copyWheelData(e,t),this.copyMouseData(e,t),this.copyData(e,t),t.nativeEvent=e.nativeEvent,t.originalEvent=e,t.target=this.hitTest(t.global.x,t.global.y),t}clonePointerEvent(e,t){let r=this.allocateEvent(lA);return r.nativeEvent=e.nativeEvent,r.originalEvent=e.originalEvent,this.copyPointerData(e,r),this.copyMouseData(e,r),this.copyData(e,r),r.target=e.target,r.path=e.composedPath().slice(),r.type=t??r.type,r}copyWheelData(e,t){t.deltaMode=e.deltaMode,t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ}copyPointerData(e,t){e instanceof lA&&t instanceof lA&&(t.pointerId=e.pointerId,t.width=e.width,t.height=e.height,t.isPrimary=e.isPrimary,t.pointerType=e.pointerType,t.pressure=e.pressure,t.tangentialPressure=e.tangentialPressure,t.tiltX=e.tiltX,t.tiltY=e.tiltY,t.twist=e.twist)}copyMouseData(e,t){e instanceof lT&&t instanceof lT&&(t.altKey=e.altKey,t.button=e.button,t.buttons=e.buttons,t.client.copyFrom(e.client),t.ctrlKey=e.ctrlKey,t.metaKey=e.metaKey,t.movement.copyFrom(e.movement),t.screen.copyFrom(e.screen),t.shiftKey=e.shiftKey,t.global.copyFrom(e.global))}copyData(e,t){t.isTrusted=e.isTrusted,t.srcElement=e.srcElement,t.timeStamp=performance.now(),t.type=e.type,t.detail=e.detail,t.view=e.view,t.which=e.which,t.layer.copyFrom(e.layer),t.page.copyFrom(e.page)}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){this.eventPool.has(e)||this.eventPool.set(e,[]);let t=this.eventPool.get(e).pop()||new e(this);return t.eventPhase=t.NONE,t.currentTarget=null,t.path=null,t.target=null,t}freeEvent(e){if(e.manager!==this)throw Error("It is illegal to free an event not managed by this EventBoundary!");let t=e.constructor;this.eventPool.has(t)||this.eventPool.set(t,[]),this.eventPool.get(t).push(e)}notifyListeners(e,t){let r=e.currentTarget._events[t];if(r&&e.currentTarget.isInteractive()){if("fn"in r)r.once&&e.currentTarget.removeListener(t,r.fn,void 0,!0),r.fn.call(r.context,e);else for(let i=0,n=r.length;i<n&&!e.propagationImmediatelyStopped;i++)r[i].once&&e.currentTarget.removeListener(t,r[i].fn,void 0,!0),r[i].fn.call(r[i].context,e)}}}const lI={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},lR=class e{constructor(t){this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.domElement=null,this.resolution=1,this.renderer=t,this.rootBoundary=new lS(null),lx.init(this),this.autoPreventDefault=!0,this.eventsAdded=!1,this.rootPointerEvent=new lA(null),this.rootWheelEvent=new lE(null),this.cursorStyles={default:"inherit",pointer:"pointer"},this.features=new Proxy({...e.defaultEventFeatures},{set:(e,t,r)=>("globalMove"===t&&(this.rootBoundary.enableGlobalMoveEvents=r),e[t]=r,!0)}),this.onPointerDown=this.onPointerDown.bind(this),this.onPointerMove=this.onPointerMove.bind(this),this.onPointerUp=this.onPointerUp.bind(this),this.onPointerOverOut=this.onPointerOverOut.bind(this),this.onWheel=this.onWheel.bind(this)}static get defaultEventMode(){return this._defaultEventMode}init(t){let{view:r,resolution:i}=this.renderer;this.setTargetElement(r),this.resolution=i,e._defaultEventMode=t.eventMode??"auto",Object.assign(this.features,t.eventFeatures??{}),this.rootBoundary.enableGlobalMoveEvents=this.features.globalMove}resolutionChange(e){this.resolution=e}destroy(){this.setTargetElement(null),this.renderer=null}setCursor(e){e=e||"default";let t=!0;if(globalThis.OffscreenCanvas&&this.domElement instanceof OffscreenCanvas&&(t=!1),this.currentCursor===e)return;this.currentCursor=e;let r=this.cursorStyles[e];if(r)switch(typeof r){case"string":t&&(this.domElement.style.cursor=r);break;case"function":r(e);break;case"object":t&&Object.assign(this.domElement.style,r)}else t&&"string"==typeof e&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.domElement.style.cursor=e)}get pointer(){return this.rootPointerEvent}onPointerDown(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=this.normalizeToPointerData(e);this.autoPreventDefault&&t[0].isNormalized&&(e.cancelable||!("cancelable"in e))&&e.preventDefault();for(let e=0,r=t.length;e<r;e++){let r=t[e],i=this.bootstrapEvent(this.rootPointerEvent,r);this.rootBoundary.mapEvent(i)}this.setCursor(this.rootBoundary.cursor)}onPointerMove(e){if(!this.features.move)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,lx.pointerMoved();let t=this.normalizeToPointerData(e);for(let e=0,r=t.length;e<r;e++){let r=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onPointerUp(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=e.target;e.composedPath&&e.composedPath().length>0&&(t=e.composedPath()[0]);let r=t!==this.domElement?"outside":"",i=this.normalizeToPointerData(e);for(let e=0,t=i.length;e<t;e++){let t=this.bootstrapEvent(this.rootPointerEvent,i[e]);t.type+=r,this.rootBoundary.mapEvent(t)}this.setCursor(this.rootBoundary.cursor)}onPointerOverOut(e){if(!this.features.click)return;this.rootBoundary.rootTarget=this.renderer.lastObjectRendered;let t=this.normalizeToPointerData(e);for(let e=0,r=t.length;e<r;e++){let r=this.bootstrapEvent(this.rootPointerEvent,t[e]);this.rootBoundary.mapEvent(r)}this.setCursor(this.rootBoundary.cursor)}onWheel(e){if(!this.features.wheel)return;let t=this.normalizeWheelEvent(e);this.rootBoundary.rootTarget=this.renderer.lastObjectRendered,this.rootBoundary.mapEvent(t)}setTargetElement(e){this.removeEvents(),this.domElement=e,lx.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;lx.addTickerListener();let e=this.domElement.style;e&&(globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none")),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,!0),this.domElement.addEventListener("pointerdown",this.onPointerDown,!0),this.domElement.addEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.addEventListener("pointerover",this.onPointerOverOut,!0),globalThis.addEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,!0),this.domElement.addEventListener("mousedown",this.onPointerDown,!0),this.domElement.addEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.addEventListener("mouseover",this.onPointerOverOut,!0),globalThis.addEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.addEventListener("touchstart",this.onPointerDown,!0),this.domElement.addEventListener("touchend",this.onPointerUp,!0),this.domElement.addEventListener("touchmove",this.onPointerMove,!0))),this.domElement.addEventListener("wheel",this.onWheel,{passive:!0,capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;lx.removeTickerListener();let e=this.domElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,!0),this.domElement.removeEventListener("pointerdown",this.onPointerDown,!0),this.domElement.removeEventListener("pointerleave",this.onPointerOverOut,!0),this.domElement.removeEventListener("pointerover",this.onPointerOverOut,!0),globalThis.removeEventListener("pointerup",this.onPointerUp,!0)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,!0),this.domElement.removeEventListener("mousedown",this.onPointerDown,!0),this.domElement.removeEventListener("mouseout",this.onPointerOverOut,!0),this.domElement.removeEventListener("mouseover",this.onPointerOverOut,!0),globalThis.removeEventListener("mouseup",this.onPointerUp,!0),this.supportsTouchEvents&&(this.domElement.removeEventListener("touchstart",this.onPointerDown,!0),this.domElement.removeEventListener("touchend",this.onPointerUp,!0),this.domElement.removeEventListener("touchmove",this.onPointerMove,!0))),this.domElement.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapPositionToPoint(e,t,r){let i=this.domElement.isConnected?this.domElement.getBoundingClientRect():{x:0,y:0,width:this.domElement.width,height:this.domElement.height,left:0,top:0},n=1/this.resolution;e.x=(t-i.left)*(this.domElement.width/i.width)*n,e.y=(r-i.top)*(this.domElement.height/i.height)*n}normalizeToPointerData(e){let t=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(let r=0,i=e.changedTouches.length;r<i;r++){let i=e.changedTouches[r];typeof i.button>"u"&&(i.button=0),typeof i.buttons>"u"&&(i.buttons=1),typeof i.isPrimary>"u"&&(i.isPrimary=1===e.touches.length&&"touchstart"===e.type),typeof i.width>"u"&&(i.width=i.radiusX||1),typeof i.height>"u"&&(i.height=i.radiusY||1),typeof i.tiltX>"u"&&(i.tiltX=0),typeof i.tiltY>"u"&&(i.tiltY=0),typeof i.pointerType>"u"&&(i.pointerType="touch"),typeof i.pointerId>"u"&&(i.pointerId=i.identifier||0),typeof i.pressure>"u"&&(i.pressure=i.force||.5),typeof i.twist>"u"&&(i.twist=0),typeof i.tangentialPressure>"u"&&(i.tangentialPressure=0),typeof i.layerX>"u"&&(i.layerX=i.offsetX=i.clientX),typeof i.layerY>"u"&&(i.layerY=i.offsetY=i.clientY),i.isNormalized=!0,i.type=e.type,t.push(i)}else(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent)))&&(typeof e.isPrimary>"u"&&(e.isPrimary=!0),typeof e.width>"u"&&(e.width=1),typeof e.height>"u"&&(e.height=1),typeof e.tiltX>"u"&&(e.tiltX=0),typeof e.tiltY>"u"&&(e.tiltY=0),typeof e.pointerType>"u"&&(e.pointerType="mouse"),typeof e.pointerId>"u"&&(e.pointerId=1),typeof e.pressure>"u"&&(e.pressure=.5),typeof e.twist>"u"&&(e.twist=0),typeof e.tangentialPressure>"u"&&(e.tangentialPressure=0),e.isNormalized=!0),t.push(e);return t}normalizeWheelEvent(e){let t=this.rootWheelEvent;return this.transferMouseData(t,e),t.deltaX=e.deltaX,t.deltaY=e.deltaY,t.deltaZ=e.deltaZ,t.deltaMode=e.deltaMode,this.mapPositionToPoint(t.screen,e.clientX,e.clientY),t.global.copyFrom(t.screen),t.offset.copyFrom(t.screen),t.nativeEvent=e,t.type=e.type,t}bootstrapEvent(e,t){return e.originalEvent=null,e.nativeEvent=t,e.pointerId=t.pointerId,e.width=t.width,e.height=t.height,e.isPrimary=t.isPrimary,e.pointerType=t.pointerType,e.pressure=t.pressure,e.tangentialPressure=t.tangentialPressure,e.tiltX=t.tiltX,e.tiltY=t.tiltY,e.twist=t.twist,this.transferMouseData(e,t),this.mapPositionToPoint(e.screen,t.clientX,t.clientY),e.global.copyFrom(e.screen),e.offset.copyFrom(e.screen),e.isTrusted=t.isTrusted,"pointerleave"===e.type&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=lI[e.type]||e.type),e}transferMouseData(e,t){e.isTrusted=t.isTrusted,e.srcElement=t.srcElement,e.timeStamp=performance.now(),e.type=t.type,e.altKey=t.altKey,e.button=t.button,e.buttons=t.buttons,e.client.x=t.clientX,e.client.y=t.clientY,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.movement.x=t.movementX,e.movement.y=t.movementY,e.page.x=t.pageX,e.page.y=t.pageY,e.relatedTarget=null,e.shiftKey=t.shiftKey}};function lM(e){return"dynamic"===e||"static"===e}lR.extension={name:"events",type:[na.RendererSystem,na.CanvasRendererSystem]},lR.defaultEventFeatures={move:!0,globalMove:!0,click:!0,wheel:!0},nu.add(lR),lt.mixin({onclick:null,onmousedown:null,onmouseenter:null,onmouseleave:null,onmousemove:null,onglobalmousemove:null,onmouseout:null,onmouseover:null,onmouseup:null,onmouseupoutside:null,onpointercancel:null,onpointerdown:null,onpointerenter:null,onpointerleave:null,onpointermove:null,onglobalpointermove:null,onpointerout:null,onpointerover:null,onpointertap:null,onpointerup:null,onpointerupoutside:null,onrightclick:null,onrightdown:null,onrightup:null,onrightupoutside:null,ontap:null,ontouchcancel:null,ontouchend:null,ontouchendoutside:null,ontouchmove:null,onglobaltouchmove:null,ontouchstart:null,onwheel:null,_internalInteractive:void 0,get interactive(){return this._internalInteractive??lM(lR.defaultEventMode)},set interactive(value){rl.deprecation("7.2.0","Setting interactive is deprecated, use eventMode = 'none'/'passive'/'auto'/'static'/'dynamic' instead."),this._internalInteractive=value,this.eventMode=value?"static":"auto"},_internalEventMode:void 0,get eventMode(){return this._internalEventMode??lR.defaultEventMode},set eventMode(value){this._internalInteractive=lM(value),this._internalEventMode=value},isInteractive(){return"static"===this.eventMode||"dynamic"===this.eventMode},interactiveChildren:!0,hitArea:null,addEventListener(e,t,r){let i="boolean"==typeof r&&r||"object"==typeof r&&r.capture,n="function"==typeof t?void 0:t;e=i?`${e}capture`:e,t="function"==typeof t?t:t.handleEvent,this.on(e,t,n)},removeEventListener(e,t,r){let i="boolean"==typeof r&&r||"object"==typeof r&&r.capture,n="function"==typeof t?void 0:t;e=i?`${e}capture`:e,t="function"==typeof t?t:t.handleEvent,this.off(e,t,n)},dispatchEvent(e){if(!(e instanceof lb))throw Error("DisplayObject cannot propagate events outside of the Federated Events API");return e.defaultPrevented=!1,e.path=null,e.target=this,e.manager.dispatchEvent(e),!e.defaultPrevented}}),lt.mixin({accessible:!1,accessibleTitle:null,accessibleHint:null,tabIndex:0,_accessibleActive:!1,_accessibleDiv:null,accessibleType:"button",accessiblePointerEvents:"auto",accessibleChildren:!0,renderId:-1});class lP{constructor(e){this.debug=!1,this._isActive=!1,this._isMobileAccessibility=!1,this.pool=[],this.renderId=0,this.children=[],this.androidUpdateCount=0,this.androidUpdateFrequency=500,this._hookDiv=null,(rl.isMobile.tablet||rl.isMobile.phone)&&this.createTouchHook();let t=document.createElement("div");t.style.width="100px",t.style.height="100px",t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.zIndex="2",this.div=t,this.renderer=e,this._onKeyDown=this._onKeyDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),globalThis.addEventListener("keydown",this._onKeyDown,!1)}get isActive(){return this._isActive}get isMobileAccessibility(){return this._isMobileAccessibility}createTouchHook(){let e=document.createElement("button");e.style.width="1px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.zIndex="2",e.style.backgroundColor="#FF0000",e.title="select to enable accessibility for this content",e.addEventListener("focus",()=>{this._isMobileAccessibility=!0,this.activate(),this.destroyTouchHook()}),document.body.appendChild(e),this._hookDiv=e}destroyTouchHook(){this._hookDiv&&(document.body.removeChild(this._hookDiv),this._hookDiv=null)}activate(){this._isActive||(this._isActive=!0,globalThis.document.addEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown,!1),this.renderer.on("postrender",this.update,this),this.renderer.view.parentNode?.appendChild(this.div))}deactivate(){!this._isActive||this._isMobileAccessibility||(this._isActive=!1,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.addEventListener("keydown",this._onKeyDown,!1),this.renderer.off("postrender",this.update),this.div.parentNode?.removeChild(this.div))}updateAccessibleObjects(e){if(!e.visible||!e.accessibleChildren)return;e.accessible&&e.isInteractive()&&(e._accessibleActive||this.addChild(e),e.renderId=this.renderId);let t=e.children;if(t)for(let e=0;e<t.length;e++)this.updateAccessibleObjects(t[e])}update(){let e=performance.now();if(rl.isMobile.android.device&&e<this.androidUpdateCount||(this.androidUpdateCount=e+this.androidUpdateFrequency,!this.renderer.renderingToScreen))return;this.renderer.lastObjectRendered&&this.updateAccessibleObjects(this.renderer.lastObjectRendered);let{x:t,y:r,width:i,height:n}=this.renderer.view.getBoundingClientRect(),{width:s,height:o,resolution:a}=this.renderer,l=i/s*a,h=n/o*a,u=this.div;u.style.left=`${t}px`,u.style.top=`${r}px`,u.style.width=`${s}px`,u.style.height=`${o}px`;for(let e=0;e<this.children.length;e++){let t=this.children[e];if(t.renderId!==this.renderId)t._accessibleActive=!1,rl.removeItems(this.children,e,1),this.div.removeChild(t._accessibleDiv),this.pool.push(t._accessibleDiv),t._accessibleDiv=null,e--;else{u=t._accessibleDiv;let e=t.hitArea,r=t.worldTransform;t.hitArea?(u.style.left=`${(r.tx+e.x*r.a)*l}px`,u.style.top=`${(r.ty+e.y*r.d)*h}px`,u.style.width=`${e.width*r.a*l}px`,u.style.height=`${e.height*r.d*h}px`):(e=t.getBounds(),this.capHitArea(e),u.style.left=`${e.x*l}px`,u.style.top=`${e.y*h}px`,u.style.width=`${e.width*l}px`,u.style.height=`${e.height*h}px`,u.title!==t.accessibleTitle&&null!==t.accessibleTitle&&(u.title=t.accessibleTitle),u.getAttribute("aria-label")!==t.accessibleHint&&null!==t.accessibleHint&&u.setAttribute("aria-label",t.accessibleHint)),(t.accessibleTitle!==u.title||t.tabIndex!==u.tabIndex)&&(u.title=t.accessibleTitle,u.tabIndex=t.tabIndex,this.debug&&this.updateDebugHTML(u))}}this.renderId++}updateDebugHTML(e){e.innerHTML=`type: ${e.type}</br> title : ${e.title}</br> tabIndex: ${e.tabIndex}`}capHitArea(e){e.x<0&&(e.width+=e.x,e.x=0),e.y<0&&(e.height+=e.y,e.y=0);let{width:t,height:r}=this.renderer;e.x+e.width>t&&(e.width=t-e.x),e.y+e.height>r&&(e.height=r-e.y)}addChild(e){let t=this.pool.pop();t||((t=document.createElement("button")).style.width="100px",t.style.height="100px",t.style.backgroundColor=this.debug?"rgba(255,255,255,0.5)":"transparent",t.style.position="absolute",t.style.zIndex="2",t.style.borderStyle="none",navigator.userAgent.toLowerCase().includes("chrome")?t.setAttribute("aria-live","off"):t.setAttribute("aria-live","polite"),navigator.userAgent.match(/rv:.*Gecko\//)?t.setAttribute("aria-relevant","additions"):t.setAttribute("aria-relevant","text"),t.addEventListener("click",this._onClick.bind(this)),t.addEventListener("focus",this._onFocus.bind(this)),t.addEventListener("focusout",this._onFocusOut.bind(this))),t.style.pointerEvents=e.accessiblePointerEvents,t.type=e.accessibleType,e.accessibleTitle&&null!==e.accessibleTitle?t.title=e.accessibleTitle:e.accessibleHint&&null!==e.accessibleHint||(t.title=`displayObject ${e.tabIndex}`),e.accessibleHint&&null!==e.accessibleHint&&t.setAttribute("aria-label",e.accessibleHint),this.debug&&this.updateDebugHTML(t),e._accessibleActive=!0,e._accessibleDiv=t,t.displayObject=e,this.children.push(e),this.div.appendChild(e._accessibleDiv),e._accessibleDiv.tabIndex=e.tabIndex}_dispatchEvent(e,t){let{displayObject:r}=e.target,i=this.renderer.events.rootBoundary,n=Object.assign(new lb(i),{target:r});i.rootTarget=this.renderer.lastObjectRendered,t.forEach(e=>i.dispatchEvent(n,e))}_onClick(e){this._dispatchEvent(e,["click","pointertap","tap"])}_onFocus(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","assertive"),this._dispatchEvent(e,["mouseover"])}_onFocusOut(e){e.target.getAttribute("aria-live")||e.target.setAttribute("aria-live","polite"),this._dispatchEvent(e,["mouseout"])}_onKeyDown(e){9===e.keyCode&&this.activate()}_onMouseMove(e){0===e.movementX&&0===e.movementY||this.deactivate()}destroy(){this.destroyTouchHook(),this.div=null,globalThis.document.removeEventListener("mousemove",this._onMouseMove,!0),globalThis.removeEventListener("keydown",this._onKeyDown),this.pool=null,this.children=null,this.renderer=null}}lP.extension={name:"accessibility",type:[na.RendererPlugin,na.CanvasRendererPlugin]},nu.add(lP);const lO=class e{constructor(t){this.stage=new lo,t=Object.assign({forceCanvas:!1},t),this.renderer=function(e){for(let t of o_)if(t.test(e))return new t(e);throw Error("Unable to auto-detect a suitable renderer.")}(t),e._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render(this.stage)}get view(){return this.renderer?.view}get screen(){return this.renderer?.screen}destroy(t,r){let i=e._plugins.slice(0);i.reverse(),i.forEach(e=>{e.destroy.call(this)}),this.stage.destroy(r),this.stage=null,this.renderer.destroy(t),this.renderer=null}};lO._plugins=[],nu.handleByList(na.Application,lO._plugins);class lD{static init(e){Object.defineProperty(this,"resizeTo",{set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this.cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this.cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{let e,t;if(this._resizeTo){if(this.cancelResize(),this._resizeTo===globalThis.window)e=globalThis.innerWidth,t=globalThis.innerHeight;else{let{clientWidth:r,clientHeight:i}=this._resizeTo;e=r,t=i}this.renderer.resize(e,t),this.render()}},this._resizeId=null,this._resizeTo=null,this.resizeTo=e.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}lD.extension=na.Application,nu.add(lD);const lN={loader:na.LoadParser,resolver:na.ResolveParser,cache:na.CacheParser,detection:na.DetectionParser};nu.handle(na.Asset,e=>{let t=e.ref;Object.entries(lN).filter(([e])=>!!t[e]).forEach(([e,r])=>nu.add(Object.assign(t[e],{extension:t[e].extension??r})))},e=>{let t=e.ref;Object.keys(lN).filter(e=>!!t[e]).forEach(e=>nu.remove(t[e]))});class lF{constructor(e,t=!1){this._loader=e,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=t}add(e){e.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;let e=[],t=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<t;r++)e.push(this._assetList.pop());await this._loader.load(e),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(e){this._isActive!==e&&(this._isActive=e,e&&!this._isLoading&&this._next())}}function lB(e,t){if(Array.isArray(t)){for(let r of t)if(e.startsWith(`data:${r}`))return!0;return!1}return e.startsWith(`data:${t}`)}function lL(e,t){let r=e.split("?")[0],i=rl.path.extname(r).toLowerCase();return Array.isArray(t)?t.includes(i):i===t}const lk=(e,t,r=!1)=>(Array.isArray(e)||(e=[e]),t?e.map(e=>"string"==typeof e||r?t(e):e):e),lU=(e,t)=>{let r=t.split("?")[1];return r&&(e+=`?${r}`),e},lG=e=>!Array.isArray(e),lz=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(e){return this._cache.has(e)}get(e){let t=this._cache.get(e);return t||console.warn(`[Assets] Asset id ${e} was not found in the Cache`),t}set(e,t){let r;let i=lk(e);for(let e=0;e<this.parsers.length;e++){let n=this.parsers[e];if(n.test(t)){r=n.getCacheableAssets(i,t);break}}r||(r={},i.forEach(e=>{r[e]=t}));let n=Object.keys(r),s={cacheKeys:n,keys:i};i.forEach(e=>{this._cacheMap.set(e,s)}),n.forEach(e=>{this._cache.has(e)&&this._cache.get(e)!==t&&console.warn("[Cache] already has key:",e),this._cache.set(e,r[e])}),t instanceof sN&&i.forEach(e=>{t.baseTexture!==sN.EMPTY.baseTexture&&nT.addToCache(t.baseTexture,e),sN.addToCache(t,e)})}remove(e){if(!this._cacheMap.has(e)){console.warn(`[Assets] Asset id ${e} was not found in the Cache`);return}let t=this._cacheMap.get(e);t.cacheKeys.forEach(e=>{this._cache.delete(e)}),t.keys.forEach(e=>{this._cacheMap.delete(e)})}get parsers(){return this._parsers}};class lj{constructor(){this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(e,t,r)=>(this._parsersValidated=!1,e[t]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(e,t){let r={promise:null,parser:null};return r.promise=(async()=>{let i=null,n=null;if(t.loadParser&&((n=this._parserHash[t.loadParser])||console.warn(`[Assets] specified load parser "${t.loadParser}" not found while loading ${e}`)),!n){for(let r=0;r<this.parsers.length;r++){let i=this.parsers[r];if(i.load&&i.test?.(e,t,this)){n=i;break}}if(!n)return console.warn(`[Assets] ${e} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await n.load(e,t,this),r.parser=n;for(let e=0;e<this.parsers.length;e++){let n=this.parsers[e];n.parse&&n.parse&&await n.testParse?.(i,t,this)&&(i=await n.parse(i,t,this)||i,r.parser=n)}return i})(),r}async load(e,t){this._parsersValidated||this._validateParsers();let r=0,i={},n=lG(e),s=lk(e,e=>({alias:[e],src:e})),o=s.length,a=s.map(async e=>{let n=rl.path.toAbsolute(e.src);if(!i[e.src])try{this.promiseCache[n]||(this.promiseCache[n]=this._getLoadPromiseAndParser(n,e)),i[e.src]=await this.promiseCache[n].promise,t&&t(++r/o)}catch(t){throw delete this.promiseCache[n],delete i[e.src],Error(`[Loader.load] Failed to load ${n}.
${t}`)}});return await Promise.all(a),n?i[s[0].src]:i}async unload(e){let t=lk(e,e=>({alias:[e],src:e})).map(async e=>{let t=rl.path.toAbsolute(e.src),r=this.promiseCache[t];if(r){let i=await r.promise;delete this.promiseCache[t],r.parser?.unload?.(i,e,this)}});await Promise.all(t)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(e=>e.name).reduce((e,t)=>(e[t.name]&&console.warn(`[Assets] loadParser name conflict "${t.name}"`),{...e,[t.name]:t}),{})}}var lH=((eu=lH||{})[eu.Low=0]="Low",eu[eu.Normal=1]="Normal",eu[eu.High=2]="High",eu);const lV={extension:{type:na.LoadParser,priority:lH.Low},name:"loadJson",test:e=>lB(e,"application/json")||lL(e,".json"),load:async e=>await (await tJ.ADAPTER.fetch(e)).json()};nu.add(lV);const lX={name:"loadTxt",extension:{type:na.LoadParser,priority:lH.Low},test:e=>lB(e,"text/plain")||lL(e,".txt"),load:async e=>await (await tJ.ADAPTER.fetch(e)).text()};nu.add(lX);const lW=["normal","bold","100","200","300","400","500","600","700","800","900"],l$=[".ttf",".otf",".woff",".woff2"],lY=["font/ttf","font/otf","font/woff","font/woff2"],lq=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i,lZ=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/,lK={extension:{type:na.LoadParser,priority:lH.Low},name:"loadWebFont",test:e=>lB(e,lY)||lL(e,l$),async load(e,t){let r=tJ.ADAPTER.getFontFaceSet();if(r){let i=[],n=t.data?.family??function(e){let t=rl.path.extname(e),r=rl.path.basename(e,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)),i=r.length>0;for(let e of r)if(!e.match(lq)){i=!1;break}let n=r.join(" ");return i||(n=`"${n.replace(/[\\"]/g,"\\$&")}"`),n}(e),s=t.data?.weights?.filter(e=>lW.includes(e))??["normal"],o=t.data??{};for(let t=0;t<s.length;t++){let a=s[t],l=new FontFace(n,`url(${lZ.test(e)?e:encodeURI(e)})`,{...o,weight:a});await l.load(),r.add(l),i.push(l)}return 1===i.length?i[0]:i}return console.warn("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(e){(Array.isArray(e)?e:[e]).forEach(e=>tJ.ADAPTER.getFontFaceSet().delete(e))}};nu.add(lK);let lQ=0,lJ;const l0={id:"checkImageBitmap",code:`
    async function checkImageBitmap()
    {
        try
        {
            if (typeof createImageBitmap !== 'function') return false;

            const response = await fetch('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=');
            const imageBlob =  await response.blob();
            const imageBitmap = await createImageBitmap(imageBlob);

            return imageBitmap.width === 1 && imageBitmap.height === 1;
        }
        catch (e)
        {
            return false;
        }
    }
    checkImageBitmap().then((result) => { self.postMessage(result); });
    `},l1={id:"loadImageBitmap",code:`
    async function loadImageBitmap(url)
    {
        const response = await fetch(url);

        if (!response.ok)
        {
            throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \`
                + \`\${response.status} \${response.statusText}\`);
        }

        const imageBlob =  await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);

        return imageBitmap;
    }
    self.onmessage = async (event) =>
    {
        try
        {
            const imageBitmap = await loadImageBitmap(event.data.data[0]);

            self.postMessage({
                data: imageBitmap,
                uuid: event.data.uuid,
                id: event.data.id,
            }, [imageBitmap]);
        }
        catch(e)
        {
            self.postMessage({
                error: e,
                uuid: event.data.uuid,
                id: event.data.id,
            });
        }
    };`},l2=new class{constructor(){this._initialized=!1,this._createdWorkers=0,this.workerPool=[],this.queue=[],this.resolveHash={}}isImageBitmapSupported(){return void 0!==this._isImageBitmapSupported||(this._isImageBitmapSupported=new Promise(e=>{let t=URL.createObjectURL(new Blob([l0.code],{type:"application/javascript"})),r=new Worker(t);r.addEventListener("message",i=>{r.terminate(),URL.revokeObjectURL(t),e(i.data)})})),this._isImageBitmapSupported}loadImageBitmap(e){return this._run("loadImageBitmap",[e])}async _initWorkers(){this._initialized||(this._initialized=!0)}getWorker(){void 0===lJ&&(lJ=navigator.hardwareConcurrency||4);let e=this.workerPool.pop();return!e&&this._createdWorkers<lJ&&(n||(n=URL.createObjectURL(new Blob([l1.code],{type:"application/javascript"}))),this._createdWorkers++,(e=new Worker(n)).addEventListener("message",e=>{this.complete(e.data),this.returnWorker(e.target),this.next()})),e}returnWorker(e){this.workerPool.push(e)}complete(e){void 0!==e.error?this.resolveHash[e.uuid].reject(e.error):this.resolveHash[e.uuid].resolve(e.data),this.resolveHash[e.uuid]=null}async _run(e,t){await this._initWorkers();let r=new Promise((r,i)=>{this.queue.push({id:e,arguments:t,resolve:r,reject:i})});return this.next(),r}next(){if(!this.queue.length)return;let e=this.getWorker();if(!e)return;let t=this.queue.pop(),r=t.id;this.resolveHash[lQ]={resolve:t.resolve,reject:t.reject},e.postMessage({data:t.arguments,uuid:lQ++,id:r})}};function l3(e,t,r){e.resource.internal=!0;let i=new sN(e),n=()=>{delete t.promiseCache[r],lz.has(r)&&lz.remove(r)};return i.baseTexture.once("destroyed",()=>{r in t.promiseCache&&(console.warn("[Assets] A BaseTexture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the BaseTexture."),n())}),i.once("destroyed",()=>{e.destroyed||(console.warn("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),n())}),i}const l4=[".jpeg",".jpg",".png",".webp",".avif"],l5=["image/jpeg","image/png","image/webp","image/avif"];async function l8(e){let t=await tJ.ADAPTER.fetch(e);if(!t.ok)throw Error(`[loadImageBitmap] Failed to fetch ${e}: ${t.status} ${t.statusText}`);let r=await t.blob();return await createImageBitmap(r)}const l6={name:"loadTextures",extension:{type:na.LoadParser,priority:lH.High},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test:e=>lB(e,l5)||lL(e,l4),async load(e,t,r){let i;let n=globalThis.createImageBitmap&&this.config.preferCreateImageBitmap;i=n?this.config.preferWorkers&&await l2.isImageBitmapSupported()?await l2.loadImageBitmap(e):await l8(e):await new Promise((t,r)=>{let i=new Image;i.crossOrigin=this.config.crossOrigin,i.src=e,i.complete?t(i):(i.onload=()=>t(i),i.onerror=e=>r(e))});let s={...t.data};s.resolution??(s.resolution=rl.getResolutionOfUrl(e)),n&&s.resourceOptions?.ownsImageBitmap===void 0&&(s.resourceOptions={...s.resourceOptions},s.resourceOptions.ownsImageBitmap=!0);let o=new nT(i,s);return o.resource.src=e,l3(o,r,e)},unload(e){e.destroy(!0)}};nu.add(l6);const l7={extension:{type:na.LoadParser,priority:lH.High},name:"loadSVG",test:e=>lB(e,"image/svg+xml")||lL(e,".svg"),testParse:async e=>oM.test(e),async parse(e,t,r){let i=new oM(e,t?.data?.resourceOptions);await i.load();let n=new nT(i,{resolution:rl.getResolutionOfUrl(e),...t?.data});return n.resource.src=t.src,l3(n,r,t.src)},load:async(e,t)=>(await tJ.ADAPTER.fetch(e)).text(),unload:l6.unload};nu.add(l7);const l9=[".mp4",".m4v",".webm",".ogv"],he=["video/mp4","video/webm","video/ogg"],ht={name:"loadVideo",extension:{type:na.LoadParser,priority:lH.High},config:{defaultAutoPlay:!0},test:e=>lB(e,he)||lL(e,l9),async load(e,t,r){let i;let n=await (await tJ.ADAPTER.fetch(e)).blob(),s=URL.createObjectURL(n);try{let n={autoPlay:this.config.defaultAutoPlay,...t?.data?.resourceOptions},o=new oP(s,n);await o.load();let a=new nT(o,{alphaMode:await rl.detectVideoAlphaMode(),resolution:rl.getResolutionOfUrl(e),...t?.data});a.resource.src=e,(i=l3(a,r,e)).baseTexture.once("destroyed",()=>{URL.revokeObjectURL(s)})}catch(e){throw URL.revokeObjectURL(s),e}return i},unload(e){e.destroy(!0)}};nu.add(ht);class hr{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(e,t)=>`${e}${this._bundleIdConnector}${t}`,extractAssetIdFromBundle:(e,t)=>t.replace(`${e}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(e){if(this._bundleIdConnector=e.connector??this._bundleIdConnector,this._createBundleAssetId=e.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=e.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...e){e.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(e){this._basePath=e}get basePath(){return this._basePath}set rootPath(e){this._rootPath=e}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(e){"string"==typeof e?this._defaultSearchParams=e:this._defaultSearchParams=Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&")}getAlias(e){let{alias:t,name:r,src:i,srcs:n}=e;return lk(t||r||i||n,e=>"string"==typeof e?e:Array.isArray(e)?e.map(e=>e?.src??e?.srcs??e):e?.src||e?.srcs?e.src??e.srcs:e,!0)}addManifest(e){this._manifest&&console.warn("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=e,e.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(e,t){let r=[];Array.isArray(t)?t.forEach(t=>{let i;let n=t.src??t.srcs,s=t.alias??t.name;if("string"==typeof s){let t=this._createBundleAssetId(e,s);r.push(t),i=[s,t]}else{let t=s.map(t=>this._createBundleAssetId(e,t));r.push(...t),i=[...s,...t]}this.add({...t,alias:i,src:n})}):Object.keys(t).forEach(i=>{let n=[i,this._createBundleAssetId(e,i)];if("string"==typeof t[i])this.add({alias:n,src:t[i]});else if(Array.isArray(t[i]))this.add({alias:n,src:t[i]});else{let e=t[i],r=e.src??e.srcs;this.add({...e,alias:n,src:Array.isArray(r)?r:[r]})}r.push(...n)}),this._bundles[e]=r}add(e,t,r,i,n){let s;let o=[];"string"==typeof e||Array.isArray(e)&&"string"==typeof e[0]?(rl.deprecation("7.2.0",`Assets.add now uses an object instead of individual parameters.
Please use Assets.add({ alias, src, data, format, loadParser }) instead.`),o.push({alias:e,src:t,data:r,format:i,loadParser:n})):Array.isArray(e)?o.push(...e):o.push(e),s=e=>{this.hasKey(e)&&console.warn(`[Resolver] already has key: ${e} overwriting`)},lk(o).forEach(e=>{let{src:t,srcs:r}=e,{data:i,format:n,loadParser:o}=e,a=lk(t||r).map(e=>"string"==typeof e?function(e){let t=e.match(/\{(.*?)\}/g),r=[];if(t){let i=[];t.forEach(e=>{let t=e.substring(1,e.length-1).split(",");i.push(t)}),function e(t,r,i,n,s){let o=r[i];for(let a=0;a<o.length;a++){let l=o[a];i<r.length-1?e(t.replace(n[i],l),r,i+1,n,s):s.push(t.replace(n[i],l))}}(e,i,0,t,r)}else r.push(e);return r}(e):Array.isArray(e)?e:[e]),l=this.getAlias(e);Array.isArray(l)?l.forEach(s):s(l);let h=[];a.forEach(e=>{e.forEach(e=>{let t={};if("object"!=typeof e){t.src=e;for(let r=0;r<this._parsers.length;r++){let i=this._parsers[r];if(i.test(e)){t=i.parse(e);break}}}else i=e.data??i,n=e.format??n,o=e.loadParser??o,t={...t,...e};if(!l)throw Error(`[Resolver] alias is undefined for this asset: ${t.src}`);t=this.buildResolvedAsset(t,{aliases:l,data:i,format:n,loadParser:o}),h.push(t)})}),l.forEach(e=>{this._assetMap[e]=h})})}resolveBundle(e){let t=lG(e);e=lk(e);let r={};return e.forEach(e=>{let t=this._bundles[e];if(t){let i=this.resolve(t),n={};for(let t in i){let r=i[t];n[this._extractAssetIdFromBundle(e,t)]=r}r[e]=n}}),t?r[e[0]]:r}resolveUrl(e){let t=this.resolve(e);if("string"!=typeof e){let e={};for(let r in t)e[r]=t[r].src;return e}return t.src}resolve(e){let t=lG(e);e=lk(e);let r={};return e.forEach(e=>{if(!this._resolverHash[e]){if(this._assetMap[e]){let t=this._assetMap[e],r=t[0],i=this._getPreferredOrder(t);i?.priority.forEach(e=>{i.params[e].forEach(r=>{let i=t.filter(t=>!!t[e]&&t[e]===r);i.length&&(t=i)})}),this._resolverHash[e]=t[0]??r}else this._resolverHash[e]=this.buildResolvedAsset({alias:[e],src:e},{})}r[e]=this._resolverHash[e]}),t?r[e[0]]:r}hasKey(e){return!!this._assetMap[e]}hasBundle(e){return!!this._bundles[e]}_getPreferredOrder(e){for(let t=0;t<e.length;t++){let t=e[0],r=this._preferredOrder.find(e=>e.params.format.includes(t.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(e){if(!this._defaultSearchParams)return e;let t=/\?/.test(e)?"&":"?";return`${e}${t}${this._defaultSearchParams}`}buildResolvedAsset(e,t){let{aliases:r,data:i,loadParser:n,format:s}=t;return(this._basePath||this._rootPath)&&(e.src=rl.path.toAbsolute(e.src,this._basePath,this._rootPath)),e.alias=r??e.alias??[e.src],e.src=this._appendDefaultSearchParams(e.src),e.data={...i||{},...e.data},e.loadParser=n??e.loadParser,e.format=s??rl.path.extname(e.src).slice(1),e.srcs=e.src,e.name=e.alias,e}}const hi=new class{constructor(){this._detections=[],this._initialized=!1,this.resolver=new hr,this.loader=new lj,this.cache=lz,this._backgroundLoader=new lF(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(e={}){if(this._initialized){console.warn("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,e.defaultSearchParams&&this.resolver.setDefaultSearchParams(e.defaultSearchParams),e.basePath&&(this.resolver.basePath=e.basePath),e.bundleIdentifier&&this.resolver.setBundleIdentifier(e.bundleIdentifier),e.manifest){let t=e.manifest;"string"==typeof t&&(t=await this.load(t)),this.resolver.addManifest(t)}let t=e.texturePreference?.resolution??1,r=await this._detectFormats({preferredFormats:e.texturePreference?.format,skipDetections:e.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:"number"==typeof t?[t]:t}}),e.preferences&&this.setPreferences(e.preferences)}add(e,t,r,i,n){this.resolver.add(e,t,r,i,n)}async load(e,t){this._initialized||await this.init();let r=lG(e),i=lk(e).map(e=>{if("string"!=typeof e){let t=this.resolver.getAlias(e);return t.some(e=>!this.resolver.hasKey(e))&&this.add(e),Array.isArray(t)?t[0]:t}return this.resolver.hasKey(e)||this.add({alias:e,src:e}),e}),n=this.resolver.resolve(i),s=await this._mapLoadToResolve(n,t);return r?s[i[0]]:s}addBundle(e,t){this.resolver.addBundle(e,t)}async loadBundle(e,t){this._initialized||await this.init();let r=!1;"string"==typeof e&&(r=!0,e=[e]);let i=this.resolver.resolveBundle(e),n={},s=Object.keys(i),o=0,a=0,l=()=>{t?.(++o/a)},h=s.map(e=>{let t=i[e];return a+=Object.keys(t).length,this._mapLoadToResolve(t,l).then(t=>{n[e]=t})});return await Promise.all(h),r?n[e[0]]:n}async backgroundLoad(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]);let t=this.resolver.resolve(e);this._backgroundLoader.add(Object.values(t))}async backgroundLoadBundle(e){this._initialized||await this.init(),"string"==typeof e&&(e=[e]),Object.values(this.resolver.resolveBundle(e)).forEach(e=>{this._backgroundLoader.add(Object.values(e))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(e){if("string"==typeof e)return lz.get(e);let t={};for(let r=0;r<e.length;r++)t[r]=lz.get(e[r]);return t}async _mapLoadToResolve(e,t){let r=Object.values(e),i=Object.keys(e);this._backgroundLoader.active=!1;let n=await this.loader.load(r,t);this._backgroundLoader.active=!0;let s={};return r.forEach((e,t)=>{let r=n[e.src],o=[e.src];e.alias&&o.push(...e.alias),s[i[t]]=r,lz.set(o,r)}),s}async unload(e){this._initialized||await this.init();let t=lk(e).map(e=>"string"!=typeof e?e.src:e),r=this.resolver.resolve(t);await this._unloadFromResolved(r)}async unloadBundle(e){this._initialized||await this.init(),e=lk(e);let t=this.resolver.resolveBundle(e),r=Object.keys(t).map(e=>this._unloadFromResolved(t[e]));await Promise.all(r)}async _unloadFromResolved(e){let t=Object.values(e);t.forEach(e=>{lz.remove(e.src)}),await this.loader.unload(t)}async _detectFormats(e){let t=[];for(let r of(e.preferredFormats&&(t=Array.isArray(e.preferredFormats)?e.preferredFormats:[e.preferredFormats]),e.detections))e.skipDetections||await r.test()?t=await r.add(t):e.skipDetections||(t=await r.remove(t));return t=t.filter((e,r)=>t.indexOf(e)===r)}get detections(){return this._detections}get preferWorkers(){return l6.config.preferWorkers}set preferWorkers(e){rl.deprecation("7.2.0","Assets.prefersWorkers is deprecated, use Assets.setPreferences({ preferWorkers: true }) instead."),this.setPreferences({preferWorkers:e})}setPreferences(e){this.loader.parsers.forEach(t=>{t.config&&Object.keys(t.config).filter(t=>t in e).forEach(r=>{t.config[r]=e[r]})})}};nu.handleByList(na.LoadParser,hi.loader.parsers).handleByList(na.ResolveParser,hi.resolver.parsers).handleByList(na.CacheParser,hi.cache.parsers).handleByList(na.DetectionParser,hi.detections);const hn={extension:na.CacheParser,test:e=>Array.isArray(e)&&e.every(e=>e instanceof sN),getCacheableAssets:(e,t)=>{let r={};return e.forEach(e=>{t.forEach((t,i)=>{r[e+(0===i?"":i+1)]=t})}),r}};async function hs(e){if("Image"in globalThis)return new Promise(t=>{let r=new Image;r.onload=()=>{t(!0)},r.onerror=()=>{t(!1)},r.src=e});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{let t=await (await fetch(e)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}nu.add(hn);const ho={extension:{type:na.DetectionParser,priority:1},test:async()=>hs("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async e=>[...e,"avif"],remove:async e=>e.filter(e=>"avif"!==e)};nu.add(ho);const ha={extension:{type:na.DetectionParser,priority:0},test:async()=>hs("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async e=>[...e,"webp"],remove:async e=>e.filter(e=>"webp"!==e)};nu.add(ha);const hl=["png","jpg","jpeg"],hh={extension:{type:na.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async e=>[...e,...hl],remove:async e=>e.filter(e=>!hl.includes(e))};nu.add(hh);const hu="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function hc(e){return!hu&&""!==document.createElement("video").canPlayType(e)}const hd={extension:{type:na.DetectionParser,priority:0},test:async()=>hc("video/webm"),add:async e=>[...e,"webm"],remove:async e=>e.filter(e=>"webm"!==e)};nu.add(hd);const hf={extension:{type:na.DetectionParser,priority:0},test:async()=>hc("video/mp4"),add:async e=>[...e,"mp4","m4v"],remove:async e=>e.filter(e=>"mp4"!==e&&"m4v"!==e)};nu.add(hf);const hp={extension:{type:na.DetectionParser,priority:0},test:async()=>hc("video/ogg"),add:async e=>[...e,"ogv"],remove:async e=>e.filter(e=>"ogv"!==e)};nu.add(hp);const hm={extension:na.ResolveParser,test:l6.test,parse:e=>({resolution:parseFloat(tJ.RETINA_PREFIX.exec(e)?.[1]??"1"),format:rl.path.extname(e).slice(1),src:e})};nu.add(hm);var hg=((ec=hg||{})[ec.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",ec[ec.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",ec[ec.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",ec[ec.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",ec[ec.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",ec[ec.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",ec[ec.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",ec[ec.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",ec[ec.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",ec[ec.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",ec[ec.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",ec[ec.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",ec[ec.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",ec[ec.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",ec[ec.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",ec[ec.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",ec[ec.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",ec[ec.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",ec[ec.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",ec[ec.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",ec[ec.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",ec[ec.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",ec[ec.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",ec[ec.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",ec[ec.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35987]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",ec[ec.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",ec[ec.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",ec);const hv={33776:.5,33777:.5,33778:1,33779:1,35916:.5,35917:.5,35918:1,35919:1,37488:.5,37489:.5,37490:1,37491:1,37492:.5,37496:1,37493:.5,37497:1,37494:.5,37495:.5,35840:.5,35842:.5,35841:.25,35843:.25,36196:.5,35986:.5,35987:1,34798:1,37808:1};function hy(){o={s3tc:s.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:s.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:s.getExtension("WEBGL_compressed_texture_etc"),etc1:s.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:s.getExtension("WEBGL_compressed_texture_atc"),astc:s.getExtension("WEBGL_compressed_texture_astc")}}const h_={extension:{type:na.DetectionParser,priority:2},test:async()=>{let e=tJ.ADAPTER.createCanvas().getContext("webgl");return e?(s=e,!0):(console.warn("WebGL not available for compressed textures."),!1)},add:async e=>{o||hy();let t=[];for(let e in o)o[e]&&t.push(e);return[...t,...e]},remove:async e=>(o||hy(),e.filter(e=>!(e in o)))};nu.add(h_);class hx extends n_{constructor(e,t={width:1,height:1,autoLoad:!0}){let r,i;"string"==typeof e?(r=e,i=new Uint8Array):(r=null,i=e),super(i,t),this.origin=r,this.buffer=i?new nd(i):null,this._load=null,this.loaded=!1,null!==this.origin&&!1!==t.autoLoad&&this.load(),null===this.origin&&this.buffer&&(this._load=Promise.resolve(this),this.loaded=!0,this.onBlobLoaded(this.buffer.rawBinaryData))}onBlobLoaded(e){}load(){return this._load||(this._load=fetch(this.origin).then(e=>e.blob()).then(e=>e.arrayBuffer()).then(e=>(this.data=new Uint32Array(e),this.buffer=new nd(e),this.loaded=!0,this.onBlobLoaded(e),this.update(),this))),this._load}}class hb extends hx{constructor(e,t){super(e,t),this.format=t.format,this.levels=t.levels||1,this._width=t.width,this._height=t.height,this._extension=hb._formatToExtension(this.format),(t.levelBuffers||this.buffer)&&(this._levelBuffers=t.levelBuffers||hb._createLevelBuffers(e instanceof Uint8Array?e:this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height))}upload(e,t,r){let i=e.gl;if(!e.context.extensions[this._extension])throw Error(`${this._extension} textures are not supported on the current machine`);if(!this._levelBuffers)return!1;i.pixelStorei(i.UNPACK_ALIGNMENT,4);for(let e=0,t=this.levels;e<t;e++){let{levelID:t,levelWidth:r,levelHeight:n,levelBuffer:s}=this._levelBuffers[e];i.compressedTexImage2D(i.TEXTURE_2D,t,this.format,r,n,0,s)}return!0}onBlobLoaded(){this._levelBuffers=hb._createLevelBuffers(this.buffer.uint8View,this.format,this.levels,4,4,this.width,this.height)}static _formatToExtension(e){if(e>=33776&&e<=33779)return"s3tc";if(e>=37488&&e<=37497)return"etc";if(e>=35840&&e<=35843)return"pvrtc";if(e>=36196)return"etc1";if(e>=35986&&e<=34798)return"atc";throw Error("Invalid (compressed) texture format given!")}static _createLevelBuffers(e,t,r,i,n,s,o){let a=Array(r),l=e.byteOffset,h=s,u=o,c=h+i-1&~(i-1),d=u+n-1&~(n-1),f=c*d*hv[t];for(let s=0;s<r;s++)a[s]={levelID:s,levelWidth:r>1?h:c,levelHeight:r>1?u:d,levelBuffer:new Uint8Array(e.buffer,l,f)},l+=f,u=u>>1||1,f=(c=(h=h>>1||1)+i-1&~(i-1))*(d=u+n-1&~(n-1))*hv[t];return a}}const hT={FOURCC:2},hA={DXGI_FORMAT:0,RESOURCE_DIMENSION:1,MISC_FLAG:2,ARRAY_SIZE:3},hE={827611204:hg.COMPRESSED_RGBA_S3TC_DXT1_EXT,861165636:hg.COMPRESSED_RGBA_S3TC_DXT3_EXT,894720068:hg.COMPRESSED_RGBA_S3TC_DXT5_EXT},hw={70:hg.COMPRESSED_RGBA_S3TC_DXT1_EXT,71:hg.COMPRESSED_RGBA_S3TC_DXT1_EXT,73:hg.COMPRESSED_RGBA_S3TC_DXT3_EXT,74:hg.COMPRESSED_RGBA_S3TC_DXT3_EXT,76:hg.COMPRESSED_RGBA_S3TC_DXT5_EXT,77:hg.COMPRESSED_RGBA_S3TC_DXT5_EXT,72:hg.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,75:hg.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,78:hg.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT},hC=[171,75,84,88,32,49,49,187,13,10,26,10],hS={ENDIANNESS:12,GL_TYPE:16,GL_FORMAT:24,GL_INTERNAL_FORMAT:28,PIXEL_WIDTH:36,PIXEL_HEIGHT:40,PIXEL_DEPTH:44,NUMBER_OF_ARRAY_ELEMENTS:48,NUMBER_OF_FACES:52,NUMBER_OF_MIPMAP_LEVELS:56,BYTES_OF_KEY_VALUE_DATA:60},hI={[rq.UNSIGNED_BYTE]:1,[rq.UNSIGNED_SHORT]:2,[rq.INT]:4,[rq.UNSIGNED_INT]:4,[rq.FLOAT]:4,[rq.HALF_FLOAT]:8},hR={[r$.RGBA]:4,[r$.RGB]:3,[r$.RG]:2,[r$.RED]:1,[r$.LUMINANCE]:1,[r$.LUMINANCE_ALPHA]:2,[r$.ALPHA]:1},hM={[rq.UNSIGNED_SHORT_4_4_4_4]:2,[rq.UNSIGNED_SHORT_5_5_5_1]:2,[rq.UNSIGNED_SHORT_5_6_5]:2},hP={extension:{type:na.LoadParser,priority:lH.High},name:"loadDDS",test:e=>lL(e,".dds"),async load(e,t,r){let i=(function(e){let t=new Uint32Array(e);if(542327876!==t[0])throw Error("Invalid DDS file magic word");let r=new Uint32Array(e,0,124/Uint32Array.BYTES_PER_ELEMENT),i=r[3],n=r[4],s=r[7],o=new Uint32Array(e,19*Uint32Array.BYTES_PER_ELEMENT,32/Uint32Array.BYTES_PER_ELEMENT),a=o[1];if(4&a){let r=o[hT.FOURCC];if(808540228!==r){let t=hE[r];return[new hb(new Uint8Array(e,128),{format:t,width:n,height:i,levels:s})]}let a=new Uint32Array(t.buffer,128,20/Uint32Array.BYTES_PER_ELEMENT),l=a[hA.DXGI_FORMAT],h=a[hA.RESOURCE_DIMENSION],u=a[hA.MISC_FLAG],c=a[hA.ARRAY_SIZE],d=hw[l];if(void 0===d)throw Error(`DDSParser cannot parse texture data with DXGI format ${l}`);if(4===u)throw Error("DDSParser does not support cubemap textures");if(6===h)throw Error("DDSParser does not supported 3D texture data");let f=[];if(1===c)f.push(new Uint8Array(e,148));else{let t=hv[d],r=0,o=n,a=i;for(let e=0;e<s;e++)r+=Math.max(1,o+3&-4)*Math.max(1,a+3&-4)*t,o>>>=1,a>>>=1;let l=148;for(let t=0;t<c;t++)f.push(new Uint8Array(e,l,r)),l+=r}return f.map(e=>new hb(e,{format:d,width:n,height:i,levels:s}))}throw 64&a?Error("DDSParser does not support uncompressed texture data."):512&a?Error("DDSParser does not supported YUV uncompressed texture data."):131072&a?Error("DDSParser does not support single-channel (lumninance) texture data!"):2&a?Error("DDSParser does not support single-channel (alpha) texture data!"):Error("DDSParser failed to load a texture file due to an unknown reason!")})(await (await tJ.ADAPTER.fetch(e)).arrayBuffer()).map(i=>l3(new nT(i,{mipmap:rJ.OFF,alphaMode:r0.NO_PREMULTIPLIED_ALPHA,resolution:rl.getResolutionOfUrl(e),...t.data}),r,e));return 1===i.length?i[0]:i},unload(e){Array.isArray(e)?e.forEach(e=>e.destroy(!0)):e.destroy(!0)}};nu.add(hP);const hO={extension:{type:na.LoadParser,priority:lH.High},name:"loadKTX",test:e=>lL(e,".ktx"),async load(e,t,r){let i=await (await tJ.ADAPTER.fetch(e)).arrayBuffer(),{compressed:n,uncompressed:s,kvData:o}=function(e,t,r=!1){let i;let n=new DataView(t);if(!function(e,t){for(let r=0;r<hC.length;r++)if(t.getUint8(r)!==hC[r])return console.error(`${e} is not a valid *.ktx file!`),!1;return!0}(e,n))return null;let s=67305985===n.getUint32(hS.ENDIANNESS,!0),o=n.getUint32(hS.GL_TYPE,s),a=n.getUint32(hS.GL_FORMAT,s),l=n.getUint32(hS.GL_INTERNAL_FORMAT,s),h=n.getUint32(hS.PIXEL_WIDTH,s),u=n.getUint32(hS.PIXEL_HEIGHT,s)||1,c=n.getUint32(hS.PIXEL_DEPTH,s)||1,d=n.getUint32(hS.NUMBER_OF_ARRAY_ELEMENTS,s)||1,f=n.getUint32(hS.NUMBER_OF_FACES,s),p=n.getUint32(hS.NUMBER_OF_MIPMAP_LEVELS,s),m=n.getUint32(hS.BYTES_OF_KEY_VALUE_DATA,s);if(0===u||1!==c)throw Error("Only 2D textures are supported");if(1!==f)throw Error("CubeTextures are not supported by KTXLoader yet!");if(1!==d)throw Error("WebGL does not support array textures");let g=h+3&-4,v=u+3&-4,y=Array(d),x=h*u;if(0===o&&(x=g*v),void 0===(i=0!==o?hI[o]?hI[o]*hR[a]:hM[o]:hv[l]))throw Error("Unable to resolve the pixel format stored in the *.ktx file!");let b=r?function(e,t,r){let i=new Map,n=0;for(;n<t;){let s=e.getUint32(64+n,r),o=64+n+4,a=3-(s+3)%4;if(0===s||s>t-n){console.error("KTXLoader: keyAndValueByteSize out of bounds");break}let l=0;for(;l<s&&0!==e.getUint8(o+l);l++);if(-1===l){console.error("KTXLoader: Failed to find null byte terminating kvData key");break}let h=new TextDecoder().decode(new Uint8Array(e.buffer,o,l)),u=new DataView(e.buffer,o+l+1,s-l-1);i.set(h,u),n+=4+s+a}return i}(n,m,s):null,T=x*i,A=h,E=u,w=g,C=v,S=64+m;for(let e=0;e<p;e++){let r=n.getUint32(S,s),a=S+4;for(let r=0;r<d;r++){let i=y[r];i||(i=y[r]=Array(p)),i[e]={levelID:e,levelWidth:p>1||0!==o?A:w,levelHeight:p>1||0!==o?E:C,levelBuffer:new Uint8Array(t,a,T)},a+=T}S+=r+4,S=S%4!=0?S+4-S%4:S,E=E>>1||1,T=(w=(A=A>>1||1)+4-1&-4)*(C=E+4-1&-4)*i}return 0!==o?{uncompressed:y.map(e=>{let t=e[0].levelBuffer,r=!1;return o===rq.FLOAT?t=new Float32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4):o===rq.UNSIGNED_INT?(r=!0,t=new Uint32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)):o===rq.INT&&(r=!0,t=new Int32Array(e[0].levelBuffer.buffer,e[0].levelBuffer.byteOffset,e[0].levelBuffer.byteLength/4)),{resource:new n_(t,{width:e[0].levelWidth,height:e[0].levelHeight}),type:o,format:r?function(e){switch(e){case r$.RGBA:return r$.RGBA_INTEGER;case r$.RGB:return r$.RGB_INTEGER;case r$.RG:return r$.RG_INTEGER;case r$.RED:return r$.RED_INTEGER;default:return e}}(a):a}}),kvData:b}:{compressed:y.map(e=>new hb(null,{format:l,width:h,height:u,levels:p,levelBuffers:e})),kvData:b}}(e,i),a=n??s,l={mipmap:rJ.OFF,alphaMode:r0.NO_PREMULTIPLIED_ALPHA,resolution:rl.getResolutionOfUrl(e),...t.data},h=a.map(t=>{a===s&&Object.assign(l,{type:t.type,format:t.format});let i=new nT(t.resource??t,l);return i.ktxKeyValueData=o,l3(i,r,e)});return 1===h.length?h[0]:h},unload(e){Array.isArray(e)?e.forEach(e=>e.destroy(!0)):e.destroy(!0)}};nu.add(hO);const hD={extension:na.ResolveParser,test:e=>["basis","ktx","dds"].includes(rl.path.extname(e).slice(1)),parse:e=>{let t=rl.path.extname(e).slice(1);if("ktx"===t){let t=[".s3tc.ktx",".s3tc_sRGB.ktx",".etc.ktx",".etc1.ktx",".pvrt.ktx",".atc.ktx",".astc.ktx"];if(t.some(t=>e.endsWith(t)))return{resolution:parseFloat(tJ.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t.find(t=>e.endsWith(t)),src:e}}return{resolution:parseFloat(tJ.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t,src:e}}};nu.add(hD);const hN=new nU,hF=class e{constructor(e){this.renderer=e,this._rendererPremultipliedAlpha=!1}contextChange(){let e=this.renderer?.gl.getContextAttributes();this._rendererPremultipliedAlpha=!!(e&&e.alpha&&e.premultipliedAlpha)}async image(e,t,r,i){let n=new Image;return n.src=await this.base64(e,t,r,i),n}async base64(e,t,r,i){let n=this.canvas(e,i);if(void 0!==n.toBlob)return new Promise((e,i)=>{n.toBlob(t=>{if(!t){i(Error("ICanvas.toBlob failed!"));return}let r=new FileReader;r.onload=()=>e(r.result),r.onerror=i,r.readAsDataURL(t)},t,r)});if(void 0!==n.toDataURL)return n.toDataURL(t,r);if(void 0!==n.convertToBlob){let e=await n.convertToBlob({type:t,quality:r});return new Promise((t,r)=>{let i=new FileReader;i.onload=()=>t(i.result),i.onerror=r,i.readAsDataURL(e)})}throw Error("Extract.base64() requires ICanvas.toDataURL, ICanvas.toBlob, or ICanvas.convertToBlob to be implemented")}canvas(t,r){let{pixels:i,width:n,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(t,r);o&&e._flipY(i,n,s),a&&e._unpremultiplyAlpha(i);let l=new rl.CanvasRenderTarget(n,s,1),h=new ImageData(new Uint8ClampedArray(i.buffer),n,s);return l.context.putImageData(h,0,0),l.canvas}pixels(t,r){let{pixels:i,width:n,height:s,flipY:o,premultipliedAlpha:a}=this._rawPixels(t,r);return o&&e._flipY(i,n,s),a&&e._unpremultiplyAlpha(i),i}_rawPixels(e,t){let r=this.renderer;if(!r)throw Error("The Extract has already been destroyed");let i,n=!1,s=!1,o,a=!1;e&&(e instanceof sF?o=e:(o=r.generateTexture(e,{region:t,resolution:r.resolution,multisample:r.multisample}),a=!0,t&&(hN.width=t.width,hN.height=t.height,t=hN)));let l=r.gl;if(o){if(i=o.baseTexture.resolution,t=t??o.frame,n=!1,s=o.baseTexture.alphaMode>0&&o.baseTexture.format===r$.RGBA,!a){r.renderTexture.bind(o);let e=o.framebuffer.glFramebuffers[r.CONTEXT_UID];e.blitFramebuffer&&r.framebuffer.bind(e.blitFramebuffer)}}else i=r.resolution,t||((t=hN).width=r.width/i,t.height=r.height/i),n=!0,s=this._rendererPremultipliedAlpha,r.renderTexture.bind();let h=Math.max(Math.round(t.width*i),1),u=Math.max(Math.round(t.height*i),1),c=new Uint8Array(4*h*u);return l.readPixels(Math.round(t.x*i),Math.round(t.y*i),h,u,l.RGBA,l.UNSIGNED_BYTE,c),a&&o?.destroy(!0),{pixels:c,width:h,height:u,flipY:n,premultipliedAlpha:s}}destroy(){this.renderer=null}static _flipY(e,t,r){let i=t<<2,n=r>>1,s=new Uint8Array(i);for(let t=0;t<n;t++){let n=t*i,o=(r-t-1)*i;s.set(e.subarray(n,n+i)),e.copyWithin(n,o,o+i),e.set(s,o)}}static _unpremultiplyAlpha(e){e instanceof Uint8ClampedArray&&(e=new Uint8Array(e.buffer));let t=e.length;for(let r=0;r<t;r+=4){let t=e[r+3];if(0!==t){let i=255.001/t;e[r]=e[r]*i+.5,e[r+1]=e[r+1]*i+.5,e[r+2]=e[r+2]*i+.5}}}};hF.extension={name:"extract",type:na.RendererSystem},nu.add(hF);const hB={build(e){let t,r,i,n,s,o;let a=e.points;if(e.type===nB.CIRC){let a=e.shape;t=a.x,r=a.y,s=o=a.radius,i=n=0}else if(e.type===nB.ELIP){let a=e.shape;t=a.x,r=a.y,s=a.width,o=a.height,i=n=0}else{let a=e.shape,l=a.width/2,h=a.height/2;t=a.x+l,r=a.y+h,s=o=Math.max(0,Math.min(a.radius,Math.min(l,h))),i=l-s,n=h-o}if(!(s>=0&&o>=0&&i>=0&&n>=0)){a.length=0;return}let l=Math.ceil(2.3*Math.sqrt(s+o)),h=8*l+(i?4:0)+(n?4:0);if(a.length=h,0===h)return;if(0===l){a.length=8,a[0]=a[6]=t+i,a[1]=a[3]=r+n,a[2]=a[4]=t-i,a[5]=a[7]=r-n;return}let u=0,c=4*l+(i?2:0)+2,d=c,f=h;{let e=i+s,o=n,l=t+e,h=t-e,p=r+o;if(a[u++]=l,a[u++]=p,a[--c]=p,a[--c]=h,n){let e=r-o;a[d++]=h,a[d++]=e,a[--f]=e,a[--f]=l}}for(let e=1;e<l;e++){let h=Math.PI/2*(e/l),p=i+Math.cos(h)*s,m=n+Math.sin(h)*o,g=t+p,v=t-p,y=r+m,x=r-m;a[u++]=g,a[u++]=y,a[--c]=y,a[--c]=v,a[d++]=v,a[d++]=x,a[--f]=x,a[--f]=g}{let e=i,s=n+o,l=t+e,h=t-e,c=r+s,d=r-s;a[u++]=l,a[u++]=c,a[--f]=d,a[--f]=l,i&&(a[u++]=h,a[u++]=c,a[--f]=d,a[--f]=h)}},triangulate(e,t){let r,i;let n=e.points,s=t.points,o=t.indices;if(0===n.length)return;let a=s.length/2,l=a;if(e.type!==nB.RREC){let t=e.shape;r=t.x,i=t.y}else{let t=e.shape;r=t.x+t.width/2,i=t.y+t.height/2}let h=e.matrix;s.push(e.matrix?h.a*r+h.c*i+h.tx:r,e.matrix?h.b*r+h.d*i+h.ty:i),a++,s.push(n[0],n[1]);for(let e=2;e<n.length;e+=2)s.push(n[e],n[e+1]),o.push(a++,l,a);o.push(l+1,l,a)}};function hL(e,t=!1){let r=e.length;if(r<6)return;let i=0;for(let t=0,n=e[r-2],s=e[r-1];t<r;t+=2){let r=e[t],o=e[t+1];i+=(r-n)*(o+s),n=r,s=o}if(!t&&i>0||t&&i<=0){let t=r/2;for(let i=t+t%2;i<r;i+=2){let t=r-i-2,n=r-i-1,s=i,o=i+1;[e[t],e[s]]=[e[s],e[t]],[e[n],e[o]]=[e[o],e[n]]}}}const hk={build(e){e.points=e.shape.points.slice()},triangulate(e,t){let r=e.points,i=e.holes,n=t.points,s=t.indices;if(r.length>=6){hL(r,!1);let e=[];for(let t=0;t<i.length;t++){let n=i[t];hL(n.points,!0),e.push(r.length/2),r=r.concat(n.points)}let t=rl.earcut(r,e,2);if(!t)return;let o=n.length/2;for(let e=0;e<t.length;e+=3)s.push(t[e]+o),s.push(t[e+1]+o),s.push(t[e+2]+o);for(let e=0;e<r.length;e++)n.push(r[e])}}};var hU=((ed=hU||{}).MITER="miter",ed.BEVEL="bevel",ed.ROUND="round",ed),hG=((ef=hG||{}).BUTT="butt",ef.ROUND="round",ef.SQUARE="square",ef);const hz={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount(e,t=20){if(!this.adaptive||!e||isNaN(e))return t;let r=Math.ceil(e/this.maxLength);return r<this.minSegments?r=this.minSegments:r>this.maxSegments&&(r=this.maxSegments),r}};class hj{static curveTo(e,t,r,i,n,s){let o=s[s.length-2],a=s[s.length-1]-t,l=o-e,h=i-t,u=r-e,c=Math.abs(a*u-l*h);if(c<1e-8||0===n)return(s[s.length-2]!==e||s[s.length-1]!==t)&&s.push(e,t),null;let d=a*a+l*l,f=h*h+u*u,p=a*h+l*u,m=n*Math.sqrt(d)/c,g=n*Math.sqrt(f)/c,v=m*p/d,y=g*p/f,x=m*u+g*l,b=m*h+g*a;return{cx:x+e,cy:b+t,radius:n,startAngle:Math.atan2(a*(g+v)-b,l*(g+v)-x),endAngle:Math.atan2(h*(m+y)-b,u*(m+y)-x),anticlockwise:l*h>u*a}}static arc(e,t,r,i,n,s,o,a,l){let h=o-s,u=hz._segmentsCount(Math.abs(h)*n,40*Math.ceil(Math.abs(h)/nD)),c=h/(2*u),d=2*c,f=Math.cos(c),p=Math.sin(c),m=u-1,g=m%1/m;for(let e=0;e<=m;++e){let t=c+s+d*(e+g*e),o=Math.cos(t),a=-Math.sin(t);l.push((f*o+p*a)*n+r,(-(f*a)+p*o)*n+i)}}}class hH{constructor(){this.reset()}begin(e,t,r){this.reset(),this.style=e,this.start=t,this.attribStart=r}end(e,t){this.attribSize=t-this.attribStart,this.size=e-this.start}reset(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0}}class hV{static curveLength(e,t,r,i,n,s,o,a){let l=0,h=0,u=0,c=0,d=0,f=0,p=0,m=0,g=0,v=0,y=0,x=e,b=t;for(let T=1;T<=10;++T)c=(u=(h=T/10)*h)*h,m=(p=(f=(d=1-h)*d)*d)*e+3*f*h*r+3*d*u*n+c*o,g=p*t+3*f*h*i+3*d*u*s+c*a,v=x-m,y=b-g,x=m,b=g,l+=Math.sqrt(v*v+y*y);return l}static curveTo(e,t,r,i,n,s,o){let a=o[o.length-2],l=o[o.length-1];o.length-=2;let h=hz._segmentsCount(hV.curveLength(a,l,e,t,r,i,n,s)),u=0,c=0,d=0,f=0,p=0;o.push(a,l);for(let m=1,g=0;m<=h;++m)d=(c=(u=1-(g=m/h))*u)*u,p=(f=g*g)*g,o.push(d*a+3*c*g*e+3*u*f*r+p*n,d*l+3*c*g*t+3*u*f*i+p*s)}}function hX(e,t,r,i,n,s,o,a){let l,h;o?(l=i,h=-r):(l=-i,h=r);let u=e-r*n+l,c=t-i*n+h,d=e+r*s+l,f=t+i*s+h;return a.push(u,c,d,f),2}function hW(e,t,r,i,n,s,o,a){let l=r-e,h=i-t,u=Math.atan2(l,h),c=Math.atan2(n-e,s-t);a&&u<c?u+=2*Math.PI:!a&&u>c&&(c+=2*Math.PI);let d=u,f=c-u,p=Math.sqrt(l*l+h*h),m=(15*Math.abs(f)*Math.sqrt(p)/Math.PI>>0)+1,g=f/m;if(d+=g,a){o.push(e,t,r,i);for(let r=1,i=d;r<m;r++,i+=g)o.push(e,t,e+Math.sin(i)*p,t+Math.cos(i)*p);o.push(e,t,n,s)}else{o.push(r,i,e,t);for(let r=1,i=d;r<m;r++,i+=g)o.push(e+Math.sin(i)*p,t+Math.cos(i)*p,e,t);o.push(n,s,e,t)}return 2*m}function h$(e,t){e.lineStyle.native?function(e,t){let r=0,i=e.shape,n=e.points||i.points,s=i.type!==nB.POLY||i.closeStroke;if(0===n.length)return;let o=t.points,a=t.indices,l=n.length/2,h=o.length/2,u=h;for(o.push(n[0],n[1]),r=1;r<l;r++)o.push(n[2*r],n[2*r+1]),a.push(u,u+1),u++;s&&a.push(u,h)}(e,t):function(e,t){let r=e.shape,i=e.points||r.points.slice(),n=t.closePointEps;if(0===i.length)return;let s=e.lineStyle,o=new nL(i[0],i[1]),a=new nL(i[i.length-2],i[i.length-1]),l=r.type!==nB.POLY||r.closeStroke,h=Math.abs(o.x-a.x)<n&&Math.abs(o.y-a.y)<n;if(l){i=i.slice(),h&&(i.pop(),i.pop(),a.set(i[i.length-2],i[i.length-1]));let e=(o.x+a.x)*.5,t=(a.y+o.y)*.5;i.unshift(e,t),i.push(e,t)}let u=t.points,c=i.length/2,d=i.length,f=u.length/2,p=s.width/2,m=p*p,g=s.miterLimit*s.miterLimit,v=i[0],y=i[1],x=i[2],b=i[3],T=0,A=0,E=-(y-b),w=v-x,C=0,S=0,I=Math.sqrt(E*E+w*w);E/=I,w/=I,E*=p,w*=p;let R=s.alignment,M=(1-R)*2,P=2*R;l||(s.cap===hG.ROUND?d+=hW(v-E*(M-P)*.5,y-w*(M-P)*.5,v-E*M,y-w*M,v+E*P,y+w*P,u,!0)+2:s.cap===hG.SQUARE&&(d+=hX(v,y,E,w,M,P,!0,u))),u.push(v-E*M,y-w*M,v+E*P,y+w*P);for(let e=1;e<c-1;++e){v=i[(e-1)*2],y=i[(e-1)*2+1],x=i[2*e],b=i[2*e+1],T=i[(e+1)*2],A=i[(e+1)*2+1],I=Math.sqrt((E=-(y-b))*E+(w=v-x)*w),E/=I,w/=I,E*=p,w*=p,I=Math.sqrt((C=-(b-A))*C+(S=x-T)*S),C/=I,S/=I,C*=p,S*=p;let t=x-v,r=y-b,n=x-T,o=A-b,a=t*n+r*o,l=r*n-o*t,h=l<0;if(Math.abs(l)<.001*Math.abs(a)){u.push(x-E*M,b-w*M,x+E*P,b+w*P),a>=0&&(s.join===hU.ROUND?d+=hW(x,b,x-E*M,b-w*M,x-C*M,b-S*M,u,!1)+4:d+=2,u.push(x-C*P,b-S*P,x+C*M,b+S*M));continue}let c=(-E+v)*(-w+b)-(-E+x)*(-w+y),f=(-C+T)*(-S+b)-(-C+x)*(-S+A),R=(t*f-n*c)/l,O=(o*c-r*f)/l,D=(R-x)*(R-x)+(O-b)*(O-b),N=x+(R-x)*M,F=b+(O-b)*M,B=x-(R-x)*P,L=b-(O-b)*P,k=h?M:P,U=D<=Math.min(t*t+r*r,n*n+o*o)+k*k*m,G=s.join;if(G===hU.MITER&&D/m>g&&(G=hU.BEVEL),U)switch(G){case hU.MITER:u.push(N,F,B,L);break;case hU.BEVEL:h?u.push(N,F,x+E*P,b+w*P,N,F,x+C*P,b+S*P):u.push(x-E*M,b-w*M,B,L,x-C*M,b-S*M,B,L),d+=2;break;case hU.ROUND:h?(u.push(N,F,x+E*P,b+w*P),d+=hW(x,b,x+E*P,b+w*P,x+C*P,b+S*P,u,!0)+4,u.push(N,F,x+C*P,b+S*P)):(u.push(x-E*M,b-w*M,B,L),d+=hW(x,b,x-E*M,b-w*M,x-C*M,b-S*M,u,!1)+4,u.push(x-C*M,b-S*M,B,L))}else{switch(u.push(x-E*M,b-w*M,x+E*P,b+w*P),G){case hU.MITER:h?u.push(B,L,B,L):u.push(N,F,N,F),d+=2;break;case hU.ROUND:h?d+=hW(x,b,x+E*P,b+w*P,x+C*P,b+S*P,u,!0)+2:d+=hW(x,b,x-E*M,b-w*M,x-C*M,b-S*M,u,!1)+2}u.push(x-C*M,b-S*M,x+C*P,b+S*P),d+=2}}v=i[(c-2)*2],y=i[(c-2)*2+1],x=i[(c-1)*2],I=Math.sqrt((E=-(y-(b=i[(c-1)*2+1])))*E+(w=v-x)*w),E/=I,w/=I,E*=p,w*=p,u.push(x-E*M,b-w*M,x+E*P,b+w*P),l||(s.cap===hG.ROUND?d+=hW(x-E*(M-P)*.5,b-w*(M-P)*.5,x-E*M,b-w*M,x+E*P,b+w*P,u,!1)+2:s.cap===hG.SQUARE&&(d+=hX(x,b,E,w,M,P,!1,u)));let O=t.indices,D=hz.epsilon*hz.epsilon;for(let e=f;e<d+f-2;++e)v=u[2*e],y=u[2*e+1],x=u[(e+1)*2],b=u[(e+1)*2+1],T=u[(e+2)*2],Math.abs(v*(b-(A=u[(e+2)*2+1]))+x*(A-y)+T*(y-b))<D||O.push(e,e+1,e+2)}(e,t)}class hY{static curveLength(e,t,r,i,n,s){let o=e-2*r+n,a=t-2*i+s,l=2*r-2*e,h=2*i-2*t,u=4*(o*o+a*a),c=4*(o*l+a*h),d=l*l+h*h,f=2*Math.sqrt(u+c+d),p=Math.sqrt(u),m=2*u*p,g=2*Math.sqrt(d),v=c/p;return(m*f+p*c*(f-g)+(4*d*u-c*c)*Math.log((2*p+v+f)/(v+g)))/(4*m)}static curveTo(e,t,r,i,n){let s=n[n.length-2],o=n[n.length-1],a=hz._segmentsCount(hY.curveLength(s,o,e,t,r,i)),l=0,h=0;for(let u=1;u<=a;++u){let c=u/a;l=s+(e-s)*c,h=o+(t-o)*c,n.push(l+(e+(r-e)*c-l)*c,h+(t+(i-t)*c-h)*c)}}}const hq={[nB.POLY]:hk,[nB.CIRC]:hB,[nB.ELIP]:hB,[nB.RECT]:{build(e){let t=e.shape,r=t.x,i=t.y,n=t.width,s=t.height,o=e.points;o.length=0,n>=0&&s>=0&&o.push(r,i,r+n,i,r+n,i+s,r,i+s)},triangulate(e,t){let r=e.points,i=t.points;if(0===r.length)return;let n=i.length/2;i.push(r[0],r[1],r[2],r[3],r[6],r[7],r[4],r[5]),t.indices.push(n,n+1,n+2,n+1,n+2,n+3)}},[nB.RREC]:{build(e){hB.build(e)},triangulate(e,t){hB.triangulate(e,t)}}},hZ=[],hK=[];class hQ{constructor(e,t=null,r=null,i=null){this.points=[],this.holes=[],this.shape=e,this.lineStyle=r,this.fillStyle=t,this.matrix=i,this.type=e.type}clone(){return new hQ(this.shape,this.fillStyle,this.lineStyle,this.matrix)}destroy(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null}}const hJ=new nL,h0=class e extends nO{constructor(){super(),this.closePointEps=1e-4,this.boundsPadding=0,this.uvsFloat32=null,this.indicesUint16=null,this.batchable=!1,this.points=[],this.colors=[],this.uvs=[],this.indices=[],this.textureIds=[],this.graphicsData=[],this.drawCalls=[],this.batchDirty=-1,this.batches=[],this.dirty=0,this.cacheDirty=-1,this.clearDirty=0,this.shapeIndex=0,this._bounds=new le,this.boundsDirty=-1}get bounds(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds}invalidate(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),hK.push(this.drawCalls[e]);this.drawCalls.length=0;for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t.reset(),hZ.push(t)}this.batches.length=0}clear(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this}drawShape(e,t=null,r=null,i=null){let n=new hQ(e,t,r,i);return this.graphicsData.push(n),this.dirty++,this}drawHole(e,t=null){if(!this.graphicsData.length)return null;let r=new hQ(e,null,null,t),i=this.graphicsData[this.graphicsData.length-1];return r.lineStyle=i.lineStyle,i.holes.push(r),this.dirty++,this}destroy(){super.destroy();for(let e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null}containsPoint(e){let t=this.graphicsData;for(let r=0;r<t.length;++r){let i=t[r];if(i.fillStyle.visible&&i.shape&&(i.matrix?i.matrix.applyInverse(e,hJ):hJ.copyFrom(e),i.shape.contains(hJ.x,hJ.y))){let e=!1;if(i.holes){for(let t=0;t<i.holes.length;t++)if(i.holes[t].shape.contains(hJ.x,hJ.y)){e=!0;break}}if(!e)return!0}}return!1}updateBatches(){if(!this.graphicsData.length){this.batchable=!0;return}if(!this.validateBatching())return;this.cacheDirty=this.dirty;let e=this.uvs,t=this.graphicsData,r=null,i=null;this.batches.length>0&&(i=(r=this.batches[this.batches.length-1]).style);for(let n=this.shapeIndex;n<t.length;n++){this.shapeIndex++;let s=t[n],o=s.fillStyle,a=s.lineStyle;hq[s.type].build(s),s.matrix&&this.transformPoints(s.points,s.matrix),(o.visible||a.visible)&&this.processHoles(s.holes);for(let t=0;t<2;t++){let n=0===t?o:a;if(!n.visible)continue;let l=n.texture.baseTexture,h=this.indices.length,u=this.points.length/2;l.wrapMode=rQ.REPEAT,0===t?this.processFill(s):this.processLine(s);let c=this.points.length/2-u;0!==c&&(r&&!this._compareStyles(i,n)&&(r.end(h,u),r=null),r||((r=hZ.pop()||new hH).begin(n,h,u),this.batches.push(r),i=n),this.addUvs(this.points,e,n.texture,u,c,n.matrix))}}let n=this.indices.length,s=this.points.length/2;if(r&&r.end(n,s),0===this.batches.length){this.batchable=!0;return}let o=s>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&o===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=o?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}_compareStyles(e,t){return!(!e||!t||e.texture.baseTexture!==t.texture.baseTexture||e.color+e.alpha!==t.color+t.alpha||!!e.native!=!!t.native)}validateBatching(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(let e=0,t=this.graphicsData.length;e<t;e++){let t=this.graphicsData[e],r=t.fillStyle,i=t.lineStyle;if(r&&!r.texture.baseTexture.valid||i&&!i.texture.baseTexture.valid)return!1}return!0}packBatches(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);let e=this.batches;for(let t=0,r=e.length;t<r;t++){let r=e[t];for(let e=0;e<r.size;e++){let t=r.start+e;this.indicesUint16[t]=this.indicesUint16[t]-r.attribStart}}}isBatchable(){if(this.points.length>131070)return!1;let t=this.batches;for(let e=0;e<t.length;e++)if(t[e].style.native)return!1;return this.points.length<2*e.BATCHABLE_SIZE}buildDrawCalls(){let e=++nT._globalBatch;for(let e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),hK.push(this.drawCalls[e]);this.drawCalls.length=0;let t=this.colors,r=this.textureIds,i=hK.pop();i||((i=new nA).texArray=new sp),i.texArray.count=0,i.start=0,i.size=0,i.type=rW.TRIANGLES;let n=0,s=null,o=0,a=!1,l=rW.TRIANGLES,h=0;this.drawCalls.push(i);for(let u=0;u<this.batches.length;u++){let c=this.batches[u],d=c.style,f=d.texture.baseTexture;!!d.native!==a&&(l=(a=!!d.native)?rW.LINES:rW.TRIANGLES,s=null,n=8,e++),s!==f&&(s=f,f._batchEnabled!==e&&(8===n&&(e++,n=0,i.size>0&&((i=hK.pop())||((i=new nA).texArray=new sp),this.drawCalls.push(i)),i.start=h,i.size=0,i.texArray.count=0,i.type=l),f.touched=1,f._batchEnabled=e,f._batchLocation=n,f.wrapMode=rQ.REPEAT,i.texArray.elements[i.texArray.count++]=f,n++)),i.size+=c.size,h+=c.size,o=f._batchLocation,this.addColors(t,d.color,d.alpha,c.attribSize,c.attribStart),this.addTextureIds(r,o,c.attribSize,c.attribStart)}nT._globalBatch=e,this.packAttributes()}packAttributes(){let e=this.points,t=this.uvs,r=this.colors,i=this.textureIds,n=new ArrayBuffer(12*e.length),s=new Float32Array(n),o=new Uint32Array(n),a=0;for(let n=0;n<e.length/2;n++)s[a++]=e[2*n],s[a++]=e[2*n+1],s[a++]=t[2*n],s[a++]=t[2*n+1],o[a++]=r[n],s[a++]=i[n];this._buffer.update(n),this._indexBuffer.update(this.indicesUint16)}processFill(e){e.holes.length?hk.triangulate(e,this):hq[e.type].triangulate(e,this)}processLine(e){h$(e,this);for(let t=0;t<e.holes.length;t++)h$(e.holes[t],this)}processHoles(e){for(let t=0;t<e.length;t++){let r=e[t];hq[r.type].build(r),r.matrix&&this.transformPoints(r.points,r.matrix)}}calculateBounds(){let e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)}transformPoints(e,t){for(let r=0;r<e.length/2;r++){let i=e[2*r],n=e[2*r+1];e[2*r]=t.a*i+t.c*n+t.tx,e[2*r+1]=t.b*i+t.d*n+t.ty}}addColors(e,t,r,i,n=0){let s=iP.shared.setValue(t).toLittleEndianNumber(),o=iP.shared.setValue(s).toPremultiplied(r);e.length=Math.max(e.length,n+i);for(let t=0;t<i;t++)e[n+t]=o}addTextureIds(e,t,r,i=0){e.length=Math.max(e.length,i+r);for(let n=0;n<r;n++)e[i+n]=t}addUvs(e,t,r,i,n,s=null){let o=0,a=t.length,l=r.frame;for(;o<n;){let r=e[(i+o)*2],n=e[(i+o)*2+1];if(s){let e=s.a*r+s.c*n+s.tx;n=s.b*r+s.d*n+s.ty,r=e}o++,t.push(r/l.width,n/l.height)}let h=r.baseTexture;(l.width<h.width||l.height<h.height)&&this.adjustUvs(t,r,a,n)}adjustUvs(e,t,r,i){let n=t.baseTexture,s=r+2*i,o=t.frame,a=o.width/n.width,l=o.height/n.height,h=o.x/o.width,u=o.y/o.height,c=Math.floor(e[r]+1e-6),d=Math.floor(e[r+1]+1e-6);for(let t=r+2;t<s;t+=2)c=Math.min(c,Math.floor(e[t]+1e-6)),d=Math.min(d,Math.floor(e[t+1]+1e-6));h-=c,u-=d;for(let t=r;t<s;t+=2)e[t]=(e[t]+h)*a,e[t+1]=(e[t+1]+u)*l}};h0.BATCHABLE_SIZE=100;class h1{constructor(){this.color=16777215,this.alpha=1,this.texture=sN.WHITE,this.matrix=null,this.visible=!1,this.reset()}clone(){let e=new h1;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e}reset(){this.color=16777215,this.alpha=1,this.texture=sN.WHITE,this.matrix=null,this.visible=!1}destroy(){this.texture=null,this.matrix=null}}class h2 extends h1{constructor(){super(...arguments),this.width=0,this.alignment=.5,this.native=!1,this.cap=hG.BUTT,this.join=hU.MITER,this.miterLimit=10}clone(){let e=new h2;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e}reset(){super.reset(),this.color=0,this.alignment=.5,this.width=0,this.native=!1,this.cap=hG.BUTT,this.join=hU.MITER,this.miterLimit=10}}const h3={},h4=class e extends lo{constructor(e=null){super(),this.shader=null,this.pluginName="batch",this.currentPath=null,this.batches=[],this.batchTint=-1,this.batchDirty=-1,this.vertexData=null,this._fillStyle=new h1,this._lineStyle=new h2,this._matrix=null,this._holeMode=!1,this.state=np.for2d(),this._geometry=e||new h0,this._geometry.refCount++,this._transformID=-1,this._tintColor=new iP(16777215),this.blendMode=rX.NORMAL}get geometry(){return this._geometry}clone(){return this.finishPoly(),new e(this._geometry)}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}get tint(){return this._tintColor.value}set tint(e){this._tintColor.setValue(e)}get fill(){return this._fillStyle}get line(){return this._lineStyle}lineStyle(e=null,t=0,r,i=.5,n=!1){return"number"==typeof e&&(e={width:e,color:t,alpha:r,alignment:i,native:n}),this.lineTextureStyle(e)}lineTextureStyle(e){e=Object.assign({width:0,texture:sN.WHITE,color:e?.texture?16777215:0,matrix:null,alignment:.5,native:!1,cap:hG.BUTT,join:hU.MITER,miterLimit:10},e),this.normalizeColor(e),this.currentPath&&this.startPoly();let t=e.width>0&&e.alpha>0;return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:t},e)):this._lineStyle.reset(),this}startPoly(){if(this.currentPath){let e=this.currentPath.points,t=this.currentPath.points.length;t>2&&(this.drawShape(this.currentPath),this.currentPath=new nj,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[t-2],e[t-1]))}else this.currentPath=new nj,this.currentPath.closeStroke=!1}finishPoly(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)}moveTo(e,t){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=t,this}lineTo(e,t){this.currentPath||this.moveTo(0,0);let r=this.currentPath.points,i=r[r.length-2],n=r[r.length-1];return(i!==e||n!==t)&&r.push(e,t),this}_initCurve(e=0,t=0){this.currentPath?0===this.currentPath.points.length&&(this.currentPath.points=[e,t]):this.moveTo(e,t)}quadraticCurveTo(e,t,r,i){this._initCurve();let n=this.currentPath.points;return 0===n.length&&this.moveTo(0,0),hY.curveTo(e,t,r,i,n),this}bezierCurveTo(e,t,r,i,n,s){return this._initCurve(),hV.curveTo(e,t,r,i,n,s,this.currentPath.points),this}arcTo(e,t,r,i,n){this._initCurve(e,t);let s=this.currentPath.points,o=hj.curveTo(e,t,r,i,n,s);if(o){let{cx:e,cy:t,radius:r,startAngle:i,endAngle:n,anticlockwise:s}=o;this.arc(e,t,r,i,n,s)}return this}arc(e,t,r,i,n,s=!1){if(i===n||(!s&&n<=i?n+=nD:s&&i<=n&&(i+=nD),n-i==0))return this;let o=e+Math.cos(i)*r,a=t+Math.sin(i)*r,l=this._geometry.closePointEps,h=this.currentPath?this.currentPath.points:null;if(h){let e=Math.abs(h[h.length-2]-o),t=Math.abs(h[h.length-1]-a);e<l&&t<l||h.push(o,a)}else this.moveTo(o,a),h=this.currentPath.points;return hj.arc(o,a,e,t,r,i,n,s,h),this}beginFill(e=0,t){return this.beginTextureFill({texture:sN.WHITE,color:e,alpha:t})}normalizeColor(e){let t=iP.shared.setValue(e.color??0);e.color=t.toNumber(),e.alpha??(e.alpha=t.alpha)}beginTextureFill(e){e=Object.assign({texture:sN.WHITE,color:16777215,matrix:null},e),this.normalizeColor(e),this.currentPath&&this.startPoly();let t=e.alpha>0;return t?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:t},e)):this._fillStyle.reset(),this}endFill(){return this.finishPoly(),this._fillStyle.reset(),this}drawRect(e,t,r,i){return this.drawShape(new nU(e,t,r,i))}drawRoundedRect(e,t,r,i,n){return this.drawShape(new nH(e,t,r,i,n))}drawCircle(e,t,r){return this.drawShape(new nG(e,t,r))}drawEllipse(e,t,r,i){return this.drawShape(new nz(e,t,r,i))}drawPolygon(...e){let t,r=!0,i=e[0];i.points?(r=i.closeStroke,t=i.points):t=Array.isArray(e[0])?e[0]:e;let n=new nj(t);return n.closeStroke=r,this.drawShape(n),this}drawShape(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this}clear(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this}isFastRect(){let e=this._geometry.graphicsData;return 1===e.length&&e[0].shape.type===nB.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)}_render(e){this.finishPoly();let t=this._geometry;t.updateBatches(),t.batchable?(this.batchDirty!==t.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))}_populateBatches(){let e=this._geometry,t=this.blendMode,r=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=r,this.vertexData=new Float32Array(e.points);for(let i=0;i<r;i++){let r=e.batches[i],n=r.style.color,s=new Float32Array(this.vertexData.buffer,8*r.attribStart,2*r.attribSize),o=new Float32Array(e.uvsFloat32.buffer,8*r.attribStart,2*r.attribSize),a={vertexData:s,blendMode:t,indices:new Uint16Array(e.indicesUint16.buffer,2*r.start,r.size),uvs:o,_batchRGB:iP.shared.setValue(n).toRgbArray(),_tintRGB:n,_texture:r.style.texture,alpha:r.style.alpha,worldAlpha:1};this.batches[i]=a}}_renderBatched(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(let t=0,r=this.batches.length;t<r;t++){let r=this.batches[t];r.worldAlpha=this.worldAlpha*r.alpha,e.plugins[this.pluginName].render(r)}}}_renderDirect(e){let t=this._resolveDirectShader(e),r=this._geometry,i=this.worldAlpha,n=t.uniforms,s=r.drawCalls;n.translationMatrix=this.transform.worldTransform,iP.shared.setValue(this._tintColor).premultiply(i).toArray(n.tint),e.shader.bind(t),e.geometry.bind(r,t),e.state.set(this.state);for(let t=0,i=s.length;t<i;t++)this._renderDrawCallDirect(e,r.drawCalls[t])}_renderDrawCallDirect(e,t){let{texArray:r,type:i,size:n,start:s}=t,o=r.count;for(let t=0;t<o;t++)e.texture.bind(r.elements[t],t);e.geometry.draw(i,n,s)}_resolveDirectShader(e){let t=this.shader,r=this.pluginName;if(!t){if(!h3[r]){let{maxTextures:t}=e.plugins[r],i=new Int32Array(t);for(let e=0;e<t;e++)i[e]=e;let n={tint:new Float32Array([1,1,1,1]),translationMatrix:new nV,default:sc.from({uSamplers:i},!0)},s=e.plugins[r]._shader.program;h3[r]=new sd(s,n)}t=h3[r]}return t}_calculateBounds(){this.finishPoly();let e=this._geometry;if(!e.graphicsData.length)return;let{minX:t,minY:r,maxX:i,maxY:n}=e.bounds;this._bounds.addFrame(this.transform,t,r,i,n)}containsPoint(t){return this.worldTransform.applyInverse(t,e._TEMP_POINT),this._geometry.containsPoint(e._TEMP_POINT)}calculateTints(){if(this.batchTint!==this.tint){this.batchTint=this._tintColor.toNumber();for(let e=0;e<this.batches.length;e++){let t=this.batches[e];t._tintRGB=iP.shared.setValue(this._tintColor).multiply(t._batchRGB).toLittleEndianNumber()}}}calculateVertices(){let e=this.transform._worldID;if(this._transformID===e)return;this._transformID=e;let t=this.transform.worldTransform,r=t.a,i=t.b,n=t.c,s=t.d,o=t.tx,a=t.ty,l=this._geometry.points,h=this.vertexData,u=0;for(let e=0;e<l.length;e+=2){let t=l[e],c=l[e+1];h[u++]=r*t+n*c+o,h[u++]=s*c+i*t+a}}closePath(){let e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this}setMatrix(e){return this._matrix=e,this}beginHole(){return this.finishPoly(),this._holeMode=!0,this}endHole(){return this.finishPoly(),this._holeMode=!1,this}destroy(e){this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,super.destroy(e)}};h4.curves=hz,h4._TEMP_POINT=new nL;class h5{constructor(e,t){this.uvBuffer=e,this.uvMatrix=t,this.data=null,this._bufferUpdateId=-1,this._textureUpdateId=-1,this._updateID=0}update(e){if(!e&&this._bufferUpdateId===this.uvBuffer._updateID&&this._textureUpdateId===this.uvMatrix._updateID)return;this._bufferUpdateId=this.uvBuffer._updateID,this._textureUpdateId=this.uvMatrix._updateID;let t=this.uvBuffer.data;this.data&&this.data.length===t.length||(this.data=new Float32Array(t.length)),this.uvMatrix.multiplyUvs(t,this.data),this._updateID++}}const h8=new nL,h6=new nj;(class e extends lo{constructor(e,t,r,i=rW.TRIANGLES){super(),this.geometry=e,this.shader=t,this.state=r||np.for2d(),this.drawMode=i,this.start=0,this.size=0,this.uvs=null,this.indices=null,this.vertexData=new Float32Array(1),this.vertexDirty=-1,this._transformID=-1,this._roundPixels=tJ.ROUND_PIXELS,this.batchUvs=null}get geometry(){return this._geometry}set geometry(e){this._geometry!==e&&(this._geometry&&(this._geometry.refCount--,0===this._geometry.refCount&&this._geometry.dispose()),this._geometry=e,this._geometry&&this._geometry.refCount++,this.vertexDirty=-1)}get uvBuffer(){return this.geometry.buffers[1]}get verticesBuffer(){return this.geometry.buffers[0]}set material(e){this.shader=e}get material(){return this.shader}set blendMode(e){this.state.blendMode=e}get blendMode(){return this.state.blendMode}set roundPixels(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e}get roundPixels(){return this._roundPixels}get tint(){return"tint"in this.shader?this.shader.tint:null}set tint(e){this.shader.tint=e}get tintValue(){return this.shader.tintValue}get texture(){return"texture"in this.shader?this.shader.texture:null}set texture(e){this.shader.texture=e}_render(t){let r=this.geometry.buffers[0].data;this.shader.batchable&&this.drawMode===rW.TRIANGLES&&r.length<2*e.BATCHABLE_SIZE?this._renderToBatch(t):this._renderDefault(t)}_renderDefault(e){let t=this.shader;t.alpha=this.worldAlpha,t.update&&t.update(),e.batch.flush(),t.uniforms.translationMatrix=this.transform.worldTransform.toArray(!0),e.shader.bind(t),e.state.set(this.state),e.geometry.bind(this.geometry,t),e.geometry.draw(this.drawMode,this.size,this.start,this.geometry.instanceCount)}_renderToBatch(e){let t=this.geometry,r=this.shader;r.uvMatrix&&(r.uvMatrix.update(),this.calculateUvs()),this.calculateVertices(),this.indices=t.indexBuffer.data,this._tintRGB=r._tintRGB,this._texture=r.texture;let i=this.material.pluginName;e.batch.setObjectRenderer(e.plugins[i]),e.plugins[i].render(this)}calculateVertices(){let e=this.geometry.buffers[0],t=e.data,r=e._updateID;if(r===this.vertexDirty&&this._transformID===this.transform._worldID)return;this._transformID=this.transform._worldID,this.vertexData.length!==t.length&&(this.vertexData=new Float32Array(t.length));let i=this.transform.worldTransform,n=i.a,s=i.b,o=i.c,a=i.d,l=i.tx,h=i.ty,u=this.vertexData;for(let e=0;e<u.length/2;e++){let r=t[2*e],i=t[2*e+1];u[2*e]=n*r+o*i+l,u[2*e+1]=s*r+a*i+h}if(this._roundPixels){let e=tJ.RESOLUTION;for(let t=0;t<u.length;++t)u[t]=Math.round(u[t]*e)/e}this.vertexDirty=r}calculateUvs(){let e=this.geometry.buffers[1],t=this.shader;t.uvMatrix.isSimple?this.uvs=e.data:(this.batchUvs||(this.batchUvs=new h5(e,t.uvMatrix)),this.batchUvs.update(),this.uvs=this.batchUvs.data)}_calculateBounds(){this.calculateVertices(),this._bounds.addVertexData(this.vertexData,0,this.vertexData.length)}containsPoint(e){if(!this.getBounds().contains(e.x,e.y))return!1;this.worldTransform.applyInverse(e,h8);let t=this.geometry.getBuffer("aVertexPosition").data,r=h6.points,i=this.geometry.getIndex().data,n=i.length,s=4===this.drawMode?3:1;for(let e=0;e+2<n;e+=s){let n=2*i[e],s=2*i[e+1],o=2*i[e+2];if(r[0]=t[n],r[1]=t[n+1],r[2]=t[s],r[3]=t[s+1],r[4]=t[o],r[5]=t[o+1],h6.contains(h8.x,h8.y))return!0}return!1}destroy(e){super.destroy(e),this._cachedTexture&&(this._cachedTexture.destroy(),this._cachedTexture=null),this.geometry=null,this.shader=null,this.state=null,this.uvs=null,this.indices=null,this.vertexData=null}}).BATCHABLE_SIZE=100;var h7=`varying vec2 vTextureCoord;
uniform vec4 uColor;

uniform sampler2D uSampler;

void main(void)
{
    gl_FragColor = texture2D(uSampler, vTextureCoord) * uColor;
}
`,h9=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTextureMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTextureMatrix * vec3(aTextureCoord, 1.0)).xy;
}
`;class ue{constructor(e,t,r){this.geometry=new nP,this.indexBuffer=null,this.size=r,this.dynamicProperties=[],this.staticProperties=[];for(let r=0;r<e.length;++r){let i=e[r];i={attributeName:i.attributeName,size:i.size,uploadFunction:i.uploadFunction,type:i.type||rq.FLOAT,offset:i.offset},t[r]?this.dynamicProperties.push(i):this.staticProperties.push(i)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this._updateID=0,this.initBuffers()}initBuffers(){let e=this.geometry,t=0;this.indexBuffer=new nw(rl.createIndicesForQuads(this.size),!0,!0),e.addIndex(this.indexBuffer),this.dynamicStride=0;for(let e=0;e<this.dynamicProperties.length;++e){let r=this.dynamicProperties[e];r.offset=t,t+=r.size,this.dynamicStride+=r.size}let r=new ArrayBuffer(this.size*this.dynamicStride*16);this.dynamicData=new Float32Array(r),this.dynamicDataUint32=new Uint32Array(r),this.dynamicBuffer=new nw(this.dynamicData,!1,!1);let i=0;this.staticStride=0;for(let e=0;e<this.staticProperties.length;++e){let t=this.staticProperties[e];t.offset=i,i+=t.size,this.staticStride+=t.size}let n=new ArrayBuffer(this.size*this.staticStride*16);this.staticData=new Float32Array(n),this.staticDataUint32=new Uint32Array(n),this.staticBuffer=new nw(this.staticData,!0,!1);for(let t=0;t<this.dynamicProperties.length;++t){let r=this.dynamicProperties[t];e.addAttribute(r.attributeName,this.dynamicBuffer,0,r.type===rq.UNSIGNED_BYTE,r.type,4*this.dynamicStride,4*r.offset)}for(let t=0;t<this.staticProperties.length;++t){let r=this.staticProperties[t];e.addAttribute(r.attributeName,this.staticBuffer,0,r.type===rq.UNSIGNED_BYTE,r.type,4*this.staticStride,4*r.offset)}}uploadDynamic(e,t,r){for(let i=0;i<this.dynamicProperties.length;i++){let n=this.dynamicProperties[i];n.uploadFunction(e,t,r,n.type===rq.UNSIGNED_BYTE?this.dynamicDataUint32:this.dynamicData,this.dynamicStride,n.offset)}this.dynamicBuffer._updateID++}uploadStatic(e,t,r){for(let i=0;i<this.staticProperties.length;i++){let n=this.staticProperties[i];n.uploadFunction(e,t,r,n.type===rq.UNSIGNED_BYTE?this.staticDataUint32:this.staticData,this.staticStride,n.offset)}this.staticBuffer._updateID++}destroy(){this.indexBuffer=null,this.dynamicProperties=null,this.dynamicBuffer=null,this.dynamicData=null,this.dynamicDataUint32=null,this.staticProperties=null,this.staticBuffer=null,this.staticData=null,this.staticDataUint32=null,this.geometry.destroy()}}var ut=`varying vec2 vTextureCoord;
varying vec4 vColor;

uniform sampler2D uSampler;

void main(void){
    vec4 color = texture2D(uSampler, vTextureCoord) * vColor;
    gl_FragColor = color;
}`,ur=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;

attribute vec2 aPositionCoord;
attribute float aRotation;

uniform mat3 translationMatrix;
uniform vec4 uColor;

varying vec2 vTextureCoord;
varying vec4 vColor;

void main(void){
    float x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);
    float y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);

    vec2 v = vec2(x, y);
    v = v + aPositionCoord;

    gl_Position = vec4((translationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vColor = aColor * uColor;
}
`;class ui extends sm{constructor(e){super(e),this.shader=null,this.properties=null,this.tempMatrix=new nV,this.properties=[{attributeName:"aVertexPosition",size:2,uploadFunction:this.uploadVertices,offset:0},{attributeName:"aPositionCoord",size:2,uploadFunction:this.uploadPosition,offset:0},{attributeName:"aRotation",size:1,uploadFunction:this.uploadRotation,offset:0},{attributeName:"aTextureCoord",size:2,uploadFunction:this.uploadUvs,offset:0},{attributeName:"aColor",size:1,type:rq.UNSIGNED_BYTE,uploadFunction:this.uploadTint,offset:0}],this.shader=sd.from(ur,ut,{}),this.state=np.for2d()}render(e){let t=e.children,r=e._maxSize,i=e._batchSize,n=this.renderer,s=t.length;if(0===s)return;s>r&&!e.autoResize&&(s=r);let o=e._buffers;o||(o=e._buffers=this.generateBuffers(e));let a=t[0]._texture.baseTexture,l=a.alphaMode>0;this.state.blendMode=rl.correctBlendMode(e.blendMode,l),n.state.set(this.state);let h=n.gl,u=e.worldTransform.copyTo(this.tempMatrix);u.prepend(n.globalUniforms.uniforms.projectionMatrix),this.shader.uniforms.translationMatrix=u.toArray(!0),this.shader.uniforms.uColor=iP.shared.setValue(e.tintRgb).premultiply(e.worldAlpha,l).toArray(this.shader.uniforms.uColor),this.shader.uniforms.uSampler=a,this.renderer.shader.bind(this.shader);let c=!1;for(let r=0,a=0;r<s;r+=i,a+=1){let l=s-r;l>i&&(l=i),a>=o.length&&o.push(this._generateOneMoreBuffer(e));let u=o[a];u.uploadDynamic(t,r,l);let d=e._bufferUpdateIDs[a]||0;(c=c||u._updateID<d)&&(u._updateID=e._updateID,u.uploadStatic(t,r,l)),n.geometry.bind(u.geometry),h.drawElements(h.TRIANGLES,6*l,h.UNSIGNED_SHORT,0)}}generateBuffers(e){let t=[],r=e._maxSize,i=e._batchSize,n=e._properties;for(let e=0;e<r;e+=i)t.push(new ue(this.properties,n,i));return t}_generateOneMoreBuffer(e){let t=e._batchSize,r=e._properties;return new ue(this.properties,r,t)}uploadVertices(e,t,r,i,n,s){let o=0,a=0,l=0,h=0;for(let u=0;u<r;++u){let r=e[t+u],c=r._texture,d=r.scale.x,f=r.scale.y,p=c.trim,m=c.orig;p?(o=(a=p.x-r.anchor.x*m.width)+p.width,l=(h=p.y-r.anchor.y*m.height)+p.height):(o=m.width*(1-r.anchor.x),a=-(m.width*r.anchor.x),l=m.height*(1-r.anchor.y),h=-(m.height*r.anchor.y)),i[s]=a*d,i[s+1]=h*f,i[s+n]=o*d,i[s+n+1]=h*f,i[s+2*n]=o*d,i[s+2*n+1]=l*f,i[s+3*n]=a*d,i[s+3*n+1]=l*f,s+=4*n}}uploadPosition(e,t,r,i,n,s){for(let o=0;o<r;o++){let r=e[t+o].position;i[s]=r.x,i[s+1]=r.y,i[s+n]=r.x,i[s+n+1]=r.y,i[s+2*n]=r.x,i[s+2*n+1]=r.y,i[s+3*n]=r.x,i[s+3*n+1]=r.y,s+=4*n}}uploadRotation(e,t,r,i,n,s){for(let o=0;o<r;o++){let r=e[t+o].rotation;i[s]=r,i[s+n]=r,i[s+2*n]=r,i[s+3*n]=r,s+=4*n}}uploadUvs(e,t,r,i,n,s){for(let o=0;o<r;++o){let r=e[t+o]._texture._uvs;r?(i[s]=r.x0,i[s+1]=r.y0,i[s+n]=r.x1,i[s+n+1]=r.y1,i[s+2*n]=r.x2,i[s+2*n+1]=r.y2,i[s+3*n]=r.x3,i[s+3*n+1]=r.y3):(i[s]=0,i[s+1]=0,i[s+n]=0,i[s+n+1]=0,i[s+2*n]=0,i[s+2*n+1]=0,i[s+3*n]=0,i[s+3*n+1]=0),s+=4*n}}uploadTint(e,t,r,i,n,s){for(let o=0;o<r;++o){let r=e[t+o],a=iP.shared.setValue(r._tintRGB).toPremultiplied(r.alpha,r.texture.baseTexture.alphaMode>0);i[s]=a,i[s+n]=a,i[s+2*n]=a,i[s+3*n]=a,s+=4*n}}destroy(){super.destroy(),this.shader&&(this.shader.destroy(),this.shader=null),this.tempMatrix=null}}ui.extension={name:"particle",type:na.RendererPlugin},nu.add(ui);var un=((ep=un||{})[ep.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",ep[ep.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL",ep);const us={willReadFrequently:!0},uo=class e{static get experimentalLetterSpacingSupported(){let t=e._experimentalLetterSpacingSupported;if(void 0!==t){let r=tJ.ADAPTER.getCanvasRenderingContext2D().prototype;t=e._experimentalLetterSpacingSupported="letterSpacing"in r||"textLetterSpacing"in r}return t}constructor(e,t,r,i,n,s,o,a,l){this.text=e,this.style=t,this.width=r,this.height=i,this.lines=n,this.lineWidths=s,this.lineHeight=o,this.maxLineWidth=a,this.fontProperties=l}static measureText(t,r,i,n=e._canvas){i=i??r.wordWrap;let s=r.toFontString(),o=e.measureFont(s);0===o.fontSize&&(o.fontSize=r.fontSize,o.ascent=r.fontSize);let a=n.getContext("2d",us);a.font=s;let l=(i?e.wordWrap(t,r,n):t).split(/(?:\r\n|\r|\n)/),h=Array(l.length),u=0;for(let t=0;t<l.length;t++){let i=e._measureText(l[t],r.letterSpacing,a);h[t]=i,u=Math.max(u,i)}let c=u+r.strokeThickness;r.dropShadow&&(c+=r.dropShadowDistance);let d=r.lineHeight||o.fontSize+r.strokeThickness,f=Math.max(d,o.fontSize+2*r.strokeThickness)+r.leading+(l.length-1)*(d+r.leading);return r.dropShadow&&(f+=r.dropShadowDistance),new e(t,r,c,f,l,h,d+r.leading,u,o)}static _measureText(t,r,i){let n=!1;e.experimentalLetterSpacingSupported&&(e.experimentalLetterSpacing?(i.letterSpacing=`${r}px`,i.textLetterSpacing=`${r}px`,n=!0):(i.letterSpacing="0px",i.textLetterSpacing="0px"));let s=i.measureText(t).width;return s>0&&(n?s-=r:s+=(e.graphemeSegmenter(t).length-1)*r),s}static wordWrap(t,r,i=e._canvas){let n=i.getContext("2d",us),s=0,o="",a="",l=Object.create(null),{letterSpacing:h,whiteSpace:u}=r,c=e.collapseSpaces(u),d=e.collapseNewlines(u),f=!c,p=r.wordWrapWidth+h,m=e.tokenize(t);for(let t=0;t<m.length;t++){let i=m[t];if(e.isNewline(i)){if(!d){a+=e.addLine(o),f=!c,o="",s=0;continue}i=" "}if(c){let t=e.isBreakingSpace(i),r=e.isBreakingSpace(o[o.length-1]);if(t&&r)continue}let u=e.getFromCache(i,h,l,n);if(u>p){if(""!==o&&(a+=e.addLine(o),o="",s=0),e.canBreakWords(i,r.breakWords)){let t=e.wordWrapSplit(i);for(let u=0;u<t.length;u++){let c=t[u],d=c,m=1;for(;t[u+m];){let n=t[u+m];if(e.canBreakChars(d,n,i,u,r.breakWords))break;c+=n,d=n,m++}u+=m-1;let g=e.getFromCache(c,h,l,n);g+s>p&&(a+=e.addLine(o),f=!1,o="",s=0),o+=c,s+=g}}else{o.length>0&&(a+=e.addLine(o),o="",s=0);let r=t===m.length-1;a+=e.addLine(i,!r),f=!1,o="",s=0}}else u+s>p&&(f=!1,a+=e.addLine(o),o="",s=0),(o.length>0||!e.isBreakingSpace(i)||f)&&(o+=i,s+=u)}return a+e.addLine(o,!1)}static addLine(t,r=!0){return t=e.trimRight(t),t=r?`${t}
`:t}static getFromCache(t,r,i,n){let s=i[t];return"number"!=typeof s&&(s=e._measureText(t,r,n)+r,i[t]=s),s}static collapseSpaces(e){return"normal"===e||"pre-line"===e}static collapseNewlines(e){return"normal"===e}static trimRight(t){if("string"!=typeof t)return"";for(let r=t.length-1;r>=0;r--){let i=t[r];if(!e.isBreakingSpace(i))break;t=t.slice(0,-1)}return t}static isNewline(t){return"string"==typeof t&&e._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,r){return"string"==typeof t&&e._breakingSpaces.includes(t.charCodeAt(0))}static tokenize(t){let r=[],i="";if("string"!=typeof t)return r;for(let n=0;n<t.length;n++){let s=t[n],o=t[n+1];if(e.isBreakingSpace(s,o)||e.isNewline(s)){""!==i&&(r.push(i),i=""),r.push(s);continue}i+=s}return""!==i&&r.push(i),r}static canBreakWords(e,t){return t}static canBreakChars(e,t,r,i,n){return!0}static wordWrapSplit(t){return e.graphemeSegmenter(t)}static measureFont(t){if(e._fonts[t])return e._fonts[t];let r={ascent:0,descent:0,fontSize:0},i=e._canvas,n=e._context;n.font=t;let s=e.METRICS_STRING+e.BASELINE_SYMBOL,o=Math.ceil(n.measureText(s).width),a=Math.ceil(n.measureText(e.BASELINE_SYMBOL).width),l=Math.ceil(e.HEIGHT_MULTIPLIER*a);if(a=a*e.BASELINE_MULTIPLIER|0,0===o||0===l)return e._fonts[t]=r,r;i.width=o,i.height=l,n.fillStyle="#f00",n.fillRect(0,0,o,l),n.font=t,n.textBaseline="alphabetic",n.fillStyle="#000",n.fillText(s,0,a);let h=n.getImageData(0,0,o,l).data,u=h.length,c=4*o,d=0,f=0,p=!1;for(d=0;d<a;++d){for(let e=0;e<c;e+=4)if(255!==h[f+e]){p=!0;break}if(p)break;f+=c}for(r.ascent=a-d,f=u-c,p=!1,d=l;d>a;--d){for(let e=0;e<c;e+=4)if(255!==h[f+e]){p=!0;break}if(p)break;f-=c}return r.descent=d-a,r.fontSize=r.ascent+r.descent,e._fonts[t]=r,r}static clearMetrics(t=""){t?delete e._fonts[t]:e._fonts={}}static get _canvas(){if(!e.__canvas){let t;try{let r=new OffscreenCanvas(0,0);if(r.getContext("2d",us)?.measureText)return e.__canvas=r,r;t=tJ.ADAPTER.createCanvas()}catch{t=tJ.ADAPTER.createCanvas()}t.width=t.height=10,e.__canvas=t}return e.__canvas}static get _context(){return e.__context||(e.__context=e._canvas.getContext("2d",us)),e.__context}};uo.METRICS_STRING="|ÉqÅ",uo.BASELINE_SYMBOL="M",uo.BASELINE_MULTIPLIER=1.4,uo.HEIGHT_MULTIPLIER=2,uo.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){let e=new Intl.Segmenter;return t=>[...e.segment(t)].map(e=>e.segment)}return e=>[...e]})(),uo.experimentalLetterSpacing=!1,uo._fonts={},uo._newlines=[10,13],uo._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];const ua=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],ul=class e{constructor(e){this.styleID=0,this.reset(),uc(this,e,e)}clone(){let t={};return uc(t,this,e.defaultStyle),new e(t)}reset(){uc(this,e.defaultStyle,e.defaultStyle)}get align(){return this._align}set align(e){this._align!==e&&(this._align=e,this.styleID++)}get breakWords(){return this._breakWords}set breakWords(e){this._breakWords!==e&&(this._breakWords=e,this.styleID++)}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(this._dropShadow=e,this.styleID++)}get dropShadowAlpha(){return this._dropShadowAlpha}set dropShadowAlpha(e){this._dropShadowAlpha!==e&&(this._dropShadowAlpha=e,this.styleID++)}get dropShadowAngle(){return this._dropShadowAngle}set dropShadowAngle(e){this._dropShadowAngle!==e&&(this._dropShadowAngle=e,this.styleID++)}get dropShadowBlur(){return this._dropShadowBlur}set dropShadowBlur(e){this._dropShadowBlur!==e&&(this._dropShadowBlur=e,this.styleID++)}get dropShadowColor(){return this._dropShadowColor}set dropShadowColor(e){let t=uu(e);this._dropShadowColor!==t&&(this._dropShadowColor=t,this.styleID++)}get dropShadowDistance(){return this._dropShadowDistance}set dropShadowDistance(e){this._dropShadowDistance!==e&&(this._dropShadowDistance=e,this.styleID++)}get fill(){return this._fill}set fill(e){let t=uu(e);this._fill!==t&&(this._fill=t,this.styleID++)}get fillGradientType(){return this._fillGradientType}set fillGradientType(e){this._fillGradientType!==e&&(this._fillGradientType=e,this.styleID++)}get fillGradientStops(){return this._fillGradientStops}set fillGradientStops(e){(function(e,t){if(!Array.isArray(e)||!Array.isArray(t)||e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0})(this._fillGradientStops,e)||(this._fillGradientStops=e,this.styleID++)}get fontFamily(){return this._fontFamily}set fontFamily(e){this.fontFamily!==e&&(this._fontFamily=e,this.styleID++)}get fontSize(){return this._fontSize}set fontSize(e){this._fontSize!==e&&(this._fontSize=e,this.styleID++)}get fontStyle(){return this._fontStyle}set fontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.styleID++)}get fontVariant(){return this._fontVariant}set fontVariant(e){this._fontVariant!==e&&(this._fontVariant=e,this.styleID++)}get fontWeight(){return this._fontWeight}set fontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.styleID++)}get letterSpacing(){return this._letterSpacing}set letterSpacing(e){this._letterSpacing!==e&&(this._letterSpacing=e,this.styleID++)}get lineHeight(){return this._lineHeight}set lineHeight(e){this._lineHeight!==e&&(this._lineHeight=e,this.styleID++)}get leading(){return this._leading}set leading(e){this._leading!==e&&(this._leading=e,this.styleID++)}get lineJoin(){return this._lineJoin}set lineJoin(e){this._lineJoin!==e&&(this._lineJoin=e,this.styleID++)}get miterLimit(){return this._miterLimit}set miterLimit(e){this._miterLimit!==e&&(this._miterLimit=e,this.styleID++)}get padding(){return this._padding}set padding(e){this._padding!==e&&(this._padding=e,this.styleID++)}get stroke(){return this._stroke}set stroke(e){let t=uu(e);this._stroke!==t&&(this._stroke=t,this.styleID++)}get strokeThickness(){return this._strokeThickness}set strokeThickness(e){this._strokeThickness!==e&&(this._strokeThickness=e,this.styleID++)}get textBaseline(){return this._textBaseline}set textBaseline(e){this._textBaseline!==e&&(this._textBaseline=e,this.styleID++)}get trim(){return this._trim}set trim(e){this._trim!==e&&(this._trim=e,this.styleID++)}get whiteSpace(){return this._whiteSpace}set whiteSpace(e){this._whiteSpace!==e&&(this._whiteSpace=e,this.styleID++)}get wordWrap(){return this._wordWrap}set wordWrap(e){this._wordWrap!==e&&(this._wordWrap=e,this.styleID++)}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(e){this._wordWrapWidth!==e&&(this._wordWrapWidth=e,this.styleID++)}toFontString(){let e="number"==typeof this.fontSize?`${this.fontSize}px`:this.fontSize,t=this.fontFamily;Array.isArray(this.fontFamily)||(t=this.fontFamily.split(","));for(let e=t.length-1;e>=0;e--){let r=t[e].trim();/([\"\'])[^\'\"]+\1/.test(r)||ua.includes(r)||(r=`"${r}"`),t[e]=r}return`${this.fontStyle} ${this.fontVariant} ${this.fontWeight} ${e} ${t.join(",")}`}};ul.defaultStyle={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:un.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let uh=ul;function uu(e){let t=iP.shared,r=e=>{let r=t.setValue(e);return 1===r.alpha?r.toHex():r.toRgbaString()};return Array.isArray(e)?e.map(r):r(e)}function uc(e,t,r){for(let i in r)Array.isArray(t[i])?e[i]=t[i].slice():e[i]=t[i]}const ud={texture:!0,children:!1,baseTexture:!0},uf=class e extends lh{constructor(t,r,i){let n=!1;i||(i=tJ.ADAPTER.createCanvas(),n=!0),i.width=3,i.height=3;let s=sN.from(i);s.orig=new nU,s.trim=new nU,super(s),this._ownCanvas=n,this.canvas=i,this.context=i.getContext("2d",{willReadFrequently:!0}),this._resolution=e.defaultResolution??tJ.RESOLUTION,this._autoResolution=e.defaultAutoResolution,this._text=null,this._style=null,this._styleListener=null,this._font="",this.text=t,this.style=r,this.localStyleID=-1}static get experimentalLetterSpacing(){return uo.experimentalLetterSpacing}static set experimentalLetterSpacing(e){rl.deprecation("7.1.0","Text.experimentalLetterSpacing is deprecated, use TextMetrics.experimentalLetterSpacing"),uo.experimentalLetterSpacing=e}updateText(e){let t,r;let i=this._style;if(this.localStyleID!==i.styleID&&(this.dirty=!0,this.localStyleID=i.styleID),!this.dirty&&e)return;this._font=this._style.toFontString();let n=this.context,s=uo.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),o=s.width,a=s.height,l=s.lines,h=s.lineHeight,u=s.lineWidths,c=s.maxLineWidth,d=s.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,o)+2*i.padding)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,a)+2*i.padding)*this._resolution),n.scale(this._resolution,this._resolution),n.clearRect(0,0,this.canvas.width,this.canvas.height),n.font=this._font,n.lineWidth=i.strokeThickness,n.textBaseline=i.textBaseline,n.lineJoin=i.lineJoin,n.miterLimit=i.miterLimit;let f=i.dropShadow?2:1;for(let e=0;e<f;++e){let o=i.dropShadow&&0===e,f=o?Math.ceil(Math.max(1,a)+2*i.padding):0,p=f*this._resolution;if(o){n.fillStyle="black",n.strokeStyle="black";let e=i.dropShadowColor,t=i.dropShadowBlur*this._resolution,r=i.dropShadowDistance*this._resolution;n.shadowColor=iP.shared.setValue(e).setAlpha(i.dropShadowAlpha).toRgbaString(),n.shadowBlur=t,n.shadowOffsetX=Math.cos(i.dropShadowAngle)*r,n.shadowOffsetY=Math.sin(i.dropShadowAngle)*r+p}else n.fillStyle=this._generateFillStyle(i,l,s),n.strokeStyle=i.stroke,n.shadowColor="black",n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0;let m=(h-d.fontSize)/2;h-d.fontSize<0&&(m=0);for(let e=0;e<l.length;e++)t=i.strokeThickness/2,r=i.strokeThickness/2+e*h+d.ascent+m,"right"===i.align?t+=c-u[e]:"center"===i.align&&(t+=(c-u[e])/2),i.stroke&&i.strokeThickness&&this.drawLetterSpacing(l[e],t+i.padding,r+i.padding-f,!0),i.fill&&this.drawLetterSpacing(l[e],t+i.padding,r+i.padding-f)}this.updateTexture()}drawLetterSpacing(e,t,r,i=!1){let n=this._style.letterSpacing,s=!1;if(uo.experimentalLetterSpacingSupported&&(uo.experimentalLetterSpacing?(this.context.letterSpacing=`${n}px`,this.context.textLetterSpacing=`${n}px`,s=!0):(this.context.letterSpacing="0px",this.context.textLetterSpacing="0px")),0===n||s){i?this.context.strokeText(e,t,r):this.context.fillText(e,t,r);return}let o=t,a=uo.graphemeSegmenter(e),l=this.context.measureText(e).width,h=0;for(let e=0;e<a.length;++e){let t=a[e];i?this.context.strokeText(t,o,r):this.context.fillText(t,o,r);let s="";for(let t=e+1;t<a.length;++t)s+=a[t];o+=l-(h=this.context.measureText(s).width)+n,l=h}}updateTexture(){let e=this.canvas;if(this._style.trim){let t=rl.trimCanvas(e);t.data&&(e.width=t.width,e.height=t.height,this.context.putImageData(t.data,0,0))}let t=this._texture,r=this._style,i=r.trim?0:r.padding,n=t.baseTexture;t.trim.width=t._frame.width=e.width/this._resolution,t.trim.height=t._frame.height=e.height/this._resolution,t.trim.x=-i,t.trim.y=-i,t.orig.width=t._frame.width-2*i,t.orig.height=t._frame.height-2*i,this._onTextureUpdate(),n.setRealSize(e.width,e.height,this._resolution),t.updateUvs(),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}updateTransform(){this.updateText(!0),super.updateTransform()}getBounds(e,t){return this.updateText(!0),-1===this._textureID&&(e=!1),super.getBounds(e,t)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds.call(this,e)}_calculateBounds(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_generateFillStyle(e,t,r){let i;let n=e.fill;if(!Array.isArray(n))return n;if(1===n.length)return n[0];let s=e.dropShadow?e.dropShadowDistance:0,o=e.padding||0,a=this.canvas.width/this._resolution-s-2*o,l=this.canvas.height/this._resolution-s-2*o,h=n.slice(),u=e.fillGradientStops.slice();if(!u.length){let e=h.length+1;for(let t=1;t<e;++t)u.push(t/e)}if(h.unshift(n[0]),u.unshift(0),h.push(n[n.length-1]),u.push(1),e.fillGradientType===un.LINEAR_VERTICAL){i=this.context.createLinearGradient(a/2,o,a/2,l+o);let n=r.fontProperties.fontSize+e.strokeThickness;for(let e=0;e<t.length;e++){let s=r.lineHeight*(e-1)+n,o=r.lineHeight*e,a=o;e>0&&s>o&&(a=(o+s)/2);let c=o+n,d=r.lineHeight*(e+1),f=c;e+1<t.length&&d<c&&(f=(c+d)/2);let p=(f-a)/l;for(let e=0;e<h.length;e++){let t=Math.min(1,Math.max(0,a/l+("number"==typeof u[e]?u[e]:e/h.length)*p));t=Number(t.toFixed(5)),i.addColorStop(t,h[e])}}}else{i=this.context.createLinearGradient(o,l/2,a+o,l/2);let e=h.length+1,t=1;for(let r=0;r<h.length;r++){let n;n="number"==typeof u[r]?u[r]:t/e,i.addColorStop(n,h[r]),t++}}return i}destroy(e){"boolean"==typeof e&&(e={children:e}),e=Object.assign({},ud,e),super.destroy(e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width}set width(e){this.updateText(!0);let t=rl.sign(this.scale.x)||1;this.scale.x=t*e/this._texture.orig.width,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height}set height(e){this.updateText(!0);let t=rl.sign(this.scale.y)||1;this.scale.y=t*e/this._texture.orig.height,this._height=e}get style(){return this._style}set style(e){(e=e||{})instanceof uh?this._style=e:this._style=new uh(e),this.localStyleID=-1,this.dirty=!0}get text(){return this._text}set text(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}};uf.defaultAutoResolution=!0;class up{constructor(e){this.maxItemsPerFrame=e,this.itemsLeft=0}beginFrame(){this.itemsLeft=this.maxItemsPerFrame}allowedToUpload(){return this.itemsLeft-- >0}}function um(e,t){let r=!1;if(e?._textures?.length){for(let i=0;i<e._textures.length;i++)if(e._textures[i]instanceof sN){let n=e._textures[i].baseTexture;t.includes(n)||(t.push(n),r=!0)}}return r}function ug(e,t){if(e.baseTexture instanceof nT){let r=e.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function uv(e,t){if(e._texture&&e._texture instanceof sN){let r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function uy(e,t){return t instanceof uf&&(t.updateText(!0),!0)}function u_(e,t){if(t instanceof uh){let e=t.toFontString();return uo.measureFont(e),!0}return!1}function ux(e,t){if(e instanceof uf){t.includes(e.style)||t.push(e.style),t.includes(e)||t.push(e);let r=e._texture.baseTexture;return t.includes(r)||t.push(r),!0}return!1}function ub(e,t){return e instanceof uh&&(t.includes(e)||t.push(e),!0)}const uT=class e{constructor(t){this.limiter=new up(e.uploadsPerFrame),this.renderer=t,this.uploadHookHelper=null,this.queue=[],this.addHooks=[],this.uploadHooks=[],this.completes=[],this.ticking=!1,this.delayedTick=()=>{this.queue&&this.prepareItems()},this.registerFindHook(ux),this.registerFindHook(ub),this.registerFindHook(um),this.registerFindHook(ug),this.registerFindHook(uv),this.registerUploadHook(uy),this.registerUploadHook(u_)}upload(e){return new Promise(t=>{e&&this.add(e),this.queue.length?(this.completes.push(t),this.ticking||(this.ticking=!0,no.system.addOnce(this.tick,this,nn.UTILITY))):t()})}tick(){setTimeout(this.delayedTick,0)}prepareItems(){for(this.limiter.beginFrame();this.queue.length&&this.limiter.allowedToUpload();){let e=this.queue[0],t=!1;if(e&&!e._destroyed){for(let r=0,i=this.uploadHooks.length;r<i;r++)if(this.uploadHooks[r](this.uploadHookHelper,e)){this.queue.shift(),t=!0;break}}t||this.queue.shift()}if(this.queue.length)no.system.addOnce(this.tick,this,nn.UTILITY);else{this.ticking=!1;let e=this.completes.slice(0);this.completes.length=0;for(let t=0,r=e.length;t<r;t++)e[t]()}}registerFindHook(e){return e&&this.addHooks.push(e),this}registerUploadHook(e){return e&&this.uploadHooks.push(e),this}add(e){for(let t=0,r=this.addHooks.length;t<r&&!this.addHooks[t](e,this.queue);t++);if(e instanceof lo)for(let t=e.children.length-1;t>=0;t--)this.add(e.children[t]);return this}destroy(){this.ticking&&no.system.remove(this.tick,this),this.ticking=!1,this.addHooks=null,this.uploadHooks=null,this.renderer=null,this.completes=null,this.queue=null,this.limiter=null,this.uploadHookHelper=null}};uT.uploadsPerFrame=4;let uA=uT;function uE(e,t){return t instanceof nT&&(t._glTextures[e.CONTEXT_UID]||e.texture.bind(t),!0)}function uw(e,t){if(!(t instanceof h4))return!1;let{geometry:r}=t;t.finishPoly(),r.updateBatches();let{batches:i}=r;for(let t=0;t<i.length;t++){let{texture:r}=i[t].style;r&&uE(e,r.baseTexture)}return r.batchable||e.geometry.bind(r,t._resolveDirectShader(e)),!0}function uC(e,t){return e instanceof h4&&(t.push(e),!0)}Object.defineProperties(tJ,{UPLOADS_PER_FRAME:{get:()=>uA.uploadsPerFrame,set(e){rl.deprecation("7.1.0","settings.UPLOADS_PER_FRAME is deprecated, use prepare.BasePrepare.uploadsPerFrame"),uA.uploadsPerFrame=e}}});class uS extends uA{constructor(e){super(e),this.uploadHookHelper=this.renderer,this.registerFindHook(uC),this.registerUploadHook(uE),this.registerUploadHook(uw)}}uS.extension={name:"prepare",type:na.RendererSystem},nu.add(uS),new nL;var uI=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,uR=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,uM=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,uP=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,uO=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`;const uD=new nV;class uN extends sm{constructor(e){super(e),e.runners.contextChange.add(this),this.quad=new sk,this.state=np.for2d()}contextChange(){let e=this.renderer,t={globals:e.globalUniforms};this.simpleShader=sd.from(uP,uO,t),this.shader=e.context.webGLVersion>1?sd.from(uR,uI,t):sd.from(uP,uM,t)}render(e){let t=this.renderer,r=this.quad,i=r.vertices;i[0]=i[6]=-(e._width*e.anchor.x),i[1]=i[3]=-(e._height*e.anchor.y),i[2]=i[4]=e._width*(1-e.anchor.x),i[5]=i[7]=e._height*(1-e.anchor.y);let n=e.uvRespectAnchor?e.anchor.x:0,s=e.uvRespectAnchor?e.anchor.y:0;(i=r.uvs)[0]=i[6]=-n,i[1]=i[3]=-s,i[2]=i[4]=1-n,i[5]=i[7]=1-s,r.invalidate();let o=e._texture,a=o.baseTexture,l=a.alphaMode>0,h=e.tileTransform.localTransform,u=e.uvMatrix,c=a.isPowerOfTwo&&o.frame.width===a.width&&o.frame.height===a.height;c&&(a._glTextures[t.CONTEXT_UID]?c=a.wrapMode!==rQ.CLAMP:a.wrapMode===rQ.CLAMP&&(a.wrapMode=rQ.REPEAT));let d=c?this.simpleShader:this.shader,f=o.width,p=o.height,m=e._width,g=e._height;uD.set(h.a*f/m,h.b*f/g,h.c*p/m,h.d*p/g,h.tx/m,h.ty/g),uD.invert(),c?uD.prepend(u.mapCoord):(d.uniforms.uMapCoord=u.mapCoord.toArray(!0),d.uniforms.uClampFrame=u.uClampFrame,d.uniforms.uClampOffset=u.uClampOffset),d.uniforms.uTransform=uD.toArray(!0),d.uniforms.uColor=iP.shared.setValue(e.tint).premultiply(e.worldAlpha,l).toArray(d.uniforms.uColor),d.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),d.uniforms.uSampler=o,t.shader.bind(d),t.geometry.bind(r),this.state.blendMode=rl.correctBlendMode(e.blendMode,l),t.state.set(this.state),t.geometry.draw(this.renderer.gl.TRIANGLES,6,0)}}uN.extension={name:"tilingSprite",type:na.RendererPlugin},nu.add(uN);const uF=class e{constructor(e,t,r=null){this.linkedSheets=[],this._texture=e instanceof sN?e:null,this.baseTexture=e instanceof nT?e:this._texture.baseTexture,this.textures={},this.animations={},this.data=t;let i=this.baseTexture.resource;this.resolution=this._updateResolution(r||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}_updateResolution(e=null){let{scale:t}=this.data.meta,r=rl.getResolutionOfUrl(e,null);return null===r&&(r="number"==typeof t?t:parseFloat(t??"1")),1!==r&&this.baseTexture.setResolution(r),r}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=e.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let r=t,i=e.BATCH_SIZE;for(;r-t<i&&r<this._frameKeys.length;){let e=this._frameKeys[r],t=this._frames[e],i=t.frame;if(i){let r=null,n=null,s=!1!==t.trimmed&&t.sourceSize?t.sourceSize:t.frame,o=new nU(0,0,Math.floor(s.w)/this.resolution,Math.floor(s.h)/this.resolution);r=t.rotated?new nU(Math.floor(i.x)/this.resolution,Math.floor(i.y)/this.resolution,Math.floor(i.h)/this.resolution,Math.floor(i.w)/this.resolution):new nU(Math.floor(i.x)/this.resolution,Math.floor(i.y)/this.resolution,Math.floor(i.w)/this.resolution,Math.floor(i.h)/this.resolution),!1!==t.trimmed&&t.spriteSourceSize&&(n=new nU(Math.floor(t.spriteSourceSize.x)/this.resolution,Math.floor(t.spriteSourceSize.y)/this.resolution,Math.floor(i.w)/this.resolution,Math.floor(i.h)/this.resolution)),this.textures[e]=new sN(this.baseTexture,r,o,n,t.rotated?2:0,t.anchor,t.borders),sN.addToCache(this.textures[e],e.toString())}r++}}_processAnimations(){let e=this.data.animations||{};for(let t in e){this.animations[t]=[];for(let r=0;r<e[t].length;r++){let i=e[t][r];this.animations[t].push(this.textures[i])}}}_parseComplete(){let e=this._callback;this._callback=null,this._batchIndex=0,e.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*e.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*e.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(e=!1){for(let e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,e&&(this._texture?.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]}};uF.BATCH_SIZE=1e3;const uB=["jpg","png","jpeg","avif","webp"],uL={extension:na.Asset,cache:{test:e=>e instanceof uF,getCacheableAssets:(e,t)=>(function e(t,r,i){let n={};if(t.forEach(e=>{n[e]=r}),Object.keys(r.textures).forEach(e=>{n[e]=r.textures[e]}),!i){let i=rl.path.dirname(t[0]);r.linkedSheets.forEach((t,s)=>{Object.assign(n,e([`${i}/${r.data.meta.related_multi_packs[s]}`],t,!0))})}return n})(e,t,!1)},resolver:{test:e=>{let t=e.split("?")[0].split("."),r=t.pop(),i=t.pop();return"json"===r&&uB.includes(i)},parse:e=>{let t=e.split(".");return{resolution:parseFloat(tJ.RETINA_PREFIX.exec(e)?.[1]??"1"),format:t[t.length-2],src:e}}},loader:{name:"spritesheetLoader",extension:{type:na.LoadParser,priority:lH.Normal},testParse:async(e,t)=>".json"===rl.path.extname(t.src).toLowerCase()&&!!e.frames,async parse(e,t,r){let i=rl.path.dirname(t.src);i&&i.lastIndexOf("/")!==i.length-1&&(i+="/");let n=i+e.meta.image;n=lU(n,t.src);let s=new uF((await r.load([n]))[n].baseTexture,e,t.src);await s.parse();let o=e?.meta?.related_multi_packs;if(Array.isArray(o)){let e=[];for(let n of o){if("string"!=typeof n)continue;let s=i+n;t.data?.ignoreMultiPack||(s=lU(s,t.src),e.push(r.load({src:s,data:{ignoreMultiPack:!0}})))}let n=await Promise.all(e);s.linkedSheets=n,n.forEach(e=>{e.linkedSheets=[s].concat(s.linkedSheets.filter(t=>t!==e))})}return s},unload(e){e.destroy(!0)}}};nu.add(uL);class uk{constructor(){this.info=[],this.common=[],this.page=[],this.char=[],this.kerning=[],this.distanceField=[]}}class uU{static test(e){return"string"==typeof e&&e.startsWith("info face=")}static parse(e){let t=e.match(/^[a-z]+\s+.+$/gm),r={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(let e in t){let i=t[e].match(/^[a-z]+/gm)[0],n=t[e].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),s={};for(let e in n){let t=n[e].split("="),r=t[0],i=t[1].replace(/"/gm,""),o=parseFloat(i),a=isNaN(o)?i:o;s[r]=a}r[i].push(s)}let i=new uk;return r.info.forEach(e=>i.info.push({face:e.face,size:parseInt(e.size,10)})),r.common.forEach(e=>i.common.push({lineHeight:parseInt(e.lineHeight,10)})),r.page.forEach(e=>i.page.push({id:parseInt(e.id,10),file:e.file})),r.char.forEach(e=>i.char.push({id:parseInt(e.id,10),page:parseInt(e.page,10),x:parseInt(e.x,10),y:parseInt(e.y,10),width:parseInt(e.width,10),height:parseInt(e.height,10),xoffset:parseInt(e.xoffset,10),yoffset:parseInt(e.yoffset,10),xadvance:parseInt(e.xadvance,10)})),r.kerning.forEach(e=>i.kerning.push({first:parseInt(e.first,10),second:parseInt(e.second,10),amount:parseInt(e.amount,10)})),r.distanceField.forEach(e=>i.distanceField.push({distanceRange:parseInt(e.distanceRange,10),fieldType:e.fieldType})),i}}class uG{static test(e){return"string"!=typeof e&&"getElementsByTagName"in e&&e.getElementsByTagName("page").length&&null!==e.getElementsByTagName("info")[0].getAttribute("face")}static parse(e){let t=new uk,r=e.getElementsByTagName("info"),i=e.getElementsByTagName("common"),n=e.getElementsByTagName("page"),s=e.getElementsByTagName("char"),o=e.getElementsByTagName("kerning"),a=e.getElementsByTagName("distanceField");for(let e=0;e<r.length;e++)t.info.push({face:r[e].getAttribute("face"),size:parseInt(r[e].getAttribute("size"),10)});for(let e=0;e<i.length;e++)t.common.push({lineHeight:parseInt(i[e].getAttribute("lineHeight"),10)});for(let e=0;e<n.length;e++)t.page.push({id:parseInt(n[e].getAttribute("id"),10)||0,file:n[e].getAttribute("file")});for(let e=0;e<s.length;e++){let r=s[e];t.char.push({id:parseInt(r.getAttribute("id"),10),page:parseInt(r.getAttribute("page"),10)||0,x:parseInt(r.getAttribute("x"),10),y:parseInt(r.getAttribute("y"),10),width:parseInt(r.getAttribute("width"),10),height:parseInt(r.getAttribute("height"),10),xoffset:parseInt(r.getAttribute("xoffset"),10),yoffset:parseInt(r.getAttribute("yoffset"),10),xadvance:parseInt(r.getAttribute("xadvance"),10)})}for(let e=0;e<o.length;e++)t.kerning.push({first:parseInt(o[e].getAttribute("first"),10),second:parseInt(o[e].getAttribute("second"),10),amount:parseInt(o[e].getAttribute("amount"),10)});for(let e=0;e<a.length;e++)t.distanceField.push({fieldType:a[e].getAttribute("fieldType"),distanceRange:parseInt(a[e].getAttribute("distanceRange"),10)});return t}}class uz{static test(e){return!!("string"==typeof e&&e.includes("<font>"))&&uG.test(tJ.ADAPTER.parseXML(e))}static parse(e){return uG.parse(tJ.ADAPTER.parseXML(e))}}const uj=[uU,uG,uz];function uH(e){return e.codePointAt?e.codePointAt(0):e.charCodeAt(0)}const uV=class e{constructor(e,t,r){let[i]=e.info,[n]=e.common,[s]=e.page,[o]=e.distanceField,a=rl.getResolutionOfUrl(s.file),l={};this._ownsTextures=r,this.font=i.face,this.size=i.size,this.lineHeight=n.lineHeight/a,this.chars={},this.pageTextures=l;for(let r=0;r<e.page.length;r++){let{id:i,file:n}=e.page[r];l[i]=t instanceof Array?t[r]:t[n],o?.fieldType&&"none"!==o.fieldType&&(l[i].baseTexture.alphaMode=r0.NO_PREMULTIPLIED_ALPHA,l[i].baseTexture.mipmap=rJ.OFF)}for(let t=0;t<e.char.length;t++){let{id:r,page:i}=e.char[t],{x:n,y:s,width:o,height:h,xoffset:u,yoffset:c,xadvance:d}=e.char[t];n/=a,s/=a,o/=a,h/=a,u/=a,c/=a,d/=a;let f=new nU(n+l[i].frame.x/a,s+l[i].frame.y/a,o,h);this.chars[r]={xOffset:u,yOffset:c,xAdvance:d,kerning:{},texture:new sN(l[i].baseTexture,f),page:i}}for(let t=0;t<e.kerning.length;t++){let{first:r,second:i,amount:n}=e.kerning[t];r/=a,i/=a,n/=a,this.chars[i]&&(this.chars[i].kerning[r]=n)}this.distanceFieldRange=o?.distanceRange,this.distanceFieldType=o?.fieldType?.toLowerCase()??"none"}destroy(){for(let e in this.chars)this.chars[e].texture.destroy(),this.chars[e].texture=null;for(let e in this.pageTextures)this._ownsTextures&&this.pageTextures[e].destroy(!0),this.pageTextures[e]=null;this.chars=null,this.pageTextures=null}static install(t,r,i){let n;if(t instanceof uk)n=t;else{let e=function(e){for(let t=0;t<uj.length;t++)if(uj[t].test(e))return uj[t];return null}(t);if(!e)throw Error("Unrecognized data format for font.");n=e.parse(t)}r instanceof sN&&(r=[r]);let s=new e(n,r,i);return e.available[s.font]=s,s}static uninstall(t){let r=e.available[t];if(!r)throw Error(`No font found named '${t}'`);r.destroy(),delete e.available[t]}static from(t,r,i){if(!t)throw Error("[BitmapFont] Property `name` is required.");let{chars:n,padding:s,resolution:o,textureWidth:a,textureHeight:l,...h}=Object.assign({},e.defaultOptions,i),u=function(e){"string"==typeof e&&(e=[e]);let t=[];for(let i=0,n=e.length;i<n;i++){let n=e[i];if(Array.isArray(n)){if(2!==n.length)throw Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${n.length}.`);let e=n[0].charCodeAt(0),r=n[1].charCodeAt(0);if(r<e)throw Error("[BitmapFont]: Invalid character range.");for(let i=e;i<=r;i++)t.push(String.fromCharCode(i))}else{var r;t.push(...(r=n,Array.from?Array.from(r):r.split("")))}}if(0===t.length)throw Error("[BitmapFont]: Empty set when resolving characters.");return t}(n),c=r instanceof uh?r:new uh(r),d=new uk;d.info[0]={face:c.fontFamily,size:c.fontSize},d.common[0]={lineHeight:c.fontSize};let f=0,p=0,m,g,v,y=0,x=[],b=[];for(let e=0;e<u.length;e++){m||((m=tJ.ADAPTER.createCanvas()).width=a,m.height=l,g=m.getContext("2d"),v=new nT(m,{resolution:o,...h}),x.push(v),b.push(new sN(v)),d.page.push({id:b.length-1,file:""}));let t=u[e],r=uo.measureText(t,c,!1,m),i=r.width,n=Math.ceil(r.height),T=Math.ceil(("italic"===c.fontStyle?2:1)*i);if(p>=l-n*o){if(0===p)throw Error(`[BitmapFont] textureHeight ${l}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${t}')`);--e,m=null,g=null,v=null,p=0,f=0,y=0;continue}if(y=Math.max(n+r.fontProperties.descent,y),T*o+f>=a){if(0===f)throw Error(`[BitmapFont] textureWidth ${a}px is too small (fontFamily: '${c.fontFamily}', fontSize: ${c.fontSize}px, char: '${t}')`);--e,p+=y*o,p=Math.ceil(p),f=0,y=0;continue}!function(e,t,r,i,n,s,o){let a=r.text,l=r.fontProperties;t.translate(i,n),t.scale(s,s);let h=o.strokeThickness/2,u=-(o.strokeThickness/2);if(t.font=o.toFontString(),t.lineWidth=o.strokeThickness,t.textBaseline=o.textBaseline,t.lineJoin=o.lineJoin,t.miterLimit=o.miterLimit,t.fillStyle=function(e,t,r,i,n,s){let o;let a=r.fill;if(!Array.isArray(a))return a;if(1===a.length)return a[0];let l=r.dropShadow?r.dropShadowDistance:0,h=r.padding||0,u=e.width/i-l-2*h,c=e.height/i-l-2*h,d=a.slice(),f=r.fillGradientStops.slice();if(!f.length){let e=d.length+1;for(let t=1;t<e;++t)f.push(t/e)}if(d.unshift(a[0]),f.unshift(0),d.push(a[a.length-1]),f.push(1),r.fillGradientType===un.LINEAR_VERTICAL){o=t.createLinearGradient(u/2,h,u/2,c+h);let e=0,i=(s.fontProperties.fontSize+r.strokeThickness)/c;for(let t=0;t<n.length;t++){let r=s.lineHeight*t;for(let t=0;t<d.length;t++){let n=Math.max(e,r/c+("number"==typeof f[t]?f[t]:t/d.length)*i);n=Math.min(n,1),o.addColorStop(n,d[t]),e=n}}}else{o=t.createLinearGradient(h,c/2,u+h,c/2);let e=d.length+1,r=1;for(let t=0;t<d.length;t++){let i;i="number"==typeof f[t]?f[t]:r/e,o.addColorStop(i,d[t]),r++}}return o}(e,t,o,s,[a],r),t.strokeStyle=o.stroke,o.dropShadow){let e=o.dropShadowColor,r=o.dropShadowBlur*s,i=o.dropShadowDistance*s;t.shadowColor=iP.shared.setValue(e).setAlpha(o.dropShadowAlpha).toRgbaString(),t.shadowBlur=r,t.shadowOffsetX=Math.cos(o.dropShadowAngle)*i,t.shadowOffsetY=Math.sin(o.dropShadowAngle)*i}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0;o.stroke&&o.strokeThickness&&t.strokeText(a,h,u+r.lineHeight-l.descent),o.fill&&t.fillText(a,h,u+r.lineHeight-l.descent),t.setTransform(1,0,0,1,0,0),t.fillStyle="rgba(0, 0, 0, 0)"}(m,g,r,f,p,o,c);let A=uH(r.text);d.char.push({id:A,page:b.length-1,x:f/o,y:p/o,width:T,height:n,xoffset:0,yoffset:0,xadvance:i-(c.dropShadow?c.dropShadowDistance:0)-(c.stroke?c.strokeThickness:0)}),f+=(T+2*s)*o,f=Math.ceil(f)}if(!i?.skipKerning)for(let e=0,t=u.length;e<t;e++){let r=u[e];for(let e=0;e<t;e++){let t=u[e],i=g.measureText(r).width,n=g.measureText(t).width,s=g.measureText(r+t).width-(i+n);s&&d.kerning.push({first:uH(r),second:uH(t),amount:s})}}let T=new e(d,b,!0);return void 0!==e.available[t]&&e.uninstall(t),e.available[t]=T,T}};uV.ALPHA=[["a","z"],["A","Z"]," "],uV.NUMERIC=[["0","9"]],uV.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],uV.ASCII=[[" ","~"]],uV.defaultOptions={resolution:1,textureWidth:512,textureHeight:512,padding:4,chars:uV.ALPHANUMERIC},uV.available={};const uX=[".xml",".fnt"],uW={extension:{type:na.LoadParser,priority:lH.Normal},name:"loadBitmapFont",test:e=>uX.includes(rl.path.extname(e).toLowerCase()),testParse:async e=>uU.test(e)||uz.test(e),async parse(e,t,r){let i=uU.test(e)?uU.parse(e):uz.parse(e),{src:n}=t,{page:s}=i,o=[];for(let e=0;e<s.length;++e){let t=s[e].file,r=rl.path.join(rl.path.dirname(n),t);r=lU(r,n),o.push(r)}let a=await r.load(o),l=o.map(e=>a[e]);return uV.install(i,l,!0)},load:async(e,t)=>(await tJ.ADAPTER.fetch(e)).text(),unload(e){e.destroy()}};nu.add(uW);const u$=class e extends uh{constructor(){super(...arguments),this._fonts=[],this._overrides=[],this._stylesheet="",this.fontsDirty=!1}static from(t){return new e(Object.keys(e.defaultOptions).reduce((e,r)=>({...e,[r]:t[r]}),{}))}cleanFonts(){this._fonts.length>0&&(this._fonts.forEach(t=>{URL.revokeObjectURL(t.src),t.refs--,0===t.refs&&(t.fontFace&&document.fonts.delete(t.fontFace),delete e.availableFonts[t.originalUrl])}),this.fontFamily="Arial",this._fonts.length=0,this.styleID++,this.fontsDirty=!0)}loadFont(t,r={}){let{availableFonts:i}=e;if(i[t]){let e=i[t];return this._fonts.push(e),e.refs++,this.styleID++,this.fontsDirty=!0,Promise.resolve()}return tJ.ADAPTER.fetch(t).then(e=>e.blob()).then(async e=>new Promise((t,r)=>{let i=URL.createObjectURL(e),n=new FileReader;n.onload=()=>t([i,n.result]),n.onerror=r,n.readAsDataURL(e)})).then(async([e,n])=>{let s=Object.assign({family:rl.path.basename(t,rl.path.extname(t)),weight:"normal",style:"normal",display:"auto",src:e,dataSrc:n,refs:1,originalUrl:t,fontFace:null},r);i[t]=s,this._fonts.push(s),this.styleID++;let o=new FontFace(s.family,`url(${s.src})`,{weight:s.weight,style:s.style,display:s.display});s.fontFace=o,await o.load(),document.fonts.add(o),await document.fonts.ready,this.styleID++,this.fontsDirty=!0})}addOverride(...e){let t=e.filter(e=>!this._overrides.includes(e));t.length>0&&(this._overrides.push(...t),this.styleID++)}removeOverride(...e){let t=e.filter(e=>this._overrides.includes(e));t.length>0&&(this._overrides=this._overrides.filter(e=>!t.includes(e)),this.styleID++)}toCSS(e){return[`transform: scale(${e})`,"transform-origin: top left","display: inline-block",`color: ${this.normalizeColor(this.fill)}`,`font-size: ${this.fontSize}px`,`font-family: ${this.fontFamily}`,`font-weight: ${this.fontWeight}`,`font-style: ${this.fontStyle}`,`font-variant: ${this.fontVariant}`,`letter-spacing: ${this.letterSpacing}px`,`text-align: ${this.align}`,`padding: ${this.padding}px`,`white-space: ${this.whiteSpace}`,...this.lineHeight?[`line-height: ${this.lineHeight}px`]:[],...this.wordWrap?[`word-wrap: ${this.breakWords?"break-all":"break-word"}`,`max-width: ${this.wordWrapWidth}px`]:[],...this.strokeThickness?[`-webkit-text-stroke-width: ${this.strokeThickness}px`,`-webkit-text-stroke-color: ${this.normalizeColor(this.stroke)}`,`text-stroke-width: ${this.strokeThickness}px`,`text-stroke-color: ${this.normalizeColor(this.stroke)}`,"paint-order: stroke"]:[],...this.dropShadow?[this.dropShadowToCSS()]:[],...this._overrides].join(";")}toGlobalCSS(){return this._fonts.reduce((e,t)=>`${e}
            @font-face {
                font-family: "${t.family}";
                src: url('${t.dataSrc}');
                font-weight: ${t.weight};
                font-style: ${t.style};
                font-display: ${t.display};
            }`,this._stylesheet)}get stylesheet(){return this._stylesheet}set stylesheet(e){this._stylesheet!==e&&(this._stylesheet=e,this.styleID++)}normalizeColor(e){return Array.isArray(e)&&(e=rl.rgb2hex(e)),"number"==typeof e?rl.hex2string(e):e}dropShadowToCSS(){let e=this.normalizeColor(this.dropShadowColor),t=this.dropShadowAlpha,r=Math.round(Math.cos(this.dropShadowAngle)*this.dropShadowDistance),i=Math.round(Math.sin(this.dropShadowAngle)*this.dropShadowDistance);e.startsWith("#")&&t<1&&(e+=(255*t|0).toString(16).padStart(2,"0"));let n=`${r}px ${i}px`;return this.dropShadowBlur>0?`text-shadow: ${n} ${this.dropShadowBlur}px ${e}`:`text-shadow: ${n} ${e}`}reset(){Object.assign(this,e.defaultOptions)}onBeforeDraw(){let{fontsDirty:e}=this;return this.fontsDirty=!1,this.isSafari&&this._fonts.length>0&&e?new Promise(e=>setTimeout(e,100)):Promise.resolve()}get isSafari(){let{userAgent:e}=tJ.ADAPTER.getNavigator();return/^((?!chrome|android).)*safari/i.test(e)}set fillGradientStops(e){console.warn("[HTMLTextStyle] fillGradientStops is not supported by HTMLText")}get fillGradientStops(){return super.fillGradientStops}set fillGradientType(e){console.warn("[HTMLTextStyle] fillGradientType is not supported by HTMLText")}get fillGradientType(){return super.fillGradientType}set miterLimit(e){console.warn("[HTMLTextStyle] miterLimit is not supported by HTMLText")}get miterLimit(){return super.miterLimit}set trim(e){console.warn("[HTMLTextStyle] trim is not supported by HTMLText")}get trim(){return super.trim}set textBaseline(e){console.warn("[HTMLTextStyle] textBaseline is not supported by HTMLText")}get textBaseline(){return super.textBaseline}set leading(e){console.warn("[HTMLTextStyle] leading is not supported by HTMLText")}get leading(){return super.leading}set lineJoin(e){console.warn("[HTMLTextStyle] lineJoin is not supported by HTMLText")}get lineJoin(){return super.lineJoin}};u$.availableFonts={},u$.defaultOptions={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,padding:0,stroke:"black",strokeThickness:0,whiteSpace:"normal",wordWrap:!1,wordWrapWidth:100};const uY=class e extends lh{constructor(t="",r={}){super(sN.EMPTY),this._text=null,this._style=null,this._autoResolution=!0,this.localStyleID=-1,this.dirty=!1,this._updateID=0,this.ownsStyle=!1;let i=new Image,n=sN.from(i,{scaleMode:tJ.SCALE_MODE,resourceOptions:{autoLoad:!1}});n.orig=new nU,n.trim=new nU,this.texture=n;let s="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xhtml",a=document.createElementNS(s,"svg"),l=document.createElementNS(s,"foreignObject"),h=document.createElementNS(o,"div"),u=document.createElementNS(o,"style");l.setAttribute("width","10000"),l.setAttribute("height","10000"),l.style.overflow="hidden",a.appendChild(l),this.maxWidth=e.defaultMaxWidth,this.maxHeight=e.defaultMaxHeight,this._domElement=h,this._styleElement=u,this._svgRoot=a,this._foreignObject=l,this._foreignObject.appendChild(u),this._foreignObject.appendChild(h),this._image=i,this._loadImage=new Image,this._autoResolution=e.defaultAutoResolution,this._resolution=e.defaultResolution??tJ.RESOLUTION,this.text=t,this.style=r}measureText(e){let{text:t,style:r,resolution:i}=Object.assign({text:this._text,style:this._style,resolution:this._resolution},e);Object.assign(this._domElement,{innerHTML:t,style:r.toCSS(i)}),this._styleElement.textContent=r.toGlobalCSS(),document.body.appendChild(this._svgRoot);let n=this._domElement.getBoundingClientRect();this._svgRoot.remove();let{width:s,height:o}=n;(s>this.maxWidth||o>this.maxHeight)&&console.warn("[HTMLText] Large expanse of text, increase HTMLText.maxWidth or HTMLText.maxHeight property.");let a=Math.min(this.maxWidth,Math.ceil(s)),l=Math.min(this.maxHeight,Math.ceil(o));return this._svgRoot.setAttribute("width",a.toString()),this._svgRoot.setAttribute("height",l.toString()),t!==this._text&&(this._domElement.innerHTML=this._text),r!==this._style&&(Object.assign(this._domElement,{style:this._style?.toCSS(i)}),this._styleElement.textContent=this._style?.toGlobalCSS()),{width:a+2*r.padding,height:l+2*r.padding}}async updateText(e=!0){let{style:t,_image:r,_loadImage:i}=this;if(this.localStyleID!==t.styleID&&(this.dirty=!0,this.localStyleID=t.styleID),!this.dirty&&e)return;let{width:n,height:s}=this.measureText();r.width=i.width=Math.ceil(Math.max(1,n)),r.height=i.height=Math.ceil(Math.max(1,s)),this._updateID++;let o=this._updateID;await new Promise(e=>{i.onload=async()=>{if(o<this._updateID){e();return}await t.onBeforeDraw(),r.src=i.src,i.onload=null,i.src="",this.updateTexture(),e()};let n=new XMLSerializer().serializeToString(this._svgRoot);i.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(n)}`})}get source(){return this._image}updateTexture(){let{style:e,texture:t,_image:r,resolution:i}=this,{padding:n}=e,{baseTexture:s}=t;t.trim.width=t._frame.width=r.width/i,t.trim.height=t._frame.height=r.height/i,t.trim.x=-n,t.trim.y=-n,t.orig.width=t._frame.width-2*n,t.orig.height=t._frame.height-2*n,this._onTextureUpdate(),s.setRealSize(r.width,r.height,i),this.dirty=!1}_render(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._render(e)}_renderCanvas(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),super._renderCanvas(e)}getLocalBounds(e){return this.updateText(!0),super.getLocalBounds(e)}_calculateBounds(){this.updateText(!0),this.calculateVertices(),this._bounds.addQuad(this.vertexData)}_onStyleChange(){this.dirty=!0}destroy(t){"boolean"==typeof t&&(t={children:t}),t=Object.assign({},e.defaultDestroyOptions,t),super.destroy(t),this.ownsStyle&&this._style?.cleanFonts(),this._style=null,this._svgRoot?.remove(),this._svgRoot=null,this._domElement?.remove(),this._domElement=null,this._foreignObject?.remove(),this._foreignObject=null,this._styleElement?.remove(),this._styleElement=null,this._loadImage.src="",this._loadImage.onload=null,this._loadImage=null,this._image.src="",this._image=null}get width(){return this.updateText(!0),Math.abs(this.scale.x)*this._image.width/this.resolution}set width(e){this.updateText(!0);let t=rl.sign(this.scale.x)||1;this.scale.x=t*e/this._image.width/this.resolution,this._width=e}get height(){return this.updateText(!0),Math.abs(this.scale.y)*this._image.height/this.resolution}set height(e){this.updateText(!0);let t=rl.sign(this.scale.y)||1;this.scale.y=t*e/this._image.height/this.resolution,this._height=e}get style(){return this._style}set style(e){this._style!==e&&((e=e||{})instanceof u$?(this.ownsStyle=!1,this._style=e):e instanceof uh?(console.warn("[HTMLText] Cloning TextStyle, if this is not what you want, use HTMLTextStyle"),this.ownsStyle=!0,this._style=u$.from(e)):(this.ownsStyle=!0,this._style=new u$(e)),this.localStyleID=-1,this.dirty=!0)}get text(){return this._text}set text(e){e=String(""===e||null==e?" ":e),e=this.sanitiseText(e),this._text!==e&&(this._text=e,this.dirty=!0)}get resolution(){return this._resolution}set resolution(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)}sanitiseText(e){return e.replace(/<br>/gi,"<br/>").replace(/<hr>/gi,"<hr/>").replace(/&nbsp;/gi,"&#160;")}};uY.defaultDestroyOptions={texture:!0,children:!1,baseTexture:!0},uY.defaultMaxWidth=2024,uY.defaultMaxHeight=2024,uY.defaultAutoResolution=!0;var uq={};u=uq,d=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,f=new WeakMap,p=(c=function(e,t){return f.set(e,t),t},function(e){var t=f.get(e),r=void 0===t?e.size:t<1073741824?t+1:0;if(!e.has(r))return c(e,r);if(e.size<536870912){for(;e.has(r);)r=Math.floor(1073741824*Math.random());return c(e,r)}if(e.size>d)throw Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;e.has(r);)r=Math.floor(Math.random()*d);return c(e,r)}),u.addUniqueNumber=function(e){var t=p(e);return e.add(t),t},u.generateUniqueNumber=p;var uZ={};m=tK("02Ztr"),g=tK("fu0YK"),v=tK("lR7jo"),y=function(e,t,r){return{endTime:t,insertTime:r,type:"exponentialRampToValue",value:e}},x=function(e,t,r){return{endTime:t,insertTime:r,type:"linearRampToValue",value:e}},b=function(e,t){return{startTime:t,type:"setValue",value:e}},T=function(e,t,r){return{duration:r,startTime:t,type:"setValueCurve",values:e}},A=function(e,t,r){var i=r.startTime,n=r.target;return n+(t-n)*Math.exp((i-e)/r.timeConstant)},E=function(e){return"exponentialRampToValue"===e.type},w=function(e){return"linearRampToValue"===e.type},C=function(e){return E(e)||w(e)},S=function(e){return"setValue"===e.type},I=function(e){return"setValueCurve"===e.type},R=function e(t,r,i,n){var s=t[r];return void 0===s?n:C(s)||S(s)?s.value:I(s)?s.values[s.values.length-1]:A(i,e(t,r-1,s.startTime,n),s)},M=function(e,t,r,i,n){return void 0===r?[i.insertTime,n]:C(r)?[r.endTime,r.value]:S(r)?[r.startTime,r.value]:I(r)?[r.startTime+r.duration,r.values[r.values.length-1]]:[r.startTime,R(e,t-1,r.startTime,n)]},P=function(e){return"cancelAndHold"===e.type},O=function(e){return"cancelScheduledValues"===e.type},D=function(e){return P(e)||O(e)?e.cancelTime:E(e)||w(e)?e.endTime:e.startTime},N=function(e,t,r,i){var n=i.endTime,s=i.value;return r===s?s:0<r&&0<s||r<0&&s<0?r*Math.pow(s/r,(e-t)/(n-t)):0},F=function(e,t,r,i){return r+(e-t)/(i.endTime-t)*(i.value-r)},B=function(e,t){var r=Math.floor(t),i=Math.ceil(t);return r===i?e[r]:(1-(t-r))*e[r]+(1-(i-t))*e[i]},L=function(e,t){var r=t.duration,i=t.startTime,n=t.values,s=(e-i)/r*(n.length-1);return B(n,s)},k=function(e){return"setTarget"===e.type},U=function(e){function t(e){g(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return v(t,[{key:e,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(e){var t=D(e);if(P(e)||O(e)){var r=this._automationEvents.findIndex(function(r){return O(e)&&I(r)?r.startTime+r.duration>=t:D(r)>=t}),i=this._automationEvents[r];if(-1!==r&&(this._automationEvents=this._automationEvents.slice(0,r)),P(e)){var n=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&C(i)){if(void 0!==n&&k(n))throw Error("The internal list is malformed.");var s=void 0===n?i.insertTime:I(n)?n.startTime+n.duration:D(n),o=void 0===n?this._defaultValue:I(n)?n.values[n.values.length-1]:n.value,a=E(i)?N(t,s,o,i):F(t,s,o,i),l=E(i)?y(a,t,this._currenTime):x(a,t,this._currenTime);this._automationEvents.push(l)}if(void 0!==n&&k(n)&&this._automationEvents.push(b(this.getValue(t),t)),void 0!==n&&I(n)&&n.startTime+n.duration>t){var h=t-n.startTime,u=(n.values.length-1)/n.duration,c=Math.max(2,1+Math.ceil(h*u)),d=h/(c-1)*u,f=n.values.slice(0,c);if(d<1)for(var p=1;p<c;p+=1){var m=d*p%1;f[p]=n.values[p-1]*(1-m)+n.values[p]*m}this._automationEvents[this._automationEvents.length-1]=T(f,n.startTime,h)}}}else{var g=this._automationEvents.findIndex(function(e){return D(e)>t}),v=-1===g?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[g-1];if(void 0!==v&&I(v)&&D(v)+v.duration>t)return!1;var A=E(e)?y(e.value,e.endTime,this._currenTime):w(e)?x(e.value,t,this._currenTime):e;if(-1===g)this._automationEvents.push(A);else{if(I(e)&&t+e.duration>D(this._automationEvents[g]))return!1;this._automationEvents.splice(g,0,A)}}return!0}},{key:"flush",value:function(e){var t=this._automationEvents.findIndex(function(t){return D(t)>e});if(t>1){var r=this._automationEvents.slice(t-1),i=r[0];k(i)&&r.unshift(b(R(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}},{key:"getValue",value:function(e){if(0===this._automationEvents.length)return this._defaultValue;var t=this._automationEvents.findIndex(function(t){return D(t)>e}),r=this._automationEvents[t],i=(-1===t?this._automationEvents.length:t)-1,n=this._automationEvents[i];if(void 0!==n&&k(n)&&(void 0===r||!C(r)||r.insertTime>e))return A(e,R(this._automationEvents,i-1,n.startTime,this._defaultValue),n);if(void 0!==n&&S(n)&&(void 0===r||!C(r)))return n.value;if(void 0!==n&&I(n)&&(void 0===r||!C(r)||n.startTime+n.duration>e))return e<n.startTime+n.duration?L(e,n):n.values[n.values.length-1];if(void 0!==n&&C(n)&&(void 0===r||!C(r)))return n.value;if(void 0!==r&&E(r)){var s=m(M(this._automationEvents,i,n,r,this._defaultValue),2);return N(e,s[0],s[1],r)}if(void 0!==r&&w(r)){var o=m(M(this._automationEvents,i,n,r,this._defaultValue),2);return F(e,o[0],o[1],r)}return this._defaultValue}}]),t}(Symbol.iterator),uZ.AutomationEventList=U,uZ.createCancelAndHoldAutomationEvent=function(e){return{cancelTime:e,type:"cancelAndHold"}},uZ.createCancelScheduledValuesAutomationEvent=function(e){return{cancelTime:e,type:"cancelScheduledValues"}},uZ.createExponentialRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"exponentialRampToValue",value:e}},uZ.createLinearRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"linearRampToValue",value:e}},uZ.createSetTargetAutomationEvent=function(e,t,r){return{startTime:t,target:e,timeConstant:r,type:"setTarget"}},uZ.createSetValueAutomationEvent=b,uZ.createSetValueCurveAutomationEvent=T;const uK=new WeakSet,uQ=new WeakMap,uJ=new WeakMap,u0=new WeakMap,u1=new WeakMap,u2=new WeakMap,u3=new WeakMap,u4=new WeakMap,u5=new WeakMap,u8=new WeakMap,u6={construct:()=>u6},u7=e=>{try{new new Proxy(e,u6)}catch{return!1}return!0},u9=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,ce=(e,t)=>{let r=[],i=e.replace(/^[\s]+/,""),n=i.match(u9);for(;null!==n;){let e=n[1].slice(1,-1),s=n[0].replace(/([\s]+)?;?$/,"").replace(e,new URL(e,t).toString());r.push(s),n=(i=i.slice(n[0].length).replace(/^[\s]+/,"")).match(u9)}return[r.join(";"),i]},ct=e=>{if(void 0!==e&&!Array.isArray(e))throw TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},cr=e=>{if(!u7(e))throw TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!=typeof e.prototype)throw TypeError("The given value for processorCtor should have a prototype.")},ci=(e,t)=>{let r=e.get(t);if(void 0===r)throw Error("A value with the given key could not be found.");return r},cn=(e,t)=>{let r=Array.from(e).filter(t);if(r.length>1)throw Error("More than one element was found.");if(0===r.length)throw Error("No element was found.");let[i]=r;return e.delete(i),i},cs=(e,t,r,i)=>{let n=ci(e,t),s=cn(n,e=>e[0]===r&&e[1]===i);return 0===n.size&&e.delete(t),s},co=e=>ci(u3,e),ca=e=>{if(uK.has(e))throw Error("The AudioNode is already stored.");uK.add(e),co(e).forEach(e=>e(!0))},cl=e=>"port"in e,ch=e=>{if(!uK.has(e))throw Error("The AudioNode is not stored.");uK.delete(e),co(e).forEach(e=>e(!1))},cu=(e,t)=>{!cl(e)&&t.every(e=>0===e.size)&&ch(e)},cc={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},cd=(e,t)=>e.context===t,cf=e=>{try{e.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},cp=()=>new DOMException("","IndexSizeError"),cm=e=>{var t;e.getChannelData=(t=e.getChannelData,r=>{try{return t.call(e,r)}catch(e){if(12===e.code)throw cp();throw e}})},cg={numberOfChannels:1},cv=e=>uK.has(e),cy={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},c_=e=>"playbackRate"in e,cx=e=>"frequency"in e&&"gain"in e,cb=e=>"offset"in e,cT=e=>!("frequency"in e)&&"gain"in e,cA=e=>"detune"in e&&"frequency"in e,cE=e=>"pan"in e,cw=e=>ci(uQ,e),cC=e=>ci(u0,e),cS=(e,t)=>{let{activeInputs:r}=cw(e);for(let i of(r.forEach(r=>r.forEach(([r])=>{t.includes(e)||cS(r,[...t,e])})),c_(e)?[e.playbackRate]:cl(e)?Array.from(e.parameters.values()):cx(e)?[e.Q,e.detune,e.frequency,e.gain]:cb(e)?[e.offset]:cT(e)?[e.gain]:cA(e)?[e.detune,e.frequency]:cE(e)?[e.pan]:[])){let e=cC(i);void 0!==e&&e.activeInputs.forEach(([e])=>cS(e,t))}cv(e)&&ch(e)},cI=e=>{cS(e.destination,[])},cR=e=>"context"in e,cM=e=>cR(e[0]),cP=(e,t,r,i)=>{for(let t of e)if(r(t)){if(i)return!1;throw Error("The set contains at least one similar element.")}return e.add(t),!0},cO=(e,t,[r,i],n)=>{cP(e,[t,r,i],e=>e[0]===t&&e[1]===r,n)},cD=(e,[t,r,i],n)=>{let s=e.get(t);void 0===s?e.set(t,new Set([[r,i]])):cP(s,[r,i],e=>e[0]===r,n)},cN=e=>"inputs"in e,cF=(e,t,r,i)=>{if(cN(t)){let n=t.inputs[i];return e.connect(n,r,0),[n,r,0]}return e.connect(t,r,i),[t,r,i]},cB=(e,t,r)=>{for(let i of e)if(i[0]===t&&i[1]===r)return e.delete(i),i;return null},cL=(e,t,r)=>cn(e,e=>e[0]===t&&e[1]===r),ck=(e,t)=>{if(!co(e).delete(t))throw Error("Missing the expected event listener.")},cU=(e,t,r)=>{let i=ci(e,t),n=cn(i,e=>e[0]===r);return 0===i.size&&e.delete(t),n},cG=(e,t,r,i)=>{cN(t)?e.disconnect(t.inputs[i],r,0):e.disconnect(t,r,i)},cz=e=>ci(uJ,e),cj=e=>ci(u1,e),cH=e=>u4.has(e),cV=e=>!uK.has(e),cX=(e,t)=>new Promise(r=>{if(null!==t)r(!0);else{let t=e.createScriptProcessor(256,1,1),i=e.createGain(),n=e.createBuffer(1,2,44100),s=n.getChannelData(0);s[0]=1,s[1]=1;let o=e.createBufferSource();o.buffer=n,o.loop=!0,o.connect(t).connect(e.destination),o.connect(i),o.disconnect(i),t.onaudioprocess=i=>{let n=i.inputBuffer.getChannelData(0);Array.prototype.some.call(n,e=>1===e)?r(!0):r(!1),o.stop(),t.onaudioprocess=null,o.disconnect(t),t.disconnect(e.destination)},o.start()}}),cW=(e,t)=>{let r=new Map;for(let t of e)for(let e of t){let t=r.get(e);r.set(e,void 0===t?1:t+1)}r.forEach((e,r)=>t(r,e))},c$=e=>"context"in e,cY=e=>{var t,r;let i=new Map;e.connect=(t=e.connect.bind(e),(e,r=0,n=0)=>{let s=c$(e)?t(e,r,n):t(e,r),o=i.get(e);return void 0===o?i.set(e,[{input:n,output:r}]):o.every(e=>e.input!==n||e.output!==r)&&o.push({input:n,output:r}),s}),e.disconnect=(r=e.disconnect,(t,n,s)=>{if(r.apply(e),void 0===t)i.clear();else if("number"==typeof t)for(let[e,r]of i){let n=r.filter(e=>e.output!==t);0===n.length?i.delete(e):i.set(e,n)}else if(i.has(t)){if(void 0===n)i.delete(t);else{let e=i.get(t);if(void 0!==e){let r=e.filter(e=>e.output!==n&&(e.input!==s||void 0===s));0===r.length?i.delete(t):i.set(t,r)}}}for(let[t,r]of i)r.forEach(r=>{c$(t)?e.connect(t,r.output,r.input):e.connect(t,r.output)})})},cq=(e,t,r,i)=>{let{activeInputs:n,passiveInputs:s}=cC(t),{outputs:o}=cw(e),a=co(e),l=o=>{let a=cz(e),l=cj(t);if(o){let t=cU(s,e,r);cO(n,e,t,!1),i||cH(e)||a.connect(l,r)}else cD(s,cL(n,e,r),!1),i||cH(e)||a.disconnect(l,r)};return!!cP(o,[t,r],e=>e[0]===t&&e[1]===r,!0)&&(a.add(l),cv(e)?cO(n,e,[r,l],!0):cD(s,[e,r,l],!0),!0)},cZ=(e,t,r,i)=>{let{activeInputs:n,passiveInputs:s}=cw(t),o=cB(n[i],e,r);return null===o?[cs(s,e,r,i)[2],!1]:[o[2],!0]},cK=(e,t,r)=>{let{activeInputs:i,passiveInputs:n}=cC(t),s=cB(i,e,r);return null===s?[cU(n,e,r)[1],!1]:[s[2],!0]},cQ=(e,t,r,i,n)=>{let[s,o]=cZ(e,r,i,n);if(null===s||(ck(e,s),!o||t||cH(e)||cG(cz(e),cz(r),i,n)),cv(r)){let{activeInputs:e}=cw(r);cu(r,e)}},cJ=(e,t,r,i)=>{let[n,s]=cK(e,r,i);null===n||(ck(e,n),!s||t||cH(e)||cz(e).disconnect(cj(r),i))},c0=(e,t)=>{let r=cw(e),i=[];for(let n of r.outputs)cM(n)?cQ(e,t,...n):cJ(e,t,...n),i.push(n[0]);return r.outputs.clear(),i},c1=(e,t,r)=>{let i=cw(e),n=[];for(let s of i.outputs)s[1]===r&&(cM(s)?cQ(e,t,...s):cJ(e,t,...s),n.push(s[0]),i.outputs.delete(s));return n},c2=(e,t,r,i,n)=>{let s=cw(e);return Array.from(s.outputs).filter(e=>e[0]===r&&(void 0===i||e[1]===i)&&(void 0===n||e[2]===n)).map(r=>(cM(r)?cQ(e,t,...r):cJ(e,t,...r),s.outputs.delete(r),r[0]))};class c3{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,t=null){return this._map.forEach((r,i)=>e.call(t,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}function c4(e,t,r,i,n){if("function"==typeof e.copyFromChannel)0===t[r].byteLength&&(t[r]=new Float32Array(128)),e.copyFromChannel(t[r],i,n);else{let s=e.getChannelData(i);if(0===t[r].byteLength)t[r]=s.slice(n,n+128);else{let e=new Float32Array(s.buffer,n*Float32Array.BYTES_PER_ELEMENT,128);t[r].set(e)}}}const c5=(e,t,r,i,n)=>{"function"==typeof e.copyToChannel?0!==t[r].byteLength&&e.copyToChannel(t[r],i,n):0!==t[r].byteLength&&e.getChannelData(i).set(t[r],n)},c8=(e,t)=>{let r=[];for(let i=0;i<e;i+=1){let e=[],n="number"==typeof t?t:t[i];for(let t=0;t<n;t+=1)e.push(new Float32Array(128));r.push(e)}return r},c6=(e,t)=>{let r=ci(u8,e);return ci(r,cz(t))},c7=async(e,t,r,i,n,s,o)=>{let a=null===t?128*Math.ceil(e.context.length/128):t.length,l=i.channelCount*i.numberOfInputs,h=n.reduce((e,t)=>e+t,0),u=0===h?null:r.createBuffer(h,a,r.sampleRate);if(void 0===s)throw Error("Missing the processor constructor.");let c=cw(e),d=await c6(r,e),f=c8(i.numberOfInputs,i.channelCount),p=c8(i.numberOfOutputs,n),m=Array.from(e.parameters.keys()).reduce((e,t)=>({...e,[t]:new Float32Array(128)}),{});for(let h=0;h<a;h+=128){if(i.numberOfInputs>0&&null!==t)for(let e=0;e<i.numberOfInputs;e+=1)for(let r=0;r<i.channelCount;r+=1)c4(t,f[e],r,r,h);void 0!==s.parameterDescriptors&&null!==t&&s.parameterDescriptors.forEach(({name:e},r)=>{c4(t,m,e,l+r,h)});for(let e=0;e<i.numberOfInputs;e+=1)for(let t=0;t<n[e];t+=1)0===p[e][t].byteLength&&(p[e][t]=new Float32Array(128));try{let e=f.map((e,t)=>0===c.activeInputs[t].size?[]:e),t=o(h/r.sampleRate,r.sampleRate,()=>d.process(e,p,m));if(null!==u)for(let e=0,t=0;e<i.numberOfOutputs;e+=1){for(let r=0;r<n[e];r+=1)c5(u,p[e],r,t+r,h);t+=n[e]}if(!t)break}catch(t){e.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}));break}}return u},c9={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},de={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},dt={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},dr={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},di={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},dn=e=>{let{port1:t,port2:r}=new MessageChannel;return new Promise(i=>{let n=()=>{r.onmessage=null,t.close(),r.close(),i()};r.onmessage=()=>n();try{t.postMessage(e,[e])}catch{}finally{n()}})},ds={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},da=e=>"delayTime"in e,dl=(e,t,r)=>{let i=t[r];if(void 0===i)throw e();return i},dh={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},du={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},dc=()=>new DOMException("","InvalidStateError"),dd=()=>new DOMException("","InvalidAccessError"),df=e=>{var t;e.getFrequencyResponse=(t=e.getFrequencyResponse,(r,i,n)=>{if(r.length!==i.length||i.length!==n.length)throw dd();return t.call(e,r,i,n)})},dp={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},dm=(e,t,r,i,n,s,o,a,l,h,u)=>{let c=h.length,d=a;for(let a=0;a<c;a+=1){let c=r[0]*h[a];for(let t=1;t<n;t+=1){let i=d-t&l-1;c+=r[t]*s[i],c-=e[t]*o[i]}for(let e=n;e<i;e+=1)c+=r[e]*s[d-e&l-1];for(let r=n;r<t;r+=1)c-=e[r]*o[d-r&l-1];s[d]=h[a],o[d]=c,d=d+1&l-1,u[a]=c}return d},dg=(e,t,r,i)=>{let n=r instanceof Float64Array?r:new Float64Array(r),s=i instanceof Float64Array?i:new Float64Array(i),o=n.length,a=s.length,l=Math.min(o,a);if(1!==n[0]){for(let e=0;e<o;e+=1)s[e]/=n[0];for(let e=1;e<a;e+=1)n[e]/=n[0]}let h=new Float32Array(32),u=new Float32Array(32),c=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),d=e.numberOfChannels;for(let t=0;t<d;t+=1){let r=e.getChannelData(t),i=c.getChannelData(t);h.fill(0),u.fill(0),dm(n,o,s,a,l,h,u,0,32,r,i)}return c},dv={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},dy=e=>{let t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{let r=e.decodeAudioData(t.buffer,()=>{});if(void 0===r)return!1;return r.catch(()=>{}),!0}catch{}return!1},d_=(e,t,r)=>{let i=t[r];void 0!==i&&i!==e[r]&&(e[r]=i)},dx=(e,t)=>{d_(e,t,"channelCount"),d_(e,t,"channelCountMode"),d_(e,t,"channelInterpretation")},db=e=>"function"==typeof e.getFloatTimeDomainData,dT=e=>{e.getFloatTimeDomainData=t=>{let r=new Uint8Array(t.length);e.getByteTimeDomainData(r);let i=Math.max(r.length,e.fftSize);for(let e=0;e<i;e+=1)t[e]=(r[e]-128)*.0078125;return t}},dA=(e,t,r)=>{let i=t[r];void 0!==i&&i!==e[r].value&&(e[r].value=i)},dE=e=>{var t;let r;e.start=(t=e.start,r=!1,(i=0,n=0,s)=>{if(r)throw dc();t.call(e,i,n,s),r=!0})},dw=e=>{var t;e.start=(t=e.start,(r=0,i=0,n)=>{if("number"==typeof n&&n<0||i<0||r<0)throw RangeError("The parameters can't be negative.");t.call(e,r,i,n)})},dC=e=>{var t;e.stop=(t=e.stop,(r=0)=>{if(r<0)throw RangeError("The parameter can't be negative.");t.call(e,r)})},dS=(e,t)=>null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t))))),dI=e=>new Promise((t,r)=>{let{port1:i,port2:n}=new MessageChannel;i.onmessage=({data:e})=>{i.close(),n.close(),t(e)},i.onmessageerror=({data:e})=>{i.close(),n.close(),r(e)},n.postMessage(e)}),dR=async(e,t)=>new e(await dI(t)),dM=(e,t,r,i)=>{let n=u8.get(e);void 0===n&&(n=new WeakMap,u8.set(e,n));let s=dR(r,i);return n.set(t,s),s},dP=(e,t)=>{let r=e.createBiquadFilter();return dx(r,t),dA(r,t,"Q"),dA(r,t,"detune"),dA(r,t,"frequency"),dA(r,t,"gain"),d_(r,t,"type"),r},dO=e=>{let t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:()=>t,set:e=>{if(e!==t)throw dc()}}),Object.defineProperty(e,"channelCountMode",{get:()=>"explicit",set:e=>{if("explicit"!==e)throw dc()}}),Object.defineProperty(e,"channelInterpretation",{get:()=>"discrete",set:e=>{if("discrete"!==e)throw dc()}})},dD=(e,t)=>{let r=e.createChannelSplitter(t.numberOfOutputs);return dx(r,t),dO(r),r},dN=(e,t)=>(e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e),dF=(e,t)=>{let r=e.createDelay(t.maxDelayTime);return dx(r,t),dA(r,t,"delayTime"),r},dB=(e,t)=>{let r=e.createGain();return dx(r,t),dA(r,t,"gain"),r};function dL(e,t){let r=[0,0];for(let n=e.length-1;n>=0;n-=1){var i;r=[(i=r)[0]*t[0]-i[1]*t[1],i[0]*t[1]+i[1]*t[0]],r[0]+=e[n]}return r}const dk=(e,t,r,i)=>e.createScriptProcessor(t,r,i),dU=()=>new DOMException("","NotSupportedError"),dG={numberOfChannels:1},dz={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},dj={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},dH={disableNormalization:!1},dV={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},dX={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},dW=(e,t,r)=>void 0===e.copyFromChannel?e.getChannelData(r)[0]:(e.copyFromChannel(t,r),t[0]),d$=e=>{if(null===e)return!1;let t=e.length;return t%2!=0?0!==e[Math.floor(t/2)]:e[t/2-1]+e[t/2]!==0},dY=(e,t,r,i)=>{let n=e;for(;!n.hasOwnProperty(t);)n=Object.getPrototypeOf(n);let{get:s,set:o}=Object.getOwnPropertyDescriptor(n,t);Object.defineProperty(e,t,{get:r(s),set:i(o)})},dq=(e,t,r)=>{try{e.setValueAtTime(t,r)}catch(i){if(9!==i.code)throw i;dq(e,t,r+1e-7)}},dZ=e=>{let t=e.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1},dK=e=>{let t=e.createBuffer(1,1,44100),r=e.createBufferSource();r.buffer=t,r.start(),r.stop();try{return r.stop(),!0}catch{return!1}},dQ=e=>{let t=e.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1},dJ=(e,t)=>{var r,i;let n;let s=t.createGain();e.connect(s);let o=(r=e.disconnect,()=>{r.call(e,s),e.removeEventListener("ended",o)});e.addEventListener("ended",o),dN(e,s),e.stop=(i=e.stop,n=!1,(t=0)=>{if(n)try{i.call(e,t)}catch{s.gain.setValueAtTime(0,t)}else i.call(e,t),n=!0})},d0=(e,t)=>r=>{let i={value:e};return(Object.defineProperties(r,{currentTarget:i,target:i}),"function"==typeof t)?t.call(e,r):t.handleEvent.call(e,r)},d1=new WeakMap,d2=(em=new Map,eg=new WeakMap,(e,t)=>{let r=eg.get(e);if(void 0!==r)return r;let i=em.get(e);if(void 0!==i)return i;try{let r=t();if(r instanceof Promise)return em.set(e,r),r.catch(()=>!1).then(t=>(em.delete(e),eg.set(e,t),t));return eg.set(e,r),r}catch{return eg.set(e,!1),!1}}),d3="undefined"==typeof window?null:window,d4=(e,t)=>{let r=e.createAnalyser();if(dx(r,t),!(t.maxDecibels>t.minDecibels))throw cp();return d_(r,t,"fftSize"),d_(r,t,"maxDecibels"),d_(r,t,"minDecibels"),d_(r,t,"smoothingTimeConstant"),d2(db,()=>db(r))||dT(r),r},d5=e=>{let t=cw(e);if(null===t.renderer)throw Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},d8=async(e,t,r)=>{let i=cw(e);await Promise.all(i.activeInputs.map((i,n)=>Array.from(i).map(async([i,s])=>{let o=d5(i),a=await o.render(i,t),l=e.context.destination;cH(i)||e===l&&cH(e)||a.connect(r,s,n)})).reduce((e,t)=>[...e,...t],[]))},d6=e=>{let t=u2.get(e);if(void 0===t)throw dc();return t},d7=null===d3?null:d3.hasOwnProperty("OfflineAudioContext")?d3.OfflineAudioContext:d3.hasOwnProperty("webkitOfflineAudioContext")?d3.webkitOfflineAudioContext:null,d9=e=>null!==d7&&e instanceof d7,fe=new WeakMap,ft=class{constructor(e){this._nativeEventTarget=e,this._listeners=new WeakMap}addEventListener(e,t,r){if(null!==t){let i=this._listeners.get(t);void 0===i&&(i=d0(this,t),"function"==typeof t&&this._listeners.set(t,i)),this._nativeEventTarget.addEventListener(e,i,r)}}dispatchEvent(e){return this._nativeEventTarget.dispatchEvent(e)}removeEventListener(e,t,r){let i=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===i?null:i,r)}},fr=null===d3?null:d3.hasOwnProperty("AudioContext")?d3.AudioContext:d3.hasOwnProperty("webkitAudioContext")?d3.webkitAudioContext:null,fi=e=>null!==fr&&e instanceof fr,fn=e=>null!==d3&&"function"==typeof d3.AudioNode&&e instanceof d3.AudioNode,fs=e=>null!==d3&&"function"==typeof d3.AudioParam&&e instanceof d3.AudioParam,fo=null===d3?null:d3.hasOwnProperty("AudioWorkletNode")?d3.AudioWorkletNode:null,fa=(ev=(e,t,r)=>{let i=[];for(let e=0;e<r.numberOfInputs;e+=1)i.push(new Set);uQ.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},ey=((e,t,r,i,n,s,o,a,l,h,u,c,d)=>{let f=new WeakMap;return(p,m,g,v,y)=>{let{activeInputs:x,passiveInputs:b}=s(m),{outputs:T}=s(p),A=a(p),E=s=>{let a=l(m),h=l(p);if(s){let t=cs(b,p,g,v);e(x,p,t,!1),y||c(p)||r(h,a,g,v),d(m)&&ca(m)}else{let e=i(x,p,g,v);t(b,v,e,!1),y||c(p)||n(h,a,g,v);let r=o(m);if(0===r)u(m)&&cu(m,x);else{let e=f.get(m);void 0!==e&&clearTimeout(e),f.set(m,setTimeout(()=>{u(m)&&cu(m,x)},1e3*r))}}};return!!h(T,[m,g,v],e=>e[0]===m&&e[1]===g&&e[2]===v,!0)&&(A.add(E),u(p)?e(x,p,[g,v,E],!0):t(b,v,[p,g,E],!0),!0)}})((e,t,[r,i,n],s)=>{cP(e[i],[t,r,n],e=>e[0]===t&&e[1]===r,s)},(e,t,[r,i,n],s)=>{let o=e.get(r);void 0===o?e.set(r,new Set([[i,t,n]])):cP(o,[i,t,n],e=>e[0]===i&&e[1]===t,s)},cF,(e,t,r,i)=>cn(e[i],e=>e[0]===t&&e[1]===r),cG,cw,e=>{var t;return null!==(t=d1.get(e))&&void 0!==t?t:0},co,cz,cP,cv,cH,cV),e_=e=>(t,r)=>{let i=u4.get(t);if(void 0===i){if(!e&&cv(t)){let e=cz(t),{outputs:r}=cw(t);for(let t of r)if(cM(t))cG(e,cz(t[0]),t[1],t[2]);else{let r=cj(t[0]);e.disconnect(r,t[1])}}u4.set(t,r)}else u4.set(t,i+r)},ex=(e,t)=>{let r=u4.get(e);if(void 0===r)throw Error("Missing the expected cycle count.");let i=d9(d6(e.context));if(r===t){if(u4.delete(e),!i&&cv(e)){let t=cz(e),{outputs:r}=cw(e);for(let e of r)if(cM(e))cF(t,cz(e[0]),e[1],e[2]);else{let r=cj(e[0]);t.connect(r,e[1])}}}else u4.set(e,r-t)},eb=function e(t,r){let i=cR(r)?r:ci(fe,r);if(da(i))return[];if(t[0]===i)return[t];if(t.includes(i))return[];let{outputs:n}=cw(i);return Array.from(n).map(r=>e([...t,i],r[0])).reduce((e,t)=>e.concat(t),[])},eT=ft,class extends eT{constructor(e,t,r,i){super(r),this._context=e,this._nativeAudioNode=r;let n=d6(e);fi(n)&&!0!==d2(cX,()=>cX(n,fo))&&cY(r),uJ.set(this,r),u3.set(this,new Set),"closed"!==e.state&&t&&ca(this),ev(this,i,r)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(e){this._nativeAudioNode.channelCount=e}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(e){this._nativeAudioNode.channelCountMode=e}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(e){this._nativeAudioNode.channelInterpretation=e}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(e,t=0,r=0){if(t<0||t>=this._nativeAudioNode.numberOfOutputs)throw cp();let i=d9(d6(this._context));if(fn(e)||fs(e))throw dd();if(cR(e)){let n=cz(e);try{let s=cF(this._nativeAudioNode,n,t,r),o=cV(this);(i||o)&&this._nativeAudioNode.disconnect(...s),"closed"!==this.context.state&&!o&&cV(e)&&ca(e)}catch(e){if(12===e.code)throw dd();throw e}return ey(this,e,t,r,i)&&cW(eb([this],e),e_(i)),e}let n=cj(e);if("playbackRate"===n.name&&1024===n.maxValue)throw dU();try{this._nativeAudioNode.connect(n,t),(i||cV(this))&&this._nativeAudioNode.disconnect(n,t)}catch(e){if(12===e.code)throw dd();throw e}cq(this,e,t,i)&&cW(eb([this],e),e_(i))}disconnect(e,t,r){let i;let n=d9(d6(this._context));if(void 0===e)i=c0(this,n);else if("number"==typeof e){if(e<0||e>=this.numberOfOutputs)throw cp();i=c1(this,n,e)}else{if(void 0!==t&&(t<0||t>=this.numberOfOutputs)||cR(e)&&void 0!==r&&(r<0||r>=e.numberOfInputs))throw cp();if(0===(i=c2(this,n,e,t,r)).length)throw dd()}for(let e of i)cW(eb([this],e),ex)}}),fl=(eA=fa,eE=()=>{let e=new WeakMap,t=async(t,r)=>{let i=cz(t);return cd(i,r)||(i=d4(r,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,fftSize:i.fftSize,maxDecibels:i.maxDecibels,minDecibels:i.minDecibels,smoothingTimeConstant:i.smoothingTimeConstant})),e.set(r,i),await d8(t,r,i),i};return{render(r,i){let n=e.get(i);return void 0!==n?Promise.resolve(n):t(r,i)}}},class extends eA{constructor(e,t){let r=d6(e),i=d4(r,{...cc,...t});super(e,!1,i,d9(r)?eE():null),this._nativeAnalyserNode=i}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(e){this._nativeAnalyserNode.fftSize=e}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(e){let t=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=t,cp()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(e){let t=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=t,cp()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(e){this._nativeAnalyserNode.smoothingTimeConstant=e}getByteFrequencyData(e){this._nativeAnalyserNode.getByteFrequencyData(e)}getByteTimeDomainData(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}getFloatFrequencyData(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}getFloatTimeDomainData(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}}),fh=new WeakSet,fu=null===d3?null:d3.hasOwnProperty("AudioBuffer")?d3.AudioBuffer:null,fc=(ew=new Uint32Array(1),e=>(ew[0]=e,ew[0])),fd=e=>{e.copyFromChannel=(t,r,i=0)=>{let n=fc(i),s=fc(r);if(s>=e.numberOfChannels)throw cp();let o=e.length,a=e.getChannelData(s),l=t.length;for(let e=n<0?-n:0;e+n<o&&e<l;e+=1)t[e]=a[e+n]},e.copyToChannel=(t,r,i=0)=>{let n=fc(i),s=fc(r);if(s>=e.numberOfChannels)throw cp();let o=e.length,a=e.getChannelData(s),l=t.length;for(let e=n<0?-n:0;e+n<o&&e<l;e+=1)a[e+n]=t[e]}},ff=e=>{var t,r;e.copyFromChannel=(t=e.copyFromChannel,(r,i,n=0)=>{let s=fc(n),o=fc(i);if(s<e.length)return t.call(e,r,o,s)}),e.copyToChannel=(r=e.copyToChannel,(t,i,n=0)=>{let s=fc(n),o=fc(i);if(s<e.length)return r.call(e,t,o,s)})},fp=(eC=()=>{if(null===fu)return!1;try{new fu({length:1,sampleRate:44100})}catch{return!1}return!0},a=null,class e{constructor(e){if(null===d7)throw Error("Missing the native OfflineAudioContext constructor.");let{length:t,numberOfChannels:r,sampleRate:i}={...cg,...e};null===a&&(a=new d7(1,1,44100));let n=null!==fu&&d2(eC,eC)?new fu({length:t,numberOfChannels:r,sampleRate:i}):a.createBuffer(r,t,i);if(0===n.numberOfChannels)throw dU();return"function"!=typeof n.copyFromChannel?(fd(n),cm(n)):d2(cf,()=>cf(n))||ff(n),fh.add(n),n}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===e.prototype||fh.has(t)}}),fm=(e,t)=>{let r=dB(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(r).connect(e.destination);let i=()=>{t.removeEventListener("ended",i),t.disconnect(r),r.disconnect()};t.addEventListener("ended",i)},fg=async(e,t,r)=>{let i=cC(e);await Promise.all(Array.from(i.activeInputs).map(async([e,i])=>{let n=d5(e),s=await n.render(e,t);cH(e)||s.connect(r,i)}))},fv=(e,t,r)=>fg(t,e,r),fy=(eS=e=>{let t=e.createBufferSource();t.start();try{t.start()}catch{return!0}return!1},eI=e=>{let t=e.createBufferSource(),r=e.createBuffer(1,1,44100);t.buffer=r;try{t.start(0,1)}catch{return!1}return!0},eR=e=>{let t=e.createBufferSource();t.start();try{t.stop()}catch{return!1}return!0},eM=e=>{var t;e.start=(t=e.start,(r=0,i=0,n)=>{let s=e.buffer,o=null===s?i:Math.min(s.duration,i);null!==s&&o>s.duration-.5/e.context.sampleRate?t.call(e,r,0,0):t.call(e,r,o,n)})},eP=(e,t)=>{let r=t.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=r),dY(e,"buffer",t=>()=>{let i=t.call(e);return i===r?null:i},t=>i=>t.call(e,null===i?r:i))},(e,t)=>{let r=e.createBufferSource();return dx(r,t),dA(r,t,"playbackRate"),d_(r,t,"buffer"),d_(r,t,"loop"),d_(r,t,"loopEnd"),d_(r,t,"loopStart"),d2(eS,()=>eS(e))||dE(r),d2(eI,()=>eI(e))||eM(r),d2(eR,()=>eR(e))||eP(r,e),d2(dZ,()=>dZ(e))||dw(r),d2(dK,()=>dK(e))||dJ(r,e),d2(dQ,()=>dQ(e))||dC(r),fm(e,r),r}),f_=(eO=e=>{let t=cC(e);if(null===t.renderer)throw Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},(e,t,r)=>(eO(t).replay(r),fg(t,e,r))),fx=(eD=(e,t)=>{u0.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},eN=e=>({replay(t){for(let r of e)if("exponentialRampToValue"===r.type){let{endTime:e,value:i}=r;t.exponentialRampToValueAtTime(i,e)}else if("linearRampToValue"===r.type){let{endTime:e,value:i}=r;t.linearRampToValueAtTime(i,e)}else if("setTarget"===r.type){let{startTime:e,target:i,timeConstant:n}=r;t.setTargetAtTime(i,e,n)}else if("setValue"===r.type){let{startTime:e,value:i}=r;t.setValueAtTime(i,e)}else if("setValueCurve"===r.type){let{duration:e,startTime:i,values:n}=r;t.setValueCurveAtTime(n,i,e)}else throw Error("Can't apply an unknown automation.")}}),eF=uZ.createCancelAndHoldAutomationEvent,eB=uZ.createCancelScheduledValuesAutomationEvent,eL=uZ.createExponentialRampToValueAutomationEvent,ek=uZ.createLinearRampToValueAutomationEvent,eU=uZ.createSetTargetAutomationEvent,eG=uZ.createSetValueAutomationEvent,ez=uZ.createSetValueCurveAutomationEvent,(e,t,r,i=null,n=null)=>{let s=r.value,o=new uZ.AutomationEventList(s),a=t?eN(o):null,l={get defaultValue(){return s},get maxValue(){return null===i?r.maxValue:i},get minValue(){return null===n?r.minValue:n},get value(){return r.value},set value(value){r.value=value,l.setValueAtTime(value,e.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof r.cancelAndHoldAtTime)null===a&&o.flush(e.context.currentTime),o.add(eF(t)),r.cancelAndHoldAtTime(t);else{let i=Array.from(o).pop();null===a&&o.flush(e.context.currentTime),o.add(eF(t));let n=Array.from(o).pop();r.cancelScheduledValues(t),i!==n&&void 0!==n&&("exponentialRampToValue"===n.type?r.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?r.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?r.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&r.setValueCurveAtTime(n.values,n.startTime,n.duration))}return l},cancelScheduledValues:t=>(null===a&&o.flush(e.context.currentTime),o.add(eB(t)),r.cancelScheduledValues(t),l),exponentialRampToValueAtTime(t,i){if(0===t||!Number.isFinite(i)||i<0)throw RangeError();let n=e.context.currentTime;return null===a&&o.flush(n),0===Array.from(o).length&&(o.add(eG(s,n)),r.setValueAtTime(s,n)),o.add(eL(t,i)),r.exponentialRampToValueAtTime(t,i),l},linearRampToValueAtTime(t,i){let n=e.context.currentTime;return null===a&&o.flush(n),0===Array.from(o).length&&(o.add(eG(s,n)),r.setValueAtTime(s,n)),o.add(ek(t,i)),r.linearRampToValueAtTime(t,i),l},setTargetAtTime:(t,i,n)=>(null===a&&o.flush(e.context.currentTime),o.add(eU(t,i,n)),r.setTargetAtTime(t,i,n),l),setValueAtTime:(t,i)=>(null===a&&o.flush(e.context.currentTime),o.add(eG(t,i)),r.setValueAtTime(t,i),l),setValueCurveAtTime(t,i,n){let s=t instanceof Float32Array?t:new Float32Array(t);if(null!==fr&&"webkitAudioContext"===fr.name){let t=i+n,h=e.context.sampleRate,u=Math.ceil(i*h),c=Math.floor(t*h),d=c-u,f=new Float32Array(d);for(let e=0;e<d;e+=1){let t=(s.length-1)/n*((u+e)/h-i),r=Math.floor(t),o=Math.ceil(t);f[e]=r===o?s[r]:(1-(t-r))*s[r]+(1-(o-t))*s[o]}null===a&&o.flush(e.context.currentTime),o.add(ez(f,i,n)),r.setValueCurveAtTime(f,i,n);let p=c/h;p<t&&dq(l,f[f.length-1],p),dq(l,s[s.length-1],t)}else null===a&&o.flush(e.context.currentTime),o.add(ez(s,i,n)),r.setValueCurveAtTime(s,i,n);return l}};return u1.set(l,r),fe.set(l,e),eD(l,a),l}),fb=(ej=fa,eH=()=>{let e=new WeakMap,t=null,r=null,i=async(i,n)=>{let s=cz(i),o=cd(s,n);return o||(s=fy(n,{buffer:s.buffer,channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,loop:s.loop,loopEnd:s.loopEnd,loopStart:s.loopStart,playbackRate:s.playbackRate.value}),null!==t&&s.start(...t),null!==r&&s.stop(r)),e.set(n,s),o?await fv(n,i.playbackRate,s.playbackRate):await f_(n,i.playbackRate,s.playbackRate),await d8(i,n,s),s};return{set start(value){t=value},set stop(value){r=value},render(t,r){let n=e.get(r);return void 0!==n?Promise.resolve(n):i(t,r)}}},class extends ej{constructor(e,t){let r=d6(e),i={...cy,...t},n=fy(r,i),s=d9(r),o=s?eH():null;super(e,!1,n,o),this._audioBufferSourceNodeRenderer=o,this._isBufferNullified=!1,this._isBufferSet=null!==i.buffer,this._nativeAudioBufferSourceNode=n,this._onended=null,this._playbackRate=fx(this,s,n.playbackRate,34028234663852886e22,-34028234663852886e22)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(e){if(this._nativeAudioBufferSourceNode.buffer=e,null!==e){if(this._isBufferSet)throw dc();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(e){this._nativeAudioBufferSourceNode.loop=e}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(e){this._nativeAudioBufferSourceNode.loopEnd=e}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(e){this._nativeAudioBufferSourceNode.loopStart=e}get onended(){return this._onended}set onended(e){let t="function"==typeof e?d0(this,e):null;this._nativeAudioBufferSourceNode.onended=t;let r=this._nativeAudioBufferSourceNode.onended;this._onended=null!==r&&r===t?e:r}get playbackRate(){return this._playbackRate}start(e=0,t=0,r){if(this._nativeAudioBufferSourceNode.start(e,t,r),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===r?[e,t]:[e,t,r]),"closed"!==this.context.state){ca(this);let e=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",e),cv(this)&&ch(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}}),fT=(eV=fa,eX=e=>{let t=new WeakMap,r=async(r,i)=>{let n=i.destination;return t.set(i,n),await e(r,i,n),n};return{render(e,i){let n=t.get(i);return void 0!==n?Promise.resolve(n):r(e,i)}}},eW=(e,t,r)=>{let i=e.destination;if(i.channelCount!==t)try{i.channelCount=t}catch{}r&&"explicit"!==i.channelCountMode&&(i.channelCountMode="explicit"),0===i.maxChannelCount&&Object.defineProperty(i,"maxChannelCount",{value:t});let n=dB(e,{channelCount:t,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:1});return dY(n,"channelCount",e=>()=>e.call(n),e=>t=>{e.call(n,t);try{i.channelCount=t}catch(e){if(t>i.maxChannelCount)throw e}}),dY(n,"channelCountMode",e=>()=>e.call(n),e=>t=>{e.call(n,t),i.channelCountMode=t}),dY(n,"channelInterpretation",e=>()=>e.call(n),e=>t=>{e.call(n,t),i.channelInterpretation=t}),Object.defineProperty(n,"maxChannelCount",{get:()=>i.maxChannelCount}),n.connect(i),n},class extends eV{constructor(e,t){let r=d6(e),i=d9(r),n=eW(r,t,i);super(e,!1,n,i?eX(d8):null),this._isNodeOfNativeOfflineAudioContext=i,this._nativeAudioDestinationNode=n}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(e){if(this._isNodeOfNativeOfflineAudioContext)throw dc();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw cp();this._nativeAudioDestinationNode.channelCount=e}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(e){if(this._isNodeOfNativeOfflineAudioContext)throw dc();this._nativeAudioDestinationNode.channelCountMode=e}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}}),fA=(e,t)=>d1.set(e,t),fE=(e$=fa,eY=()=>{let e=new WeakMap,t=async(t,r)=>{let i=cz(t),n=cd(i,r);return n||(i=dP(r,{Q:i.Q.value,channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,detune:i.detune.value,frequency:i.frequency.value,gain:i.gain.value,type:i.type})),e.set(r,i),n?(await fv(r,t.Q,i.Q),await fv(r,t.detune,i.detune),await fv(r,t.frequency,i.frequency),await fv(r,t.gain,i.gain)):(await f_(r,t.Q,i.Q),await f_(r,t.detune,i.detune),await f_(r,t.frequency,i.frequency),await f_(r,t.gain,i.gain)),await d8(t,r,i),i};return{render(r,i){let n=e.get(i);return void 0!==n?Promise.resolve(n):t(r,i)}}},class extends e${constructor(e,t){let r=d6(e),i=dP(r,{...c9,...t}),n=d9(r);super(e,!1,i,n?eY():null),this._Q=fx(this,n,i.Q,34028234663852886e22,-34028234663852886e22),this._detune=fx(this,n,i.detune,1200*Math.log2(34028234663852886e22),-1200*Math.log2(34028234663852886e22)),this._frequency=fx(this,n,i.frequency,e.sampleRate/2,0),this._gain=fx(this,n,i.gain,40*Math.log10(34028234663852886e22),-34028234663852886e22),this._nativeBiquadFilterNode=i,fA(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(e){this._nativeBiquadFilterNode.type=e}getFrequencyResponse(e,t,r){try{this._nativeBiquadFilterNode.getFrequencyResponse(e,t,r)}catch(e){if(11===e.code)throw dd();throw e}if(e.length!==t.length||t.length!==r.length)throw dd()}}),fw=(e,t,r)=>{var i,n;let s=new Set;return e.connect=(i=e.connect,(r,n=0,o=0)=>{let a=0===s.size;if(fn(r))return i.call(e,r,n,o),cP(s,[r,n,o],e=>e[0]===r&&e[1]===n&&e[2]===o,!0),a&&t(),r;i.call(e,r,n),cP(s,[r,n],e=>e[0]===r&&e[1]===n,!0),a&&t()}),e.disconnect=(n=e.disconnect,(t,i,o)=>{let a=s.size>0;if(void 0===t)n.apply(e),s.clear();else if("number"==typeof t)for(let r of(n.call(e,t),s))r[1]===t&&s.delete(r);else for(let r of(fn(t)?n.call(e,t,i,o):n.call(e,t,i),s))r[0]===t&&(void 0===i||r[1]===i)&&(void 0===o||r[2]===o)&&s.delete(r);let l=0===s.size;a&&l&&r()}),e},fC=(eq=(e,t)=>{t.channelCount=1,t.channelCountMode="explicit",Object.defineProperty(t,"channelCount",{get:()=>1,set:()=>{throw dc()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:()=>{throw dc()}});let r=e.createBufferSource();fw(t,()=>{let e=t.numberOfInputs;for(let i=0;i<e;i+=1)r.connect(t,0,i)},()=>r.disconnect(t))},(e,t)=>{let r=e.createChannelMerger(t.numberOfInputs);return null!==fr&&"webkitAudioContext"===fr.name&&eq(e,r),dx(r,t),r}),fS=(eZ=fa,eK=()=>{let e=new WeakMap,t=async(t,r)=>{let i=cz(t);return cd(i,r)||(i=fC(r,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,numberOfInputs:i.numberOfInputs})),e.set(r,i),await d8(t,r,i),i};return{render(r,i){let n=e.get(i);return void 0!==n?Promise.resolve(n):t(r,i)}}},class extends eZ{constructor(e,t){let r=d6(e);super(e,!1,fC(r,{...de,...t}),d9(r)?eK():null)}}),fI=(eQ=fa,eJ=()=>{let e=new WeakMap,t=async(t,r)=>{let i=cz(t);return cd(i,r)||(i=dD(r,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,numberOfOutputs:i.numberOfOutputs})),e.set(r,i),await d8(t,r,i),i};return{render(r,i){let n=e.get(i);return void 0!==n?Promise.resolve(n):t(r,i)}}},e0=e=>({...e,channelCount:e.numberOfOutputs}),class extends eQ{constructor(e,t){let r=d6(e);super(e,!1,dD(r,e0({...dt,...t})),d9(r)?eJ():null)}}),fR=(e1=(e,{offset:t,...r})=>{let i=e.createBuffer(1,2,44100),n=fy(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=dB(e,{...r,gain:t}),o=i.getChannelData(0);return o[0]=1,o[1]=1,n.buffer=i,n.loop=!0,fm(e,n),fw(dN({get bufferSize(){return},get channelCount(){return s.channelCount},set channelCount(value){s.channelCount=value},get channelCountMode(){return s.channelCountMode},set channelCountMode(value){s.channelCountMode=value},get channelInterpretation(){return s.channelInterpretation},set channelInterpretation(value){s.channelInterpretation=value},get context(){return s.context},get inputs(){return[]},get numberOfInputs(){return n.numberOfInputs},get numberOfOutputs(){return s.numberOfOutputs},get offset(){return s.gain},get onended(){return n.onended},set onended(value){n.onended=value},addEventListener:(...e)=>n.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>n.dispatchEvent(e[0]),removeEventListener:(...e)=>n.removeEventListener(e[0],e[1],e[2]),start(e=0){n.start.call(n,e)},stop(e=0){n.stop.call(n,e)}},s),()=>n.connect(s),()=>n.disconnect(s))},(e,t)=>{if(void 0===e.createConstantSource)return e1(e,t);let r=e.createConstantSource();return dx(r,t),dA(r,t,"offset"),d2(dZ,()=>dZ(e))||dw(r),d2(dQ,()=>dQ(e))||dC(r),fm(e,r),r}),fM=(e2=fa,e3=()=>{let e=new WeakMap,t=null,r=null,i=async(i,n)=>{let s=cz(i),o=cd(s,n);return o||(s=fR(n,{channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,offset:s.offset.value}),null!==t&&s.start(t),null!==r&&s.stop(r)),e.set(n,s),o?await fv(n,i.offset,s.offset):await f_(n,i.offset,s.offset),await d8(i,n,s),s};return{set start(value){t=value},set stop(value){r=value},render(t,r){let n=e.get(r);return void 0!==n?Promise.resolve(n):i(t,r)}}},class extends e2{constructor(e,t){let r=d6(e),i=fR(r,{...dr,...t}),n=d9(r),s=n?e3():null;super(e,!1,i,s),this._constantSourceNodeRenderer=s,this._nativeConstantSourceNode=i,this._offset=fx(this,n,i.offset,34028234663852886e22,-34028234663852886e22),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(e){let t="function"==typeof e?d0(this,e):null;this._nativeConstantSourceNode.onended=t;let r=this._nativeConstantSourceNode.onended;this._onended=null!==r&&r===t?e:r}start(e=0){if(this._nativeConstantSourceNode.start(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=e),"closed"!==this.context.state){ca(this);let e=()=>{this._nativeConstantSourceNode.removeEventListener("ended",e),cv(this)&&ch(this)};this._nativeConstantSourceNode.addEventListener("ended",e)}}stop(e=0){this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}}),fP=(e,t)=>{let r=e.createConvolver();if(dx(r,t),t.disableNormalization===r.normalize&&(r.normalize=!t.disableNormalization),d_(r,t,"buffer"),t.channelCount>2||(dY(r,"channelCount",e=>()=>e.call(r),e=>t=>{if(t>2)throw dU();return e.call(r,t)}),"max"===t.channelCountMode))throw dU();return dY(r,"channelCountMode",e=>()=>e.call(r),e=>t=>{if("max"===t)throw dU();return e.call(r,t)}),r},fO=(e4=fa,e5=()=>{let e=new WeakMap,t=async(t,r)=>{let i=cz(t);return cd(i,r)||(i=fP(r,{buffer:i.buffer,channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,disableNormalization:!i.normalize})),e.set(r,i),cN(i)?await d8(t,r,i.inputs[0]):await d8(t,r,i),i};return{render(r,i){let n=e.get(i);return void 0!==n?Promise.resolve(n):t(r,i)}}},class extends e4{constructor(e,t){let r=d6(e),i={...di,...t},n=fP(r,i);super(e,!1,n,d9(r)?e5():null),this._isBufferNullified=!1,this._nativeConvolverNode=n,null!==i.buffer&&fA(this,i.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){let e=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=e.createBuffer(1,1,e.sampleRate),this._isBufferNullified=!0,fA(this,0)}else this._isBufferNullified=!1,fA(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(e){this._nativeConvolverNode.normalize=e}}),fD=(e8=fa,e6=e=>{let t=new WeakMap,r=async(r,i)=>{let n=cz(r),s=cd(n,i);return s||(n=dF(i,{channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation,delayTime:n.delayTime.value,maxDelayTime:e})),t.set(i,n),s?await fv(i,r.delayTime,n.delayTime):await f_(i,r.delayTime,n.delayTime),await d8(r,i,n),n};return{render(e,i){let n=t.get(i);return void 0!==n?Promise.resolve(n):r(e,i)}}},class extends e8{constructor(e,t){let r=d6(e),i={...ds,...t},n=dF(r,i),s=d9(r);super(e,!1,n,s?e6(i.maxDelayTime):null),this._delayTime=fx(this,s,n.delayTime),fA(this,i.maxDelayTime)}get delayTime(){return this._delayTime}}),fN=(e,t)=>{let r=e.createDynamicsCompressor();if(dx(r,t),t.channelCount>2||"max"===t.channelCountMode)throw dU();return dA(r,t,"attack"),dA(r,t,"knee"),dA(r,t,"ratio"),dA(r,t,"release"),dA(r,t,"threshold"),r},fF=(e7=fa,e9=()=>{let e=new WeakMap,t=async(t,r)=>{let i=cz(t),n=cd(i,r);return n||(i=fN(r,{attack:i.attack.value,channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,knee:i.knee.value,ratio:i.ratio.value,release:i.release.value,threshold:i.threshold.value})),e.set(r,i),n?(await fv(r,t.attack,i.attack),await fv(r,t.knee,i.knee),await fv(r,t.ratio,i.ratio),await fv(r,t.release,i.release),await fv(r,t.threshold,i.threshold)):(await f_(r,t.attack,i.attack),await f_(r,t.knee,i.knee),await f_(r,t.ratio,i.ratio),await f_(r,t.release,i.release),await f_(r,t.threshold,i.threshold)),await d8(t,r,i),i};return{render(r,i){let n=e.get(i);return void 0!==n?Promise.resolve(n):t(r,i)}}},class extends e7{constructor(e,t){let r=d6(e),i=fN(r,{...dh,...t}),n=d9(r);super(e,!1,i,n?e9():null),this._attack=fx(this,n,i.attack),this._knee=fx(this,n,i.knee),this._nativeDynamicsCompressorNode=i,this._ratio=fx(this,n,i.ratio),this._release=fx(this,n,i.release),this._threshold=fx(this,n,i.threshold),fA(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(e){let t=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=t,dU()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(e){let t=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=t,dU()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}}),fB=(te=fa,tt=()=>{let e=new WeakMap,t=async(t,r)=>{let i=cz(t),n=cd(i,r);return n||(i=dB(r,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,gain:i.gain.value})),e.set(r,i),n?await fv(r,t.gain,i.gain):await f_(r,t.gain,i.gain),await d8(t,r,i),i};return{render(r,i){let n=e.get(i);return void 0!==n?Promise.resolve(n):t(r,i)}}},class extends te{constructor(e,t){let r=d6(e),i=dB(r,{...du,...t}),n=d9(r);super(e,!1,i,n?tt():null),this._gain=fx(this,n,i.gain,34028234663852886e22,-34028234663852886e22)}get gain(){return this._gain}}),fL=(tr=()=>{if(null===d7)return Promise.resolve(!1);let e=new d7(1,1,44100),t=dB(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(r=>{e.oncomplete=()=>{t.disconnect(),r(0!==e.currentTime)},e.startRendering()})},e=>d2(dy,()=>dy(e))?Promise.resolve(d2(tr,tr)).then(t=>{if(!t){let t=dk(e,512,0,1);e.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>e.currentTime,t.connect(e.destination)}return e.startRendering()}):new Promise(t=>{let r=dB(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});e.oncomplete=e=>{r.disconnect(),t(e.renderedBuffer)},r.connect(e.destination),e.startRendering()})),fk=(ti=(e,t,{channelCount:r,channelCountMode:i,channelInterpretation:n,feedback:s,feedforward:o})=>{let a=dS(t,e.sampleRate),l=s instanceof Float64Array?s:new Float64Array(s),h=o instanceof Float64Array?o:new Float64Array(o),u=l.length,c=h.length,d=Math.min(u,c);if(0===u||u>20)throw dU();if(0===l[0])throw dc();if(0===c||c>20)throw dU();if(0===h[0])throw dc();if(1!==l[0]){for(let e=0;e<c;e+=1)h[e]/=l[0];for(let e=1;e<u;e+=1)l[e]/=l[0]}let f=dk(e,a,r,r);f.channelCount=r,f.channelCountMode=i,f.channelInterpretation=n;let p=[],m=[],g=[];for(let e=0;e<r;e+=1){p.push(0);let e=new Float32Array(32),t=new Float32Array(32);e.fill(0),t.fill(0),m.push(e),g.push(t)}f.onaudioprocess=e=>{let t=e.inputBuffer,r=e.outputBuffer,i=t.numberOfChannels;for(let e=0;e<i;e+=1){let i=t.getChannelData(e),n=r.getChannelData(e);p[e]=dm(l,u,h,c,d,m[e],g[e],p[e],32,i,n)}};let v=e.sampleRate/2;return dN({get bufferSize(){return a},get channelCount(){return f.channelCount},set channelCount(value){f.channelCount=value},get channelCountMode(){return f.channelCountMode},set channelCountMode(value){f.channelCountMode=value},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(value){f.channelInterpretation=value},get context(){return f.context},get inputs(){return[f]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},addEventListener:(...e)=>f.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>f.dispatchEvent(e[0]),getFrequencyResponse(e,t,r){if(e.length!==t.length||t.length!==r.length)throw dd();let i=e.length;for(let n=0;n<i;n+=1){let i=-(e[n]/v*Math.PI),s=[Math.cos(i),Math.sin(i)],o=function(e,t){let r=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/r,(e[1]*t[0]-e[0]*t[1])/r]}(dL(h,s),dL(l,s));t[n]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),r[n]=Math.atan2(o[1],o[0])}},removeEventListener:(...e)=>f.removeEventListener(e[0],e[1],e[2])},f)},(e,t,r)=>{if(void 0===e.createIIRFilter)return ti(e,t,r);let i=e.createIIRFilter(r.feedforward,r.feedback);return dx(i,r),i}),fU=(tn=fa,ts=(e,t)=>{let r=new WeakMap,i=null,n=async(n,s)=>{let o=null,a=cz(n),l=cd(a,s);if(void 0===s.createIIRFilter?o=fy(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):l||(a=s.createIIRFilter(t,e)),r.set(s,null===o?a:o),null!==o){if(null===i){if(null===d7)throw Error("Missing the native OfflineAudioContext constructor.");let r=new d7(n.context.destination.channelCount,n.context.length,s.sampleRate);i=(async()=>(await d8(n,r,r.destination),dg(await fL(r),s,e,t)))()}let r=await i;return o.buffer=r,o.start(0),o}return await d8(n,s,a),a};return{render(e,t){let i=r.get(t);return void 0!==i?Promise.resolve(i):n(e,t)}}},class extends tn{constructor(e,t){let r=d6(e),i=d9(r),n={...dp,...t},s=fk(r,i?null:e.baseLatency,n);super(e,!1,s,i?ts(n.feedback,n.feedforward):null),df(s),this._nativeIIRFilterNode=s,fA(this,1)}getFrequencyResponse(e,t,r){return this._nativeIIRFilterNode.getFrequencyResponse(e,t,r)}}),fG=new WeakMap,fz=(to=(e,t)=>{let r=t.listener,{forwardX:i,forwardY:n,forwardZ:s,positionX:o,positionY:a,positionZ:l,upX:h,upY:u,upZ:c}=void 0===r.forwardX?(()=>{let i=new Float32Array(1),n=fC(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),s=d9(t),o=!1,a=[0,0,-1,0,1,0],l=[0,0,0],h=()=>{if(o)return;o=!0;let e=dk(t,256,9,0);e.onaudioprocess=({inputBuffer:e})=>{let t=[dW(e,i,0),dW(e,i,1),dW(e,i,2),dW(e,i,3),dW(e,i,4),dW(e,i,5)];t.some((e,t)=>e!==a[t])&&(r.setOrientation(...t),a=t);let n=[dW(e,i,6),dW(e,i,7),dW(e,i,8)];n.some((e,t)=>e!==l[t])&&(r.setPosition(...n),l=n)},n.connect(e)},u=e=>t=>{t!==a[e]&&(a[e]=t,r.setOrientation(...a))},c=e=>t=>{t!==l[e]&&(l[e]=t,r.setPosition(...l))},d=(r,i,o)=>{var a,l,u,c,d,f,p;let m=fR(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});m.connect(n,0,r),m.start(),Object.defineProperty(m.offset,"defaultValue",{get:()=>i});let g=fx({context:e},s,m.offset,34028234663852886e22,-34028234663852886e22);return dY(g,"value",e=>()=>e.call(g),e=>t=>{try{e.call(g,t)}catch(e){if(9!==e.code)throw e}h(),s&&o(t)}),g.cancelAndHoldAtTime=(a=g.cancelAndHoldAtTime,s?()=>{throw dU()}:(...e)=>{let t=a.apply(g,e);return h(),t}),g.cancelScheduledValues=(l=g.cancelScheduledValues,s?()=>{throw dU()}:(...e)=>{let t=l.apply(g,e);return h(),t}),g.exponentialRampToValueAtTime=(u=g.exponentialRampToValueAtTime,s?()=>{throw dU()}:(...e)=>{let t=u.apply(g,e);return h(),t}),g.linearRampToValueAtTime=(c=g.linearRampToValueAtTime,s?()=>{throw dU()}:(...e)=>{let t=c.apply(g,e);return h(),t}),g.setTargetAtTime=(d=g.setTargetAtTime,s?()=>{throw dU()}:(...e)=>{let t=d.apply(g,e);return h(),t}),g.setValueAtTime=(f=g.setValueAtTime,s?()=>{throw dU()}:(...e)=>{let t=f.apply(g,e);return h(),t}),g.setValueCurveAtTime=(p=g.setValueCurveAtTime,s?()=>{throw dU()}:(...e)=>{let t=p.apply(g,e);return h(),t}),g};return{forwardX:d(0,0,u(0)),forwardY:d(1,0,u(1)),forwardZ:d(2,-1,u(2)),positionX:d(6,0,c(0)),positionY:d(7,0,c(1)),positionZ:d(8,0,c(2)),upX:d(3,0,u(3)),upY:d(4,1,u(4)),upZ:d(5,0,u(5))}})():r;return{get forwardX(){return i},get forwardY(){return n},get forwardZ(){return s},get positionX(){return o},get positionY(){return a},get positionZ(){return l},get upX(){return h},get upY(){return u},get upZ(){return c}}},ta=ft,class extends ta{constructor(e,t){super(e),this._nativeContext=e,u2.set(this,e),d9(e)&&fG.set(e,new Set),this._destination=new fT(this,t),this._listener=to(this,e),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(e){let t="function"==typeof e?d0(this,e):null;this._nativeContext.onstatechange=t;let r=this._nativeContext.onstatechange;this._onstatechange=null!==r&&r===t?e:r}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}}),fj=(e,t)=>{let r=e.createOscillator();return dx(r,t),dA(r,t,"detune"),dA(r,t,"frequency"),void 0!==t.periodicWave?r.setPeriodicWave(t.periodicWave):d_(r,t,"type"),d2(dZ,()=>dZ(e))||dw(r),d2(dK,()=>dK(e))||dJ(r,e),d2(dQ,()=>dQ(e))||dC(r),fm(e,r),r},fH=(tl=fa,th=()=>{let e=new WeakMap,t=null,r=null,i=null,n=async(n,s)=>{let o=cz(n),a=cd(o,s);return a||(o=fj(s,{channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,detune:o.detune.value,frequency:o.frequency.value,periodicWave:null===t?void 0:t,type:o.type}),null!==r&&o.start(r),null!==i&&o.stop(i)),e.set(s,o),a?(await fv(s,n.detune,o.detune),await fv(s,n.frequency,o.frequency)):(await f_(s,n.detune,o.detune),await f_(s,n.frequency,o.frequency)),await d8(n,s,o),o};return{set periodicWave(value){t=value},set start(value){r=value},set stop(value){i=value},render(t,r){let i=e.get(r);return void 0!==i?Promise.resolve(i):n(t,r)}}},class extends tl{constructor(e,t){let r=d6(e),i={...dz,...t},n=fj(r,i),s=d9(r),o=s?th():null,a=e.sampleRate/2;super(e,!1,n,o),this._detune=fx(this,s,n.detune,153600,-153600),this._frequency=fx(this,s,n.frequency,a,-a),this._nativeOscillatorNode=n,this._onended=null,this._oscillatorNodeRenderer=o,null!==this._oscillatorNodeRenderer&&void 0!==i.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=i.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(e){let t="function"==typeof e?d0(this,e):null;this._nativeOscillatorNode.onended=t;let r=this._nativeOscillatorNode.onended;this._onended=null!==r&&r===t?e:r}get type(){return this._nativeOscillatorNode.type}set type(e){this._nativeOscillatorNode.type=e,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}start(e=0){if(this._nativeOscillatorNode.start(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=e),"closed"!==this.context.state){ca(this);let e=()=>{this._nativeOscillatorNode.removeEventListener("ended",e),cv(this)&&ch(this)};this._nativeOscillatorNode.addEventListener("ended",e)}}stop(e=0){this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}}),fV=(e,t)=>{let r=fy(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(t),r.start(),()=>{r.stop(),r.disconnect(t)}},fX=(tu=(e,{curve:t,oversample:r,...i})=>{let n=e.createWaveShaper(),s=e.createWaveShaper();dx(n,i),dx(s,i);let o=dB(e,{...i,gain:1}),a=dB(e,{...i,gain:-1}),l=dB(e,{...i,gain:1}),h=dB(e,{...i,gain:-1}),u=null,c=!1,d=null,f={get bufferSize(){return},get channelCount(){return n.channelCount},set channelCount(value){o.channelCount=value,a.channelCount=value,n.channelCount=value,l.channelCount=value,s.channelCount=value,h.channelCount=value},get channelCountMode(){return n.channelCountMode},set channelCountMode(value){o.channelCountMode=value,a.channelCountMode=value,n.channelCountMode=value,l.channelCountMode=value,s.channelCountMode=value,h.channelCountMode=value},get channelInterpretation(){return n.channelInterpretation},set channelInterpretation(value){o.channelInterpretation=value,a.channelInterpretation=value,n.channelInterpretation=value,l.channelInterpretation=value,s.channelInterpretation=value,h.channelInterpretation=value},get context(){return n.context},get curve(){return d},set curve(value){if(null!==value&&value.length<2)throw dc();if(null===value)n.curve=value,s.curve=value;else{let e=value.length,t=new Float32Array(e+2-e%2),r=new Float32Array(e+2-e%2);t[0]=value[0],r[0]=-value[e-1];let i=Math.ceil((e+1)/2),o=(e+1)/2-1;for(let n=1;n<i;n+=1){let s=n/i*o,a=Math.floor(s),l=Math.ceil(s);t[n]=a===l?value[a]:(1-(s-a))*value[a]+(1-(l-s))*value[l],r[n]=a===l?-value[e-1-a]:-((1-(s-a))*value[e-1-a])-(1-(l-s))*value[e-1-l]}t[i]=e%2==1?value[i-1]:(value[i-2]+value[i-1])/2,n.curve=t,s.curve=r}d=value,c&&(d$(d)&&null===u?u=fV(e,o):null!==u&&(u(),u=null))},get inputs(){return[o]},get numberOfInputs(){return n.numberOfInputs},get numberOfOutputs(){return n.numberOfOutputs},get oversample(){return n.oversample},set oversample(value){n.oversample=value,s.oversample=value},addEventListener:(...e)=>o.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>o.dispatchEvent(e[0]),removeEventListener:(...e)=>o.removeEventListener(e[0],e[1],e[2])};return null!==t&&(f.curve=t instanceof Float32Array?t:new Float32Array(t)),r!==f.oversample&&(f.oversample=r),fw(dN(f,l),()=>{o.connect(n).connect(l),o.connect(a).connect(s).connect(h).connect(l),c=!0,d$(d)&&(u=fV(e,o))},()=>{o.disconnect(n),n.disconnect(l),o.disconnect(a),a.disconnect(s),s.disconnect(h),h.disconnect(l),c=!1,null!==u&&(u(),u=null)})},(e,t)=>{let r=e.createWaveShaper();if(null!==fr&&"webkitAudioContext"===fr.name&&void 0===e.createGain().gain.automationRate)return tu(e,t);dx(r,t);let i=null===t.curve||t.curve instanceof Float32Array?t.curve:new Float32Array(t.curve);if(null!==i&&i.length<2)throw dc();d_(r,{curve:i},"curve"),d_(r,t,"oversample");let n=null,s=!1;return dY(r,"curve",e=>()=>e.call(r),t=>i=>(t.call(r,i),s&&(d$(i)&&null===n?n=fV(e,r):d$(i)||null===n||(n(),n=null)),i)),fw(r,()=>{s=!0,d$(r.curve)&&(n=fV(e,r))},()=>{s=!1,null!==n&&(n(),n=null)})}),fW=(tc=(e,{coneInnerAngle:t,coneOuterAngle:r,coneOuterGain:i,distanceModel:n,maxDistance:s,orientationX:o,orientationY:a,orientationZ:l,panningModel:h,positionX:u,positionY:c,positionZ:d,refDistance:f,rolloffFactor:p,...m})=>{let g=e.createPanner();if(m.channelCount>2||"max"===m.channelCountMode)throw dU();dx(g,m);let v={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},y=fC(e,{...v,channelInterpretation:"speakers",numberOfInputs:6}),x=dB(e,{...m,gain:1}),b=dB(e,{...v,gain:1}),T=dB(e,{...v,gain:0}),A=dB(e,{...v,gain:0}),E=dB(e,{...v,gain:0}),w=dB(e,{...v,gain:0}),C=dB(e,{...v,gain:0}),S=dk(e,256,6,1),I=fX(e,{...v,curve:new Float32Array([1,1]),oversample:"none"}),R=[o,a,l],M=[u,c,d],P=new Float32Array(1);S.onaudioprocess=({inputBuffer:e})=>{let t=[dW(e,P,0),dW(e,P,1),dW(e,P,2)];t.some((e,t)=>e!==R[t])&&(g.setOrientation(...t),R=t);let r=[dW(e,P,3),dW(e,P,4),dW(e,P,5)];r.some((e,t)=>e!==M[t])&&(g.setPosition(...r),M=r)},Object.defineProperty(T.gain,"defaultValue",{get:()=>0}),Object.defineProperty(A.gain,"defaultValue",{get:()=>0}),Object.defineProperty(E.gain,"defaultValue",{get:()=>0}),Object.defineProperty(w.gain,"defaultValue",{get:()=>0}),Object.defineProperty(C.gain,"defaultValue",{get:()=>0});let O={get bufferSize(){return},get channelCount(){return g.channelCount},set channelCount(value){if(value>2)throw dU();x.channelCount=value,g.channelCount=value},get channelCountMode(){return g.channelCountMode},set channelCountMode(value){if("max"===value)throw dU();x.channelCountMode=value,g.channelCountMode=value},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(value){x.channelInterpretation=value,g.channelInterpretation=value},get coneInnerAngle(){return g.coneInnerAngle},set coneInnerAngle(value){g.coneInnerAngle=value},get coneOuterAngle(){return g.coneOuterAngle},set coneOuterAngle(value){g.coneOuterAngle=value},get coneOuterGain(){return g.coneOuterGain},set coneOuterGain(value){if(value<0||value>1)throw dc();g.coneOuterGain=value},get context(){return g.context},get distanceModel(){return g.distanceModel},set distanceModel(value){g.distanceModel=value},get inputs(){return[x]},get maxDistance(){return g.maxDistance},set maxDistance(value){if(value<0)throw RangeError();g.maxDistance=value},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get orientationX(){return b.gain},get orientationY(){return T.gain},get orientationZ(){return A.gain},get panningModel(){return g.panningModel},set panningModel(value){g.panningModel=value},get positionX(){return E.gain},get positionY(){return w.gain},get positionZ(){return C.gain},get refDistance(){return g.refDistance},set refDistance(value){if(value<0)throw RangeError();g.refDistance=value},get rolloffFactor(){return g.rolloffFactor},set rolloffFactor(value){if(value<0)throw RangeError();g.rolloffFactor=value},addEventListener:(...e)=>x.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>x.dispatchEvent(e[0]),removeEventListener:(...e)=>x.removeEventListener(e[0],e[1],e[2])};return t!==O.coneInnerAngle&&(O.coneInnerAngle=t),r!==O.coneOuterAngle&&(O.coneOuterAngle=r),i!==O.coneOuterGain&&(O.coneOuterGain=i),n!==O.distanceModel&&(O.distanceModel=n),s!==O.maxDistance&&(O.maxDistance=s),o!==O.orientationX.value&&(O.orientationX.value=o),a!==O.orientationY.value&&(O.orientationY.value=a),l!==O.orientationZ.value&&(O.orientationZ.value=l),h!==O.panningModel&&(O.panningModel=h),u!==O.positionX.value&&(O.positionX.value=u),c!==O.positionY.value&&(O.positionY.value=c),d!==O.positionZ.value&&(O.positionZ.value=d),f!==O.refDistance&&(O.refDistance=f),p!==O.rolloffFactor&&(O.rolloffFactor=p),(1!==R[0]||0!==R[1]||0!==R[2])&&g.setOrientation(...R),(0!==M[0]||0!==M[1]||0!==M[2])&&g.setPosition(...M),fw(dN(O,g),()=>{x.connect(g),cF(x,I,0,0),I.connect(b).connect(y,0,0),I.connect(T).connect(y,0,1),I.connect(A).connect(y,0,2),I.connect(E).connect(y,0,3),I.connect(w).connect(y,0,4),I.connect(C).connect(y,0,5),y.connect(S).connect(e.destination)},()=>{x.disconnect(g),cG(x,I,0,0),I.disconnect(b),b.disconnect(y),I.disconnect(T),T.disconnect(y),I.disconnect(A),A.disconnect(y),I.disconnect(E),E.disconnect(y),I.disconnect(w),w.disconnect(y),I.disconnect(C),C.disconnect(y),y.disconnect(S),S.disconnect(e.destination)})},(e,t)=>{let r=e.createPanner();return void 0===r.orientationX?tc(e,t):(dx(r,t),dA(r,t,"orientationX"),dA(r,t,"orientationY"),dA(r,t,"orientationZ"),dA(r,t,"positionX"),dA(r,t,"positionY"),dA(r,t,"positionZ"),d_(r,t,"coneInnerAngle"),d_(r,t,"coneOuterAngle"),d_(r,t,"coneOuterGain"),d_(r,t,"distanceModel"),d_(r,t,"maxDistance"),d_(r,t,"panningModel"),d_(r,t,"refDistance"),d_(r,t,"rolloffFactor"),r)}),f$=(td=fa,tf=()=>{let e=new WeakMap,t=null,r=async(r,i)=>{let n=null,s=cz(r),o={channelCount:s.channelCount,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation},a={...o,coneInnerAngle:s.coneInnerAngle,coneOuterAngle:s.coneOuterAngle,coneOuterGain:s.coneOuterGain,distanceModel:s.distanceModel,maxDistance:s.maxDistance,panningModel:s.panningModel,refDistance:s.refDistance,rolloffFactor:s.rolloffFactor},l=cd(s,i);if("bufferSize"in s?n=dB(i,{...o,gain:1}):l||(s=fW(i,{...a,orientationX:s.orientationX.value,orientationY:s.orientationY.value,orientationZ:s.orientationZ.value,positionX:s.positionX.value,positionY:s.positionY.value,positionZ:s.positionZ.value})),e.set(i,null===n?s:n),null!==n){if(null===t){if(null===d7)throw Error("Missing the native OfflineAudioContext constructor.");let e=new d7(6,r.context.length,i.sampleRate),n=fC(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});n.connect(e.destination),t=(async()=>{let t=await Promise.all([r.orientationX,r.orientationY,r.orientationZ,r.positionX,r.positionY,r.positionZ].map(async(t,r)=>{let i=fR(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===r?1:0});return await f_(e,t,i.offset),i}));for(let e=0;e<6;e+=1)t[e].connect(n,0,e),t[e].start(0);return fL(e)})()}let e=await t,s=dB(i,{...o,gain:1});await d8(r,i,s);let l=[];for(let t=0;t<e.numberOfChannels;t+=1)l.push(e.getChannelData(t));let h=[l[0][0],l[1][0],l[2][0]],u=[l[3][0],l[4][0],l[5][0]],c=dB(i,{...o,gain:1}),d=fW(i,{...a,orientationX:h[0],orientationY:h[1],orientationZ:h[2],positionX:u[0],positionY:u[1],positionZ:u[2]});s.connect(c).connect(d.inputs[0]),d.connect(n);for(let t=128;t<e.length;t+=128){let e=[l[0][t],l[1][t],l[2][t]],r=[l[3][t],l[4][t],l[5][t]];if(e.some((e,t)=>e!==h[t])||r.some((e,t)=>e!==u[t])){h=e,u=r;let l=t/i.sampleRate;c.gain.setValueAtTime(0,l),c=dB(i,{...o,gain:0}),d=fW(i,{...a,orientationX:h[0],orientationY:h[1],orientationZ:h[2],positionX:u[0],positionY:u[1],positionZ:u[2]}),c.gain.setValueAtTime(1,l),s.connect(c).connect(d.inputs[0]),d.connect(n)}}return n}return l?(await fv(i,r.orientationX,s.orientationX),await fv(i,r.orientationY,s.orientationY),await fv(i,r.orientationZ,s.orientationZ),await fv(i,r.positionX,s.positionX),await fv(i,r.positionY,s.positionY),await fv(i,r.positionZ,s.positionZ)):(await f_(i,r.orientationX,s.orientationX),await f_(i,r.orientationY,s.orientationY),await f_(i,r.orientationZ,s.orientationZ),await f_(i,r.positionX,s.positionX),await f_(i,r.positionY,s.positionY),await f_(i,r.positionZ,s.positionZ)),cN(s)?await d8(r,i,s.inputs[0]):await d8(r,i,s),s};return{render(t,i){let n=e.get(i);return void 0!==n?Promise.resolve(n):r(t,i)}}},class extends td{constructor(e,t){let r=d6(e),i=fW(r,{...dj,...t}),n=d9(r);super(e,!1,i,n?tf():null),this._nativePannerNode=i,this._orientationX=fx(this,n,i.orientationX,34028234663852886e22,-34028234663852886e22),this._orientationY=fx(this,n,i.orientationY,34028234663852886e22,-34028234663852886e22),this._orientationZ=fx(this,n,i.orientationZ,34028234663852886e22,-34028234663852886e22),this._positionX=fx(this,n,i.positionX,34028234663852886e22,-34028234663852886e22),this._positionY=fx(this,n,i.positionY,34028234663852886e22,-34028234663852886e22),this._positionZ=fx(this,n,i.positionZ,34028234663852886e22,-34028234663852886e22),fA(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(e){this._nativePannerNode.coneInnerAngle=e}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(e){this._nativePannerNode.coneOuterAngle=e}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(e){this._nativePannerNode.coneOuterGain=e}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(e){this._nativePannerNode.distanceModel=e}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(e){this._nativePannerNode.maxDistance=e}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(e){this._nativePannerNode.panningModel=e}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(e){this._nativePannerNode.refDistance=e}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(e){this._nativePannerNode.rolloffFactor=e}}),fY=(tp=(e,{disableNormalization:t,imag:r,real:i})=>{let n=r instanceof Float32Array?r:new Float32Array(r),s=i instanceof Float32Array?i:new Float32Array(i),o=e.createPeriodicWave(s,n,{disableNormalization:t});if(Array.from(r).length<2)throw cp();return o},tm=new WeakSet,tg=e=>{let{imag:t,real:r}=e;return void 0===t?void 0===r?{...e,imag:[0,0],real:[0,0]}:{...e,imag:Array.from(r,()=>0),real:r}:void 0===r?{...e,imag:t,real:Array.from(t,()=>0)}:{...e,imag:t,real:r}},class e{constructor(e,t){let r=tp(d6(e),tg({...dH,...t}));return tm.add(r),r}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===e.prototype||tm.has(t)}}),fq=(tv=((e,t,r,i,n,s)=>{let o=new Float32Array([1,1]),a=Math.PI/2,l={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},h={...l,oversample:"none"},u=(e,t,n,s)=>{let u=new Float32Array(16385),c=new Float32Array(16385);for(let e=0;e<16385;e+=1){let t=e/16384*a;u[e]=Math.cos(t),c[e]=Math.sin(t)}let d=r(e,{...l,gain:0}),f=i(e,{...h,curve:u}),p=i(e,{...h,curve:o}),m=r(e,{...l,gain:0}),g=i(e,{...h,curve:c});return{connectGraph(){t.connect(d),t.connect(void 0===p.inputs?p:p.inputs[0]),t.connect(m),p.connect(n),n.connect(void 0===f.inputs?f:f.inputs[0]),n.connect(void 0===g.inputs?g:g.inputs[0]),f.connect(d.gain),g.connect(m.gain),d.connect(s,0,0),m.connect(s,0,1)},disconnectGraph(){t.disconnect(d),t.disconnect(void 0===p.inputs?p:p.inputs[0]),t.disconnect(m),p.disconnect(n),n.disconnect(void 0===f.inputs?f:f.inputs[0]),n.disconnect(void 0===g.inputs?g:g.inputs[0]),f.disconnect(d.gain),g.disconnect(m.gain),d.disconnect(s,0,0),m.disconnect(s,0,1)}}},c=(e,n,s,u)=>{let c=new Float32Array(16385),d=new Float32Array(16385),f=new Float32Array(16385),p=new Float32Array(16385),m=Math.floor(8192.5);for(let e=0;e<16385;e+=1)if(e>m){let t=(e-m)/(16384-m)*a;c[e]=Math.cos(t),d[e]=Math.sin(t),f[e]=0,p[e]=1}else{let t=e/(16384-m)*a;c[e]=1,d[e]=0,f[e]=Math.cos(t),p[e]=Math.sin(t)}let g=t(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),v=r(e,{...l,gain:0}),y=i(e,{...h,curve:c}),x=r(e,{...l,gain:0}),b=i(e,{...h,curve:d}),T=i(e,{...h,curve:o}),A=r(e,{...l,gain:0}),E=i(e,{...h,curve:f}),w=r(e,{...l,gain:0}),C=i(e,{...h,curve:p});return{connectGraph(){n.connect(g),n.connect(void 0===T.inputs?T:T.inputs[0]),g.connect(v,0),g.connect(x,0),g.connect(A,1),g.connect(w,1),T.connect(s),s.connect(void 0===y.inputs?y:y.inputs[0]),s.connect(void 0===b.inputs?b:b.inputs[0]),s.connect(void 0===E.inputs?E:E.inputs[0]),s.connect(void 0===C.inputs?C:C.inputs[0]),y.connect(v.gain),b.connect(x.gain),E.connect(A.gain),C.connect(w.gain),v.connect(u,0,0),A.connect(u,0,0),x.connect(u,0,1),w.connect(u,0,1)},disconnectGraph(){n.disconnect(g),n.disconnect(void 0===T.inputs?T:T.inputs[0]),g.disconnect(v,0),g.disconnect(x,0),g.disconnect(A,1),g.disconnect(w,1),T.disconnect(s),s.disconnect(void 0===y.inputs?y:y.inputs[0]),s.disconnect(void 0===b.inputs?b:b.inputs[0]),s.disconnect(void 0===E.inputs?E:E.inputs[0]),s.disconnect(void 0===C.inputs?C:C.inputs[0]),y.disconnect(v.gain),b.disconnect(x.gain),E.disconnect(A.gain),C.disconnect(w.gain),v.disconnect(u,0,0),A.disconnect(u,0,0),x.disconnect(u,0,1),w.disconnect(u,0,1)}}},d=(e,t,r,i,s)=>{if(1===t)return u(e,r,i,s);if(2===t)return c(e,r,i,s);throw n()};return(t,{channelCount:i,channelCountMode:o,pan:a,...l})=>{if("max"===o)throw n();let h=e(t,{...l,channelCount:1,channelCountMode:o,numberOfInputs:2}),u=r(t,{...l,channelCount:i,channelCountMode:o,gain:1}),c=r(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a}),{connectGraph:f,disconnectGraph:p}=d(t,i,u,c,h);Object.defineProperty(c.gain,"defaultValue",{get:()=>0}),Object.defineProperty(c.gain,"maxValue",{get:()=>1}),Object.defineProperty(c.gain,"minValue",{get:()=>-1});let m=!1;return s(dN({get bufferSize(){return},get channelCount(){return u.channelCount},set channelCount(value){u.channelCount!==value&&(m&&p(),{connectGraph:f,disconnectGraph:p}=d(t,value,u,c,h),m&&f()),u.channelCount=value},get channelCountMode(){return u.channelCountMode},set channelCountMode(value){if("clamped-max"===value||"max"===value)throw n();u.channelCountMode=value},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(value){u.channelInterpretation=value},get context(){return u.context},get inputs(){return[u]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get pan(){return c.gain},addEventListener:(...e)=>u.addEventListener(e[0],e[1],e[2]),dispatchEvent:(...e)=>u.dispatchEvent(e[0]),removeEventListener:(...e)=>u.removeEventListener(e[0],e[1],e[2])},h),()=>{f(),m=!0},()=>{p(),m=!1})}})(fC,dD,dB,fX,dU,fw),(e,t)=>{let r=t.channelCountMode;if("clamped-max"===r)throw dU();if(void 0===e.createStereoPanner)return tv(e,t);let i=e.createStereoPanner();return dx(i,t),dA(i,t,"pan"),Object.defineProperty(i,"channelCountMode",{get:()=>r,set:e=>{if(e!==r)throw dU()}}),i}),fZ=(ty=fa,t_=()=>{let e=new WeakMap,t=async(t,r)=>{let i=cz(t),n=cd(i,r);return n||(i=fq(r,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,pan:i.pan.value})),e.set(r,i),n?await fv(r,t.pan,i.pan):await f_(r,t.pan,i.pan),cN(i)?await d8(t,r,i.inputs[0]):await d8(t,r,i),i};return{render(r,i){let n=e.get(i);return void 0!==n?Promise.resolve(n):t(r,i)}}},class extends ty{constructor(e,t){let r=d6(e),i=fq(r,{...dV,...t}),n=d9(r);super(e,!1,i,n?t_():null),this._pan=fx(this,n,i.pan)}get pan(){return this._pan}}),fK=(tx=fa,tb=()=>{let e=new WeakMap,t=async(t,r)=>{let i=cz(t);return cd(i,r)||(i=fX(r,{channelCount:i.channelCount,channelCountMode:i.channelCountMode,channelInterpretation:i.channelInterpretation,curve:i.curve,oversample:i.oversample})),e.set(r,i),cN(i)?await d8(t,r,i.inputs[0]):await d8(t,r,i),i};return{render(r,i){let n=e.get(i);return void 0!==n?Promise.resolve(n):t(r,i)}}},class extends tx{constructor(e,t){let r=d6(e),i=fX(r,{...dX,...t});super(e,!0,i,d9(r)?tb():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=i,fA(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw dc();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(e){this._nativeWaveShaperNode.oversample=e}}),fQ=null!==d3&&d3.isSecureContext,fJ=(e,t,r)=>{Object.defineProperties(d3,{currentFrame:{configurable:!0,get:()=>Math.round(e*t)},currentTime:{configurable:!0,get:()=>e}});try{return r()}finally{null!==d3&&(delete d3.currentFrame,delete d3.currentTime)}},f0=new WeakMap,f1=fQ?(tA=e=>new Promise((t,r)=>{if(null===d3){r(SyntaxError());return}let i=d3.document.head;if(null===i)r(SyntaxError());else{let n=d3.document.createElement("script"),s=new Blob([e],{type:"application/javascript"}),o=URL.createObjectURL(s),a=d3.onerror,l=()=>{d3.onerror=a,URL.revokeObjectURL(o)};d3.onerror=(e,t,i,n,s)=>t===o||t===d3.location.href&&1===i&&1===n?(l(),r(s),!1):null!==a?a(e,t,i,n,s):void 0,n.onerror=()=>{l(),r(SyntaxError())},n.onload=()=>{l(),t()},n.src=o,n.type="module",i.appendChild(n)}}),tT=()=>new DOMException("","AbortError"),tE=async e=>{try{let t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw tT()},tw=e=>{let t=f0.get(e);if(void 0!==t)return t;if(null===d7)throw Error("Missing the native OfflineAudioContext constructor.");return t=new d7(1,1,44100),f0.set(e,t),t},tC=new WeakMap,tS=new WeakMap,tI=async()=>{if(null===fo)return!0;if(null===d7)return!1;let e=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),t=new d7(1,128,44100),r=URL.createObjectURL(e),i=!1,n=!1;try{await t.audioWorklet.addModule(r);let e=new fo(t,"a",{numberOfOutputs:0}),s=t.createOscillator();e.port.onmessage=()=>i=!0,e.onprocessorerror=()=>n=!0,s.connect(e),s.start(0),await t.startRendering(),await new Promise(e=>setTimeout(e))}catch{}finally{URL.revokeObjectURL(r)}return i&&!n},l=0,(e,t,r={credentials:"omit"})=>{let i=tS.get(e);if(void 0!==i&&i.has(t))return Promise.resolve();let n=tC.get(e);if(void 0!==n){let e=n.get(t);if(void 0!==e)return e}let s=d6(e),o=void 0===s.audioWorklet?tE(t).then(([e,t])=>{let[r,i]=ce(e,t);return tA(`${r};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${i}
})})(window,'_AWGS')`)}).then(()=>{let e=d3._AWGS.pop();if(void 0===e)throw SyntaxError();fJ(s.currentTime,s.sampleRate,()=>e(class{},void 0,(e,t)=>{if(""===e.trim())throw dU();let r=u5.get(s);if(void 0!==r){if(r.has(e))throw dU();cr(t),ct(t.parameterDescriptors),r.set(e,t)}else cr(t),ct(t.parameterDescriptors),u5.set(s,new Map([[e,t]]))},s.sampleRate,void 0,void 0))}):Promise.all([tE(t),Promise.resolve(d2(tI,tI))]).then(([[e,t],i])=>{let n=l+1;l=n;let[o,a]=ce(e,t),h=`${o};((AudioWorkletProcessor,registerProcessor)=>{${a}
})(${i?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${i?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${i?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${n}',class extends AudioWorkletProcessor{process(){return !1}})`,u=new Blob([h],{type:"application/javascript; charset=utf-8"}),c=URL.createObjectURL(u);return s.audioWorklet.addModule(c,r).then(()=>{if(d9(s))return s;let e=tw(s);return e.audioWorklet.addModule(c,r).then(()=>e)}).then(e=>{if(null===fo)throw SyntaxError();try{new fo(e,`__sac${n}`)}catch{throw SyntaxError()}}).finally(()=>URL.revokeObjectURL(c))});return void 0===n?tC.set(e,new Map([[t,o]])):n.set(t,o),o.then(()=>{let r=tS.get(e);void 0===r?tS.set(e,new Set([t])):r.add(t)}).finally(()=>{let r=tC.get(e);void 0!==r&&r.delete(t)}),o}):void 0,f2=(tR=()=>new DOMException("","DataCloneError"),tM=()=>new DOMException("","EncodingError"),tP=new WeakSet,tO=e=>fi(e)||d9(e),(e,t)=>{let r=tO(e)?e:d6(e);if(tP.has(t))return Promise.reject(tR());try{tP.add(t)}catch{}return d2(dy,()=>dy(r))?r.decodeAudioData(t).then(e=>(dn(t).catch(()=>{}),d2(cf,()=>cf(e))||ff(e),fh.add(e),e)):new Promise((e,i)=>{let n=async()=>{try{await dn(t)}catch{}},s=e=>{i(e),n()};try{r.decodeAudioData(t,t=>{"function"!=typeof t.copyFromChannel&&(fd(t),cm(t)),fh.add(t),n().then(()=>e(t))},e=>{null===e?s(tM()):s(e)})}catch(e){s(e)}})}),f3=(tD=fz,class extends tD{constructor(e,t){super(e,t),this._nativeContext=e,this._audioWorklet=void 0===f1?void 0:{addModule:(e,t)=>f1(this,e,t)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new fl(this)}createBiquadFilter(){return new fE(this)}createBuffer(e,t,r){return new fp({length:t,numberOfChannels:e,sampleRate:r})}createBufferSource(){return new fb(this)}createChannelMerger(e=6){return new fS(this,{numberOfInputs:e})}createChannelSplitter(e=6){return new fI(this,{numberOfOutputs:e})}createConstantSource(){return new fM(this)}createConvolver(){return new fO(this)}createDelay(e=1){return new fD(this,{maxDelayTime:e})}createDynamicsCompressor(){return new fF(this)}createGain(){return new fB(this)}createIIRFilter(e,t){return new fU(this,{feedback:t,feedforward:e})}createOscillator(){return new fH(this)}createPanner(){return new f$(this)}createPeriodicWave(e,t,r={disableNormalization:!1}){return new fY(this,{...r,imag:t,real:e})}createStereoPanner(){return new fZ(this)}createWaveShaper(){return new fK(this)}decodeAudioData(e,t,r){return f2(this._nativeContext,e).then(e=>("function"==typeof t&&t(e),e),e=>{throw"function"==typeof r&&r(e),e})}}),f4=(tN=fa,tF=(e,t)=>e.createMediaElementSource(t.mediaElement),tB=fa,tL=(e,t)=>{let r=e.createMediaStreamDestination();return dx(r,t),1===r.numberOfOutputs&&Object.defineProperty(r,"numberOfOutputs",{get:()=>0}),r},tk=fa,tU=(e,{mediaStream:t})=>{let r=t.getAudioTracks();r.sort((e,t)=>e.id<t.id?-1:e.id>t.id?1:0);let i=r.slice(0,1),n=e.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(n,"mediaStream",{value:t}),n},tG=fa,tz=(e,{mediaStreamTrack:t})=>{if("function"==typeof e.createMediaStreamTrackSource)return e.createMediaStreamTrackSource(t);let r=new MediaStream([t]),i=e.createMediaStreamSource(r);if("audio"!==t.kind)throw dc();if(d9(e))throw TypeError();return i},e=>{let t=fG.get(e);if(void 0===t)throw Error("The context has no set of AudioWorkletNodes.");return t}),f5=(e,t,r=0,i=0)=>{let n=e[r];if(void 0===n)throw cp();return c$(t)?n.connect(t,0,i):n.connect(t,0)},f8=(e,t,r,i=0)=>void 0===t?e.forEach(e=>e.disconnect()):"number"==typeof t?dl(cp,e,t).disconnect():c$(t)?void 0===r?e.forEach(e=>e.disconnect(t)):void 0===i?dl(cp,e,r).disconnect(t,0):dl(cp,e,r).disconnect(t,0,i):void 0===r?e.forEach(e=>e.disconnect(t)):dl(cp,e,r).disconnect(t,0),f6=new WeakMap,f7=(tj=e=>ci(f6,e),tH=(e,t)=>{f4(e).delete(t)},(e,t,r)=>{if(null===d7)throw Error("Missing the native OfflineAudioContext constructor.");try{return new d7(e,t,r)}catch(e){if("SyntaxError"===e.name)throw dU();throw e}}),f9=(e,t)=>d5(e).render(e,t).then(()=>Promise.all(Array.from(f4(t)).map(e=>d5(e).render(e,t)))).then(()=>fL(t)).then(e=>("function"!=typeof e.copyFromChannel?(fd(e),cm(e)):d2(cf,()=>cf(e))||ff(e),fh.add(e),e)),pe=(tV=f3,class extends tV{constructor(e,t,r){let i;if("number"==typeof e&&void 0!==t&&void 0!==r)i={length:t,numberOfChannels:e,sampleRate:r};else if("object"==typeof e)i=e;else throw Error("The given parameters are not valid.");let{length:n,numberOfChannels:s,sampleRate:o}={...dG,...i},a=f7(s,n,o);d2(dy,()=>dy(a))||a.addEventListener("statechange",(()=>{let e=0,t=r=>{"running"===this._state&&(e>0?(a.removeEventListener("statechange",t),r.stopImmediatePropagation(),this._waitForThePromiseToSettle(r)):e+=1)};return t})()),super(a,s),this._length=n,this._nativeOfflineAudioContext=a,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(dc()):(this._state="running",f9(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,cI(this)}))}_waitForThePromiseToSettle(e){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout(()=>this._waitForThePromiseToSettle(e))}}),pt=(e,t,r)=>{let i=new pe(e.numberOfChannels,Math.round(r*e.sampleRate),e.sampleRate),n=i.createBiquadFilter(),s=i.createBufferSource();return n.frequency.value=240,n.type="lowpass",s.buffer=e,s.connect(n).connect(i.destination),s.start(0,t,r),i.startRendering().then(e=>({channelData:e.getChannelData(0),sampleRate:e.sampleRate}))},pr=(tX=e=>{let t=new Worker(e),r=new Set;return{analyze:(...e)=>{var i;let[n,s,o]=e,a="number"==typeof s?s:0,l="number"==typeof o?o:n.duration-a,h="object"==typeof s?s:"object"==typeof o?o:null!==(i=e[3])&&void 0!==i?i:null;return new Promise(async(e,i)=>{let{channelData:s,sampleRate:o}=await pt(n,a,l),u=(0,uq.addUniqueNumber)(r),c=({data:n})=>{n.id===u&&(r.delete(u),t.removeEventListener("message",c),null===n.error?e(n.result.tempo):i(Error(n.error.message)))};t.addEventListener("message",c),t.postMessage({id:u,method:"analyze",params:{channelData:s,sampleRate:o,...null===h?h:{tempoSettings:h}}},[s.buffer])})},guess:(...e)=>{var i;let[n,s,o]=e,a="number"==typeof s?s:0,l="number"==typeof o?o:n.duration-a,h="object"==typeof s?s:"object"==typeof o?o:null!==(i=e[3])&&void 0!==i?i:null;return new Promise(async(e,i)=>{let{channelData:s,sampleRate:o}=await pt(n,a,l),u=(0,uq.addUniqueNumber)(r),c=({data:n})=>{n.id===u&&(r.delete(u),t.removeEventListener("message",c),null===n.error?e(n.result):i(Error(n.error.message)))};t.addEventListener("message",c),t.postMessage({id:u,method:"guess",params:{channelData:s,sampleRate:o,...null===h?h:{tempoSettings:h}}},[s.buffer])})}}},h=null,()=>{if(null!==h)return h;let e=new Blob(['(()=>{"use strict";const e=(e,t,o)=>{const s=e.length,n=[];let a=!1;for(let r=0;r<s;r+=1)e[r]>t?a=!0:a&&(a=!1,n.push(r-1),r+=o/4-1);return a&&n.push(s-1),n},t=(t,o,s)=>{const n=(e=>{let t=0;const o=e.length;for(let s=0;s<o;s+=1)e[s]>t&&(t=e[s]);return t})(t),a=.3*n;let r=[],l=n-.05*n;if(n>.25)for(;r.length<30&&l>=a;)r=e(t,l,o),l-=.05*n;const p=(e=>{const t=[];return e.forEach(((o,s)=>{const n=Math.min(e.length-s,10);for(let a=1;a<n;a+=1){const n=e[s+a]-o;t.some((e=>e.interval===n&&(e.peaks.push(o),!0)))||t.push({interval:n,peaks:[o]})}})),t})(r),h=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var s,n;const a=Math.max(0,null!==(s=o.minTempo)&&void 0!==s?s:90),r=Math.max(0,null!==(n=o.maxTempo)&&void 0!==n?n:180),l=[];return e.forEach((e=>{let o=60/(e.interval/t);for(;o<a;)o*=2;for(;o>r;)o/=2;let s=!1,n=e.peaks.length;l.forEach((t=>{if(t.tempo===o&&(t.score+=e.peaks.length,t.peaks=[...t.peaks,...e.peaks],s=!0),t.tempo>o-.5&&t.tempo<o+.5){const s=2*Math.abs(t.tempo-o);n+=(1-s)*t.peaks.length,t.score+=(1-s)*e.peaks.length}})),s||l.push({peaks:e.peaks,score:n,tempo:o})})),l}(p,o,s);return h.sort(((e,t)=>t.score-e.score)),h};addEventListener("message",(e=>{let{data:o}=e;try{if("analyze"===o.method){const{id:e,params:{channelData:s,sampleRate:n,tempoSettings:a}}=o,r=((e,o,s)=>{const n=t(e,o,s);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");return n[0].tempo})(s,n,a);postMessage({error:null,id:e,result:{tempo:r}})}else{if("guess"!==o.method)throw new Error(\'The given method "\'.concat(o.method,\'" is not supported\'));{const{id:e,params:{channelData:s,sampleRate:n,tempoSettings:a}}=o,{bpm:r,offset:l,tempo:p}=((e,o,s)=>{const n=t(e,o,s);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");const{peaks:a,tempo:r}=n[0],l=Math.round(r),p=60/l;a.sort(((e,t)=>e-t));let h=a[0]/o;for(;h>p;)h-=p;return{bpm:l,offset:h,tempo:r}})(s,n,a);postMessage({error:null,id:e,result:{bpm:r,offset:l,tempo:p}})}}}catch(e){postMessage({error:{message:e.message},id:o.id,result:null})}}))})();'],{type:"application/javascript; charset=utf-8"}),t=URL.createObjectURL(e);return h=tX(t),setTimeout(()=>URL.revokeObjectURL(t)),h}),pi=(...e)=>pr().analyze(...e),pn={main:t$(new URL("logo_tapages.fce56a75.webp",import.meta.url).toString())};class ps{constructor(){this.audioContext=null,this.sourceNode=null,this.destinationNode=null,this.audioBuffer=null,this.scriptNode=null,this.resolveBufferPromise=null,this.bufferPromise=null,this.initialize()}async initialize(){try{let e=await navigator.mediaDevices.getUserMedia({audio:!0});this.audioContext=new(window.AudioContext||window.webkitAudioContext),console.log(this.audioContext.destination),this.sourceNode=this.audioContext.createMediaStreamSource(e),this.destinationNode=this.audioContext.createMediaStreamDestination(),this.scriptNode=this.audioContext.createScriptProcessor(2048,1,1),this.sourceNode.connect(this.destinationNode),this.destinationNode&&(this.destinationNode.disconnect(),this.destinationNode.connect(this.audioContext.destination)),this.audioBuffer=this.audioContext.createBuffer(1,2048,this.audioContext.sampleRate),this.scriptNode&&(this.scriptNode.onaudioprocess=e=>{let t=e.inputBuffer.getChannelData(0);this.audioBuffer&&this.audioBuffer.getChannelData(0).set(t)},this.destinationNode.connect(this.scriptNode),this.scriptNode.connect(this.audioContext.destination),setTimeout(()=>{this.destinationNode?.stream&&(this.destinationNode.stream.getAudioTracks()[0].stop(),console.log("Recording ended"))},5e3))}catch(e){console.error("Error accessing the microphone: ",e)}}async getAudioBuffer(){return this.audioBuffer||(this.bufferPromise||(this.bufferPromise=new Promise(e=>{this.resolveBufferPromise=e})),await this.bufferPromise),this.audioBuffer}onRecordingEnded(){console.log("Recording ended"),this.resolveBufferPromise&&this.resolveBufferPromise(this.audioBuffer)}}const po={BEAT_ANIMATION_DURATION_MS:500,BPM:30},pa=e=>e/60;new class{constructor(e,t,r){this.app=new lO({width:t,height:r,backgroundColor:1118481,resizeTo:window,sharedTicker:!0}),e.appendChild(this.app.view),this.init()}prepareBackgroundContainer(){let e=lh.from("../assets/image/fff.png");e.anchor.set(0,0),e.anchor.x=0,e.anchor.y=0,e.width=this.app.screen.width,e.height=this.app.screen.height;let t=new lo,r=new sT(void 0,`
        #define NUM_LAYERS 4.

        precision highp float;
        uniform vec3      iResolution;           // viewport resolution (in pixels)
        uniform float     iTime;                 // shader playback time (in seconds)
        uniform vec4      iMouse;                // mouse pixel coords. xy: current (if MLB down), zw: click
        varying vec2 vTextureCoord;
        uniform sampler2D uSampler;

        mat2 Rot(float a) {
            float s = sin(a), c = cos(a);
            return mat2(c, -s, s, c);
        }

        float Star(vec2 uv, float flare){
            float d = length(uv);
            float m = .05/d;
            
            float rays = max(0.,1.-abs(uv.x * uv.y * 1000.));
            m += rays* flare;
            uv *= Rot(3.1415/4.);
            rays = max(0.,1.-abs(uv.x * uv.y * 1000.));
            m += rays * .3 * flare;
            m*= smoothstep(1.,.2,d);
            return m;
        }

        //RNG
        float Hash21(vec2 p){
            p = fract(p*vec2(123.34, 456.21));
            p += dot(p, p + 45.32);
            return fract(p.x * p.y);
        }

        vec3 StarLayer(vec2 uv){
            vec3 col = vec3(0);

            //boxes
            vec2 gv = fract(uv) - 0.5;
            vec2 id = floor(uv);

            for(int y=-1;y<=1;y++){
                for(int x=-1;x<=1;x++){
                    vec2 offs = vec2(x,y);
                    float n=  Hash21(id+offs); // random betwen 0 and 1
                    float size = fract(n*345.32);
                    float star = Star(gv-offs-vec2(n,fract(n*34.))+.5,smoothstep(.8, .9, size));
                    vec3 color = sin(vec3(.2,.3,.9)*fract(n*2345.2)*6.2831* 100.)* 0.5 + 0.5;
                    color = color* vec3(1,.5,1.+size);            
                    color += pow(length(gv - offs) * 0.1,mod(iTime + n,.2));
                    star *= sin(iTime*90.+n*6.2831)*.2+1.;
                    col += size * star * color;
                }
            }
            return col;
        }

        void main(void)
        {
            // Normalized pixel coordinates (from -0.5 to 0.5)
            vec2 uv = (gl_FragCoord.xy -.5*iResolution.xy)/iResolution.y;
            vec2 M = (iMouse.xy -.5*iResolution.xy)/iResolution.y;
            float t = iTime*.01;
            uv += M *4.;
            uv *= Rot(t);
            vec3 col = vec3(0);
            
            for(float i=0.; i<1.; i+=1./NUM_LAYERS) {
                float depth = fract(i+t);
                float scale = mix(20.,.5,depth);
                float fade = depth* smoothstep(1.,.9,depth);
                col += StarLayer(uv*scale+i*453.2-M)*fade;
            }
            
            //red grid
            //if(gv.x > .48 || gv.y > .48) col.r = 1.;
            
            //col.rg += id*.4;
            //col += Hash21(uv);
            
            // Output to screen
            gl_FragColor = vec4(col,1.0);
        }
        `,{iResolution:[this.app.screen.width,this.app.screen.height,1],iTime:350,iMouse:[.001*this.app.screen.width,.4*this.app.screen.height,.2*this.app.screen.width,this.app.screen.height/2]});new oF(.2,3);let i=new oG({threshold:.5,bloomScale:.03,brightness:.5,blur:.8,quality:4});return this.app.ticker.add(()=>{r.uniforms.iTime+=.05}),t.filters=[r,i],t.addChild(e),t}prepareLogoContainer(){let e=new lo,t=new ak(2,0,1),r=lh.from(pn.main),i=[new aO([30,30],15),new aV([11,0],[2,0],[1,4])],n=[t];e.filters=n,r.x=this.app.screen.width/2,r.y=this.app.screen.height/2,r.height=.4*this.app.screen.width,r.width=r.height,r.anchor.set(.5,.5),this.app.ticker.add(e=>{r.rotation+=.003});let s=new no;return s.minFPS=pa(po.BPM),s.maxFPS=pa(po.BPM),s.start(),s.add(t=>{e.filters=e.filters.concat(i),setTimeout(t=>{e.filters=n},po.BEAT_ANIMATION_DURATION_MS)}),e.addChild(r),e}async setupAudioCapture(){let e=new ps;pi(await e.getAudioBuffer()).then(e=>{console.log(e)}).catch(e=>{console.error(e)})}init(){let e=this.prepareBackgroundContainer(),t=this.prepareLogoContainer();this.app.stage.addChild(e),this.app.stage.addChild(t)}}(document.body,window.innerWidth,window.innerHeight);
//# sourceMappingURL=index.0d05273c.js.map
